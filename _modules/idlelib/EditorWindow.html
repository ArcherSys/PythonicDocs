

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>idlelib.EditorWindow &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>idlelib.EditorWindow</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for idlelib.EditorWindow</h1><div class="highlight"><pre>
<span class="kn">import</span> <span class="nn">importlib</span>
<span class="kn">import</span> <span class="nn">importlib.abc</span>
<span class="kn">import</span> <span class="nn">importlib.util</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">tkinter.simpledialog</span> <span class="kn">as</span> <span class="nn">tkSimpleDialog</span>
<span class="kn">import</span> <span class="nn">tkinter.messagebox</span> <span class="kn">as</span> <span class="nn">tkMessageBox</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>

<span class="kn">from</span> <span class="nn">idlelib.MultiCall</span> <span class="kn">import</span> <span class="n">MultiCallCreator</span>
<span class="kn">from</span> <span class="nn">idlelib</span> <span class="kn">import</span> <span class="n">idlever</span>
<span class="kn">from</span> <span class="nn">idlelib</span> <span class="kn">import</span> <span class="n">WindowList</span>
<span class="kn">from</span> <span class="nn">idlelib</span> <span class="kn">import</span> <span class="n">SearchDialog</span>
<span class="kn">from</span> <span class="nn">idlelib</span> <span class="kn">import</span> <span class="n">GrepDialog</span>
<span class="kn">from</span> <span class="nn">idlelib</span> <span class="kn">import</span> <span class="n">ReplaceDialog</span>
<span class="kn">from</span> <span class="nn">idlelib</span> <span class="kn">import</span> <span class="n">PyParse</span>
<span class="kn">from</span> <span class="nn">idlelib.configHandler</span> <span class="kn">import</span> <span class="n">idleConf</span>
<span class="kn">from</span> <span class="nn">idlelib</span> <span class="kn">import</span> <span class="n">aboutDialog</span><span class="p">,</span> <span class="n">textView</span><span class="p">,</span> <span class="n">configDialog</span>
<span class="kn">from</span> <span class="nn">idlelib</span> <span class="kn">import</span> <span class="n">macosxSupport</span>

<span class="c"># The default tab setting for a Text widget, in average-width characters.</span>
<span class="n">TK_TABWIDTH_DEFAULT</span> <span class="o">=</span> <span class="mi">8</span>

<span class="n">_py_version</span> <span class="o">=</span> <span class="s">&#39; (</span><span class="si">%s</span><span class="s">)&#39;</span> <span class="o">%</span> <span class="n">platform</span><span class="o">.</span><span class="n">python_version</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">_sphinx_version</span><span class="p">():</span>
    <span class="s">&quot;Format sys.version_info to produce the Sphinx version string used to install the chm docs&quot;</span>
    <span class="n">major</span><span class="p">,</span> <span class="n">minor</span><span class="p">,</span> <span class="n">micro</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">serial</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span>
    <span class="n">release</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">major</span><span class="p">,</span> <span class="n">minor</span><span class="p">)</span>
    <span class="n">release</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">micro</span><span class="p">,)</span>
    <span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="s">&#39;candidate&#39;</span><span class="p">:</span>
        <span class="n">release</span> <span class="o">+=</span> <span class="s">&#39;rc</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">serial</span><span class="p">,)</span>
    <span class="k">elif</span> <span class="n">level</span> <span class="o">!=</span> <span class="s">&#39;final&#39;</span><span class="p">:</span>
        <span class="n">release</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%s%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">level</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">serial</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">release</span>


<div class="viewcode-block" id="HelpDialog"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.HelpDialog">[docs]</a><span class="k">class</span> <span class="nc">HelpDialog</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">None</span>      <span class="c"># parent of help window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span> <span class="o">=</span> <span class="bp">None</span>         <span class="c"># the help window iteself</span>

<div class="viewcode-block" id="HelpDialog.display"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.HelpDialog.display">[docs]</a>    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">near</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Display the help dialog.</span>

<span class="sd">            parent - parent widget for the help window</span>

<span class="sd">            near - a Toplevel widget (e.g. EditorWindow or PyShell)</span>
<span class="sd">                   to use as a reference for placing the help window</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_dialog</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">near</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nearwindow</span><span class="p">(</span><span class="n">near</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HelpDialog.show_dialog"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.HelpDialog.show_dialog">[docs]</a>    <span class="k">def</span> <span class="nf">show_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="n">fn</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)),</span><span class="s">&#39;help.txt&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span> <span class="o">=</span> <span class="n">dlg</span> <span class="o">=</span> <span class="n">textView</span><span class="o">.</span><span class="n">view_file</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span><span class="s">&#39;Help&#39;</span><span class="p">,</span><span class="n">fn</span><span class="p">,</span> <span class="n">modal</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;&lt;Destroy&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">destroy</span><span class="p">,</span> <span class="s">&#39;+&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HelpDialog.nearwindow"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.HelpDialog.nearwindow">[docs]</a>    <span class="k">def</span> <span class="nf">nearwindow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">near</span><span class="p">):</span>
        <span class="c"># Place the help dialog near the window specified by parent.</span>
        <span class="c"># Note - this may not reposition the window in Metacity</span>
        <span class="c">#  if &quot;/apps/metacity/general/disable_workarounds&quot; is enabled</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span>
        <span class="n">geom</span> <span class="o">=</span> <span class="p">(</span><span class="n">near</span><span class="o">.</span><span class="n">winfo_rootx</span><span class="p">()</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">near</span><span class="o">.</span><span class="n">winfo_rooty</span><span class="p">()</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s">&quot;=+</span><span class="si">%d</span><span class="s">+</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">geom</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">deiconify</span><span class="p">()</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="HelpDialog.destroy"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.HelpDialog.destroy">[docs]</a>    <span class="k">def</span> <span class="nf">destroy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">None</span>
</div></div>
<span class="n">helpDialog</span> <span class="o">=</span> <span class="n">HelpDialog</span><span class="p">()</span>  <span class="c"># singleton instance</span>
<span class="k">def</span> <span class="nf">_help_dialog</span><span class="p">(</span><span class="n">parent</span><span class="p">):</span>  <span class="c"># wrapper for htest</span>
    <span class="n">helpDialog</span><span class="o">.</span><span class="n">show_dialog</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>


<div class="viewcode-block" id="EditorWindow"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow">[docs]</a><span class="k">class</span> <span class="nc">EditorWindow</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">idlelib.Percolator</span> <span class="kn">import</span> <span class="n">Percolator</span>
    <span class="kn">from</span> <span class="nn">idlelib.ColorDelegator</span> <span class="kn">import</span> <span class="n">ColorDelegator</span>
    <span class="kn">from</span> <span class="nn">idlelib.UndoDelegator</span> <span class="kn">import</span> <span class="n">UndoDelegator</span>
    <span class="kn">from</span> <span class="nn">idlelib.IOBinding</span> <span class="kn">import</span> <span class="n">IOBinding</span><span class="p">,</span> <span class="n">filesystemencoding</span><span class="p">,</span> <span class="n">encoding</span>
    <span class="kn">from</span> <span class="nn">idlelib</span> <span class="kn">import</span> <span class="n">Bindings</span>
    <span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">Toplevel</span>
    <span class="kn">from</span> <span class="nn">idlelib.MultiStatusBar</span> <span class="kn">import</span> <span class="n">MultiStatusBar</span>

    <span class="n">help_url</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flist</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">EditorWindow</span><span class="o">.</span><span class="n">help_url</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">dochome</span> <span class="o">=</span>  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">base_prefix</span><span class="p">,</span> <span class="s">&#39;Doc&#39;</span><span class="p">,</span> <span class="s">&#39;index.html&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&#39;linux&#39;</span><span class="p">):</span>
                <span class="c"># look for html docs in a couple of standard places</span>
                <span class="n">pyver</span> <span class="o">=</span> <span class="s">&#39;python-docs-&#39;</span> <span class="o">+</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">.</span><span class="si">%s</span><span class="s">.</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s">&#39;/var/www/html/python/&#39;</span><span class="p">):</span>  <span class="c"># &quot;python2&quot; rpm</span>
                    <span class="n">dochome</span> <span class="o">=</span> <span class="s">&#39;/var/www/html/python/index.html&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">basepath</span> <span class="o">=</span> <span class="s">&#39;/usr/share/doc/&#39;</span>  <span class="c"># standard location</span>
                    <span class="n">dochome</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basepath</span><span class="p">,</span> <span class="n">pyver</span><span class="p">,</span>
                                           <span class="s">&#39;Doc&#39;</span><span class="p">,</span> <span class="s">&#39;index.html&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;win&#39;</span><span class="p">:</span>
                <span class="n">chmfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">base_prefix</span><span class="p">,</span> <span class="s">&#39;Doc&#39;</span><span class="p">,</span>
                                       <span class="s">&#39;Python</span><span class="si">%s</span><span class="s">.chm&#39;</span> <span class="o">%</span> <span class="n">_sphinx_version</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">chmfile</span><span class="p">):</span>
                    <span class="n">dochome</span> <span class="o">=</span> <span class="n">chmfile</span>
            <span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&#39;darwin&#39;</span><span class="p">:</span>
                <span class="c"># documentation may be stored inside a python framework</span>
                <span class="n">dochome</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">base_prefix</span><span class="p">,</span>
                        <span class="s">&#39;Resources/English.lproj/Documentation/index.html&#39;</span><span class="p">)</span>
            <span class="n">dochome</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">dochome</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">dochome</span><span class="p">):</span>
                <span class="n">EditorWindow</span><span class="o">.</span><span class="n">help_url</span> <span class="o">=</span> <span class="n">dochome</span>
                <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&#39;darwin&#39;</span><span class="p">:</span>
                    <span class="c"># Safari requires real file:-URLs</span>
                    <span class="n">EditorWindow</span><span class="o">.</span><span class="n">help_url</span> <span class="o">=</span> <span class="s">&#39;file://&#39;</span> <span class="o">+</span> <span class="n">EditorWindow</span><span class="o">.</span><span class="n">help_url</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">EditorWindow</span><span class="o">.</span><span class="n">help_url</span> <span class="o">=</span> <span class="s">&quot;https://docs.python.org/</span><span class="si">%d</span><span class="s">.</span><span class="si">%d</span><span class="s">/&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">currentTheme</span><span class="o">=</span><span class="n">idleConf</span><span class="o">.</span><span class="n">CurrentTheme</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flist</span> <span class="o">=</span> <span class="n">flist</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">root</span> <span class="ow">or</span> <span class="n">flist</span><span class="o">.</span><span class="n">root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">ps1</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">ps1</span> <span class="o">=</span> <span class="s">&#39;&gt;&gt;&gt; &#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menubar</span> <span class="o">=</span> <span class="n">Menu</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">top</span> <span class="o">=</span> <span class="n">WindowList</span><span class="o">.</span><span class="n">ListedToplevel</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">menubar</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">flist</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tkinter_vars</span> <span class="o">=</span> <span class="n">flist</span><span class="o">.</span><span class="n">vars</span>
            <span class="c">#self.top.instance_dict makes flist.inversedict available to</span>
            <span class="c">#configDialog.py so it can access all EditorWindow instances</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">instance_dict</span> <span class="o">=</span> <span class="n">flist</span><span class="o">.</span><span class="n">inversedict</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tkinter_vars</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c"># keys: Tkinter event names</span>
                                    <span class="c"># values: Tkinter variable instances</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">instance_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recent_files_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">idleConf</span><span class="o">.</span><span class="n">GetUserCfgDir</span><span class="p">(),</span>
                <span class="s">&#39;recent-files.lst&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_frame</span> <span class="o">=</span> <span class="n">text_frame</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vbar</span> <span class="o">=</span> <span class="n">vbar</span> <span class="o">=</span> <span class="n">Scrollbar</span><span class="p">(</span><span class="n">text_frame</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;vbar&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetOption</span><span class="p">(</span><span class="s">&#39;main&#39;</span><span class="p">,</span> <span class="s">&#39;EditorWindow&#39;</span><span class="p">,</span>
                                        <span class="s">&#39;width&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&#39;int&#39;</span><span class="p">)</span>
        <span class="n">text_options</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;text&#39;</span><span class="p">,</span>
                <span class="s">&#39;padx&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="s">&#39;wrap&#39;</span><span class="p">:</span> <span class="s">&#39;none&#39;</span><span class="p">,</span>
                <span class="s">&#39;width&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                <span class="s">&#39;height&#39;</span><span class="p">:</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetOption</span><span class="p">(</span><span class="s">&#39;main&#39;</span><span class="p">,</span> <span class="s">&#39;EditorWindow&#39;</span><span class="p">,</span>
                                             <span class="s">&#39;height&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&#39;int&#39;</span><span class="p">)}</span>
        <span class="k">if</span> <span class="n">TkVersion</span> <span class="o">&gt;=</span> <span class="mf">8.5</span><span class="p">:</span>
            <span class="c"># Starting with tk 8.5 we have to set the new tabstyle option</span>
            <span class="c"># to &#39;wordprocessor&#39; to achieve the same display of tabs as in</span>
            <span class="c"># older tk versions.</span>
            <span class="n">text_options</span><span class="p">[</span><span class="s">&#39;tabstyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;wordprocessor&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span> <span class="o">=</span> <span class="n">MultiCallCreator</span><span class="p">(</span><span class="n">Text</span><span class="p">)(</span><span class="n">text_frame</span><span class="p">,</span> <span class="o">**</span><span class="n">text_options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">focused_widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">createmenubar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apply_bindings</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s">&quot;WM_DELETE_WINDOW&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;close-window&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">close_event</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">macosxSupport</span><span class="o">.</span><span class="n">isAquaTk</span><span class="p">():</span>
            <span class="c"># Command-W on editorwindows doesn&#39;t work without this.</span>
            <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;&lt;&lt;close-window&gt;&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">close_event</span><span class="p">)</span>
            <span class="c"># Some OS X systems have only one mouse button,</span>
            <span class="c"># so use control-click for pulldown menus there.</span>
            <span class="c">#  (Note, AquaTk defines &lt;2&gt; as the right button if</span>
            <span class="c">#   present and the Tk Text widget already binds &lt;2&gt;.)</span>
            <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;Control-Button-1&gt;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">right_menu_event</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Elsewhere, use right-click for pulldown menus.</span>
            <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;3&gt;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">right_menu_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;cut&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cut</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;copy&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;paste&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">paste</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;center-insert&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">center_insert_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;help&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">help_dialog</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;python-docs&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">python_docs</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;about-idle&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">about_dialog</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;open-config-dialog&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dialog</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;open-module&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_module</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;do-nothing&gt;&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="s">&quot;break&quot;</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;select-all&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_all</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;remove-selection&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_selection</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;find&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;find-again&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_again_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;find-in-files&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_in_files_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;find-selection&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_selection_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;replace&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;goto-line&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">goto_line_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;smart-backspace&gt;&gt;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">smart_backspace_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;newline-and-indent&gt;&gt;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">newline_and_indent_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;smart-indent&gt;&gt;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">smart_indent_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;indent-region&gt;&gt;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">indent_region_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;dedent-region&gt;&gt;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dedent_region_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;comment-region&gt;&gt;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_region_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;uncomment-region&gt;&gt;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">uncomment_region_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;tabify-region&gt;&gt;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tabify_region_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;untabify-region&gt;&gt;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">untabify_region_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;toggle-tabs&gt;&gt;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_tabs_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;change-indentwidth&gt;&gt;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">change_indentwidth_event</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;Left&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_at_edge_if_selection</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;Right&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_at_edge_if_selection</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;del-word-left&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">del_word_left</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;del-word-right&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">del_word_right</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;beginning-of-line&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">home_callback</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">flist</span><span class="p">:</span>
            <span class="n">flist</span><span class="o">.</span><span class="n">inversedict</span><span class="p">[</span><span class="bp">self</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">if</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">flist</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;open-new-window&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_callback</span><span class="p">)</span>
            <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;close-all-windows&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">flist</span><span class="o">.</span><span class="n">close_all_callback</span><span class="p">)</span>
            <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;open-class-browser&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_class_browser</span><span class="p">)</span>
            <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;open-path-browser&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_path_browser</span><span class="p">)</span>
            <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;open-turtle-demo&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_turtle_demo</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_status_bar</span><span class="p">()</span>
        <span class="n">vbar</span><span class="p">[</span><span class="s">&#39;command&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">yview</span>
        <span class="n">vbar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">RIGHT</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
        <span class="n">text</span><span class="p">[</span><span class="s">&#39;yscrollcommand&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vbar</span><span class="o">.</span><span class="n">set</span>
        <span class="n">fontWeight</span> <span class="o">=</span> <span class="s">&#39;normal&#39;</span>
        <span class="k">if</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetOption</span><span class="p">(</span><span class="s">&#39;main&#39;</span><span class="p">,</span> <span class="s">&#39;EditorWindow&#39;</span><span class="p">,</span> <span class="s">&#39;font-bold&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&#39;bool&#39;</span><span class="p">):</span>
            <span class="n">fontWeight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span>
        <span class="n">text</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="n">idleConf</span><span class="o">.</span><span class="n">GetOption</span><span class="p">(</span><span class="s">&#39;main&#39;</span><span class="p">,</span> <span class="s">&#39;EditorWindow&#39;</span><span class="p">,</span> <span class="s">&#39;font&#39;</span><span class="p">),</span>
                          <span class="n">idleConf</span><span class="o">.</span><span class="n">GetOption</span><span class="p">(</span><span class="s">&#39;main&#39;</span><span class="p">,</span> <span class="s">&#39;EditorWindow&#39;</span><span class="p">,</span>
                                             <span class="s">&#39;font-size&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&#39;int&#39;</span><span class="p">),</span>
                          <span class="n">fontWeight</span><span class="p">))</span>
        <span class="n">text_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">TOP</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">focus_set</span><span class="p">()</span>

        <span class="c"># usetabs true  -&gt; literal tab characters are used by indent and</span>
        <span class="c">#                  dedent cmds, possibly mixed with spaces if</span>
        <span class="c">#                  indentwidth is not a multiple of tabwidth,</span>
        <span class="c">#                  which will cause Tabnanny to nag!</span>
        <span class="c">#         false -&gt; tab characters are converted to spaces by indent</span>
        <span class="c">#                  and dedent cmds, and ditto TAB keystrokes</span>
        <span class="c"># Although use-spaces=0 can be configured manually in config-main.def,</span>
        <span class="c"># configuration of tabs v. spaces is not supported in the configuration</span>
        <span class="c"># dialog.  IDLE promotes the preferred Python indentation: use spaces!</span>
        <span class="n">usespaces</span> <span class="o">=</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetOption</span><span class="p">(</span><span class="s">&#39;main&#39;</span><span class="p">,</span> <span class="s">&#39;Indent&#39;</span><span class="p">,</span>
                                       <span class="s">&#39;use-spaces&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&#39;bool&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">usetabs</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">usespaces</span>

        <span class="c"># tabwidth is the display width of a literal tab character.</span>
        <span class="c"># CAUTION:  telling Tk to use anything other than its default</span>
        <span class="c"># tab setting causes it to use an entirely different tabbing algorithm,</span>
        <span class="c"># treating tab stops as fixed distances from the left margin.</span>
        <span class="c"># Nobody expects this, so for now tabwidth should never be changed.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span> <span class="o">=</span> <span class="mi">8</span>    <span class="c"># must remain 8 until Tk is fixed.</span>

        <span class="c"># indentwidth is the number of screen characters per indent level.</span>
        <span class="c"># The recommended Python indentation is four spaces.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_notabs_indentwidth</span><span class="p">()</span>

        <span class="c"># If context_use_ps1 is true, parsing searches back for a ps1 line;</span>
        <span class="c"># else searches for a popular (if, def, ...) Python stmt.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context_use_ps1</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="c"># When searching backwards for a reliable place to begin parsing,</span>
        <span class="c"># first start num_context_lines[0] lines back, then</span>
        <span class="c"># num_context_lines[1] lines back if that didn&#39;t work, and so on.</span>
        <span class="c"># The last value should be huge (larger than the # of lines in a</span>
        <span class="c"># conceivable file).</span>
        <span class="c"># Making the initial values larger slows things down more often.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_context_lines</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">5000000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">per</span> <span class="o">=</span> <span class="n">per</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Percolator</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">undo</span> <span class="o">=</span> <span class="n">undo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UndoDelegator</span><span class="p">()</span>
        <span class="n">per</span><span class="o">.</span><span class="n">insertfilter</span><span class="p">(</span><span class="n">undo</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">undo_block_start</span> <span class="o">=</span> <span class="n">undo</span><span class="o">.</span><span class="n">undo_block_start</span>
        <span class="n">text</span><span class="o">.</span><span class="n">undo_block_stop</span> <span class="o">=</span> <span class="n">undo</span><span class="o">.</span><span class="n">undo_block_stop</span>
        <span class="n">undo</span><span class="o">.</span><span class="n">set_saved_change_hook</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saved_change_hook</span><span class="p">)</span>
        <span class="c"># IOBinding implements file I/O and printing functionality</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">io</span> <span class="o">=</span> <span class="n">io</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IOBinding</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">io</span><span class="o">.</span><span class="n">set_filename_change_hook</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename_change_hook</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">good_load</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_indentation_params</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="bp">None</span> <span class="c"># initialized below in self.ResetColorizer</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">io</span><span class="o">.</span><span class="n">loadfile</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">good_load</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">is_py_src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ispythonsource</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_indentation_params</span><span class="p">(</span><span class="n">is_py_src</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">io</span><span class="o">.</span><span class="n">set_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">good_load</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ResetColorizer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saved_change_hook</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_recent_files_list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_extensions</span><span class="p">()</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menudict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;windows&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">menu</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;end&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">end</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">end</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">add_separator</span><span class="p">()</span>
                <span class="n">end</span> <span class="o">=</span> <span class="n">end</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wmenu_end</span> <span class="o">=</span> <span class="n">end</span>
            <span class="n">WindowList</span><span class="o">.</span><span class="n">register_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postwindowsmenu</span><span class="p">)</span>

        <span class="c"># Some abstractions so IDLE extensions are cross-IDE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">askyesno</span> <span class="o">=</span> <span class="n">tkMessageBox</span><span class="o">.</span><span class="n">askyesno</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">askinteger</span> <span class="o">=</span> <span class="n">tkSimpleDialog</span><span class="o">.</span><span class="n">askinteger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showerror</span> <span class="o">=</span> <span class="n">tkMessageBox</span><span class="o">.</span><span class="n">showerror</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_highlight_workaround</span><span class="p">()</span>  <span class="c"># Fix selection tags on Windows</span>

    <span class="k">def</span> <span class="nf">_highlight_workaround</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># On Windows, Tk removes painting of the selection</span>
        <span class="c"># tags which is different behavior than on Linux and Mac.</span>
        <span class="c"># See issue14146 for more information.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;win&#39;</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
        <span class="n">text</span><span class="o">.</span><span class="n">event_add</span><span class="p">(</span><span class="s">&quot;&lt;&lt;Highlight-FocusOut&gt;&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;FocusOut&gt;&quot;</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">event_add</span><span class="p">(</span><span class="s">&quot;&lt;&lt;Highlight-FocusIn&gt;&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;FocusIn&gt;&quot;</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">highlight_fix</span><span class="p">(</span><span class="n">focus</span><span class="p">):</span>
            <span class="n">sel_range</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">tag_ranges</span><span class="p">(</span><span class="s">&quot;sel&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sel_range</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">focus</span> <span class="o">==</span> <span class="s">&#39;out&#39;</span><span class="p">:</span>
                    <span class="n">HILITE_CONFIG</span> <span class="o">=</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetHighlight</span><span class="p">(</span>
                            <span class="n">idleConf</span><span class="o">.</span><span class="n">CurrentTheme</span><span class="p">(),</span> <span class="s">&#39;hilite&#39;</span><span class="p">)</span>
                    <span class="n">text</span><span class="o">.</span><span class="n">tag_config</span><span class="p">(</span><span class="s">&quot;sel_fix&quot;</span><span class="p">,</span> <span class="n">HILITE_CONFIG</span><span class="p">)</span>
                    <span class="n">text</span><span class="o">.</span><span class="n">tag_raise</span><span class="p">(</span><span class="s">&quot;sel_fix&quot;</span><span class="p">)</span>
                    <span class="n">text</span><span class="o">.</span><span class="n">tag_add</span><span class="p">(</span><span class="s">&quot;sel_fix&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">sel_range</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">focus</span> <span class="o">==</span> <span class="s">&#39;in&#39;</span><span class="p">:</span>
                    <span class="n">text</span><span class="o">.</span><span class="n">tag_remove</span><span class="p">(</span><span class="s">&quot;sel_fix&quot;</span><span class="p">,</span> <span class="s">&quot;1.0&quot;</span><span class="p">,</span> <span class="s">&quot;end&quot;</span><span class="p">)</span>

        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;Highlight-FocusOut&gt;&gt;&quot;</span><span class="p">,</span>
                <span class="k">lambda</span> <span class="n">ev</span><span class="p">:</span> <span class="n">highlight_fix</span><span class="p">(</span><span class="s">&quot;out&quot;</span><span class="p">))</span>
        <span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;Highlight-FocusIn&gt;&gt;&quot;</span><span class="p">,</span>
                <span class="k">lambda</span> <span class="n">ev</span><span class="p">:</span> <span class="n">highlight_fix</span><span class="p">(</span><span class="s">&quot;in&quot;</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_filename_to_unicode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;convert filename to unicode in order to display it in Tk&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">filename</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">filename</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filesystemencoding</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>
                <span class="c"># XXX</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">filename</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>
                    <span class="c"># byte-to-byte conversion</span>
                    <span class="k">return</span> <span class="n">filename</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&#39;iso8859-1&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="EditorWindow.new_callback"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.new_callback">[docs]</a>    <span class="k">def</span> <span class="nf">new_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">dirname</span><span class="p">,</span> <span class="n">basename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">defaultfilename</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flist</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">dirname</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.home_callback"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.home_callback">[docs]</a>    <span class="k">def</span> <span class="nf">home_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">state</span> <span class="o">&amp;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">keysym</span> <span class="o">==</span> <span class="s">&quot;Home&quot;</span><span class="p">:</span>
            <span class="c"># state&amp;4==Control. If &lt;Control-Home&gt;, use the Tk binding.</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;iomark&quot;</span><span class="p">)</span> <span class="ow">and</span> \
           <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="s">&quot;iomark&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;=&quot;</span><span class="p">,</span> <span class="s">&quot;insert lineend&quot;</span><span class="p">)</span> <span class="ow">and</span> \
           <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="s">&quot;insert linestart&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;=&quot;</span><span class="p">,</span> <span class="s">&quot;iomark&quot;</span><span class="p">):</span>
            <span class="c"># In Shell on input line, go to just after prompt</span>
            <span class="n">insertpt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;iomark&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;insert linestart&quot;</span><span class="p">,</span> <span class="s">&quot;insert lineend&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">insertpt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="n">insertpt</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">):</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">insertpt</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">lineat</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">insertpt</span> <span class="o">==</span> <span class="n">lineat</span><span class="p">:</span>
            <span class="n">insertpt</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">dest</span> <span class="o">=</span> <span class="s">&quot;insert linestart+&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">insertpt</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;c&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">state</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c"># shift was not pressed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">tag_remove</span><span class="p">(</span><span class="s">&quot;sel&quot;</span><span class="p">,</span> <span class="s">&quot;1.0&quot;</span><span class="p">,</span> <span class="s">&quot;end&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;sel.first&quot;</span><span class="p">):</span>
                <span class="c"># there was no previous selection</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">mark_set</span><span class="p">(</span><span class="s">&quot;my_anchor&quot;</span><span class="p">,</span> <span class="s">&quot;insert&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;sel.first&quot;</span><span class="p">),</span> <span class="s">&quot;&lt;&quot;</span><span class="p">,</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">)):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">mark_set</span><span class="p">(</span><span class="s">&quot;my_anchor&quot;</span><span class="p">,</span> <span class="s">&quot;sel.first&quot;</span><span class="p">)</span> <span class="c"># extend back</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">mark_set</span><span class="p">(</span><span class="s">&quot;my_anchor&quot;</span><span class="p">,</span> <span class="s">&quot;sel.last&quot;</span><span class="p">)</span> <span class="c"># extend forward</span>
            <span class="n">first</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span>
            <span class="n">last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;my_anchor&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">first</span><span class="p">,</span><span class="s">&quot;&gt;&quot;</span><span class="p">,</span><span class="n">last</span><span class="p">):</span>
                <span class="n">first</span><span class="p">,</span><span class="n">last</span> <span class="o">=</span> <span class="n">last</span><span class="p">,</span><span class="n">first</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">tag_remove</span><span class="p">(</span><span class="s">&quot;sel&quot;</span><span class="p">,</span> <span class="s">&quot;1.0&quot;</span><span class="p">,</span> <span class="s">&quot;end&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">tag_add</span><span class="p">(</span><span class="s">&quot;sel&quot;</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">mark_set</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">see</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.set_status_bar"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.set_status_bar">[docs]</a>    <span class="k">def</span> <span class="nf">set_status_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_bar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MultiStatusBar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&quot;darwin&quot;</span><span class="p">:</span>
            <span class="c"># Insert some padding to avoid obscuring some of the statusbar</span>
            <span class="c"># by the resize widget.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_bar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&#39;_padding1&#39;</span><span class="p">,</span> <span class="s">&#39;    &#39;</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="n">RIGHT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_bar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&#39;column&#39;</span><span class="p">,</span> <span class="s">&#39;Col: ?&#39;</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="n">RIGHT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_bar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="s">&#39;Ln: ?&#39;</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="n">RIGHT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_bar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;set-line-and-column&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_line_and_column</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">event_add</span><span class="p">(</span><span class="s">&quot;&lt;&lt;set-line-and-column&gt;&gt;&quot;</span><span class="p">,</span>
                            <span class="s">&quot;&lt;KeyRelease&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;ButtonRelease&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">after_idle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_line_and_column</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.set_line_and_column"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.set_line_and_column">[docs]</a>    <span class="k">def</span> <span class="nf">set_line_and_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">line</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">INSERT</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_bar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&#39;column&#39;</span><span class="p">,</span> <span class="s">&#39;Col: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">column</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_bar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="s">&#39;Ln: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">line</span><span class="p">)</span>
</div>
    <span class="n">menu_specs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s">&quot;file&quot;</span><span class="p">,</span> <span class="s">&quot;_File&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&quot;edit&quot;</span><span class="p">,</span> <span class="s">&quot;_Edit&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&quot;format&quot;</span><span class="p">,</span> <span class="s">&quot;F_ormat&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&quot;run&quot;</span><span class="p">,</span> <span class="s">&quot;_Run&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&quot;options&quot;</span><span class="p">,</span> <span class="s">&quot;_Options&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&quot;windows&quot;</span><span class="p">,</span> <span class="s">&quot;_Windows&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&quot;help&quot;</span><span class="p">,</span> <span class="s">&quot;_Help&quot;</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&quot;darwin&quot;</span><span class="p">:</span>
        <span class="n">menu_specs</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;windows&quot;</span><span class="p">,</span> <span class="s">&quot;_Window&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="EditorWindow.createmenubar"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.createmenubar">[docs]</a>    <span class="k">def</span> <span class="nf">createmenubar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menubar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menudict</span> <span class="o">=</span> <span class="n">menudict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">menu_specs</span><span class="p">:</span>
            <span class="n">underline</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">prepstr</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="n">menudict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">menu</span> <span class="o">=</span> <span class="n">Menu</span><span class="p">(</span><span class="n">mbar</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
            <span class="n">mbar</span><span class="o">.</span><span class="n">add_cascade</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="n">menu</span><span class="p">,</span> <span class="n">underline</span><span class="o">=</span><span class="n">underline</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">macosxSupport</span><span class="o">.</span><span class="n">isCarbonTk</span><span class="p">():</span>
            <span class="c"># Insert the application menu</span>
            <span class="n">menudict</span><span class="p">[</span><span class="s">&#39;application&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">menu</span> <span class="o">=</span> <span class="n">Menu</span><span class="p">(</span><span class="n">mbar</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;apple&#39;</span><span class="p">)</span>
            <span class="n">mbar</span><span class="o">.</span><span class="n">add_cascade</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;IDLE&#39;</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="n">menu</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_menus</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recent_files_menu</span> <span class="o">=</span> <span class="n">Menu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">menubar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menudict</span><span class="p">[</span><span class="s">&#39;file&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">insert_cascade</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Recent Files&#39;</span><span class="p">,</span>
                                             <span class="n">underline</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                             <span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recent_files_menu</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_helpmenu_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menudict</span><span class="p">[</span><span class="s">&#39;help&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">END</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_help_menu_entries</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EditorWindow.postwindowsmenu"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.postwindowsmenu">[docs]</a>    <span class="k">def</span> <span class="nf">postwindowsmenu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Only called when Windows menu exists</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menudict</span><span class="p">[</span><span class="s">&#39;windows&#39;</span><span class="p">]</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;end&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">end</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">wmenu_end</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wmenu_end</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
        <span class="n">WindowList</span><span class="o">.</span><span class="n">add_windows_to_menu</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span>
</div>
    <span class="n">rmenu</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="EditorWindow.right_menu_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.right_menu_event">[docs]</a>    <span class="k">def</span> <span class="nf">right_menu_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">mark_set</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="s">&quot;@</span><span class="si">%d</span><span class="s">,</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmenu</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">make_rmenu</span><span class="p">()</span>
        <span class="n">rmenu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmenu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event</span> <span class="o">=</span> <span class="n">event</span>
        <span class="n">iswin</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;win&#39;</span>
        <span class="k">if</span> <span class="n">iswin</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">cursor</span><span class="o">=</span><span class="s">&quot;arrow&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmenu_specs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">label</span><span class="p">,</span> <span class="n">eventname</span><span class="p">,</span> <span class="n">verify_state</span> <span class="o">=</span> <span class="n">item</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="c"># see issue1207589</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">verify_state</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">state</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verify_state</span><span class="p">)()</span>
            <span class="n">rmenu</span><span class="o">.</span><span class="n">entryconfigure</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">)</span>


        <span class="n">rmenu</span><span class="o">.</span><span class="n">tk_popup</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x_root</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y_root</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">iswin</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">cursor</span><span class="o">=</span><span class="s">&quot;ibeam&quot;</span><span class="p">)</span>
</div>
    <span class="n">rmenu_specs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="c"># (&quot;Label&quot;, &quot;&lt;&lt;virtual-event&gt;&gt;&quot;, &quot;statefuncname&quot;), ...</span>
        <span class="p">(</span><span class="s">&quot;Close&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;&lt;close-window&gt;&gt;&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="c"># Example</span>
    <span class="p">]</span>

<div class="viewcode-block" id="EditorWindow.make_rmenu"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.make_rmenu">[docs]</a>    <span class="k">def</span> <span class="nf">make_rmenu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rmenu</span> <span class="o">=</span> <span class="n">Menu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmenu_specs</span><span class="p">:</span>
            <span class="n">label</span><span class="p">,</span> <span class="n">eventname</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">eventname</span><span class="o">=</span><span class="n">eventname</span><span class="p">):</span>
                    <span class="n">text</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="n">eventname</span><span class="p">)</span>
                <span class="n">rmenu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rmenu</span><span class="o">.</span><span class="n">add_separator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmenu</span> <span class="o">=</span> <span class="n">rmenu</span>
</div>
<div class="viewcode-block" id="EditorWindow.rmenu_check_cut"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.rmenu_check_cut">[docs]</a>    <span class="k">def</span> <span class="nf">rmenu_check_cut</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmenu_check_copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EditorWindow.rmenu_check_copy"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.rmenu_check_copy">[docs]</a>    <span class="k">def</span> <span class="nf">rmenu_check_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">indx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&#39;sel.first&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">TclError</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&#39;disabled&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&#39;normal&#39;</span> <span class="k">if</span> <span class="n">indx</span> <span class="k">else</span> <span class="s">&#39;disabled&#39;</span>
</div>
<div class="viewcode-block" id="EditorWindow.rmenu_check_paste"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.rmenu_check_paste">[docs]</a>    <span class="k">def</span> <span class="nf">rmenu_check_paste</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&#39;tk::GetSelection&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s">&#39;CLIPBOARD&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">TclError</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&#39;disabled&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&#39;normal&#39;</span>
</div>
<div class="viewcode-block" id="EditorWindow.about_dialog"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.about_dialog">[docs]</a>    <span class="k">def</span> <span class="nf">about_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">aboutDialog</span><span class="o">.</span><span class="n">AboutDialog</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">,</span><span class="s">&#39;About IDLE&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.config_dialog"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.config_dialog">[docs]</a>    <span class="k">def</span> <span class="nf">config_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">configDialog</span><span class="o">.</span><span class="n">ConfigDialog</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">,</span><span class="s">&#39;Settings&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.help_dialog"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.help_dialog">[docs]</a>    <span class="k">def</span> <span class="nf">help_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span>
        <span class="n">helpDialog</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">near</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.python_docs"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.python_docs">[docs]</a>    <span class="k">def</span> <span class="nf">python_docs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;win&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">help_url</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">why</span><span class="p">:</span>
                <span class="n">tkMessageBox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;Document Start Failure&#39;</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">why</span><span class="p">),</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">help_url</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.cut"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.cut">[docs]</a>    <span class="k">def</span> <span class="nf">cut</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="s">&quot;&lt;&lt;Cut&gt;&gt;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.copy"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">tag_ranges</span><span class="p">(</span><span class="s">&quot;sel&quot;</span><span class="p">):</span>
            <span class="c"># There is no selection, so do nothing and maybe interrupt.</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="s">&quot;&lt;&lt;Copy&gt;&gt;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.paste"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.paste">[docs]</a>    <span class="k">def</span> <span class="nf">paste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="s">&quot;&lt;&lt;Paste&gt;&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">see</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.select_all"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.select_all">[docs]</a>    <span class="k">def</span> <span class="nf">select_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">tag_add</span><span class="p">(</span><span class="s">&quot;sel&quot;</span><span class="p">,</span> <span class="s">&quot;1.0&quot;</span><span class="p">,</span> <span class="s">&quot;end-1c&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">mark_set</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="s">&quot;1.0&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">see</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.remove_selection"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.remove_selection">[docs]</a>    <span class="k">def</span> <span class="nf">remove_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">tag_remove</span><span class="p">(</span><span class="s">&quot;sel&quot;</span><span class="p">,</span> <span class="s">&quot;1.0&quot;</span><span class="p">,</span> <span class="s">&quot;end&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">see</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.move_at_edge_if_selection"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.move_at_edge_if_selection">[docs]</a>    <span class="k">def</span> <span class="nf">move_at_edge_if_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge_index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cursor move begins at start or end of selection</span>

<span class="sd">        When a left/right cursor key is pressed create and return to Tkinter a</span>
<span class="sd">        function which causes a cursor move from the associated edge of the</span>
<span class="sd">        selection.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">self_text_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">index</span>
        <span class="n">self_text_mark_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">mark_set</span>
        <span class="n">edges_table</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;sel.first+1c&quot;</span><span class="p">,</span> <span class="s">&quot;sel.last-1c&quot;</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">move_at_edge</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">state</span> <span class="o">&amp;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c"># no shift(==1) or control(==4) pressed</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">self_text_index</span><span class="p">(</span><span class="s">&quot;sel.first&quot;</span><span class="p">)</span>
                    <span class="n">self_text_mark_set</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="n">edges_table</span><span class="p">[</span><span class="n">edge_index</span><span class="p">])</span>
                <span class="k">except</span> <span class="n">TclError</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">return</span> <span class="n">move_at_edge</span>
</div>
<div class="viewcode-block" id="EditorWindow.del_word_left"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.del_word_left">[docs]</a>    <span class="k">def</span> <span class="nf">del_word_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="s">&#39;&lt;Meta-Delete&gt;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.del_word_right"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.del_word_right">[docs]</a>    <span class="k">def</span> <span class="nf">del_word_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="s">&#39;&lt;Meta-d&gt;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.find_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.find_event">[docs]</a>    <span class="k">def</span> <span class="nf">find_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">SearchDialog</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.find_again_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.find_again_event">[docs]</a>    <span class="k">def</span> <span class="nf">find_again_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">SearchDialog</span><span class="o">.</span><span class="n">find_again</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.find_selection_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.find_selection_event">[docs]</a>    <span class="k">def</span> <span class="nf">find_selection_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">SearchDialog</span><span class="o">.</span><span class="n">find_selection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.find_in_files_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.find_in_files_event">[docs]</a>    <span class="k">def</span> <span class="nf">find_in_files_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">GrepDialog</span><span class="o">.</span><span class="n">grep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">io</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">flist</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.replace_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.replace_event">[docs]</a>    <span class="k">def</span> <span class="nf">replace_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">ReplaceDialog</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.goto_line_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.goto_line_event">[docs]</a>    <span class="k">def</span> <span class="nf">goto_line_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
        <span class="n">lineno</span> <span class="o">=</span> <span class="n">tkSimpleDialog</span><span class="o">.</span><span class="n">askinteger</span><span class="p">(</span><span class="s">&quot;Goto&quot;</span><span class="p">,</span>
                <span class="s">&quot;Go to line number:&quot;</span><span class="p">,</span><span class="n">parent</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lineno</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;break&quot;</span>
        <span class="k">if</span> <span class="n">lineno</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">bell</span><span class="p">()</span>
            <span class="k">return</span> <span class="s">&quot;break&quot;</span>
        <span class="n">text</span><span class="o">.</span><span class="n">mark_set</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s">.0&quot;</span> <span class="o">%</span> <span class="n">lineno</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">see</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.open_module"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.open_module">[docs]</a>    <span class="k">def</span> <span class="nf">open_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c"># XXX Shouldn&#39;t this be in IOBinding?</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;sel.first&quot;</span><span class="p">,</span> <span class="s">&quot;sel.last&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">TclError</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">tkSimpleDialog</span><span class="o">.</span><span class="n">askstring</span><span class="p">(</span><span class="s">&quot;Module&quot;</span><span class="p">,</span>
                 <span class="s">&quot;Enter the name of a Python module</span><span class="se">\n</span><span class="s">&quot;</span>
                 <span class="s">&quot;to search on sys.path and open:&quot;</span><span class="p">,</span>
                 <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">initialvalue</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c"># XXX Ought to insert current file&#39;s directory in front of path</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">spec</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">find_spec</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">ImportError</span><span class="p">)</span> <span class="k">as</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">tkMessageBox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s">&quot;Import error&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">spec</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">tkMessageBox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s">&quot;Import error&quot;</span><span class="p">,</span> <span class="s">&quot;module not found&quot;</span><span class="p">,</span>
                                   <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="p">,</span> <span class="n">importlib</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">SourceLoader</span><span class="p">):</span>
            <span class="n">tkMessageBox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s">&quot;Import error&quot;</span><span class="p">,</span> <span class="s">&quot;not a source-based module&quot;</span><span class="p">,</span>
                                   <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">get_filename</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tkMessageBox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s">&quot;Import error&quot;</span><span class="p">,</span>
                                   <span class="s">&quot;loader does not support get_filename&quot;</span><span class="p">,</span>
                                   <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flist</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flist</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadfile</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.open_class_browser"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.open_class_browser">[docs]</a>    <span class="k">def</span> <span class="nf">open_class_browser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">filename</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">tkMessageBox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span>
                <span class="s">&quot;No filename&quot;</span><span class="p">,</span>
                <span class="s">&quot;This buffer has no associated filename&quot;</span><span class="p">,</span>
                <span class="n">master</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">focus_set</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="n">head</span><span class="p">,</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">base</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">idlelib</span> <span class="kn">import</span> <span class="n">ClassBrowser</span>
        <span class="n">ClassBrowser</span><span class="o">.</span><span class="n">ClassBrowser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flist</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="p">[</span><span class="n">head</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="EditorWindow.open_path_browser"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.open_path_browser">[docs]</a>    <span class="k">def</span> <span class="nf">open_path_browser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">idlelib</span> <span class="kn">import</span> <span class="n">PathBrowser</span>
        <span class="n">PathBrowser</span><span class="o">.</span><span class="n">PathBrowser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flist</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.open_turtle_demo"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.open_turtle_demo">[docs]</a>    <span class="k">def</span> <span class="nf">open_turtle_demo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">subprocess</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span>
               <span class="s">&#39;-c&#39;</span><span class="p">,</span>
               <span class="s">&#39;from turtledemo.__main__ import main; main()&#39;</span><span class="p">]</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.gotoline"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.gotoline">[docs]</a>    <span class="k">def</span> <span class="nf">gotoline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lineno</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">lineno</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">lineno</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">mark_set</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s">.0&quot;</span> <span class="o">%</span> <span class="n">lineno</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">tag_remove</span><span class="p">(</span><span class="s">&quot;sel&quot;</span><span class="p">,</span> <span class="s">&quot;1.0&quot;</span><span class="p">,</span> <span class="s">&quot;end&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">tag_add</span><span class="p">(</span><span class="s">&quot;sel&quot;</span><span class="p">,</span> <span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="s">&quot;insert +1l&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EditorWindow.ispythonsource"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.ispythonsource">[docs]</a>    <span class="k">def</span> <span class="nf">ispythonsource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="n">base</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normcase</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;.py&quot;</span><span class="p">,</span> <span class="s">&quot;.pyw&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;1.0&#39;</span><span class="p">,</span> <span class="s">&#39;1.0 lineend&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;#!&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="s">&#39;python&#39;</span> <span class="ow">in</span> <span class="n">line</span>
</div>
<div class="viewcode-block" id="EditorWindow.close_hook"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.close_hook">[docs]</a>    <span class="k">def</span> <span class="nf">close_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flist</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flist</span><span class="o">.</span><span class="n">unregister_maybe_terminate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flist</span> <span class="o">=</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="EditorWindow.set_close_hook"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.set_close_hook">[docs]</a>    <span class="k">def</span> <span class="nf">set_close_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">close_hook</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_hook</span> <span class="o">=</span> <span class="n">close_hook</span>
</div>
<div class="viewcode-block" id="EditorWindow.filename_change_hook"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.filename_change_hook">[docs]</a>    <span class="k">def</span> <span class="nf">filename_change_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flist</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flist</span><span class="o">.</span><span class="n">filename_changed_edit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saved_change_hook</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">update_windowlist_registry</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ResetColorizer</span><span class="p">()</span>
</div>
    <span class="k">def</span> <span class="nf">_addcolorizer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ispythonsource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">filename</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ColorDelegator</span><span class="p">()</span>
        <span class="c"># can add more colorizers here...</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">per</span><span class="o">.</span><span class="n">removefilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">undo</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">per</span><span class="o">.</span><span class="n">insertfilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">per</span><span class="o">.</span><span class="n">insertfilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">undo</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_rmcolorizer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">removecolors</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">per</span><span class="o">.</span><span class="n">removefilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="EditorWindow.ResetColorizer"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.ResetColorizer">[docs]</a>    <span class="k">def</span> <span class="nf">ResetColorizer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Update the colour theme&quot;</span>
        <span class="c"># Called from self.filename_change_hook and from configDialog.py</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rmcolorizer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_addcolorizer</span><span class="p">()</span>
        <span class="n">theme</span> <span class="o">=</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetOption</span><span class="p">(</span><span class="s">&#39;main&#39;</span><span class="p">,</span><span class="s">&#39;Theme&#39;</span><span class="p">,</span><span class="s">&#39;name&#39;</span><span class="p">)</span>
        <span class="n">normal_colors</span> <span class="o">=</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetHighlight</span><span class="p">(</span><span class="n">theme</span><span class="p">,</span> <span class="s">&#39;normal&#39;</span><span class="p">)</span>
        <span class="n">cursor_color</span> <span class="o">=</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetHighlight</span><span class="p">(</span><span class="n">theme</span><span class="p">,</span> <span class="s">&#39;cursor&#39;</span><span class="p">,</span> <span class="n">fgBg</span><span class="o">=</span><span class="s">&#39;fg&#39;</span><span class="p">)</span>
        <span class="n">select_colors</span> <span class="o">=</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetHighlight</span><span class="p">(</span><span class="n">theme</span><span class="p">,</span> <span class="s">&#39;hilite&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">config</span><span class="p">(</span>
            <span class="n">foreground</span><span class="o">=</span><span class="n">normal_colors</span><span class="p">[</span><span class="s">&#39;foreground&#39;</span><span class="p">],</span>
            <span class="n">background</span><span class="o">=</span><span class="n">normal_colors</span><span class="p">[</span><span class="s">&#39;background&#39;</span><span class="p">],</span>
            <span class="n">insertbackground</span><span class="o">=</span><span class="n">cursor_color</span><span class="p">,</span>
            <span class="n">selectforeground</span><span class="o">=</span><span class="n">select_colors</span><span class="p">[</span><span class="s">&#39;foreground&#39;</span><span class="p">],</span>
            <span class="n">selectbackground</span><span class="o">=</span><span class="n">select_colors</span><span class="p">[</span><span class="s">&#39;background&#39;</span><span class="p">],</span>
            <span class="p">)</span>
</div>
    <span class="n">IDENTCHARS</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="o">+</span> <span class="s">&quot;_&quot;</span>

<div class="viewcode-block" id="EditorWindow.colorize_syntax_error"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.colorize_syntax_error">[docs]</a>    <span class="k">def</span> <span class="nf">colorize_syntax_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">text</span><span class="o">.</span><span class="n">tag_add</span><span class="p">(</span><span class="s">&quot;ERROR&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="n">char</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">char</span> <span class="ow">and</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">IDENTCHARS</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">tag_add</span><span class="p">(</span><span class="s">&quot;ERROR&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">+</span> <span class="s">&quot; wordstart&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">==</span> <span class="n">text</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>   <span class="c"># error at line end</span>
            <span class="n">text</span><span class="o">.</span><span class="n">mark_set</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">mark_set</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">+</span> <span class="s">&quot;+1c&quot;</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">see</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.ResetFont"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.ResetFont">[docs]</a>    <span class="k">def</span> <span class="nf">ResetFont</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Update the text widgets&#39; font if it is changed&quot;</span>
        <span class="c"># Called from configDialog.py</span>
        <span class="n">fontWeight</span><span class="o">=</span><span class="s">&#39;normal&#39;</span>
        <span class="k">if</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetOption</span><span class="p">(</span><span class="s">&#39;main&#39;</span><span class="p">,</span><span class="s">&#39;EditorWindow&#39;</span><span class="p">,</span><span class="s">&#39;font-bold&#39;</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s">&#39;bool&#39;</span><span class="p">):</span>
            <span class="n">fontWeight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="n">idleConf</span><span class="o">.</span><span class="n">GetOption</span><span class="p">(</span><span class="s">&#39;main&#39;</span><span class="p">,</span><span class="s">&#39;EditorWindow&#39;</span><span class="p">,</span><span class="s">&#39;font&#39;</span><span class="p">),</span>
                <span class="n">idleConf</span><span class="o">.</span><span class="n">GetOption</span><span class="p">(</span><span class="s">&#39;main&#39;</span><span class="p">,</span><span class="s">&#39;EditorWindow&#39;</span><span class="p">,</span><span class="s">&#39;font-size&#39;</span><span class="p">,</span>
                                   <span class="nb">type</span><span class="o">=</span><span class="s">&#39;int&#39;</span><span class="p">),</span>
                <span class="n">fontWeight</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="EditorWindow.RemoveKeybindings"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.RemoveKeybindings">[docs]</a>    <span class="k">def</span> <span class="nf">RemoveKeybindings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Remove the keybindings before they are changed.&quot;</span>
        <span class="c"># Called from configDialog.py</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bindings</span><span class="o">.</span><span class="n">default_keydefs</span> <span class="o">=</span> <span class="n">keydefs</span> <span class="o">=</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetCurrentKeySet</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">keylist</span> <span class="ow">in</span> <span class="n">keydefs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">event_delete</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="o">*</span><span class="n">keylist</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">extensionName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_standard_extension_names</span><span class="p">():</span>
            <span class="n">xkeydefs</span> <span class="o">=</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetExtensionBindings</span><span class="p">(</span><span class="n">extensionName</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xkeydefs</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">keylist</span> <span class="ow">in</span> <span class="n">xkeydefs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">event_delete</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="o">*</span><span class="n">keylist</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.ApplyKeybindings"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.ApplyKeybindings">[docs]</a>    <span class="k">def</span> <span class="nf">ApplyKeybindings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Update the keybindings after they are changed&quot;</span>
        <span class="c"># Called from configDialog.py</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bindings</span><span class="o">.</span><span class="n">default_keydefs</span> <span class="o">=</span> <span class="n">keydefs</span> <span class="o">=</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetCurrentKeySet</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apply_bindings</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">extensionName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_standard_extension_names</span><span class="p">():</span>
            <span class="n">xkeydefs</span> <span class="o">=</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetExtensionBindings</span><span class="p">(</span><span class="n">extensionName</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xkeydefs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">apply_bindings</span><span class="p">(</span><span class="n">xkeydefs</span><span class="p">)</span>
        <span class="c">#update menu accelerators</span>
        <span class="n">menuEventDict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">menu</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Bindings</span><span class="o">.</span><span class="n">menudefs</span><span class="p">:</span>
            <span class="n">menuEventDict</span><span class="p">[</span><span class="n">menu</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">menu</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">item</span><span class="p">:</span>
                    <span class="n">menuEventDict</span><span class="p">[</span><span class="n">menu</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">prepstr</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">menubarItem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">menudict</span><span class="p">:</span>
            <span class="n">menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menudict</span><span class="p">[</span><span class="n">menubarItem</span><span class="p">]</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">END</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c"># Skip empty menus</span>
                <span class="k">continue</span>
            <span class="n">end</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">menu</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;command&#39;</span><span class="p">:</span>
                    <span class="n">accel</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="n">entrycget</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s">&#39;accelerator&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">accel</span><span class="p">:</span>
                        <span class="n">itemName</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="n">entrycget</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s">&#39;label&#39;</span><span class="p">)</span>
                        <span class="n">event</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
                        <span class="k">if</span> <span class="n">menubarItem</span> <span class="ow">in</span> <span class="n">menuEventDict</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">itemName</span> <span class="ow">in</span> <span class="n">menuEventDict</span><span class="p">[</span><span class="n">menubarItem</span><span class="p">]:</span>
                                <span class="n">event</span> <span class="o">=</span> <span class="n">menuEventDict</span><span class="p">[</span><span class="n">menubarItem</span><span class="p">][</span><span class="n">itemName</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">event</span><span class="p">:</span>
                            <span class="n">accel</span> <span class="o">=</span> <span class="n">get_accelerator</span><span class="p">(</span><span class="n">keydefs</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
                            <span class="n">menu</span><span class="o">.</span><span class="n">entryconfig</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">accelerator</span><span class="o">=</span><span class="n">accel</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.set_notabs_indentwidth"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.set_notabs_indentwidth">[docs]</a>    <span class="k">def</span> <span class="nf">set_notabs_indentwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Update the indentwidth if changed and not using tabs in this window&quot;</span>
        <span class="c"># Called from configDialog.py</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">usetabs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span> <span class="o">=</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetOption</span><span class="p">(</span><span class="s">&#39;main&#39;</span><span class="p">,</span> <span class="s">&#39;Indent&#39;</span><span class="p">,</span><span class="s">&#39;num-spaces&#39;</span><span class="p">,</span>
                                                  <span class="nb">type</span><span class="o">=</span><span class="s">&#39;int&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.reset_help_menu_entries"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.reset_help_menu_entries">[docs]</a>    <span class="k">def</span> <span class="nf">reset_help_menu_entries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Update the additional help entries on the Help menu&quot;</span>
        <span class="n">help_list</span> <span class="o">=</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetAllExtraHelpSourcesList</span><span class="p">()</span>
        <span class="n">helpmenu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menudict</span><span class="p">[</span><span class="s">&#39;help&#39;</span><span class="p">]</span>
        <span class="c"># first delete the extra help entries, if any</span>
        <span class="n">helpmenu_length</span> <span class="o">=</span> <span class="n">helpmenu</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">END</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">helpmenu_length</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_helpmenu_length</span><span class="p">:</span>
            <span class="n">helpmenu</span><span class="o">.</span><span class="n">delete</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">base_helpmenu_length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">helpmenu_length</span><span class="p">)</span>
        <span class="c"># then rebuild them</span>
        <span class="k">if</span> <span class="n">help_list</span><span class="p">:</span>
            <span class="n">helpmenu</span><span class="o">.</span><span class="n">add_separator</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">help_list</span><span class="p">:</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extra_help_callback</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">helpmenu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">command</span><span class="o">=</span><span class="n">cmd</span><span class="p">)</span>
        <span class="c"># and update the menu dictionary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menudict</span><span class="p">[</span><span class="s">&#39;help&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">helpmenu</span>
</div>
    <span class="k">def</span> <span class="nf">__extra_help_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">helpfile</span><span class="p">):</span>
        <span class="s">&quot;Create a callback with the helpfile value frozen at definition time&quot;</span>
        <span class="k">def</span> <span class="nf">display_extra_help</span><span class="p">(</span><span class="n">helpfile</span><span class="o">=</span><span class="n">helpfile</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">helpfile</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s">&#39;www&#39;</span><span class="p">,</span> <span class="s">&#39;http&#39;</span><span class="p">)):</span>
                <span class="n">helpfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">helpfile</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;win&#39;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="n">helpfile</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">why</span><span class="p">:</span>
                    <span class="n">tkMessageBox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;Document Start Failure&#39;</span><span class="p">,</span>
                        <span class="n">message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">why</span><span class="p">),</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">helpfile</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">display_extra_help</span>

<div class="viewcode-block" id="EditorWindow.update_recent_files_list"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.update_recent_files_list">[docs]</a>    <span class="k">def</span> <span class="nf">update_recent_files_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_file</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="s">&quot;Load and update the recent files list and menus&quot;</span>
        <span class="n">rf_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recent_files_path</span><span class="p">):</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recent_files_path</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">,</span>
                      <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;utf_8&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s">&#39;replace&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">rf_list_file</span><span class="p">:</span>
                <span class="n">rf_list</span> <span class="o">=</span> <span class="n">rf_list_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">new_file</span><span class="p">:</span>
            <span class="n">new_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">new_file</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="k">if</span> <span class="n">new_file</span> <span class="ow">in</span> <span class="n">rf_list</span><span class="p">:</span>
                <span class="n">rf_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">new_file</span><span class="p">)</span>  <span class="c"># move to top</span>
            <span class="n">rf_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">new_file</span><span class="p">)</span>
        <span class="c"># clean and save the recent files list</span>
        <span class="n">bad_paths</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">rf_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="s">&#39;</span><span class="se">\0</span><span class="s">&#39;</span> <span class="ow">in</span> <span class="n">path</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">bad_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">rf_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">rf_list</span> <span class="k">if</span> <span class="n">path</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bad_paths</span><span class="p">]</span>
        <span class="n">ulchars</span> <span class="o">=</span> <span class="s">&quot;1234567890ABCDEFGHIJK&quot;</span>
        <span class="n">rf_list</span> <span class="o">=</span> <span class="n">rf_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">ulchars</span><span class="p">)]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recent_files_path</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">,</span>
                        <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;utf_8&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s">&#39;replace&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">rf_file</span><span class="p">:</span>
                <span class="n">rf_file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">rf_list</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s">&quot;recentfilelist_error_displayed&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">recentfilelist_error_displayed</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="n">tkMessageBox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;IDLE Error&#39;</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="s">&#39;Unable to update Recent Files list:</span><span class="se">\n</span><span class="si">%s</span><span class="s">&#39;</span>
                        <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">),</span>
                    <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="c"># for each edit window instance, construct the recent files menu</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">instance_dict</span><span class="p">:</span>
            <span class="n">menu</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">recent_files_menu</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">END</span><span class="p">)</span>  <span class="c"># clear, and rebuild:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rf_list</span><span class="p">):</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>  <span class="c"># zap \n</span>
                <span class="c"># make unicode string to display non-ASCII chars correctly</span>
                <span class="n">ufile_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename_to_unicode</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
                <span class="n">callback</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">__recent_file_callback</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">ulchars</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">ufile_name</span><span class="p">,</span>
                                 <span class="n">command</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span>
                                 <span class="n">underline</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__recent_file_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">open_recent_file</span><span class="p">(</span><span class="n">fn_closure</span><span class="o">=</span><span class="n">file_name</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">editFile</span><span class="o">=</span><span class="n">fn_closure</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">open_recent_file</span>

<div class="viewcode-block" id="EditorWindow.saved_change_hook"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.saved_change_hook">[docs]</a>    <span class="k">def</span> <span class="nf">saved_change_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">short</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">short_title</span><span class="p">()</span>
        <span class="nb">long</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">long_title</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">short</span> <span class="ow">and</span> <span class="nb">long</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">short</span> <span class="o">+</span> <span class="s">&quot; - &quot;</span> <span class="o">+</span> <span class="nb">long</span> <span class="o">+</span> <span class="n">_py_version</span>
        <span class="k">elif</span> <span class="n">short</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">short</span>
        <span class="k">elif</span> <span class="nb">long</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="nb">long</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s">&quot;Untitled&quot;</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">short</span> <span class="ow">or</span> <span class="nb">long</span> <span class="ow">or</span> <span class="n">title</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_saved</span><span class="p">():</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s">&quot;*</span><span class="si">%s</span><span class="s">*&quot;</span> <span class="o">%</span> <span class="n">title</span>
            <span class="n">icon</span> <span class="o">=</span> <span class="s">&quot;*</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">icon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">wm_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">wm_iconname</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.get_saved"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.get_saved">[docs]</a>    <span class="k">def</span> <span class="nf">get_saved</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">undo</span><span class="o">.</span><span class="n">get_saved</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EditorWindow.set_saved"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.set_saved">[docs]</a>    <span class="k">def</span> <span class="nf">set_saved</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">undo</span><span class="o">.</span><span class="n">set_saved</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.reset_undo"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.reset_undo">[docs]</a>    <span class="k">def</span> <span class="nf">reset_undo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">undo</span><span class="o">.</span><span class="n">reset_undo</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EditorWindow.short_title"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.short_title">[docs]</a>    <span class="k">def</span> <span class="nf">short_title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">filename</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s">&quot;Untitled&quot;</span>
        <span class="c"># return unicode string to display non-ASCII chars correctly</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename_to_unicode</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.long_title"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.long_title">[docs]</a>    <span class="k">def</span> <span class="nf">long_title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># return unicode string to display non-ASCII chars correctly</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename_to_unicode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">filename</span> <span class="ow">or</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.center_insert_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.center_insert_event">[docs]</a>    <span class="k">def</span> <span class="nf">center_insert_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EditorWindow.center"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.center">[docs]</a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mark</span><span class="o">=</span><span class="s">&quot;insert&quot;</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
        <span class="n">top</span><span class="p">,</span> <span class="n">bot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getwindowlines</span><span class="p">()</span>
        <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getlineno</span><span class="p">(</span><span class="n">mark</span><span class="p">)</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">bot</span> <span class="o">-</span> <span class="n">top</span>
        <span class="n">newtop</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">-</span> <span class="n">height</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">yview</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">newtop</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="EditorWindow.getwindowlines"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.getwindowlines">[docs]</a>    <span class="k">def</span> <span class="nf">getwindowlines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
        <span class="n">top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getlineno</span><span class="p">(</span><span class="s">&quot;@0,0&quot;</span><span class="p">)</span>
        <span class="n">bot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getlineno</span><span class="p">(</span><span class="s">&quot;@0,65535&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">top</span> <span class="o">==</span> <span class="n">bot</span> <span class="ow">and</span> <span class="n">text</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c"># Geometry manager hasn&#39;t run yet</span>
            <span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="s">&#39;height&#39;</span><span class="p">])</span>
            <span class="n">bot</span> <span class="o">=</span> <span class="n">top</span> <span class="o">+</span> <span class="n">height</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">top</span><span class="p">,</span> <span class="n">bot</span>
</div>
<div class="viewcode-block" id="EditorWindow.getlineno"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.getlineno">[docs]</a>    <span class="k">def</span> <span class="nf">getlineno</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mark</span><span class="o">=</span><span class="s">&quot;insert&quot;</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">mark</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="EditorWindow.get_geometry"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.get_geometry">[docs]</a>    <span class="k">def</span> <span class="nf">get_geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Return (width, height, x, y)&quot;</span>
        <span class="n">geom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">wm_geometry</span><span class="p">()</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">r&quot;(\d+)x(\d+)\+(-?\d+)\+(-?\d+)&quot;</span><span class="p">,</span> <span class="n">geom</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()))</span>
</div>
<div class="viewcode-block" id="EditorWindow.close_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.close_event">[docs]</a>    <span class="k">def</span> <span class="nf">close_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EditorWindow.maybesave"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.maybesave">[docs]</a>    <span class="k">def</span> <span class="nf">maybesave</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">io</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_saved</span><span class="p">():</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">state</span><span class="p">()</span><span class="o">!=</span><span class="s">&#39;normal&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">deiconify</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">maybesave</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EditorWindow.close"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maybesave</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">reply</span><span class="p">)</span> <span class="o">!=</span> <span class="s">&quot;cancel&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">reply</span>
</div>
    <span class="k">def</span> <span class="nf">_close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_recent_files_list</span><span class="p">(</span><span class="n">new_file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">WindowList</span><span class="o">.</span><span class="n">unregister_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postwindowsmenu</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unload_extensions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">io</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">undo</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tkinter_vars</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">per</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">per</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">close_hook</span><span class="p">:</span>
            <span class="c"># unless override: unregister from flist, terminate if last window</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close_hook</span><span class="p">()</span>

<div class="viewcode-block" id="EditorWindow.load_extensions"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.load_extensions">[docs]</a>    <span class="k">def</span> <span class="nf">load_extensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_standard_extensions</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EditorWindow.unload_extensions"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.unload_extensions">[docs]</a>    <span class="k">def</span> <span class="nf">unload_extensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ins</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ins</span><span class="p">,</span> <span class="s">&quot;close&quot;</span><span class="p">):</span>
                <span class="n">ins</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span> <span class="o">=</span> <span class="p">{}</span>
</div>
<div class="viewcode-block" id="EditorWindow.load_standard_extensions"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.load_standard_extensions">[docs]</a>    <span class="k">def</span> <span class="nf">load_standard_extensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_standard_extension_names</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">load_extension</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;Failed to load extension&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
                <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EditorWindow.get_standard_extension_names"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.get_standard_extension_names">[docs]</a>    <span class="k">def</span> <span class="nf">get_standard_extension_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetExtensions</span><span class="p">(</span><span class="n">editor_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.load_extension"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.load_extension">[docs]</a>    <span class="k">def</span> <span class="nf">load_extension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">mod</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="s">&#39;.&#39;</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="n">package</span><span class="o">=</span><span class="n">__package__</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ImportError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="n">mod</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Failed to import extension: &quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">raise</span>
        <span class="n">cls</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">keydefs</span> <span class="o">=</span> <span class="n">idleConf</span><span class="o">.</span><span class="n">GetExtensionBindings</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="s">&quot;menudefs&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fill_menus</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">menudefs</span><span class="p">,</span> <span class="n">keydefs</span><span class="p">)</span>
        <span class="n">ins</span> <span class="o">=</span> <span class="n">cls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ins</span>
        <span class="k">if</span> <span class="n">keydefs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apply_bindings</span><span class="p">(</span><span class="n">keydefs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">vevent</span> <span class="ow">in</span> <span class="n">keydefs</span><span class="p">:</span>
                <span class="n">methodname</span> <span class="o">=</span> <span class="n">vevent</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="s">&quot;_&quot;</span><span class="p">)</span>
                <span class="k">while</span> <span class="n">methodname</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;&lt;&#39;</span><span class="p">:</span>
                    <span class="n">methodname</span> <span class="o">=</span> <span class="n">methodname</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="k">while</span> <span class="n">methodname</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s">&#39;&gt;&#39;</span><span class="p">:</span>
                    <span class="n">methodname</span> <span class="o">=</span> <span class="n">methodname</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">methodname</span> <span class="o">=</span> <span class="n">methodname</span> <span class="o">+</span> <span class="s">&quot;_event&quot;</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ins</span><span class="p">,</span> <span class="n">methodname</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">vevent</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ins</span><span class="p">,</span> <span class="n">methodname</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="EditorWindow.apply_bindings"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.apply_bindings">[docs]</a>    <span class="k">def</span> <span class="nf">apply_bindings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keydefs</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">keydefs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">keydefs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Bindings</span><span class="o">.</span><span class="n">default_keydefs</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
        <span class="n">text</span><span class="o">.</span><span class="n">keydefs</span> <span class="o">=</span> <span class="n">keydefs</span>
        <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">keylist</span> <span class="ow">in</span> <span class="n">keydefs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">keylist</span><span class="p">:</span>
                <span class="n">text</span><span class="o">.</span><span class="n">event_add</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="o">*</span><span class="n">keylist</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.fill_menus"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.fill_menus">[docs]</a>    <span class="k">def</span> <span class="nf">fill_menus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">menudefs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">keydefs</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add appropriate entries to the menus and submenus</span>

<span class="sd">        Menus that are absent or None in self.menudict are ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">menudefs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">menudefs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Bindings</span><span class="o">.</span><span class="n">menudefs</span>
        <span class="k">if</span> <span class="n">keydefs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">keydefs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Bindings</span><span class="o">.</span><span class="n">default_keydefs</span>
        <span class="n">menudict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menudict</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
        <span class="k">for</span> <span class="n">mname</span><span class="p">,</span> <span class="n">entrylist</span> <span class="ow">in</span> <span class="n">menudefs</span><span class="p">:</span>
            <span class="n">menu</span> <span class="o">=</span> <span class="n">menudict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">mname</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">menu</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entrylist</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">entry</span><span class="p">:</span>
                    <span class="n">menu</span><span class="o">.</span><span class="n">add_separator</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">label</span><span class="p">,</span> <span class="n">eventname</span> <span class="o">=</span> <span class="n">entry</span>
                    <span class="n">checkbutton</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;!&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">checkbutton</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="n">underline</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">prepstr</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                    <span class="n">accelerator</span> <span class="o">=</span> <span class="n">get_accelerator</span><span class="p">(</span><span class="n">keydefs</span><span class="p">,</span> <span class="n">eventname</span><span class="p">)</span>
                    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">eventname</span><span class="o">=</span><span class="n">eventname</span><span class="p">):</span>
                        <span class="n">text</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="n">eventname</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">checkbutton</span><span class="p">:</span>
                        <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_var_obj</span><span class="p">(</span><span class="n">eventname</span><span class="p">,</span> <span class="n">BooleanVar</span><span class="p">)</span>
                        <span class="n">menu</span><span class="o">.</span><span class="n">add_checkbutton</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">underline</span><span class="o">=</span><span class="n">underline</span><span class="p">,</span>
                            <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">,</span> <span class="n">accelerator</span><span class="o">=</span><span class="n">accelerator</span><span class="p">,</span>
                            <span class="n">variable</span><span class="o">=</span><span class="n">var</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">underline</span><span class="o">=</span><span class="n">underline</span><span class="p">,</span>
                                         <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">,</span>
                                         <span class="n">accelerator</span><span class="o">=</span><span class="n">accelerator</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.getvar"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.getvar">[docs]</a>    <span class="k">def</span> <span class="nf">getvar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_var_obj</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">var</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.setvar"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.setvar">[docs]</a>    <span class="k">def</span> <span class="nf">setvar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">vartype</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_var_obj</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">vartype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">var</span><span class="p">:</span>
            <span class="n">var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.get_var_obj"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.get_var_obj">[docs]</a>    <span class="k">def</span> <span class="nf">get_var_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">vartype</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tkinter_vars</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">var</span> <span class="ow">and</span> <span class="n">vartype</span><span class="p">:</span>
            <span class="c"># create a Tkinter variable object with self.text as master:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tkinter_vars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span> <span class="o">=</span> <span class="n">vartype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">var</span>

    <span class="c"># Tk implementations of &quot;virtual text methods&quot; -- each platform</span>
    <span class="c"># reusing IDLE&#39;s support code needs to define these for its GUI&#39;s</span>
    <span class="c"># flavor of widget.</span>

    <span class="c"># Is character at text_index in a Python string?  Return 0 for</span>
    <span class="c"># &quot;guaranteed no&quot;, true for anything else.  This info is expensive</span>
    <span class="c"># to compute ab initio, but is probably already known by the</span>
    <span class="c"># platform&#39;s colorizer.</span>
</div>
<div class="viewcode-block" id="EditorWindow.is_char_in_string"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.is_char_in_string">[docs]</a>    <span class="k">def</span> <span class="nf">is_char_in_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text_index</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">:</span>
            <span class="c"># Return true iff colorizer hasn&#39;t (re)gotten this far</span>
            <span class="c"># yet, or the character is tagged as being in a string</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">tag_prevrange</span><span class="p">(</span><span class="s">&quot;TODO&quot;</span><span class="p">,</span> <span class="n">text_index</span><span class="p">)</span> <span class="ow">or</span> \
                   <span class="s">&quot;STRING&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">tag_names</span><span class="p">(</span><span class="n">text_index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># The colorizer is missing: assume the worst</span>
            <span class="k">return</span> <span class="mi">1</span>

    <span class="c"># If a selection is defined in the text widget, return (start,</span>
    <span class="c"># end) as Tkinter text indices, otherwise return (None, None)</span></div>
<div class="viewcode-block" id="EditorWindow.get_selection_indices"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.get_selection_indices">[docs]</a>    <span class="k">def</span> <span class="nf">get_selection_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">first</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;sel.first&quot;</span><span class="p">)</span>
            <span class="n">last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;sel.last&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">first</span><span class="p">,</span> <span class="n">last</span>
        <span class="k">except</span> <span class="n">TclError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>

    <span class="c"># Return the text widget&#39;s current view of what a tab stop means</span>
    <span class="c"># (equivalent width in spaces).</span>
</div>
<div class="viewcode-block" id="EditorWindow.get_tk_tabwidth"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.get_tk_tabwidth">[docs]</a>    <span class="k">def</span> <span class="nf">get_tk_tabwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="s">&#39;tabs&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">TK_TABWIDTH_DEFAULT</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>

    <span class="c"># Set the text widget&#39;s current view of what a tab stop means.</span>
</div>
<div class="viewcode-block" id="EditorWindow.set_tk_tabwidth"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.set_tk_tabwidth">[docs]</a>    <span class="k">def</span> <span class="nf">set_tk_tabwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newtabwidth</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tk_tabwidth</span><span class="p">()</span> <span class="o">!=</span> <span class="n">newtabwidth</span><span class="p">:</span>
            <span class="c"># Set text widget tab width</span>
            <span class="n">pixels</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&quot;font&quot;</span><span class="p">,</span> <span class="s">&quot;measure&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">[</span><span class="s">&quot;font&quot;</span><span class="p">],</span>
                                  <span class="s">&quot;-displayof&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">.</span><span class="n">master</span><span class="p">,</span>
                                  <span class="s">&quot;n&quot;</span> <span class="o">*</span> <span class="n">newtabwidth</span><span class="p">)</span>
            <span class="n">text</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">tabs</span><span class="o">=</span><span class="n">pixels</span><span class="p">)</span>

<span class="c">### begin autoindent code ###  (configuration was moved to beginning of class)</span>
</div>
<div class="viewcode-block" id="EditorWindow.set_indentation_params"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.set_indentation_params">[docs]</a>    <span class="k">def</span> <span class="nf">set_indentation_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_py_src</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_py_src</span> <span class="ow">and</span> <span class="n">guess</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">guess_indent</span><span class="p">()</span>
            <span class="k">if</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">usetabs</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_tk_tabwidth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.smart_backspace_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.smart_backspace_event">[docs]</a>    <span class="k">def</span> <span class="nf">smart_backspace_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
        <span class="n">first</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_selection_indices</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">first</span> <span class="ow">and</span> <span class="n">last</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">)</span>
            <span class="n">text</span><span class="o">.</span><span class="n">mark_set</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="n">first</span><span class="p">)</span>
            <span class="k">return</span> <span class="s">&quot;break&quot;</span>
        <span class="c"># Delete whitespace left, until hitting a real char or closest</span>
        <span class="c"># preceding virtual tab stop.</span>
        <span class="n">chars</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;insert linestart&quot;</span><span class="p">,</span> <span class="s">&quot;insert&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">chars</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="s">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;1.0&quot;</span><span class="p">):</span>
                <span class="c"># easy: delete preceding newline</span>
                <span class="n">text</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s">&quot;insert-1c&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">text</span><span class="o">.</span><span class="n">bell</span><span class="p">()</span>     <span class="c"># at start of buffer</span>
            <span class="k">return</span> <span class="s">&quot;break&quot;</span>
        <span class="k">if</span>  <span class="n">chars</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s">&quot; </span><span class="se">\t</span><span class="s">&quot;</span><span class="p">:</span>
            <span class="c"># easy: delete preceding real char</span>
            <span class="n">text</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s">&quot;insert-1c&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s">&quot;break&quot;</span>
        <span class="c"># Ick.  It may require *inserting* spaces if we back up over a</span>
        <span class="c"># tab character!  This is written to be clear, not fast.</span>
        <span class="n">tabwidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span>
        <span class="n">have</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="n">tabwidth</span><span class="p">))</span>
        <span class="k">assert</span> <span class="n">have</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="n">want</span> <span class="o">=</span> <span class="p">((</span><span class="n">have</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span>
        <span class="c"># Debug prompt is multilined....</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context_use_ps1</span><span class="p">:</span>
            <span class="n">last_line_of_prompt</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">ps1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">last_line_of_prompt</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="n">ncharsdeleted</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chars</span> <span class="o">==</span> <span class="n">last_line_of_prompt</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">chars</span> <span class="o">=</span> <span class="n">chars</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ncharsdeleted</span> <span class="o">=</span> <span class="n">ncharsdeleted</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">have</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="n">tabwidth</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">have</span> <span class="o">&lt;=</span> <span class="n">want</span> <span class="ow">or</span> <span class="n">chars</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s">&quot; </span><span class="se">\t</span><span class="s">&quot;</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">text</span><span class="o">.</span><span class="n">undo_block_start</span><span class="p">()</span>
        <span class="n">text</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s">&quot;insert-</span><span class="si">%d</span><span class="s">c&quot;</span> <span class="o">%</span> <span class="n">ncharsdeleted</span><span class="p">,</span> <span class="s">&quot;insert&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">have</span> <span class="o">&lt;</span> <span class="n">want</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="s">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">want</span> <span class="o">-</span> <span class="n">have</span><span class="p">))</span>
        <span class="n">text</span><span class="o">.</span><span class="n">undo_block_stop</span><span class="p">()</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.smart_indent_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.smart_indent_event">[docs]</a>    <span class="k">def</span> <span class="nf">smart_indent_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="c"># if intraline selection:</span>
        <span class="c">#     delete it</span>
        <span class="c"># elif multiline selection:</span>
        <span class="c">#     do indent-region</span>
        <span class="c"># else:</span>
        <span class="c">#     indent one level</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
        <span class="n">first</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_selection_indices</span><span class="p">()</span>
        <span class="n">text</span><span class="o">.</span><span class="n">undo_block_start</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">first</span> <span class="ow">and</span> <span class="n">last</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">index2line</span><span class="p">(</span><span class="n">first</span><span class="p">)</span> <span class="o">!=</span> <span class="n">index2line</span><span class="p">(</span><span class="n">last</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">indent_region_event</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                <span class="n">text</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">)</span>
                <span class="n">text</span><span class="o">.</span><span class="n">mark_set</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="n">first</span><span class="p">)</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;insert linestart&quot;</span><span class="p">,</span> <span class="s">&quot;insert&quot;</span><span class="p">)</span>
            <span class="n">raw</span><span class="p">,</span> <span class="n">effective</span> <span class="o">=</span> <span class="n">classifyws</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">raw</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
                <span class="c"># only whitespace to the left</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reindent_to</span><span class="p">(</span><span class="n">effective</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># tab to the next &#39;stop&#39; within or to right of line&#39;s text:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">usetabs</span><span class="p">:</span>
                    <span class="n">pad</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">effective</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span><span class="p">))</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span>
                    <span class="n">pad</span> <span class="o">=</span> <span class="s">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">effective</span> <span class="o">%</span> <span class="n">n</span><span class="p">)</span>
                <span class="n">text</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="p">)</span>
            <span class="n">text</span><span class="o">.</span><span class="n">see</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s">&quot;break&quot;</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">undo_block_stop</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EditorWindow.newline_and_indent_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.newline_and_indent_event">[docs]</a>    <span class="k">def</span> <span class="nf">newline_and_indent_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
        <span class="n">first</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_selection_indices</span><span class="p">()</span>
        <span class="n">text</span><span class="o">.</span><span class="n">undo_block_start</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">first</span> <span class="ow">and</span> <span class="n">last</span><span class="p">:</span>
                <span class="n">text</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">)</span>
                <span class="n">text</span><span class="o">.</span><span class="n">mark_set</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="n">first</span><span class="p">)</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;insert linestart&quot;</span><span class="p">,</span> <span class="s">&quot;insert&quot;</span><span class="p">)</span>
            <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="s">&quot; </span><span class="se">\t</span><span class="s">&quot;</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
                <span class="c"># the cursor is in or at leading indentation in a continuation</span>
                <span class="c"># line; just inject an empty line at the start</span>
                <span class="n">text</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s">&quot;insert linestart&quot;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="s">&quot;break&quot;</span>
            <span class="n">indent</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
            <span class="c"># strip whitespace before insert point unless it&#39;s in the prompt</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">last_line_of_prompt</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">ps1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">while</span> <span class="n">line</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="s">&quot; </span><span class="se">\t</span><span class="s">&quot;</span> <span class="ow">and</span> <span class="n">line</span> <span class="o">!=</span> <span class="n">last_line_of_prompt</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">i</span><span class="p">:</span>
                <span class="n">text</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s">&quot;insert - </span><span class="si">%d</span><span class="s"> chars&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s">&quot;insert&quot;</span><span class="p">)</span>
            <span class="c"># strip whitespace after insert point</span>
            <span class="k">while</span> <span class="n">text</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="s">&quot; </span><span class="se">\t</span><span class="s">&quot;</span><span class="p">:</span>
                <span class="n">text</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">)</span>
            <span class="c"># start new line</span>
            <span class="n">text</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

            <span class="c"># adjust indentation for continuations and block</span>
            <span class="c"># open/close first need to find the last stmt</span>
            <span class="n">lno</span> <span class="o">=</span> <span class="n">index2line</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&#39;insert&#39;</span><span class="p">))</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">PyParse</span><span class="o">.</span><span class="n">Parser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">context_use_ps1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">context</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_context_lines</span><span class="p">:</span>
                    <span class="n">startat</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">lno</span> <span class="o">-</span> <span class="n">context</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">startatindex</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">startat</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.0&quot;</span>
                    <span class="n">rawtext</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">startatindex</span><span class="p">,</span> <span class="s">&quot;insert&quot;</span><span class="p">)</span>
                    <span class="n">y</span><span class="o">.</span><span class="n">set_str</span><span class="p">(</span><span class="n">rawtext</span><span class="p">)</span>
                    <span class="n">bod</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">find_good_parse_start</span><span class="p">(</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">context_use_ps1</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">_build_char_in_string_func</span><span class="p">(</span><span class="n">startatindex</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">bod</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">startat</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="n">y</span><span class="o">.</span><span class="n">set_lo</span><span class="p">(</span><span class="n">bod</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">tag_prevrange</span><span class="p">(</span><span class="s">&quot;console&quot;</span><span class="p">,</span> <span class="s">&quot;insert&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
                    <span class="n">startatindex</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">startatindex</span> <span class="o">=</span> <span class="s">&quot;1.0&quot;</span>
                <span class="n">rawtext</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">startatindex</span><span class="p">,</span> <span class="s">&quot;insert&quot;</span><span class="p">)</span>
                <span class="n">y</span><span class="o">.</span><span class="n">set_str</span><span class="p">(</span><span class="n">rawtext</span><span class="p">)</span>
                <span class="n">y</span><span class="o">.</span><span class="n">set_lo</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="n">c</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">get_continuation_type</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="n">PyParse</span><span class="o">.</span><span class="n">C_NONE</span><span class="p">:</span>
                <span class="c"># The current stmt hasn&#39;t ended yet.</span>
                <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">PyParse</span><span class="o">.</span><span class="n">C_STRING_FIRST_LINE</span><span class="p">:</span>
                    <span class="c"># after the first line of a string; do not indent at all</span>
                    <span class="k">pass</span>
                <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="n">PyParse</span><span class="o">.</span><span class="n">C_STRING_NEXT_LINES</span><span class="p">:</span>
                    <span class="c"># inside a string which started before this line;</span>
                    <span class="c"># just mimic the current indent</span>
                    <span class="n">text</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="n">PyParse</span><span class="o">.</span><span class="n">C_BRACKET</span><span class="p">:</span>
                    <span class="c"># line up with the first (if any) element of the</span>
                    <span class="c"># last open bracket structure; else indent one</span>
                    <span class="c"># level beyond the indent of the line with the</span>
                    <span class="c"># last open bracket</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">reindent_to</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">compute_bracket_indent</span><span class="p">())</span>
                <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="n">PyParse</span><span class="o">.</span><span class="n">C_BACKSLASH</span><span class="p">:</span>
                    <span class="c"># if more than one line in this stmt already, just</span>
                    <span class="c"># mimic the current indent; else if initial line</span>
                    <span class="c"># has a start on an assignment stmt, indent to</span>
                    <span class="c"># beyond leftmost =; else to beyond first chunk of</span>
                    <span class="c"># non-whitespace on initial line</span>
                    <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">get_num_lines_in_stmt</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">text</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">reindent_to</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">compute_backslash_indent</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;bogus continuation type </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">,)</span>
                <span class="k">return</span> <span class="s">&quot;break&quot;</span>

            <span class="c"># This line starts a brand new stmt; indent relative to</span>
            <span class="c"># indentation of initial line of closest preceding</span>
            <span class="c"># interesting stmt.</span>
            <span class="n">indent</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">get_base_indent_string</span><span class="p">()</span>
            <span class="n">text</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">is_block_opener</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">smart_indent_event</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">indent</span> <span class="ow">and</span> <span class="n">y</span><span class="o">.</span><span class="n">is_block_closer</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">smart_backspace_event</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="k">return</span> <span class="s">&quot;break&quot;</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">see</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">)</span>
            <span class="n">text</span><span class="o">.</span><span class="n">undo_block_stop</span><span class="p">()</span>

    <span class="c"># Our editwin provides a is_char_in_string function that works</span>
    <span class="c"># with a Tk text index, but PyParse only knows about offsets into</span>
    <span class="c"># a string. This builds a function for PyParse that accepts an</span>
    <span class="c"># offset.</span>
</div>
    <span class="k">def</span> <span class="nf">_build_char_in_string_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startindex</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">_startindex</span><span class="o">=</span><span class="n">startindex</span><span class="p">,</span>
                  <span class="n">_icis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_char_in_string</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">_icis</span><span class="p">(</span><span class="n">_startindex</span> <span class="o">+</span> <span class="s">&quot;+</span><span class="si">%d</span><span class="s">c&quot;</span> <span class="o">%</span> <span class="n">offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">inner</span>

<div class="viewcode-block" id="EditorWindow.indent_region_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.indent_region_event">[docs]</a>    <span class="k">def</span> <span class="nf">indent_region_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_region</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">raw</span><span class="p">,</span> <span class="n">effective</span> <span class="o">=</span> <span class="n">classifyws</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span><span class="p">)</span>
                <span class="n">effective</span> <span class="o">=</span> <span class="n">effective</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span>
                <span class="n">lines</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_blanks</span><span class="p">(</span><span class="n">effective</span><span class="p">)</span> <span class="o">+</span> <span class="n">line</span><span class="p">[</span><span class="n">raw</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.dedent_region_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.dedent_region_event">[docs]</a>    <span class="k">def</span> <span class="nf">dedent_region_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_region</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">raw</span><span class="p">,</span> <span class="n">effective</span> <span class="o">=</span> <span class="n">classifyws</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span><span class="p">)</span>
                <span class="n">effective</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">effective</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">lines</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_blanks</span><span class="p">(</span><span class="n">effective</span><span class="p">)</span> <span class="o">+</span> <span class="n">line</span><span class="p">[</span><span class="n">raw</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.comment_region_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.comment_region_event">[docs]</a>    <span class="k">def</span> <span class="nf">comment_region_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_region</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
            <span class="n">lines</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;##&#39;</span> <span class="o">+</span> <span class="n">line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.uncomment_region_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.uncomment_region_event">[docs]</a>    <span class="k">def</span> <span class="nf">uncomment_region_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_region</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;##&#39;</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
            <span class="k">elif</span> <span class="n">line</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;#&#39;</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">lines</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.tabify_region_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.tabify_region_event">[docs]</a>    <span class="k">def</span> <span class="nf">tabify_region_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_region</span><span class="p">()</span>
        <span class="n">tabwidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_asktabwidth</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">tabwidth</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">raw</span><span class="p">,</span> <span class="n">effective</span> <span class="o">=</span> <span class="n">classifyws</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">tabwidth</span><span class="p">)</span>
                <span class="n">ntabs</span><span class="p">,</span> <span class="n">nspaces</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">effective</span><span class="p">,</span> <span class="n">tabwidth</span><span class="p">)</span>
                <span class="n">lines</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span> <span class="o">*</span> <span class="n">ntabs</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">*</span> <span class="n">nspaces</span> <span class="o">+</span> <span class="n">line</span><span class="p">[</span><span class="n">raw</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.untabify_region_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.untabify_region_event">[docs]</a>    <span class="k">def</span> <span class="nf">untabify_region_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_region</span><span class="p">()</span>
        <span class="n">tabwidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_asktabwidth</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">tabwidth</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>
            <span class="n">lines</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="n">tabwidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EditorWindow.toggle_tabs_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.toggle_tabs_event">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_tabs_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">askyesno</span><span class="p">(</span>
              <span class="s">&quot;Toggle tabs&quot;</span><span class="p">,</span>
              <span class="s">&quot;Turn tabs &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s">&quot;on&quot;</span><span class="p">,</span> <span class="s">&quot;off&quot;</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">usetabs</span><span class="p">]</span> <span class="o">+</span>
              <span class="s">&quot;?</span><span class="se">\n</span><span class="s">Indent width &quot;</span> <span class="o">+</span>
              <span class="p">(</span><span class="s">&quot;will be&quot;</span><span class="p">,</span> <span class="s">&quot;remains at&quot;</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">usetabs</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot; 8.&quot;</span> <span class="o">+</span>
              <span class="s">&quot;</span><span class="se">\n</span><span class="s"> Note: a tab is always 8 columns&quot;</span><span class="p">,</span>
              <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">usetabs</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">usetabs</span>
            <span class="c"># Try to prevent inconsistent indentation.</span>
            <span class="c"># User must change indent width manually after using tabs.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>

    <span class="c"># XXX this isn&#39;t bound to anything -- see tabwidth comments</span>
<span class="c">##     def change_tabwidth_event(self, event):</span>
<span class="c">##         new = self._asktabwidth()</span>
<span class="c">##         if new != self.tabwidth:</span>
<span class="c">##             self.tabwidth = new</span>
<span class="c">##             self.set_indentation_params(0, guess=0)</span>
<span class="c">##         return &quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.change_indentwidth_event"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.change_indentwidth_event">[docs]</a>    <span class="k">def</span> <span class="nf">change_indentwidth_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">askinteger</span><span class="p">(</span>
                  <span class="s">&quot;Indent width&quot;</span><span class="p">,</span>
                  <span class="s">&quot;New indent width (2-16)</span><span class="se">\n</span><span class="s">(Always use 8 when using tabs)&quot;</span><span class="p">,</span>
                  <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                  <span class="n">initialvalue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span><span class="p">,</span>
                  <span class="n">minvalue</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                  <span class="n">maxvalue</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">new</span> <span class="ow">and</span> <span class="n">new</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">usetabs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span> <span class="o">=</span> <span class="n">new</span>
        <span class="k">return</span> <span class="s">&quot;break&quot;</span>
</div>
<div class="viewcode-block" id="EditorWindow.get_region"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.get_region">[docs]</a>    <span class="k">def</span> <span class="nf">get_region</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
        <span class="n">first</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_selection_indices</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">first</span> <span class="ow">and</span> <span class="n">last</span><span class="p">:</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="s">&quot; linestart&quot;</span><span class="p">)</span>
            <span class="n">tail</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">last</span> <span class="o">+</span> <span class="s">&quot;-1c lineend +1c&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;insert linestart&quot;</span><span class="p">)</span>
            <span class="n">tail</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;insert lineend +1c&quot;</span><span class="p">)</span>
        <span class="n">chars</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">)</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">chars</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">lines</span>
</div>
<div class="viewcode-block" id="EditorWindow.set_region"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.set_region">[docs]</a>    <span class="k">def</span> <span class="nf">set_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
        <span class="n">newchars</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">newchars</span> <span class="o">==</span> <span class="n">chars</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">bell</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="n">text</span><span class="o">.</span><span class="n">tag_remove</span><span class="p">(</span><span class="s">&quot;sel&quot;</span><span class="p">,</span> <span class="s">&quot;1.0&quot;</span><span class="p">,</span> <span class="s">&quot;end&quot;</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">mark_set</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="n">head</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">undo_block_start</span><span class="p">()</span>
        <span class="n">text</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">newchars</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">undo_block_stop</span><span class="p">()</span>
        <span class="n">text</span><span class="o">.</span><span class="n">tag_add</span><span class="p">(</span><span class="s">&quot;sel&quot;</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="s">&quot;insert&quot;</span><span class="p">)</span>

    <span class="c"># Make string that displays as n leading blanks.</span>
</div>
    <span class="k">def</span> <span class="nf">_make_blanks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">usetabs</span><span class="p">:</span>
            <span class="n">ntabs</span><span class="p">,</span> <span class="n">nspaces</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span><span class="p">)</span>
            <span class="k">return</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span> <span class="o">*</span> <span class="n">ntabs</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">*</span> <span class="n">nspaces</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&#39; &#39;</span> <span class="o">*</span> <span class="n">n</span>

    <span class="c"># Delete from beginning of line to insert point, then reinsert</span>
    <span class="c"># column logical (meaning use tabs if appropriate) spaces.</span>

<div class="viewcode-block" id="EditorWindow.reindent_to"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.reindent_to">[docs]</a>    <span class="k">def</span> <span class="nf">reindent_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
        <span class="n">text</span><span class="o">.</span><span class="n">undo_block_start</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="s">&quot;insert linestart&quot;</span><span class="p">,</span> <span class="s">&quot;!=&quot;</span><span class="p">,</span> <span class="s">&quot;insert&quot;</span><span class="p">):</span>
            <span class="n">text</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s">&quot;insert linestart&quot;</span><span class="p">,</span> <span class="s">&quot;insert&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">column</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s">&quot;insert&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_blanks</span><span class="p">(</span><span class="n">column</span><span class="p">))</span>
        <span class="n">text</span><span class="o">.</span><span class="n">undo_block_stop</span><span class="p">()</span>
</div>
    <span class="k">def</span> <span class="nf">_asktabwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">askinteger</span><span class="p">(</span>
            <span class="s">&quot;Tab width&quot;</span><span class="p">,</span>
            <span class="s">&quot;Columns per tab? (2-16)&quot;</span><span class="p">,</span>
            <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
            <span class="n">initialvalue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">indentwidth</span><span class="p">,</span>
            <span class="n">minvalue</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">maxvalue</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="c"># Guess indentwidth from text content.</span>
    <span class="c"># Return guessed indentwidth.  This should not be believed unless</span>
    <span class="c"># it&#39;s in a reasonable range (e.g., it will be 0 if no indented</span>
    <span class="c"># blocks are found).</span>

<div class="viewcode-block" id="EditorWindow.guess_indent"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.EditorWindow.guess_indent">[docs]</a>    <span class="k">def</span> <span class="nf">guess_indent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">opener</span><span class="p">,</span> <span class="n">indented</span> <span class="o">=</span> <span class="n">IndentSearcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">opener</span> <span class="ow">and</span> <span class="n">indented</span><span class="p">:</span>
            <span class="n">raw</span><span class="p">,</span> <span class="n">indentsmall</span> <span class="o">=</span> <span class="n">classifyws</span><span class="p">(</span><span class="n">opener</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span><span class="p">)</span>
            <span class="n">raw</span><span class="p">,</span> <span class="n">indentlarge</span> <span class="o">=</span> <span class="n">classifyws</span><span class="p">(</span><span class="n">indented</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">indentsmall</span> <span class="o">=</span> <span class="n">indentlarge</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">indentlarge</span> <span class="o">-</span> <span class="n">indentsmall</span>

<span class="c"># &quot;line.col&quot; -&gt; line, as an int</span></div></div>
<div class="viewcode-block" id="index2line"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.index2line">[docs]</a><span class="k">def</span> <span class="nf">index2line</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>

<span class="c"># Look at the leading whitespace in s.</span>
<span class="c"># Return pair (# of leading ws characters,</span>
<span class="c">#              effective # of leading blanks after expanding</span>
<span class="c">#              tabs to width tabwidth)</span>
</div>
<div class="viewcode-block" id="classifyws"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.classifyws">[docs]</a><span class="k">def</span> <span class="nf">classifyws</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">tabwidth</span><span class="p">):</span>
    <span class="n">raw</span> <span class="o">=</span> <span class="n">effective</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s">&#39; &#39;</span><span class="p">:</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">raw</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">effective</span> <span class="o">=</span> <span class="n">effective</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">ch</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">:</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">raw</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">effective</span> <span class="o">=</span> <span class="p">(</span><span class="n">effective</span> <span class="o">//</span> <span class="n">tabwidth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">tabwidth</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">raw</span><span class="p">,</span> <span class="n">effective</span>
</div>
<span class="kn">import</span> <span class="nn">tokenize</span>
<span class="n">_tokenize</span> <span class="o">=</span> <span class="n">tokenize</span>
<span class="k">del</span> <span class="n">tokenize</span>

<div class="viewcode-block" id="IndentSearcher"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.IndentSearcher">[docs]</a><span class="k">class</span> <span class="nc">IndentSearcher</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="c"># .run() chews over the Text widget, looking for a block opener</span>
    <span class="c"># and the stmt following it.  Returns a pair,</span>
    <span class="c">#     (line containing block opener, line containing stmt)</span>
    <span class="c"># Either or both may be None.</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">tabwidth</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span> <span class="o">=</span> <span class="n">tabwidth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">finished</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blkopenline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indentedline</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="IndentSearcher.readline"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.IndentSearcher.readline">[docs]</a>    <span class="k">def</span> <span class="nf">readline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">finished</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">mark</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.0&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">mark</span><span class="p">,</span> <span class="s">&quot;&gt;=&quot;</span><span class="p">,</span> <span class="s">&quot;end&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">mark</span><span class="p">,</span> <span class="n">mark</span> <span class="o">+</span> <span class="s">&quot; lineend+1c&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IndentSearcher.tokeneater"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.IndentSearcher.tokeneater">[docs]</a>    <span class="k">def</span> <span class="nf">tokeneater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span>
                   <span class="n">INDENT</span><span class="o">=</span><span class="n">_tokenize</span><span class="o">.</span><span class="n">INDENT</span><span class="p">,</span>
                   <span class="n">NAME</span><span class="o">=</span><span class="n">_tokenize</span><span class="o">.</span><span class="n">NAME</span><span class="p">,</span>
                   <span class="n">OPENERS</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;class&#39;</span><span class="p">,</span> <span class="s">&#39;def&#39;</span><span class="p">,</span> <span class="s">&#39;for&#39;</span><span class="p">,</span> <span class="s">&#39;if&#39;</span><span class="p">,</span> <span class="s">&#39;try&#39;</span><span class="p">,</span> <span class="s">&#39;while&#39;</span><span class="p">)):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">finished</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="n">NAME</span> <span class="ow">and</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">OPENERS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blkopenline</span> <span class="o">=</span> <span class="n">line</span>
        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="n">INDENT</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">blkopenline</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">indentedline</span> <span class="o">=</span> <span class="n">line</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">finished</span> <span class="o">=</span> <span class="mi">1</span>
</div>
<div class="viewcode-block" id="IndentSearcher.run"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.IndentSearcher.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">save_tabsize</span> <span class="o">=</span> <span class="n">_tokenize</span><span class="o">.</span><span class="n">tabsize</span>
        <span class="n">_tokenize</span><span class="o">.</span><span class="n">tabsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabwidth</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tokens</span> <span class="o">=</span> <span class="n">_tokenize</span><span class="o">.</span><span class="n">generate_tokens</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">readline</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tokeneater</span><span class="p">(</span><span class="o">*</span><span class="n">token</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">_tokenize</span><span class="o">.</span><span class="n">TokenError</span><span class="p">,</span> <span class="ne">SyntaxError</span><span class="p">):</span>
                <span class="c"># since we cut off the tokenizer early, we can trigger</span>
                <span class="c"># spurious errors</span>
                <span class="k">pass</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">_tokenize</span><span class="o">.</span><span class="n">tabsize</span> <span class="o">=</span> <span class="n">save_tabsize</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">blkopenline</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indentedline</span>

<span class="c">### end autoindent code ###</span>
</div></div>
<div class="viewcode-block" id="prepstr"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.prepstr">[docs]</a><span class="k">def</span> <span class="nf">prepstr</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="c"># Helper to extract the underscore from a string, e.g.</span>
    <span class="c"># prepstr(&quot;Co_py&quot;) returns (2, &quot;Copy&quot;).</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span>

</div>
<span class="n">keynames</span> <span class="o">=</span> <span class="p">{</span>
 <span class="s">&#39;bracketleft&#39;</span><span class="p">:</span> <span class="s">&#39;[&#39;</span><span class="p">,</span>
 <span class="s">&#39;bracketright&#39;</span><span class="p">:</span> <span class="s">&#39;]&#39;</span><span class="p">,</span>
 <span class="s">&#39;slash&#39;</span><span class="p">:</span> <span class="s">&#39;/&#39;</span><span class="p">,</span>
<span class="p">}</span>

<div class="viewcode-block" id="get_accelerator"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.get_accelerator">[docs]</a><span class="k">def</span> <span class="nf">get_accelerator</span><span class="p">(</span><span class="n">keydefs</span><span class="p">,</span> <span class="n">eventname</span><span class="p">):</span>
    <span class="n">keylist</span> <span class="o">=</span> <span class="n">keydefs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">eventname</span><span class="p">)</span>
    <span class="c"># issue10940: temporary workaround to prevent hang with OS X Cocoa Tk 8.5</span>
    <span class="c"># if not keylist:</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">keylist</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">macosxSupport</span><span class="o">.</span><span class="n">isCocoaTk</span><span class="p">()</span> <span class="ow">and</span> <span class="n">eventname</span> <span class="ow">in</span> <span class="p">{</span>
                            <span class="s">&quot;&lt;&lt;open-module&gt;&gt;&quot;</span><span class="p">,</span>
                            <span class="s">&quot;&lt;&lt;goto-line&gt;&gt;&quot;</span><span class="p">,</span>
                            <span class="s">&quot;&lt;&lt;change-indentwidth&gt;&gt;&quot;</span><span class="p">}):</span>
        <span class="k">return</span> <span class="s">&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">keylist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&quot;-[a-z]\b&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&quot;\b\w+\b&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">keynames</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(),</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()),</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;Key-&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;Cancel&quot;</span><span class="p">,</span><span class="s">&quot;Ctrl-Break&quot;</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>   <span class="c"># dscherer@cmu.edu</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;Control-&quot;</span><span class="p">,</span> <span class="s">&quot;Ctrl-&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="s">&quot;+&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;&gt;&lt;&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span>

</div>
<div class="viewcode-block" id="fixwordbreaks"><a class="viewcode-back" href="../../idlelib.html#idlelib.EditorWindow.fixwordbreaks">[docs]</a><span class="k">def</span> <span class="nf">fixwordbreaks</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
    <span class="c"># Make sure that Tk&#39;s double-click and next/previous word</span>
    <span class="c"># operations use our definition of a word (i.e. an identifier)</span>
    <span class="n">tk</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">tk</span>
    <span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&#39;tcl_wordBreakAfter&#39;</span><span class="p">,</span> <span class="s">&#39;a b&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c"># make sure word.tcl is loaded</span>
    <span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&#39;set&#39;</span><span class="p">,</span> <span class="s">&#39;tcl_wordchars&#39;</span><span class="p">,</span> <span class="s">&#39;[a-zA-Z0-9_]&#39;</span><span class="p">)</span>
    <span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&#39;set&#39;</span><span class="p">,</span> <span class="s">&#39;tcl_nonwordchars&#39;</span><span class="p">,</span> <span class="s">&#39;[^a-zA-Z0-9_]&#39;</span><span class="p">)</span>

</div>
<span class="k">def</span> <span class="nf">_editor_window</span><span class="p">(</span><span class="n">parent</span><span class="p">):</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">parent</span>
    <span class="n">fixwordbreaks</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">macosxSupport</span><span class="o">.</span><span class="n">setupApp</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">edit</span> <span class="o">=</span> <span class="n">EditorWindow</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">edit</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;close-all-windows&gt;&gt;&quot;</span><span class="p">,</span> <span class="n">edit</span><span class="o">.</span><span class="n">close_event</span><span class="p">)</span>
    <span class="n">parent</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">idlelib.idle_test.htest</span> <span class="kn">import</span> <span class="n">run</span>
    <span class="n">run</span><span class="p">(</span><span class="n">_help_dialog</span><span class="p">,</span> <span class="n">_editor_window</span><span class="p">)</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>