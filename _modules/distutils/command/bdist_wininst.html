

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>distutils.command.bdist_wininst &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      
    <li>distutils.command.bdist_wininst</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for distutils.command.bdist_wininst</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;distutils.command.bdist_wininst</span>

<span class="sd">Implements the Distutils &#39;bdist_wininst&#39; command: create a windows installer</span>
<span class="sd">exe-program.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">distutils.core</span> <span class="kn">import</span> <span class="n">Command</span>
<span class="kn">from</span> <span class="nn">distutils.util</span> <span class="kn">import</span> <span class="n">get_platform</span>
<span class="kn">from</span> <span class="nn">distutils.dir_util</span> <span class="kn">import</span> <span class="n">create_tree</span><span class="p">,</span> <span class="n">remove_tree</span>
<span class="kn">from</span> <span class="nn">distutils.errors</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">distutils.sysconfig</span> <span class="kn">import</span> <span class="n">get_python_version</span>
<span class="kn">from</span> <span class="nn">distutils</span> <span class="kn">import</span> <span class="n">log</span>

<div class="viewcode-block" id="bdist_wininst"><a class="viewcode-back" href="../../../distutils.command.html#distutils.command.bdist_wininst.bdist_wininst">[docs]</a><span class="k">class</span> <span class="nc">bdist_wininst</span><span class="p">(</span><span class="n">Command</span><span class="p">):</span>

    <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;create an executable installer for MS Windows&quot;</span>

    <span class="n">user_options</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;bdist-dir=&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
                     <span class="s">&quot;temporary directory for creating the distribution&quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;plat-name=&#39;</span><span class="p">,</span> <span class="s">&#39;p&#39;</span><span class="p">,</span>
                     <span class="s">&quot;platform name to embed in generated filenames &quot;</span>
                     <span class="s">&quot;(default: </span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">get_platform</span><span class="p">()),</span>
                    <span class="p">(</span><span class="s">&#39;keep-temp&#39;</span><span class="p">,</span> <span class="s">&#39;k&#39;</span><span class="p">,</span>
                     <span class="s">&quot;keep the pseudo-installation tree around after &quot;</span> <span class="o">+</span>
                     <span class="s">&quot;creating the distribution archive&quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;target-version=&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
                     <span class="s">&quot;require a specific python version&quot;</span> <span class="o">+</span>
                     <span class="s">&quot; on the target system&quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;no-target-compile&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span>
                     <span class="s">&quot;do not compile .py to .pyc on the target system&quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;no-target-optimize&#39;</span><span class="p">,</span> <span class="s">&#39;o&#39;</span><span class="p">,</span>
                     <span class="s">&quot;do not compile .py to .pyo (optimized)&quot;</span>
                     <span class="s">&quot;on the target system&quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;dist-dir=&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">,</span>
                     <span class="s">&quot;directory to put final built distributions in&quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;bitmap=&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span>
                     <span class="s">&quot;bitmap to use for the installer instead of python-powered logo&quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;title=&#39;</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">,</span>
                     <span class="s">&quot;title to display on the installer background instead of default&quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;skip-build&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
                     <span class="s">&quot;skip rebuilding everything (for testing/debugging)&quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;install-script=&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
                     <span class="s">&quot;basename of installation script to be run after&quot;</span>
                     <span class="s">&quot;installation or before deinstallation&quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;pre-install-script=&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
                     <span class="s">&quot;Fully qualified filename of a script to be run before &quot;</span>
                     <span class="s">&quot;any files are installed.  This script need not be in the &quot;</span>
                     <span class="s">&quot;distribution&quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;user-access-control=&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
                     <span class="s">&quot;specify Vista&#39;s UAC handling - &#39;none&#39;/default=no &quot;</span>
                     <span class="s">&quot;handling, &#39;auto&#39;=use UAC if target Python installed for &quot;</span>
                     <span class="s">&quot;all users, &#39;force&#39;=always use UAC&quot;</span><span class="p">),</span>
                   <span class="p">]</span>

    <span class="n">boolean_options</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;keep-temp&#39;</span><span class="p">,</span> <span class="s">&#39;no-target-compile&#39;</span><span class="p">,</span> <span class="s">&#39;no-target-optimize&#39;</span><span class="p">,</span>
                       <span class="s">&#39;skip-build&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="bdist_wininst.initialize_options"><a class="viewcode-back" href="../../../distutils.command.html#distutils.command.bdist_wininst.bdist_wininst.initialize_options">[docs]</a>    <span class="k">def</span> <span class="nf">initialize_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bdist_dir</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plat_name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep_temp</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_target_compile</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_target_optimize</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_version</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_dir</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bitmap</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_build</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">install_script</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pre_install_script</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_access_control</span> <span class="o">=</span> <span class="bp">None</span>

</div>
<div class="viewcode-block" id="bdist_wininst.finalize_options"><a class="viewcode-back" href="../../../distutils.command.html#distutils.command.bdist_wininst.bdist_wininst.finalize_options">[docs]</a>    <span class="k">def</span> <span class="nf">finalize_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_undefined_options</span><span class="p">(</span><span class="s">&#39;bdist&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;skip_build&#39;</span><span class="p">,</span> <span class="s">&#39;skip_build&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bdist_dir</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_build</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">plat_name</span><span class="p">:</span>
                <span class="c"># If build is skipped and plat_name is overridden, bdist will</span>
                <span class="c"># not see the correct &#39;plat_name&#39; - so set that up manually.</span>
                <span class="n">bdist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">get_command_obj</span><span class="p">(</span><span class="s">&#39;bdist&#39;</span><span class="p">)</span>
                <span class="n">bdist</span><span class="o">.</span><span class="n">plat_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plat_name</span>
                <span class="c"># next the command will be initialized using that name</span>
            <span class="n">bdist_base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_finalized_command</span><span class="p">(</span><span class="s">&#39;bdist&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bdist_base</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bdist_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bdist_base</span><span class="p">,</span> <span class="s">&#39;wininst&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_version</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">target_version</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_build</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">has_ext_modules</span><span class="p">():</span>
            <span class="n">short_version</span> <span class="o">=</span> <span class="n">get_python_version</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_version</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_version</span> <span class="o">!=</span> <span class="n">short_version</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DistutilsOptionError</span><span class="p">(</span>
                      <span class="s">&quot;target version can only be </span><span class="si">%s</span><span class="s">, or the &#39;--skip-build&#39;&quot;</span> \
                      <span class="s">&quot; option must be specified&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">short_version</span><span class="p">,))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">target_version</span> <span class="o">=</span> <span class="n">short_version</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_undefined_options</span><span class="p">(</span><span class="s">&#39;bdist&#39;</span><span class="p">,</span>
                                   <span class="p">(</span><span class="s">&#39;dist_dir&#39;</span><span class="p">,</span> <span class="s">&#39;dist_dir&#39;</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s">&#39;plat_name&#39;</span><span class="p">,</span> <span class="s">&#39;plat_name&#39;</span><span class="p">),</span>
                                  <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">install_script</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">script</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">scripts</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">install_script</span> <span class="o">==</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">script</span><span class="p">):</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DistutilsOptionError</span><span class="p">(</span>
                      <span class="s">&quot;install_script &#39;</span><span class="si">%s</span><span class="s">&#39; not found in scripts&quot;</span>
                      <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">install_script</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="bdist_wininst.run"><a class="viewcode-back" href="../../../distutils.command.html#distutils.command.bdist_wininst.bdist_wininst.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">!=</span> <span class="s">&quot;win32&quot;</span> <span class="ow">and</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">has_ext_modules</span><span class="p">()</span> <span class="ow">or</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">has_c_libraries</span><span class="p">())):</span>
            <span class="k">raise</span> <span class="n">DistutilsPlatformError</span> \
                  <span class="p">(</span><span class="s">&quot;distribution contains extensions and/or C libraries; &quot;</span>
                   <span class="s">&quot;must be compiled on a Windows 32 platform&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_build</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="s">&#39;build&#39;</span><span class="p">)</span>

        <span class="n">install</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reinitialize_command</span><span class="p">(</span><span class="s">&#39;install&#39;</span><span class="p">,</span> <span class="n">reinit_subcommands</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">install</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bdist_dir</span>
        <span class="n">install</span><span class="o">.</span><span class="n">skip_build</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_build</span>
        <span class="n">install</span><span class="o">.</span><span class="n">warn_dir</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">install</span><span class="o">.</span><span class="n">plat_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plat_name</span>

        <span class="n">install_lib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reinitialize_command</span><span class="p">(</span><span class="s">&#39;install_lib&#39;</span><span class="p">)</span>
        <span class="c"># we do not want to include pyc or pyo files</span>
        <span class="n">install_lib</span><span class="o">.</span><span class="n">compile</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">install_lib</span><span class="o">.</span><span class="n">optimize</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">has_ext_modules</span><span class="p">():</span>
            <span class="c"># If we are building an installer for a Python version other</span>
            <span class="c"># than the one we are currently running, then we need to ensure</span>
            <span class="c"># our build_lib reflects the other Python version rather than ours.</span>
            <span class="c"># Note that for target_version!=sys.version, we must have skipped the</span>
            <span class="c"># build step, so there is no issue with enforcing the build of this</span>
            <span class="c"># version.</span>
            <span class="n">target_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_version</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">target_version</span><span class="p">:</span>
                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_build</span><span class="p">,</span> <span class="s">&quot;Should have already checked this&quot;</span>
                <span class="n">target_version</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">plat_specifier</span> <span class="o">=</span> <span class="s">&quot;.</span><span class="si">%s</span><span class="s">-</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plat_name</span><span class="p">,</span> <span class="n">target_version</span><span class="p">)</span>
            <span class="n">build</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_finalized_command</span><span class="p">(</span><span class="s">&#39;build&#39;</span><span class="p">)</span>
            <span class="n">build</span><span class="o">.</span><span class="n">build_lib</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">build</span><span class="o">.</span><span class="n">build_base</span><span class="p">,</span>
                                           <span class="s">&#39;lib&#39;</span> <span class="o">+</span> <span class="n">plat_specifier</span><span class="p">)</span>

        <span class="c"># Use a custom scheme for the zip-file, because we have to decide</span>
        <span class="c"># at installation time which scheme to use.</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;purelib&#39;</span><span class="p">,</span> <span class="s">&#39;platlib&#39;</span><span class="p">,</span> <span class="s">&#39;headers&#39;</span><span class="p">,</span> <span class="s">&#39;scripts&#39;</span><span class="p">,</span> <span class="s">&#39;data&#39;</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s">&#39;headers&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="s">&#39;/Include/$dist_name&#39;</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">install</span><span class="p">,</span>
                    <span class="s">&#39;install_&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="p">,</span>
                    <span class="n">value</span><span class="p">)</span>

        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;installing to </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bdist_dir</span><span class="p">)</span>
        <span class="n">install</span><span class="o">.</span><span class="n">ensure_finalized</span><span class="p">()</span>

        <span class="c"># avoid warning of &#39;install_lib&#39; about installing</span>
        <span class="c"># into a directory not in sys.path</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bdist_dir</span><span class="p">,</span> <span class="s">&#39;PURELIB&#39;</span><span class="p">))</span>

        <span class="n">install</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">del</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c"># And make an archive relative to the root of the</span>
        <span class="c"># pseudo-installation tree.</span>
        <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">mktemp</span>
        <span class="n">archive_basename</span> <span class="o">=</span> <span class="n">mktemp</span><span class="p">()</span>
        <span class="n">fullname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">get_fullname</span><span class="p">()</span>
        <span class="n">arcname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_archive</span><span class="p">(</span><span class="n">archive_basename</span><span class="p">,</span> <span class="s">&quot;zip&quot;</span><span class="p">,</span>
                                    <span class="n">root_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bdist_dir</span><span class="p">)</span>
        <span class="c"># create an exe containing the zip-file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_exe</span><span class="p">(</span><span class="n">arcname</span><span class="p">,</span> <span class="n">fullname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bitmap</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">has_ext_modules</span><span class="p">():</span>
            <span class="n">pyversion</span> <span class="o">=</span> <span class="n">get_python_version</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pyversion</span> <span class="o">=</span> <span class="s">&#39;any&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">dist_files</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&#39;bdist_wininst&#39;</span><span class="p">,</span> <span class="n">pyversion</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">get_installer_filename</span><span class="p">(</span><span class="n">fullname</span><span class="p">)))</span>
        <span class="c"># remove the zip-file again</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;removing temporary file &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span><span class="p">,</span> <span class="n">arcname</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">arcname</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_temp</span><span class="p">:</span>
            <span class="n">remove_tree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bdist_dir</span><span class="p">,</span> <span class="n">dry_run</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dry_run</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="bdist_wininst.get_inidata"><a class="viewcode-back" href="../../../distutils.command.html#distutils.command.bdist_wininst.bdist_wininst.get_inidata">[docs]</a>    <span class="k">def</span> <span class="nf">get_inidata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Return data describing the installation.</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">metadata</span>

        <span class="c"># Write the [metadata] section.</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;[metadata]&quot;</span><span class="p">)</span>

        <span class="c"># &#39;info&#39; will be displayed in the installer&#39;s dialog box,</span>
        <span class="c"># describing the items to be installed.</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">(</span><span class="n">metadata</span><span class="o">.</span><span class="n">long_description</span> <span class="ow">or</span> <span class="s">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

        <span class="c"># Escape newline characters</span>
        <span class="k">def</span> <span class="nf">escape</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">n&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;author&quot;</span><span class="p">,</span> <span class="s">&quot;author_email&quot;</span><span class="p">,</span> <span class="s">&quot;description&quot;</span><span class="p">,</span> <span class="s">&quot;maintainer&quot;</span><span class="p">,</span>
                     <span class="s">&quot;maintainer_email&quot;</span><span class="p">,</span> <span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="s">&quot;url&quot;</span><span class="p">,</span> <span class="s">&quot;version&quot;</span><span class="p">]:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">info</span> <span class="o">=</span> <span class="n">info</span> <span class="o">+</span> <span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">    </span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> \
                               <span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">(),</span> <span class="n">escape</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">escape</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>

        <span class="c"># The [setup] section contains entries controlling</span>
        <span class="c"># the installer runtime.</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">[Setup]&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">install_script</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;install_script=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">install_script</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;info=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">escape</span><span class="p">(</span><span class="n">info</span><span class="p">))</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;target_compile=</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_target_compile</span><span class="p">))</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;target_optimize=</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_target_optimize</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_version</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;target_version=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_version</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_access_control</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;user_access_control=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_access_control</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">get_fullname</span><span class="p">()</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;title=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">escape</span><span class="p">(</span><span class="n">title</span><span class="p">))</span>
        <span class="kn">import</span> <span class="nn">time</span>
        <span class="kn">import</span> <span class="nn">distutils</span>
        <span class="n">build_info</span> <span class="o">=</span> <span class="s">&quot;Built </span><span class="si">%s</span><span class="s"> with distutils-</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> \
                     <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()),</span> <span class="n">distutils</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;build_info=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">build_info</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="bdist_wininst.create_exe"><a class="viewcode-back" href="../../../distutils.command.html#distutils.command.bdist_wininst.bdist_wininst.create_exe">[docs]</a>    <span class="k">def</span> <span class="nf">create_exe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arcname</span><span class="p">,</span> <span class="n">fullname</span><span class="p">,</span> <span class="n">bitmap</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">struct</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mkpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_dir</span><span class="p">)</span>

        <span class="n">cfgdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_inidata</span><span class="p">()</span>

        <span class="n">installer_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_installer_filename</span><span class="p">(</span><span class="n">fullname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">announce</span><span class="p">(</span><span class="s">&quot;creating </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">installer_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bitmap</span><span class="p">:</span>
            <span class="n">bitmapdata</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">bitmap</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">bitmaplen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bitmapdata</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bitmaplen</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">installer_name</span><span class="p">,</span> <span class="s">&quot;wb&quot;</span><span class="p">)</span>
        <span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_exe_bytes</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">bitmap</span><span class="p">:</span>
            <span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bitmapdata</span><span class="p">)</span>

        <span class="c"># Convert cfgdata from unicode to ascii, mbcs encoded</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfgdata</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">cfgdata</span> <span class="o">=</span> <span class="n">cfgdata</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;mbcs&quot;</span><span class="p">)</span>

        <span class="c"># Append the pre-install script</span>
        <span class="n">cfgdata</span> <span class="o">=</span> <span class="n">cfgdata</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\0</span><span class="s">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_install_script</span><span class="p">:</span>
            <span class="c"># We need to normalize newlines, so we open in text mode and</span>
            <span class="c"># convert back to bytes. &quot;latin-1&quot; simply avoids any possible</span>
            <span class="c"># failures.</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pre_install_script</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">,</span>
                <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">script</span><span class="p">:</span>
                <span class="n">script_data</span> <span class="o">=</span> <span class="n">script</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;latin-1&quot;</span><span class="p">)</span>
            <span class="n">cfgdata</span> <span class="o">=</span> <span class="n">cfgdata</span> <span class="o">+</span> <span class="n">script_data</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\n\0</span><span class="s">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># empty pre-install script</span>
            <span class="n">cfgdata</span> <span class="o">=</span> <span class="n">cfgdata</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\0</span><span class="s">&quot;</span>
        <span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cfgdata</span><span class="p">)</span>

        <span class="c"># The &#39;magic number&#39; 0x1234567B is used to make sure that the</span>
        <span class="c"># binary layout of &#39;cfgdata&#39; is what the wininst.exe binary</span>
        <span class="c"># expects.  If the layout changes, increment that number, make</span>
        <span class="c"># the corresponding changes to the wininst.exe sources, and</span>
        <span class="c"># recompile them.</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;iii&quot;</span><span class="p">,</span>
                             <span class="mh">0x1234567B</span><span class="p">,</span>       <span class="c"># tag</span>
                             <span class="nb">len</span><span class="p">(</span><span class="n">cfgdata</span><span class="p">),</span>     <span class="c"># length</span>
                             <span class="n">bitmaplen</span><span class="p">,</span>        <span class="c"># number of bytes in bitmap</span>
                             <span class="p">)</span>
        <span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        <span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">arcname</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="bdist_wininst.get_installer_filename"><a class="viewcode-back" href="../../../distutils.command.html#distutils.command.bdist_wininst.bdist_wininst.get_installer_filename">[docs]</a>    <span class="k">def</span> <span class="nf">get_installer_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fullname</span><span class="p">):</span>
        <span class="c"># Factored out to allow overriding in subclasses</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_version</span><span class="p">:</span>
            <span class="c"># if we create an installer for a specific python version,</span>
            <span class="c"># it&#39;s better to include this in the name</span>
            <span class="n">installer_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_dir</span><span class="p">,</span>
                                          <span class="s">&quot;</span><span class="si">%s</span><span class="s">.</span><span class="si">%s</span><span class="s">-py</span><span class="si">%s</span><span class="s">.exe&quot;</span> <span class="o">%</span>
                                           <span class="p">(</span><span class="n">fullname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plat_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_version</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">installer_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_dir</span><span class="p">,</span>
                                          <span class="s">&quot;</span><span class="si">%s</span><span class="s">.</span><span class="si">%s</span><span class="s">.exe&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fullname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plat_name</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">installer_name</span>
</div>
<div class="viewcode-block" id="bdist_wininst.get_exe_bytes"><a class="viewcode-back" href="../../../distutils.command.html#distutils.command.bdist_wininst.bdist_wininst.get_exe_bytes">[docs]</a>    <span class="k">def</span> <span class="nf">get_exe_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">distutils.msvccompiler</span> <span class="kn">import</span> <span class="n">get_build_version</span>
        <span class="c"># If a target-version other than the current version has been</span>
        <span class="c"># specified, then using the MSVC version from *this* build is no good.</span>
        <span class="c"># Without actually finding and executing the target version and parsing</span>
        <span class="c"># its sys.version, we just hard-code our knowledge of old versions.</span>
        <span class="c"># NOTE: Possible alternative is to allow &quot;--target-version&quot; to</span>
        <span class="c"># specify a Python executable rather than a simple version string.</span>
        <span class="c"># We can then execute this program to obtain any info we need, such</span>
        <span class="c"># as the real sys.version string for the build.</span>
        <span class="n">cur_version</span> <span class="o">=</span> <span class="n">get_python_version</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_version</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_version</span> <span class="o">!=</span> <span class="n">cur_version</span><span class="p">:</span>
            <span class="c"># If the target version is *later* than us, then we assume they</span>
            <span class="c"># use what we use</span>
            <span class="c"># string compares seem wrong, but are what sysconfig.py itself uses</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_version</span> <span class="o">&gt;</span> <span class="n">cur_version</span><span class="p">:</span>
                <span class="n">bv</span> <span class="o">=</span> <span class="n">get_build_version</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_version</span> <span class="o">&lt;</span> <span class="s">&quot;2.4&quot;</span><span class="p">:</span>
                    <span class="n">bv</span> <span class="o">=</span> <span class="mf">6.0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bv</span> <span class="o">=</span> <span class="mf">7.1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># for current version - use authoritative check.</span>
            <span class="n">bv</span> <span class="o">=</span> <span class="n">get_build_version</span><span class="p">()</span>

        <span class="c"># wininst-x.y.exe is in the same directory as this file</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span>
        <span class="c"># we must use a wininst-x.y.exe built with the same C compiler</span>
        <span class="c"># used for python.  XXX What about mingw, borland, and so on?</span>

        <span class="c"># if plat_name starts with &quot;win&quot; but is not &quot;win32&quot;</span>
        <span class="c"># we want to strip &quot;win&quot; and leave the rest (e.g. -amd64)</span>
        <span class="c"># for all other cases, we don&#39;t want any suffix</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plat_name</span> <span class="o">!=</span> <span class="s">&#39;win32&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">plat_name</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;win&#39;</span><span class="p">:</span>
            <span class="n">sfix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plat_name</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sfix</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="s">&quot;wininst-</span><span class="si">%.1f%s</span><span class="s">.exe&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bv</span><span class="p">,</span> <span class="n">sfix</span><span class="p">))</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div></div>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>