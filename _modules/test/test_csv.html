

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_csv &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_csv</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_csv</h1><div class="highlight"><pre>
<span class="c"># Copyright (C) 2001,2002 Python Software Foundation</span>
<span class="c"># csv package unit tests</span>

<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryFile</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">gc</span>
<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">support</span>

<div class="viewcode-block" id="Test_Csv"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv">[docs]</a><span class="k">class</span> <span class="nc">Test_Csv</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test the underlying C csv parser in ways that are not appropriate</span>
<span class="sd">    from the high level interface. Further tests of this nature are done</span>
<span class="sd">    in TestDialectRegistry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_test_arg_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">ctor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">bad_attr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="s">&#39;XX&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">quotechar</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">lineterminator</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">lineterminator</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span>
                          <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">,</span> <span class="n">quotechar</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span>
                          <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">,</span> <span class="n">quotechar</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

<div class="viewcode-block" id="Test_Csv.test_reader_arg_valid"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_reader_arg_valid">[docs]</a>    <span class="k">def</span> <span class="nf">test_reader_arg_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_test_arg_valid</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">,</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="Test_Csv.test_writer_arg_valid"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_writer_arg_valid">[docs]</a>    <span class="k">def</span> <span class="nf">test_writer_arg_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_test_arg_valid</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">,</span> <span class="n">StringIO</span><span class="p">())</span>
</div>
    <span class="k">def</span> <span class="nf">_test_default_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">ctor</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="c"># Check defaults</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">doublequote</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">escapechar</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">lineterminator</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">quotechar</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">quoting</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_MINIMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">skipinitialspace</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">strict</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="c"># Try deleting or changing attributes (they are read-only)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">delattr</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="p">,</span> <span class="s">&#39;delimiter&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="p">,</span> <span class="s">&#39;delimiter&#39;</span><span class="p">,</span> <span class="s">&#39;:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">delattr</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="p">,</span> <span class="s">&#39;quoting&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="p">,</span>
                          <span class="s">&#39;quoting&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

<div class="viewcode-block" id="Test_Csv.test_reader_attrs"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_reader_attrs">[docs]</a>    <span class="k">def</span> <span class="nf">test_reader_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_test_default_attrs</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">,</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="Test_Csv.test_writer_attrs"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_writer_attrs">[docs]</a>    <span class="k">def</span> <span class="nf">test_writer_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_test_default_attrs</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">,</span> <span class="n">StringIO</span><span class="p">())</span>
</div>
    <span class="k">def</span> <span class="nf">_test_kw_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="c"># Now try with alternate options</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;:&#39;</span><span class="p">,</span> <span class="n">doublequote</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span>
                      <span class="n">lineterminator</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\r</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">quotechar</span><span class="o">=</span><span class="s">&#39;*&#39;</span><span class="p">,</span>
                      <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                      <span class="n">strict</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">ctor</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&#39;:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">doublequote</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">escapechar</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">lineterminator</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">quotechar</span><span class="p">,</span> <span class="s">&#39;*&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">quoting</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">skipinitialspace</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">strict</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>

<div class="viewcode-block" id="Test_Csv.test_reader_kw_attrs"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_reader_kw_attrs">[docs]</a>    <span class="k">def</span> <span class="nf">test_reader_kw_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_test_kw_attrs</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">,</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="Test_Csv.test_writer_kw_attrs"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_writer_kw_attrs">[docs]</a>    <span class="k">def</span> <span class="nf">test_writer_kw_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_test_kw_attrs</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">,</span> <span class="n">StringIO</span><span class="p">())</span>
</div>
    <span class="k">def</span> <span class="nf">_test_dialect_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctor</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="c"># Now try with dialect-derived options</span>
        <span class="k">class</span> <span class="nc">dialect</span><span class="p">:</span>
            <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;-&#39;</span>
            <span class="n">doublequote</span><span class="o">=</span><span class="bp">False</span>
            <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;^&#39;</span>
            <span class="n">lineterminator</span><span class="o">=</span><span class="s">&#39;$&#39;</span>
            <span class="n">quotechar</span><span class="o">=</span><span class="s">&#39;#&#39;</span>
            <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span>
            <span class="n">skipinitialspace</span><span class="o">=</span><span class="bp">True</span>
            <span class="n">strict</span><span class="o">=</span><span class="bp">False</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">args</span> <span class="o">+</span> <span class="p">(</span><span class="n">dialect</span><span class="p">,)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">ctor</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&#39;-&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">doublequote</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">escapechar</span><span class="p">,</span> <span class="s">&#39;^&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">lineterminator</span><span class="p">,</span> <span class="s">&quot;$&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">quotechar</span><span class="p">,</span> <span class="s">&#39;#&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">quoting</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">skipinitialspace</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">strict</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

<div class="viewcode-block" id="Test_Csv.test_reader_dialect_attrs"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_reader_dialect_attrs">[docs]</a>    <span class="k">def</span> <span class="nf">test_reader_dialect_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_test_dialect_attrs</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">,</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="Test_Csv.test_writer_dialect_attrs"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_writer_dialect_attrs">[docs]</a>    <span class="k">def</span> <span class="nf">test_writer_dialect_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_test_dialect_attrs</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">,</span> <span class="n">StringIO</span><span class="p">())</span>

</div>
    <span class="k">def</span> <span class="nf">_write_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">expect</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
                             <span class="n">expect</span> <span class="o">+</span> <span class="n">writer</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">lineterminator</span><span class="p">)</span>

<div class="viewcode-block" id="Test_Csv.test_write_arg_valid"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_write_arg_valid">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_arg_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">((),</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">([</span><span class="bp">None</span><span class="p">],</span> <span class="s">&#39;&quot;&quot;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">,</span>
                          <span class="p">[</span><span class="bp">None</span><span class="p">],</span> <span class="bp">None</span><span class="p">,</span> <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span><span class="p">)</span>
        <span class="c"># Check that exceptions are passed up the chain</span>
        <span class="k">class</span> <span class="nc">BadList</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">10</span><span class="p">;</span>
            <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">OSError</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">,</span> <span class="n">BadList</span><span class="p">(),</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">BadItem</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">OSError</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">,</span> <span class="p">[</span><span class="n">BadItem</span><span class="p">()],</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Test_Csv.test_write_bigfield"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_write_bigfield">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_bigfield</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># This exercises the buffer realloc functionality</span>
        <span class="n">bigstring</span> <span class="o">=</span> <span class="s">&#39;X&#39;</span> <span class="o">*</span> <span class="mi">50000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">([</span><span class="n">bigstring</span><span class="p">,</span><span class="n">bigstring</span><span class="p">],</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> \
                         <span class="p">(</span><span class="n">bigstring</span><span class="p">,</span> <span class="n">bigstring</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Test_Csv.test_write_quoting"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_write_quoting">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_quoting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">([</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;p,q&#39;</span><span class="p">],</span> <span class="s">&#39;a,1,&quot;p,q&quot;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">,</span>
                          <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;p,q&#39;</span><span class="p">],</span> <span class="s">&#39;a,1,p,q&#39;</span><span class="p">,</span>
                          <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">([</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;p,q&#39;</span><span class="p">],</span> <span class="s">&#39;a,1,&quot;p,q&quot;&#39;</span><span class="p">,</span>
                         <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_MINIMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">([</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;p,q&#39;</span><span class="p">],</span> <span class="s">&#39;&quot;a&quot;,1,&quot;p,q&quot;&#39;</span><span class="p">,</span>
                         <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONNUMERIC</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">([</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;p,q&#39;</span><span class="p">],</span> <span class="s">&#39;&quot;a&quot;,&quot;1&quot;,&quot;p,q&quot;&#39;</span><span class="p">,</span>
                         <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">([</span><span class="s">&#39;a</span><span class="se">\n</span><span class="s">b&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;&quot;a</span><span class="se">\n</span><span class="s">b&quot;,&quot;1&quot;&#39;</span><span class="p">,</span>
                         <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Test_Csv.test_write_escape"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_write_escape">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_escape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">([</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;p,q&#39;</span><span class="p">],</span> <span class="s">&#39;a,1,&quot;p,q&quot;&#39;</span><span class="p">,</span>
                         <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">,</span>
                          <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;p,&quot;q&quot;&#39;</span><span class="p">],</span> <span class="s">&#39;a,1,&quot;p,</span><span class="se">\\</span><span class="s">&quot;q</span><span class="se">\\</span><span class="s">&quot;&quot;&#39;</span><span class="p">,</span>
                          <span class="n">escapechar</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">doublequote</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">([</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;p,&quot;q&quot;&#39;</span><span class="p">],</span> <span class="s">&#39;a,1,&quot;p,</span><span class="se">\\</span><span class="s">&quot;q</span><span class="se">\\</span><span class="s">&quot;&quot;&#39;</span><span class="p">,</span>
                         <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">doublequote</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">([</span><span class="s">&#39;&quot;&#39;</span><span class="p">],</span> <span class="s">&#39;&quot;&quot;&quot;&quot;&#39;</span><span class="p">,</span>
                         <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_MINIMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">([</span><span class="s">&#39;&quot;&#39;</span><span class="p">],</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">&quot;&#39;</span><span class="p">,</span>
                         <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_MINIMAL</span><span class="p">,</span>
                         <span class="n">doublequote</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">([</span><span class="s">&#39;&quot;&#39;</span><span class="p">],</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">&quot;&#39;</span><span class="p">,</span>
                         <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_test</span><span class="p">([</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;p,q&#39;</span><span class="p">],</span> <span class="s">&#39;a,1,p</span><span class="se">\\</span><span class="s">,q&#39;</span><span class="p">,</span>
                         <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Test_Csv.test_writerows"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_writerows">[docs]</a>    <span class="k">def</span> <span class="nf">test_writerows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">BrokenFile</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buf</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">OSError</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">BrokenFile</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">]])</span>

        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fileobj</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">([[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">],[</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">]])</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="s">&quot;a,b</span><span class="se">\r\n</span><span class="s">c,d</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
</div>
    <span class="nd">@support.cpython_only</span>
<div class="viewcode-block" id="Test_Csv.test_writerows_legacy_strings"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_writerows_legacy_strings">[docs]</a>    <span class="k">def</span> <span class="nf">test_writerows_legacy_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">_testcapi</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">_testcapi</span><span class="o">.</span><span class="n">unicode_legacy_string</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fileobj</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">([[</span><span class="n">c</span><span class="p">]])</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="s">&quot;a</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_read_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">expect</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expect</span><span class="p">)</span>

<div class="viewcode-block" id="Test_Csv.test_read_oddinputs"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_read_oddinputs">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_oddinputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([],</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;&#39;</span><span class="p">],</span> <span class="p">[[]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">,</span>
                          <span class="p">[</span><span class="s">&#39;&quot;ab&quot;c&#39;</span><span class="p">],</span> <span class="bp">None</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c"># cannot handle null bytes for the moment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">,</span>
                          <span class="p">[</span><span class="s">&#39;ab</span><span class="se">\0</span><span class="s">c&#39;</span><span class="p">],</span> <span class="bp">None</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;&quot;ab&quot;c&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;abc&#39;</span><span class="p">]],</span> <span class="n">doublequote</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">,</span>
                          <span class="p">[</span><span class="n">b</span><span class="s">&#39;ab</span><span class="se">\0</span><span class="s">c&#39;</span><span class="p">],</span> <span class="bp">None</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Test_Csv.test_read_eol"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_read_eol">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_eol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;a,b&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;a,b</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;a,b</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;a,b</span><span class="se">\r</span><span class="s">&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;a,b</span><span class="se">\r</span><span class="s">c,d&#39;</span><span class="p">],</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;a,b</span><span class="se">\n</span><span class="s">c,d&#39;</span><span class="p">],</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;a,b</span><span class="se">\r\n</span><span class="s">c,d&#39;</span><span class="p">],</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="Test_Csv.test_read_eof"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_read_eof">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_eof</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;a,&quot;&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;&quot;a&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;^&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">]],</span> <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;^&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;a,&quot;&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="n">strict</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;&quot;a&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="n">strict</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">,</span>
                          <span class="p">[</span><span class="s">&#39;^&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;^&#39;</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Test_Csv.test_read_escape"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_read_escape">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_escape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;a,</span><span class="se">\\</span><span class="s">b,c&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">]],</span> <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;a,b</span><span class="se">\\</span><span class="s">,c&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b,c&#39;</span><span class="p">]],</span> <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;a,&quot;b</span><span class="se">\\</span><span class="s">,c&quot;&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b,c&#39;</span><span class="p">]],</span> <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;a,&quot;b,</span><span class="se">\\</span><span class="s">c&quot;&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b,c&#39;</span><span class="p">]],</span> <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;a,&quot;b,c</span><span class="se">\\</span><span class="s">&quot;&quot;&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b,c&quot;&#39;</span><span class="p">]],</span> <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;a,&quot;b,c&quot;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b,c</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">]],</span> <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Test_Csv.test_read_quoting"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_read_quoting">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_quoting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;1,&quot;,3,&quot;,5&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;,3,&#39;</span><span class="p">,</span> <span class="s">&#39;5&#39;</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;1,&quot;,3,&quot;,5&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s">&#39;5&#39;</span><span class="p">]],</span>
                        <span class="n">quotechar</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;1,&quot;,3,&quot;,5&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s">&#39;5&#39;</span><span class="p">]],</span>
                        <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span><span class="p">,</span> <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="c"># will this fail where locale uses comma for decimals?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;,3,&quot;5&quot;,7.3, 9&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;5&#39;</span><span class="p">,</span> <span class="mf">7.3</span><span class="p">,</span> <span class="mi">9</span><span class="p">]],</span>
                        <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONNUMERIC</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="s">&#39;&quot;a</span><span class="se">\n</span><span class="s">b&quot;, 7&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s">&#39;a</span><span class="se">\n</span><span class="s">b&#39;</span><span class="p">,</span> <span class="s">&#39; 7&#39;</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">,</span>
                          <span class="p">[</span><span class="s">&#39;abc,3&#39;</span><span class="p">],</span> <span class="p">[[]],</span>
                          <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONNUMERIC</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Test_Csv.test_read_bigfield"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_read_bigfield">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_bigfield</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># This exercises the buffer realloc functionality and field size</span>
        <span class="c"># limits.</span>
        <span class="n">limit</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">field_size_limit</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="mi">50000</span>
            <span class="n">bigstring</span> <span class="o">=</span> <span class="s">&#39;X&#39;</span> <span class="o">*</span> <span class="n">size</span>
            <span class="n">bigline</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bigstring</span><span class="p">,</span> <span class="n">bigstring</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="n">bigline</span><span class="p">],</span> <span class="p">[[</span><span class="n">bigstring</span><span class="p">,</span> <span class="n">bigstring</span><span class="p">]])</span>
            <span class="n">csv</span><span class="o">.</span><span class="n">field_size_limit</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">([</span><span class="n">bigline</span><span class="p">],</span> <span class="p">[[</span><span class="n">bigstring</span><span class="p">,</span> <span class="n">bigstring</span><span class="p">]])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">field_size_limit</span><span class="p">(),</span> <span class="n">size</span><span class="p">)</span>
            <span class="n">csv</span><span class="o">.</span><span class="n">field_size_limit</span><span class="p">(</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_test</span><span class="p">,</span> <span class="p">[</span><span class="n">bigline</span><span class="p">],</span> <span class="p">[])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">field_size_limit</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">field_size_limit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">csv</span><span class="o">.</span><span class="n">field_size_limit</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Test_Csv.test_read_linenum"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_read_linenum">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_linenum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">([</span><span class="s">&#39;line,1&#39;</span><span class="p">,</span> <span class="s">&#39;line,2&#39;</span><span class="p">,</span> <span class="s">&#39;line,3&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">line_num</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nb">next</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">line_num</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="nb">next</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">line_num</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nb">next</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">line_num</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">StopIteration</span><span class="p">,</span> <span class="nb">next</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">line_num</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Test_Csv.test_roundtrip_quoteed_newlines"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_roundtrip_quoteed_newlines">[docs]</a>    <span class="k">def</span> <span class="nf">test_roundtrip_quoteed_newlines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fileobj</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="p">[[</span><span class="s">&#39;a</span><span class="se">\n</span><span class="s">b&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">],[</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="s">&#39;x</span><span class="se">\r\n</span><span class="s">d&#39;</span><span class="p">]]</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">fileobj</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="Test_Csv.test_roundtrip_escaped_unquoted_newlines"><a class="viewcode-back" href="../../test.html#test.test_csv.Test_Csv.test_roundtrip_escaped_unquoted_newlines">[docs]</a>    <span class="k">def</span> <span class="nf">test_roundtrip_escaped_unquoted_newlines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span><span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span><span class="p">,</span><span class="n">escapechar</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="p">[[</span><span class="s">&#39;a</span><span class="se">\n</span><span class="s">b&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">],[</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="s">&#39;x</span><span class="se">\r\n</span><span class="s">d&#39;</span><span class="p">]]</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span><span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span><span class="p">,</span><span class="n">escapechar</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</div></div>
<div class="viewcode-block" id="TestDialectRegistry"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectRegistry">[docs]</a><span class="k">class</span> <span class="nc">TestDialectRegistry</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="TestDialectRegistry.test_registry_badargs"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectRegistry.test_registry_badargs">[docs]</a>    <span class="k">def</span> <span class="nf">test_registry_badargs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">list_dialects</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">get_dialect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">get_dialect</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">get_dialect</span><span class="p">,</span> <span class="s">&quot;nonesuch&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">unregister_dialect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">unregister_dialect</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">unregister_dialect</span><span class="p">,</span> <span class="s">&quot;nonesuch&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">register_dialect</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">register_dialect</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">register_dialect</span><span class="p">,</span> <span class="s">&quot;nonesuch&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">register_dialect</span><span class="p">,</span> <span class="s">&quot;nonesuch&quot;</span><span class="p">,</span>
                          <span class="n">badargument</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">register_dialect</span><span class="p">,</span> <span class="s">&quot;nonesuch&quot;</span><span class="p">,</span>
                          <span class="n">quoting</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">register_dialect</span><span class="p">,</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestDialectRegistry.test_registry"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectRegistry.test_registry">[docs]</a>    <span class="k">def</span> <span class="nf">test_registry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">myexceltsv</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">excel</span><span class="p">):</span>
            <span class="n">delimiter</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;myexceltsv&quot;</span>
        <span class="n">expected_dialects</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">list_dialects</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">expected_dialects</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">csv</span><span class="o">.</span><span class="n">register_dialect</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">myexceltsv</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addCleanup</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">unregister_dialect</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">get_dialect</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">got_dialects</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">list_dialects</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expected_dialects</span><span class="p">,</span> <span class="n">got_dialects</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDialectRegistry.test_register_kwargs"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectRegistry.test_register_kwargs">[docs]</a>    <span class="k">def</span> <span class="nf">test_register_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;fedcba&#39;</span>
        <span class="n">csv</span><span class="o">.</span><span class="n">register_dialect</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addCleanup</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">unregister_dialect</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">get_dialect</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&#39;;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([[</span><span class="s">&#39;X&#39;</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">,</span> <span class="s">&#39;Z&#39;</span><span class="p">]],</span> <span class="nb">list</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">([</span><span class="s">&#39;X;Y;Z&#39;</span><span class="p">],</span> <span class="n">name</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="TestDialectRegistry.test_incomplete_dialect"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectRegistry.test_incomplete_dialect">[docs]</a>    <span class="k">def</span> <span class="nf">test_incomplete_dialect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">myexceltsv</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Dialect</span><span class="p">):</span>
            <span class="n">delimiter</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="n">myexceltsv</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDialectRegistry.test_space_dialect"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectRegistry.test_space_dialect">[docs]</a>    <span class="k">def</span> <span class="nf">test_space_dialect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">space</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">excel</span><span class="p">):</span>
            <span class="n">delimiter</span> <span class="o">=</span> <span class="s">&quot; &quot;</span>
            <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span>
            <span class="n">escapechar</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span>

        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;abc def</span><span class="se">\n</span><span class="s">c1ccccc1 benzene</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="n">space</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">),</span> <span class="p">[</span><span class="s">&quot;abc&quot;</span><span class="p">,</span> <span class="s">&quot;def&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">),</span> <span class="p">[</span><span class="s">&quot;c1ccccc1&quot;</span><span class="p">,</span> <span class="s">&quot;benzene&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestDialectRegistry.compare_dialect_123"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectRegistry.compare_dialect_123">[docs]</a>    <span class="k">def</span> <span class="nf">compare_dialect_123</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span> <span class="o">*</span><span class="n">writeargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwwriteargs</span><span class="p">):</span>

        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>

            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="o">*</span><span class="n">writeargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwwriteargs</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDialectRegistry.test_dialect_apply"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectRegistry.test_dialect_apply">[docs]</a>    <span class="k">def</span> <span class="nf">test_dialect_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">testA</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">excel</span><span class="p">):</span>
            <span class="n">delimiter</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span>
        <span class="k">class</span> <span class="nc">testB</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">excel</span><span class="p">):</span>
            <span class="n">delimiter</span> <span class="o">=</span> <span class="s">&quot;:&quot;</span>
        <span class="k">class</span> <span class="nc">testC</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">excel</span><span class="p">):</span>
            <span class="n">delimiter</span> <span class="o">=</span> <span class="s">&quot;|&quot;</span>
        <span class="k">class</span> <span class="nc">testUni</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">excel</span><span class="p">):</span>
            <span class="n">delimiter</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\u039B</span><span class="s">&quot;</span>

        <span class="n">csv</span><span class="o">.</span><span class="n">register_dialect</span><span class="p">(</span><span class="s">&#39;testC&#39;</span><span class="p">,</span> <span class="n">testC</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compare_dialect_123</span><span class="p">(</span><span class="s">&quot;1,2,3</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compare_dialect_123</span><span class="p">(</span><span class="s">&quot;1</span><span class="se">\t</span><span class="s">2</span><span class="se">\t</span><span class="s">3</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">testA</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compare_dialect_123</span><span class="p">(</span><span class="s">&quot;1:2:3</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="n">testB</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compare_dialect_123</span><span class="p">(</span><span class="s">&quot;1|2|3</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="s">&#39;testC&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compare_dialect_123</span><span class="p">(</span><span class="s">&quot;1;2;3</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="n">testA</span><span class="p">,</span>
                                     <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compare_dialect_123</span><span class="p">(</span><span class="s">&quot;1</span><span class="se">\u039B</span><span class="s">2</span><span class="se">\u039B</span><span class="s">3</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">,</span>
                                     <span class="n">dialect</span><span class="o">=</span><span class="n">testUni</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="n">csv</span><span class="o">.</span><span class="n">unregister_dialect</span><span class="p">(</span><span class="s">&#39;testC&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDialectRegistry.test_bad_dialect"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectRegistry.test_bad_dialect">[docs]</a>    <span class="k">def</span> <span class="nf">test_bad_dialect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Unknown parameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">,</span> <span class="p">[],</span> <span class="n">bad_attr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c"># Bad values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">,</span> <span class="p">[],</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">,</span> <span class="p">[],</span> <span class="n">quoting</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">,</span> <span class="p">[],</span> <span class="n">quoting</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="TestCsvBase"><a class="viewcode-back" href="../../test.html#test.test_csv.TestCsvBase">[docs]</a><span class="k">class</span> <span class="nc">TestCsvBase</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="TestCsvBase.readerAssertEqual"><a class="viewcode-back" href="../../test.html#test.test_csv.TestCsvBase.readerAssertEqual">[docs]</a>    <span class="k">def</span> <span class="nf">readerAssertEqual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">dialect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialect</span><span class="p">)</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCsvBase.writerAssertEqual"><a class="viewcode-back" href="../../test.html#test.test_csv.TestCsvBase.writerAssertEqual">[docs]</a>    <span class="k">def</span> <span class="nf">writerAssertEqual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">dialect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialect</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">expected_result</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="TestDialectExcel"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel">[docs]</a><span class="k">class</span> <span class="nc">TestDialectExcel</span><span class="p">(</span><span class="n">TestCsvBase</span><span class="p">):</span>
    <span class="n">dialect</span> <span class="o">=</span> <span class="s">&#39;excel&#39;</span>

<div class="viewcode-block" id="TestDialectExcel.test_single"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_single">[docs]</a>    <span class="k">def</span> <span class="nf">test_single</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;abc&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_simple"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_simple">[docs]</a>    <span class="k">def</span> <span class="nf">test_simple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;1,2,3,4,5&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;1&#39;</span><span class="p">,</span><span class="s">&#39;2&#39;</span><span class="p">,</span><span class="s">&#39;3&#39;</span><span class="p">,</span><span class="s">&#39;4&#39;</span><span class="p">,</span><span class="s">&#39;5&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_blankline"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_blankline">[docs]</a>    <span class="k">def</span> <span class="nf">test_blankline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_empty_fields"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_empty_fields">[docs]</a>    <span class="k">def</span> <span class="nf">test_empty_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_singlequoted"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_singlequoted">[docs]</a>    <span class="k">def</span> <span class="nf">test_singlequoted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;&quot;&quot;&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_singlequoted_left_empty"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_singlequoted_left_empty">[docs]</a>    <span class="k">def</span> <span class="nf">test_singlequoted_left_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;&quot;&quot;,&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_singlequoted_right_empty"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_singlequoted_right_empty">[docs]</a>    <span class="k">def</span> <span class="nf">test_singlequoted_right_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;,&quot;&quot;&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_single_quoted_quote"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_single_quoted_quote">[docs]</a>    <span class="k">def</span> <span class="nf">test_single_quoted_quote</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;&quot;&quot;&quot;&quot;&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;&quot;&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_quoted_quotes"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_quoted_quotes">[docs]</a>    <span class="k">def</span> <span class="nf">test_quoted_quotes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;&quot;&quot;&quot;&quot;&quot;&quot;&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;&quot;&quot;&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_inline_quote"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_inline_quote">[docs]</a>    <span class="k">def</span> <span class="nf">test_inline_quote</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;a&quot;&quot;b&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;a&quot;&quot;b&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_inline_quotes"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_inline_quotes">[docs]</a>    <span class="k">def</span> <span class="nf">test_inline_quotes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;a&quot;b&quot;c&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;a&quot;b&quot;c&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_quotes_and_more"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_quotes_and_more">[docs]</a>    <span class="k">def</span> <span class="nf">test_quotes_and_more</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Excel would never write a field containing &#39;&quot;a&quot;b&#39;, but when</span>
        <span class="c"># reading one, it will return &#39;ab&#39;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;&quot;a&quot;b&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;ab&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_lone_quote"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_lone_quote">[docs]</a>    <span class="k">def</span> <span class="nf">test_lone_quote</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;a&quot;b&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;a&quot;b&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_quote_and_quote"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_quote_and_quote">[docs]</a>    <span class="k">def</span> <span class="nf">test_quote_and_quote</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Excel would never write a field containing &#39;&quot;a&quot; &quot;b&quot;&#39;, but when</span>
        <span class="c"># reading one, it will return &#39;a &quot;b&quot;&#39;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;&quot;a&quot; &quot;b&quot;&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;a &quot;b&quot;&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_space_and_quote"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_space_and_quote">[docs]</a>    <span class="k">def</span> <span class="nf">test_space_and_quote</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39; &quot;a&quot;&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39; &quot;a&quot;&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_quoted"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_quoted">[docs]</a>    <span class="k">def</span> <span class="nf">test_quoted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;1,2,3,&quot;I think, therefore I am&quot;,5,6&#39;</span><span class="p">,</span>
                               <span class="p">[[</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;I think, therefore I am&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;5&#39;</span><span class="p">,</span> <span class="s">&#39;6&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_quoted_quote"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_quoted_quote">[docs]</a>    <span class="k">def</span> <span class="nf">test_quoted_quote</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;1,2,3,&quot;&quot;&quot;I see,&quot;&quot; said the blind man&quot;,&quot;as he picked up his hammer and saw&quot;&#39;</span><span class="p">,</span>
                               <span class="p">[[</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;&quot;I see,&quot; said the blind man&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;as he picked up his hammer and saw&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_quoted_nl"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_quoted_nl">[docs]</a>    <span class="k">def</span> <span class="nf">test_quoted_nl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">input</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;</span><span class="se">\</span>
<span class="s">1,2,3,&quot;&quot;&quot;I see,&quot;&quot;</span>
<span class="s">said the blind man&quot;,&quot;as he picked up his</span>
<span class="s">hammer and saw&quot;</span>
<span class="s">9,8,7,6&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span>
                               <span class="p">[[</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">,</span>
                                   <span class="s">&#39;&quot;I see,&quot;</span><span class="se">\n</span><span class="s">said the blind man&#39;</span><span class="p">,</span>
                                   <span class="s">&#39;as he picked up his</span><span class="se">\n</span><span class="s">hammer and saw&#39;</span><span class="p">],</span>
                                <span class="p">[</span><span class="s">&#39;9&#39;</span><span class="p">,</span><span class="s">&#39;8&#39;</span><span class="p">,</span><span class="s">&#39;7&#39;</span><span class="p">,</span><span class="s">&#39;6&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_dubious_quote"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_dubious_quote">[docs]</a>    <span class="k">def</span> <span class="nf">test_dubious_quote</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;12,12,1&quot;,&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;12&#39;</span><span class="p">,</span> <span class="s">&#39;12&#39;</span><span class="p">,</span> <span class="s">&#39;1&quot;&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_null"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_null">[docs]</a>    <span class="k">def</span> <span class="nf">test_null</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writerAssertEqual</span><span class="p">([],</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_single_writer"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_single_writer">[docs]</a>    <span class="k">def</span> <span class="nf">test_single_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writerAssertEqual</span><span class="p">([[</span><span class="s">&#39;abc&#39;</span><span class="p">]],</span> <span class="s">&#39;abc</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_simple_writer"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_simple_writer">[docs]</a>    <span class="k">def</span> <span class="nf">test_simple_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writerAssertEqual</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="s">&#39;1,2,abc,3,4</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_quotes"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_quotes">[docs]</a>    <span class="k">def</span> <span class="nf">test_quotes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writerAssertEqual</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;a&quot;bc&quot;&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="s">&#39;1,2,&quot;a&quot;&quot;bc&quot;&quot;&quot;,3,4</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_quote_fieldsep"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_quote_fieldsep">[docs]</a>    <span class="k">def</span> <span class="nf">test_quote_fieldsep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writerAssertEqual</span><span class="p">([[</span><span class="s">&#39;abc,def&#39;</span><span class="p">]],</span> <span class="s">&#39;&quot;abc,def&quot;</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDialectExcel.test_newlines"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectExcel.test_newlines">[docs]</a>    <span class="k">def</span> <span class="nf">test_newlines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writerAssertEqual</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;a</span><span class="se">\n</span><span class="s">bc&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="s">&#39;1,2,&quot;a</span><span class="se">\n</span><span class="s">bc&quot;,3,4</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="EscapedExcel"><a class="viewcode-back" href="../../test.html#test.test_csv.EscapedExcel">[docs]</a><span class="k">class</span> <span class="nc">EscapedExcel</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">excel</span><span class="p">):</span>
    <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span>
    <span class="n">escapechar</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span>
</div>
<div class="viewcode-block" id="TestEscapedExcel"><a class="viewcode-back" href="../../test.html#test.test_csv.TestEscapedExcel">[docs]</a><span class="k">class</span> <span class="nc">TestEscapedExcel</span><span class="p">(</span><span class="n">TestCsvBase</span><span class="p">):</span>
    <span class="n">dialect</span> <span class="o">=</span> <span class="n">EscapedExcel</span><span class="p">()</span>

<div class="viewcode-block" id="TestEscapedExcel.test_escape_fieldsep"><a class="viewcode-back" href="../../test.html#test.test_csv.TestEscapedExcel.test_escape_fieldsep">[docs]</a>    <span class="k">def</span> <span class="nf">test_escape_fieldsep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writerAssertEqual</span><span class="p">([[</span><span class="s">&#39;abc,def&#39;</span><span class="p">]],</span> <span class="s">&#39;abc</span><span class="se">\\</span><span class="s">,def</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestEscapedExcel.test_read_escape_fieldsep"><a class="viewcode-back" href="../../test.html#test.test_csv.TestEscapedExcel.test_read_escape_fieldsep">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_escape_fieldsep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;abc</span><span class="se">\\</span><span class="s">,def</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;abc,def&#39;</span><span class="p">]])</span>
</div></div>
<div class="viewcode-block" id="TestDialectUnix"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectUnix">[docs]</a><span class="k">class</span> <span class="nc">TestDialectUnix</span><span class="p">(</span><span class="n">TestCsvBase</span><span class="p">):</span>
    <span class="n">dialect</span> <span class="o">=</span> <span class="s">&#39;unix&#39;</span>

<div class="viewcode-block" id="TestDialectUnix.test_simple_writer"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectUnix.test_simple_writer">[docs]</a>    <span class="k">def</span> <span class="nf">test_simple_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writerAssertEqual</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;abc def&#39;</span><span class="p">,</span> <span class="s">&#39;abc&#39;</span><span class="p">]],</span> <span class="s">&#39;&quot;1&quot;,&quot;abc def&quot;,&quot;abc&quot;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDialectUnix.test_simple_reader"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectUnix.test_simple_reader">[docs]</a>    <span class="k">def</span> <span class="nf">test_simple_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;&quot;1&quot;,&quot;abc def&quot;,&quot;abc&quot;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;abc def&#39;</span><span class="p">,</span> <span class="s">&#39;abc&#39;</span><span class="p">]])</span>
</div></div>
<div class="viewcode-block" id="QuotedEscapedExcel"><a class="viewcode-back" href="../../test.html#test.test_csv.QuotedEscapedExcel">[docs]</a><span class="k">class</span> <span class="nc">QuotedEscapedExcel</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">excel</span><span class="p">):</span>
    <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONNUMERIC</span>
    <span class="n">escapechar</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span>
</div>
<div class="viewcode-block" id="TestQuotedEscapedExcel"><a class="viewcode-back" href="../../test.html#test.test_csv.TestQuotedEscapedExcel">[docs]</a><span class="k">class</span> <span class="nc">TestQuotedEscapedExcel</span><span class="p">(</span><span class="n">TestCsvBase</span><span class="p">):</span>
    <span class="n">dialect</span> <span class="o">=</span> <span class="n">QuotedEscapedExcel</span><span class="p">()</span>

<div class="viewcode-block" id="TestQuotedEscapedExcel.test_write_escape_fieldsep"><a class="viewcode-back" href="../../test.html#test.test_csv.TestQuotedEscapedExcel.test_write_escape_fieldsep">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_escape_fieldsep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writerAssertEqual</span><span class="p">([[</span><span class="s">&#39;abc,def&#39;</span><span class="p">]],</span> <span class="s">&#39;&quot;abc,def&quot;</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestQuotedEscapedExcel.test_read_escape_fieldsep"><a class="viewcode-back" href="../../test.html#test.test_csv.TestQuotedEscapedExcel.test_read_escape_fieldsep">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_escape_fieldsep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readerAssertEqual</span><span class="p">(</span><span class="s">&#39;&quot;abc</span><span class="se">\\</span><span class="s">,def&quot;</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s">&#39;abc,def&#39;</span><span class="p">]])</span>
</div></div>
<div class="viewcode-block" id="TestDictFields"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDictFields">[docs]</a><span class="k">class</span> <span class="nc">TestDictFields</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="c">### &quot;long&quot; means the row is longer than the number of fieldnames</span>
    <span class="c">### &quot;short&quot; means there are fewer elements in the row than fieldnames</span>
<div class="viewcode-block" id="TestDictFields.test_write_simple_dict"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDictFields.test_write_simple_dict">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_simple_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictWriter</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">fieldnames</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;f1&quot;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">,</span> <span class="s">&quot;f3&quot;</span><span class="p">])</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writeheader</span><span class="p">()</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">readline</span><span class="p">(),</span> <span class="s">&quot;f1,f2,f3</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">({</span><span class="s">&quot;f1&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;f3&quot;</span><span class="p">:</span> <span class="s">&quot;abc&quot;</span><span class="p">})</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span> <span class="c"># header</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="s">&quot;10,,abc</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDictFields.test_write_no_fields"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDictFields.test_write_no_fields">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_no_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fileobj</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictWriter</span><span class="p">,</span> <span class="n">fileobj</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDictFields.test_write_fields_not_in_fieldnames"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDictFields.test_write_fields_not_in_fieldnames">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_fields_not_in_fieldnames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictWriter</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">fieldnames</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;f1&quot;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">,</span> <span class="s">&quot;f3&quot;</span><span class="p">])</span>
            <span class="c"># Of special note is the non-string key (issue 19449)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cx</span><span class="p">:</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">({</span><span class="s">&quot;f4&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">:</span> <span class="s">&quot;spam&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s">&quot;abc&quot;</span><span class="p">})</span>
            <span class="n">exception</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cx</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;fieldnames&quot;</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;&#39;f4&#39;&quot;</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="s">&quot;&#39;f2&#39;&quot;</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDictFields.test_read_dict_fields"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDictFields.test_read_dict_fields">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_dict_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;1,2,abc</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span>
                                    <span class="n">fieldnames</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;f1&quot;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">,</span> <span class="s">&quot;f3&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">),</span> <span class="p">{</span><span class="s">&quot;f1&quot;</span><span class="p">:</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">:</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&quot;f3&quot;</span><span class="p">:</span> <span class="s">&#39;abc&#39;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestDictFields.test_read_dict_no_fieldnames"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDictFields.test_read_dict_no_fieldnames">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_dict_no_fieldnames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;f1,f2,f3</span><span class="se">\r\n</span><span class="s">1,2,abc</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">fileobj</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">),</span> <span class="p">{</span><span class="s">&quot;f1&quot;</span><span class="p">:</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">:</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&quot;f3&quot;</span><span class="p">:</span> <span class="s">&#39;abc&#39;</span><span class="p">})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;f1&quot;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">,</span> <span class="s">&quot;f3&quot;</span><span class="p">])</span>

    <span class="c"># Two test cases to make sure existing ways of implicitly setting</span>
    <span class="c"># fieldnames continue to work.  Both arise from discussion in issue3436.</span></div>
<div class="viewcode-block" id="TestDictFields.test_read_dict_fieldnames_from_file"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDictFields.test_read_dict_fieldnames_from_file">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_dict_fieldnames_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;f1,f2,f3</span><span class="se">\r\n</span><span class="s">1,2,abc</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span>
                                    <span class="n">fieldnames</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">fileobj</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;f1&quot;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">,</span> <span class="s">&quot;f3&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">),</span> <span class="p">{</span><span class="s">&quot;f1&quot;</span><span class="p">:</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">:</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&quot;f3&quot;</span><span class="p">:</span> <span class="s">&#39;abc&#39;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestDictFields.test_read_dict_fieldnames_chain"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDictFields.test_read_dict_fieldnames_chain">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_dict_fieldnames_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">itertools</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;f1,f2,f3</span><span class="se">\r\n</span><span class="s">1,2,abc</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">fileobj</span><span class="p">)</span>
            <span class="n">first</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">([</span><span class="n">first</span><span class="p">],</span> <span class="n">reader</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;f1&quot;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">,</span> <span class="s">&quot;f3&quot;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;f1&quot;</span><span class="p">:</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">:</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&quot;f3&quot;</span><span class="p">:</span> <span class="s">&#39;abc&#39;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestDictFields.test_read_long"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDictFields.test_read_long">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_long</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;1,2,abc,4,5,6</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span>
                                    <span class="n">fieldnames</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;f1&quot;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">),</span> <span class="p">{</span><span class="s">&quot;f1&quot;</span><span class="p">:</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">:</span> <span class="s">&#39;2&#39;</span><span class="p">,</span>
                                             <span class="bp">None</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;abc&quot;</span><span class="p">,</span> <span class="s">&quot;4&quot;</span><span class="p">,</span> <span class="s">&quot;5&quot;</span><span class="p">,</span> <span class="s">&quot;6&quot;</span><span class="p">]})</span>
</div>
<div class="viewcode-block" id="TestDictFields.test_read_long_with_rest"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDictFields.test_read_long_with_rest">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_long_with_rest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;1,2,abc,4,5,6</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span>
                                    <span class="n">fieldnames</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;f1&quot;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">],</span> <span class="n">restkey</span><span class="o">=</span><span class="s">&quot;_rest&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">),</span> <span class="p">{</span><span class="s">&quot;f1&quot;</span><span class="p">:</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">:</span> <span class="s">&#39;2&#39;</span><span class="p">,</span>
                                             <span class="s">&quot;_rest&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;abc&quot;</span><span class="p">,</span> <span class="s">&quot;4&quot;</span><span class="p">,</span> <span class="s">&quot;5&quot;</span><span class="p">,</span> <span class="s">&quot;6&quot;</span><span class="p">]})</span>
</div>
<div class="viewcode-block" id="TestDictFields.test_read_long_with_rest_no_fieldnames"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDictFields.test_read_long_with_rest_no_fieldnames">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_long_with_rest_no_fieldnames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;f1,f2</span><span class="se">\r\n</span><span class="s">1,2,abc,4,5,6</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">restkey</span><span class="o">=</span><span class="s">&quot;_rest&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;f1&quot;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">),</span> <span class="p">{</span><span class="s">&quot;f1&quot;</span><span class="p">:</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&quot;f2&quot;</span><span class="p">:</span> <span class="s">&#39;2&#39;</span><span class="p">,</span>
                                             <span class="s">&quot;_rest&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;abc&quot;</span><span class="p">,</span> <span class="s">&quot;4&quot;</span><span class="p">,</span> <span class="s">&quot;5&quot;</span><span class="p">,</span> <span class="s">&quot;6&quot;</span><span class="p">]})</span>
</div>
<div class="viewcode-block" id="TestDictFields.test_read_short"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDictFields.test_read_short">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_short</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;1,2,abc,4,5,6</span><span class="se">\r\n</span><span class="s">1,2,abc</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span>
                                    <span class="n">fieldnames</span><span class="o">=</span><span class="s">&quot;1 2 3 4 5 6&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
                                    <span class="n">restval</span><span class="o">=</span><span class="s">&quot;DEFAULT&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">),</span> <span class="p">{</span><span class="s">&quot;1&quot;</span><span class="p">:</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&quot;2&quot;</span><span class="p">:</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">:</span> <span class="s">&#39;abc&#39;</span><span class="p">,</span>
                                             <span class="s">&quot;4&quot;</span><span class="p">:</span> <span class="s">&#39;4&#39;</span><span class="p">,</span> <span class="s">&quot;5&quot;</span><span class="p">:</span> <span class="s">&#39;5&#39;</span><span class="p">,</span> <span class="s">&quot;6&quot;</span><span class="p">:</span> <span class="s">&#39;6&#39;</span><span class="p">})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">),</span> <span class="p">{</span><span class="s">&quot;1&quot;</span><span class="p">:</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&quot;2&quot;</span><span class="p">:</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">:</span> <span class="s">&#39;abc&#39;</span><span class="p">,</span>
                                             <span class="s">&quot;4&quot;</span><span class="p">:</span> <span class="s">&#39;DEFAULT&#39;</span><span class="p">,</span> <span class="s">&quot;5&quot;</span><span class="p">:</span> <span class="s">&#39;DEFAULT&#39;</span><span class="p">,</span>
                                             <span class="s">&quot;6&quot;</span><span class="p">:</span> <span class="s">&#39;DEFAULT&#39;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestDictFields.test_read_multi"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDictFields.test_read_multi">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_multi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s">&#39;2147483648,43.0e12,17,abc,def</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">,</span>
            <span class="s">&#39;147483648,43.0e2,17,abc,def</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">,</span>
            <span class="s">&#39;47483648,43.0,170,abc,def</span><span class="se">\r\n</span><span class="s">&#39;</span>
            <span class="p">]</span>

        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span>
                                <span class="n">fieldnames</span><span class="o">=</span><span class="s">&quot;i1 float i2 s1 s2&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">),</span> <span class="p">{</span><span class="s">&quot;i1&quot;</span><span class="p">:</span> <span class="s">&#39;2147483648&#39;</span><span class="p">,</span>
                                         <span class="s">&quot;float&quot;</span><span class="p">:</span> <span class="s">&#39;43.0e12&#39;</span><span class="p">,</span>
                                         <span class="s">&quot;i2&quot;</span><span class="p">:</span> <span class="s">&#39;17&#39;</span><span class="p">,</span>
                                         <span class="s">&quot;s1&quot;</span><span class="p">:</span> <span class="s">&#39;abc&#39;</span><span class="p">,</span>
                                         <span class="s">&quot;s2&quot;</span><span class="p">:</span> <span class="s">&#39;def&#39;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestDictFields.test_read_with_blanks"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDictFields.test_read_with_blanks">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_with_blanks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">([</span><span class="s">&quot;1,2,abc,4,5,6</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">,</span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">,</span>
                                 <span class="s">&quot;1,2,abc,4,5,6</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">],</span>
                                <span class="n">fieldnames</span><span class="o">=</span><span class="s">&quot;1 2 3 4 5 6&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">),</span> <span class="p">{</span><span class="s">&quot;1&quot;</span><span class="p">:</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&quot;2&quot;</span><span class="p">:</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">:</span> <span class="s">&#39;abc&#39;</span><span class="p">,</span>
                                         <span class="s">&quot;4&quot;</span><span class="p">:</span> <span class="s">&#39;4&#39;</span><span class="p">,</span> <span class="s">&quot;5&quot;</span><span class="p">:</span> <span class="s">&#39;5&#39;</span><span class="p">,</span> <span class="s">&quot;6&quot;</span><span class="p">:</span> <span class="s">&#39;6&#39;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">),</span> <span class="p">{</span><span class="s">&quot;1&quot;</span><span class="p">:</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&quot;2&quot;</span><span class="p">:</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">:</span> <span class="s">&#39;abc&#39;</span><span class="p">,</span>
                                         <span class="s">&quot;4&quot;</span><span class="p">:</span> <span class="s">&#39;4&#39;</span><span class="p">,</span> <span class="s">&quot;5&quot;</span><span class="p">:</span> <span class="s">&#39;5&#39;</span><span class="p">,</span> <span class="s">&quot;6&quot;</span><span class="p">:</span> <span class="s">&#39;6&#39;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestDictFields.test_read_semi_sep"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDictFields.test_read_semi_sep">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_semi_sep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">([</span><span class="s">&quot;1;2;abc;4;5;6</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">],</span>
                                <span class="n">fieldnames</span><span class="o">=</span><span class="s">&quot;1 2 3 4 5 6&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
                                <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">),</span> <span class="p">{</span><span class="s">&quot;1&quot;</span><span class="p">:</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&quot;2&quot;</span><span class="p">:</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">:</span> <span class="s">&#39;abc&#39;</span><span class="p">,</span>
                                         <span class="s">&quot;4&quot;</span><span class="p">:</span> <span class="s">&#39;4&#39;</span><span class="p">,</span> <span class="s">&quot;5&quot;</span><span class="p">:</span> <span class="s">&#39;5&#39;</span><span class="p">,</span> <span class="s">&quot;6&quot;</span><span class="p">:</span> <span class="s">&#39;6&#39;</span><span class="p">})</span>
</div></div>
<div class="viewcode-block" id="TestArrayWrites"><a class="viewcode-back" href="../../test.html#test.test_csv.TestArrayWrites">[docs]</a><span class="k">class</span> <span class="nc">TestArrayWrites</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="TestArrayWrites.test_int_write"><a class="viewcode-back" href="../../test.html#test.test_csv.TestArrayWrites.test_int_write">[docs]</a>    <span class="k">def</span> <span class="nf">test_int_write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">array</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">20</span><span class="o">-</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="n">contents</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="s">&quot;excel&quot;</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="n">expected</span> <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">])</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestArrayWrites.test_double_write"><a class="viewcode-back" href="../../test.html#test.test_csv.TestArrayWrites.test_double_write">[docs]</a>    <span class="k">def</span> <span class="nf">test_double_write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">array</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">20</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="mf">0.1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="n">contents</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="s">&quot;excel&quot;</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="n">expected</span> <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">])</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestArrayWrites.test_float_write"><a class="viewcode-back" href="../../test.html#test.test_csv.TestArrayWrites.test_float_write">[docs]</a>    <span class="k">def</span> <span class="nf">test_float_write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">array</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">20</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="mf">0.1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="n">contents</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="s">&quot;excel&quot;</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="n">expected</span> <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">])</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestArrayWrites.test_char_write"><a class="viewcode-back" href="../../test.html#test.test_csv.TestArrayWrites.test_char_write">[docs]</a>    <span class="k">def</span> <span class="nf">test_char_write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">array</span><span class="o">,</span> <span class="nn">string</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="s">&quot;excel&quot;</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="n">expected</span> <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">expected</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="TestDialectValidity"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectValidity">[docs]</a><span class="k">class</span> <span class="nc">TestDialectValidity</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="TestDialectValidity.test_quoting"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectValidity.test_quoting">[docs]</a>    <span class="k">def</span> <span class="nf">test_quoting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">mydialect</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Dialect</span><span class="p">):</span>
            <span class="n">delimiter</span> <span class="o">=</span> <span class="s">&quot;;&quot;</span>
            <span class="n">escapechar</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span>
            <span class="n">doublequote</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">lineterminator</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\r\n</span><span class="s">&#39;</span>
            <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">mydialect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">quoting</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span><span class="p">)</span>

        <span class="n">mydialect</span><span class="o">.</span><span class="n">quoting</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="n">mydialect</span><span class="p">)</span>

        <span class="n">mydialect</span><span class="o">.</span><span class="n">doublequote</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">mydialect</span><span class="o">.</span><span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span>
        <span class="n">mydialect</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="s">&#39;&quot;&#39;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">mydialect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">quoting</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">quotechar</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">doublequote</span><span class="p">)</span>

        <span class="n">mydialect</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="s">&quot;&#39;&#39;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">mydialect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                         <span class="s">&#39;&quot;quotechar&quot; must be an 1-character string&#39;</span><span class="p">)</span>

        <span class="n">mydialect</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">mydialect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                         <span class="s">&#39;&quot;quotechar&quot; must be string, not int&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDialectValidity.test_delimiter"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectValidity.test_delimiter">[docs]</a>    <span class="k">def</span> <span class="nf">test_delimiter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">mydialect</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Dialect</span><span class="p">):</span>
            <span class="n">delimiter</span> <span class="o">=</span> <span class="s">&quot;;&quot;</span>
            <span class="n">escapechar</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span>
            <span class="n">doublequote</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">lineterminator</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\r\n</span><span class="s">&#39;</span>
            <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">mydialect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&quot;;&quot;</span><span class="p">)</span>

        <span class="n">mydialect</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="s">&quot;:::&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">mydialect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                         <span class="s">&#39;&quot;delimiter&quot; must be an 1-character string&#39;</span><span class="p">)</span>

        <span class="n">mydialect</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">mydialect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                         <span class="s">&#39;&quot;delimiter&quot; must be an 1-character string&#39;</span><span class="p">)</span>

        <span class="n">mydialect</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;,&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">mydialect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                         <span class="s">&#39;&quot;delimiter&quot; must be string, not bytes&#39;</span><span class="p">)</span>

        <span class="n">mydialect</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">mydialect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                         <span class="s">&#39;&quot;delimiter&quot; must be string, not int&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDialectValidity.test_lineterminator"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectValidity.test_lineterminator">[docs]</a>    <span class="k">def</span> <span class="nf">test_lineterminator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">mydialect</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Dialect</span><span class="p">):</span>
            <span class="n">delimiter</span> <span class="o">=</span> <span class="s">&quot;;&quot;</span>
            <span class="n">escapechar</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span>
            <span class="n">doublequote</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">lineterminator</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\r\n</span><span class="s">&#39;</span>
            <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">mydialect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">lineterminator</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="n">mydialect</span><span class="o">.</span><span class="n">lineterminator</span> <span class="o">=</span> <span class="s">&quot;:::&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">mydialect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">lineterminator</span><span class="p">,</span> <span class="s">&quot;:::&quot;</span><span class="p">)</span>

        <span class="n">mydialect</span><span class="o">.</span><span class="n">lineterminator</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">mydialect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                         <span class="s">&#39;&quot;lineterminator&quot; must be a string&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDialectValidity.test_invalid_chars"><a class="viewcode-back" href="../../test.html#test.test_csv.TestDialectValidity.test_invalid_chars">[docs]</a>    <span class="k">def</span> <span class="nf">test_invalid_chars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">create_invalid</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="k">class</span> <span class="nc">mydialect</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Dialect</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">mydialect</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">mydialect</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;delimiter&quot;</span><span class="p">,</span> <span class="s">&quot;escapechar&quot;</span><span class="p">,</span> <span class="s">&quot;quotechar&quot;</span><span class="p">):</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">subTest</span><span class="p">(</span><span class="n">field_name</span><span class="o">=</span><span class="n">field_name</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="n">create_invalid</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="n">create_invalid</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="s">&quot;abc&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="n">create_invalid</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="n">create_invalid</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="TestSniffer"><a class="viewcode-back" href="../../test.html#test.test_csv.TestSniffer">[docs]</a><span class="k">class</span> <span class="nc">TestSniffer</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">sample1</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">Harry&#39;s, Arlington Heights, IL, 2/1/03, Kimi Hayes</span>
<span class="s">Shark City, Glendale Heights, IL, 12/28/02, Prezence</span>
<span class="s">Tommy&#39;s Place, Blue Island, IL, 12/28/02, Blue Sunday/White Crow</span>
<span class="s">Stonecutters Seafood and Chop House, Lemont, IL, 12/19/02, Week Back</span>
<span class="s">&quot;&quot;&quot;</span>
    <span class="n">sample2</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">&#39;Harry&#39;&#39;s&#39;:&#39;Arlington Heights&#39;:&#39;IL&#39;:&#39;2/1/03&#39;:&#39;Kimi Hayes&#39;</span>
<span class="s">&#39;Shark City&#39;:&#39;Glendale Heights&#39;:&#39;IL&#39;:&#39;12/28/02&#39;:&#39;Prezence&#39;</span>
<span class="s">&#39;Tommy&#39;&#39;s Place&#39;:&#39;Blue Island&#39;:&#39;IL&#39;:&#39;12/28/02&#39;:&#39;Blue Sunday/White Crow&#39;</span>
<span class="s">&#39;Stonecutters &#39;&#39;Seafood&#39;&#39; and Chop House&#39;:&#39;Lemont&#39;:&#39;IL&#39;:&#39;12/19/02&#39;:&#39;Week Back&#39;</span>
<span class="s">&quot;&quot;&quot;</span>
    <span class="n">header1</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;</span><span class="se">\</span>
<span class="s">&quot;venue&quot;,&quot;city&quot;,&quot;state&quot;,&quot;date&quot;,&quot;performers&quot;</span>
<span class="s">&#39;&#39;&#39;</span>
    <span class="n">sample3</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;</span><span class="se">\</span>
<span class="s">05/05/03?05/05/03?05/05/03?05/05/03?05/05/03?05/05/03</span>
<span class="s">05/05/03?05/05/03?05/05/03?05/05/03?05/05/03?05/05/03</span>
<span class="s">05/05/03?05/05/03?05/05/03?05/05/03?05/05/03?05/05/03</span>
<span class="s">&#39;&#39;&#39;</span>

    <span class="n">sample4</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;</span><span class="se">\</span>
<span class="s">2147483648;43.0e12;17;abc;def</span>
<span class="s">147483648;43.0e2;17;abc;def</span>
<span class="s">47483648;43.0;170;abc;def</span>
<span class="s">&#39;&#39;&#39;</span>

    <span class="n">sample5</span> <span class="o">=</span> <span class="s">&quot;aaa</span><span class="se">\t</span><span class="s">bbb</span><span class="se">\r\n</span><span class="s">AAA</span><span class="se">\t\r\n</span><span class="s">BBB</span><span class="se">\t\r\n</span><span class="s">&quot;</span>
    <span class="n">sample6</span> <span class="o">=</span> <span class="s">&quot;a|b|c</span><span class="se">\r\n</span><span class="s">d|e|f</span><span class="se">\r\n</span><span class="s">&quot;</span>
    <span class="n">sample7</span> <span class="o">=</span> <span class="s">&quot;&#39;a&#39;|&#39;b&#39;|&#39;c&#39;</span><span class="se">\r\n</span><span class="s">&#39;d&#39;|e|f</span><span class="se">\r\n</span><span class="s">&quot;</span>

<span class="c"># Issue 18155: Use a delimiter that is a special char to regex:</span>

    <span class="n">header2</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;</span><span class="se">\</span>
<span class="s">&quot;venue&quot;+&quot;city&quot;+&quot;state&quot;+&quot;date&quot;+&quot;performers&quot;</span>
<span class="s">&#39;&#39;&#39;</span>
    <span class="n">sample8</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">Harry&#39;s+ Arlington Heights+ IL+ 2/1/03+ Kimi Hayes</span>
<span class="s">Shark City+ Glendale Heights+ IL+ 12/28/02+ Prezence</span>
<span class="s">Tommy&#39;s Place+ Blue Island+ IL+ 12/28/02+ Blue Sunday/White Crow</span>
<span class="s">Stonecutters Seafood and Chop House+ Lemont+ IL+ 12/19/02+ Week Back</span>
<span class="s">&quot;&quot;&quot;</span>
    <span class="n">sample9</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">&#39;Harry&#39;&#39;s&#39;+ Arlington Heights&#39;+ &#39;IL&#39;+ &#39;2/1/03&#39;+ &#39;Kimi Hayes&#39;</span>
<span class="s">&#39;Shark City&#39;+ Glendale Heights&#39;+&#39; IL&#39;+ &#39;12/28/02&#39;+ &#39;Prezence&#39;</span>
<span class="s">&#39;Tommy&#39;&#39;s Place&#39;+ Blue Island&#39;+ &#39;IL&#39;+ &#39;12/28/02&#39;+ &#39;Blue Sunday/White Crow&#39;</span>
<span class="s">&#39;Stonecutters &#39;&#39;Seafood&#39;&#39; and Chop House&#39;+ &#39;Lemont&#39;+ &#39;IL&#39;+ &#39;12/19/02&#39;+ &#39;Week Back&#39;</span>
<span class="s">&quot;&quot;&quot;</span>

<div class="viewcode-block" id="TestSniffer.test_has_header"><a class="viewcode-back" href="../../test.html#test.test_csv.TestSniffer.test_has_header">[docs]</a>    <span class="k">def</span> <span class="nf">test_has_header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sniffer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">Sniffer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">sniffer</span><span class="o">.</span><span class="n">has_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample1</span><span class="p">),</span> <span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">sniffer</span><span class="o">.</span><span class="n">has_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample1</span><span class="p">),</span>
                         <span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestSniffer.test_has_header_regex_special_delimiter"><a class="viewcode-back" href="../../test.html#test.test_csv.TestSniffer.test_has_header_regex_special_delimiter">[docs]</a>    <span class="k">def</span> <span class="nf">test_has_header_regex_special_delimiter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sniffer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">Sniffer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">sniffer</span><span class="o">.</span><span class="n">has_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample8</span><span class="p">),</span> <span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">sniffer</span><span class="o">.</span><span class="n">has_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample8</span><span class="p">),</span>
                         <span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestSniffer.test_sniff"><a class="viewcode-back" href="../../test.html#test.test_csv.TestSniffer.test_sniff">[docs]</a>    <span class="k">def</span> <span class="nf">test_sniff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sniffer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">Sniffer</span><span class="p">()</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&quot;,&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">quotechar</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">skipinitialspace</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>

        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&quot;:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">quotechar</span><span class="p">,</span> <span class="s">&quot;&#39;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">skipinitialspace</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestSniffer.test_delimiters"><a class="viewcode-back" href="../../test.html#test.test_csv.TestSniffer.test_delimiters">[docs]</a>    <span class="k">def</span> <span class="nf">test_delimiters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sniffer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">Sniffer</span><span class="p">()</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample3</span><span class="p">)</span>
        <span class="c"># given that all three lines in sample3 are equal,</span>
        <span class="c"># I think that any character could have been &#39;guessed&#39; as the</span>
        <span class="c"># delimiter, depending on dictionary order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample3</span><span class="p">)</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample3</span><span class="p">,</span> <span class="n">delimiters</span><span class="o">=</span><span class="s">&quot;?,&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&quot;?&quot;</span><span class="p">)</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample3</span><span class="p">,</span> <span class="n">delimiters</span><span class="o">=</span><span class="s">&quot;/,&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&quot;/&quot;</span><span class="p">)</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&quot;;&quot;</span><span class="p">)</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">)</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">quotechar</span><span class="p">,</span> <span class="s">&quot;&#39;&quot;</span><span class="p">)</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&#39;+&#39;</span><span class="p">)</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="s">&#39;+&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">quotechar</span><span class="p">,</span> <span class="s">&quot;&#39;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestSniffer.test_doublequote"><a class="viewcode-back" href="../../test.html#test.test_csv.TestSniffer.test_doublequote">[docs]</a>    <span class="k">def</span> <span class="nf">test_doublequote</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sniffer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">Sniffer</span><span class="p">()</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">doublequote</span><span class="p">)</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">doublequote</span><span class="p">)</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">doublequote</span><span class="p">)</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">doublequote</span><span class="p">)</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="n">sniffer</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">doublequote</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="NUL"><a class="viewcode-back" href="../../test.html#test.test_csv.NUL">[docs]</a><span class="k">class</span> <span class="nc">NUL</span><span class="p">:</span>
<div class="viewcode-block" id="NUL.write"><a class="viewcode-back" href="../../test.html#test.test_csv.NUL.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">pass</span></div>
    <span class="n">writelines</span> <span class="o">=</span> <span class="n">write</span>
</div>
<span class="nd">@unittest.skipUnless</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">&quot;gettotalrefcount&quot;</span><span class="p">),</span>
                     <span class="s">&#39;requires sys.gettotalrefcount()&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="TestLeaks"><a class="viewcode-back" href="../../test.html#test.test_csv.TestLeaks">[docs]</a><span class="k">class</span> <span class="nc">TestLeaks</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="TestLeaks.test_create_read"><a class="viewcode-back" href="../../test.html#test.test_csv.TestLeaks.test_create_read">[docs]</a>    <span class="k">def</span> <span class="nf">test_create_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">lastrc</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettotalrefcount</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">gc</span><span class="o">.</span><span class="n">garbage</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">rc</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettotalrefcount</span><span class="p">()</span>
            <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">([</span><span class="s">&quot;a,b,c</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">])</span>
            <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">([</span><span class="s">&quot;a,b,c</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">])</span>
            <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">([</span><span class="s">&quot;a,b,c</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">])</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">rc</span><span class="o">-</span><span class="n">lastrc</span>
            <span class="n">lastrc</span> <span class="o">=</span> <span class="n">rc</span>
        <span class="c"># if csv.reader() leaks, last delta should be 3 or more</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">delta</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestLeaks.test_create_write"><a class="viewcode-back" href="../../test.html#test.test_csv.TestLeaks.test_create_write">[docs]</a>    <span class="k">def</span> <span class="nf">test_create_write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">lastrc</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettotalrefcount</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">NUL</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">gc</span><span class="o">.</span><span class="n">garbage</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">rc</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettotalrefcount</span><span class="p">()</span>
            <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">rc</span><span class="o">-</span><span class="n">lastrc</span>
            <span class="n">lastrc</span> <span class="o">=</span> <span class="n">rc</span>
        <span class="c"># if csv.writer() leaks, last delta should be 3 or more</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">delta</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestLeaks.test_read"><a class="viewcode-back" href="../../test.html#test.test_csv.TestLeaks.test_read">[docs]</a>    <span class="k">def</span> <span class="nf">test_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;a,b,c</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">5</span>
        <span class="n">lastrc</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettotalrefcount</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">gc</span><span class="o">.</span><span class="n">garbage</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">rc</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettotalrefcount</span><span class="p">()</span>
            <span class="n">rdr</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rdr</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">rc</span><span class="o">-</span><span class="n">lastrc</span>
            <span class="n">lastrc</span> <span class="o">=</span> <span class="n">rc</span>
        <span class="c"># if reader leaks during read, delta should be 5 or more</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">delta</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestLeaks.test_write"><a class="viewcode-back" href="../../test.html#test.test_csv.TestLeaks.test_write">[docs]</a>    <span class="k">def</span> <span class="nf">test_write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span><span class="o">*</span><span class="mi">5</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">NUL</span><span class="p">()</span>
        <span class="n">lastrc</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettotalrefcount</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">gc</span><span class="o">.</span><span class="n">garbage</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">rc</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettotalrefcount</span><span class="p">()</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">rc</span><span class="o">-</span><span class="n">lastrc</span>
            <span class="n">lastrc</span> <span class="o">=</span> <span class="n">rc</span>
        <span class="c"># if writer leaks during write, last delta should be 5 or more</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">delta</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="TestUnicode"><a class="viewcode-back" href="../../test.html#test.test_csv.TestUnicode">[docs]</a><span class="k">class</span> <span class="nc">TestUnicode</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;Martin von Löwis&quot;</span><span class="p">,</span>
             <span class="s">&quot;Marc André Lemburg&quot;</span><span class="p">,</span>
             <span class="s">&quot;Guido van Rossum&quot;</span><span class="p">,</span>
             <span class="s">&quot;François Pinard&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="TestUnicode.test_unicode_read"><a class="viewcode-back" href="../../test.html#test.test_csv.TestUnicode.test_unicode_read">[docs]</a>    <span class="k">def</span> <span class="nf">test_unicode_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">io</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">fileobj</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="p">),</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="TestUnicode.test_unicode_write"><a class="viewcode-back" href="../../test.html#test.test_csv.TestUnicode.test_unicode_write">[docs]</a>    <span class="k">def</span> <span class="nf">test_unicode_write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">io</span>
        <span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s">&quot;w+&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fileobj</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
            <span class="n">expected</span> <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span>
            <span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">expected</span><span class="p">)</span>


</div></div>
<div class="viewcode-block" id="test_main"><a class="viewcode-back" href="../../test.html#test.test_csv.test_main">[docs]</a><span class="k">def</span> <span class="nf">test_main</span><span class="p">():</span>
    <span class="n">mod</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">__name__</span><span class="p">]</span>
    <span class="n">support</span><span class="o">.</span><span class="n">run_unittest</span><span class="p">(</span>
        <span class="o">*</span><span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;Test&#39;</span><span class="p">)]</span>
    <span class="p">)</span>
</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">test_main</span><span class="p">()</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>