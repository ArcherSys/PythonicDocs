

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_extcall &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_extcall</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_extcall</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;Doctest for method/function calls.</span>

<span class="sd">We&#39;re going the use these types for extra testing</span>

<span class="sd">    &gt;&gt;&gt; from collections import UserList</span>
<span class="sd">    &gt;&gt;&gt; from collections import UserDict</span>

<span class="sd">We&#39;re defining four helper functions</span>

<span class="sd">    &gt;&gt;&gt; def e(a,b):</span>
<span class="sd">    ...     print(a, b)</span>

<span class="sd">    &gt;&gt;&gt; def f(*a, **k):</span>
<span class="sd">    ...     print(a, support.sortdict(k))</span>

<span class="sd">    &gt;&gt;&gt; def g(x, *y, **z):</span>
<span class="sd">    ...     print(x, y, support.sortdict(z))</span>

<span class="sd">    &gt;&gt;&gt; def h(j=1, a=2, h=3):</span>
<span class="sd">    ...     print(j, a, h)</span>

<span class="sd">Argument list examples</span>

<span class="sd">    &gt;&gt;&gt; f()</span>
<span class="sd">    () {}</span>
<span class="sd">    &gt;&gt;&gt; f(1)</span>
<span class="sd">    (1,) {}</span>
<span class="sd">    &gt;&gt;&gt; f(1, 2)</span>
<span class="sd">    (1, 2) {}</span>
<span class="sd">    &gt;&gt;&gt; f(1, 2, 3)</span>
<span class="sd">    (1, 2, 3) {}</span>
<span class="sd">    &gt;&gt;&gt; f(1, 2, 3, *(4, 5))</span>
<span class="sd">    (1, 2, 3, 4, 5) {}</span>
<span class="sd">    &gt;&gt;&gt; f(1, 2, 3, *[4, 5])</span>
<span class="sd">    (1, 2, 3, 4, 5) {}</span>
<span class="sd">    &gt;&gt;&gt; f(1, 2, 3, *UserList([4, 5]))</span>
<span class="sd">    (1, 2, 3, 4, 5) {}</span>

<span class="sd">Here we add keyword arguments</span>

<span class="sd">    &gt;&gt;&gt; f(1, 2, 3, **{&#39;a&#39;:4, &#39;b&#39;:5})</span>
<span class="sd">    (1, 2, 3) {&#39;a&#39;: 4, &#39;b&#39;: 5}</span>
<span class="sd">    &gt;&gt;&gt; f(1, 2, 3, *[4, 5], **{&#39;a&#39;:6, &#39;b&#39;:7})</span>
<span class="sd">    (1, 2, 3, 4, 5) {&#39;a&#39;: 6, &#39;b&#39;: 7}</span>
<span class="sd">    &gt;&gt;&gt; f(1, 2, 3, x=4, y=5, *(6, 7), **{&#39;a&#39;:8, &#39;b&#39;: 9})</span>
<span class="sd">    (1, 2, 3, 6, 7) {&#39;a&#39;: 8, &#39;b&#39;: 9, &#39;x&#39;: 4, &#39;y&#39;: 5}</span>

<span class="sd">    &gt;&gt;&gt; f(1, 2, 3, **UserDict(a=4, b=5))</span>
<span class="sd">    (1, 2, 3) {&#39;a&#39;: 4, &#39;b&#39;: 5}</span>
<span class="sd">    &gt;&gt;&gt; f(1, 2, 3, *(4, 5), **UserDict(a=6, b=7))</span>
<span class="sd">    (1, 2, 3, 4, 5) {&#39;a&#39;: 6, &#39;b&#39;: 7}</span>
<span class="sd">    &gt;&gt;&gt; f(1, 2, 3, x=4, y=5, *(6, 7), **UserDict(a=8, b=9))</span>
<span class="sd">    (1, 2, 3, 6, 7) {&#39;a&#39;: 8, &#39;b&#39;: 9, &#39;x&#39;: 4, &#39;y&#39;: 5}</span>

<span class="sd">Examples with invalid arguments (TypeErrors). We&#39;re also testing the function</span>
<span class="sd">names in the exception messages.</span>

<span class="sd">Verify clearing of SF bug #733667</span>

<span class="sd">    &gt;&gt;&gt; e(c=4)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: e() got an unexpected keyword argument &#39;c&#39;</span>

<span class="sd">    &gt;&gt;&gt; g()</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: g() missing 1 required positional argument: &#39;x&#39;</span>

<span class="sd">    &gt;&gt;&gt; g(*())</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: g() missing 1 required positional argument: &#39;x&#39;</span>

<span class="sd">    &gt;&gt;&gt; g(*(), **{})</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: g() missing 1 required positional argument: &#39;x&#39;</span>

<span class="sd">    &gt;&gt;&gt; g(1)</span>
<span class="sd">    1 () {}</span>
<span class="sd">    &gt;&gt;&gt; g(1, 2)</span>
<span class="sd">    1 (2,) {}</span>
<span class="sd">    &gt;&gt;&gt; g(1, 2, 3)</span>
<span class="sd">    1 (2, 3) {}</span>
<span class="sd">    &gt;&gt;&gt; g(1, 2, 3, *(4, 5))</span>
<span class="sd">    1 (2, 3, 4, 5) {}</span>

<span class="sd">    &gt;&gt;&gt; class Nothing: pass</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; g(*Nothing())</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: g() argument after * must be a sequence, not Nothing</span>

<span class="sd">    &gt;&gt;&gt; class Nothing:</span>
<span class="sd">    ...     def __len__(self): return 5</span>
<span class="sd">    ...</span>

<span class="sd">    &gt;&gt;&gt; g(*Nothing())</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: g() argument after * must be a sequence, not Nothing</span>

<span class="sd">    &gt;&gt;&gt; class Nothing():</span>
<span class="sd">    ...     def __len__(self): return 5</span>
<span class="sd">    ...     def __getitem__(self, i):</span>
<span class="sd">    ...         if i&lt;3: return i</span>
<span class="sd">    ...         else: raise IndexError(i)</span>
<span class="sd">    ...</span>

<span class="sd">    &gt;&gt;&gt; g(*Nothing())</span>
<span class="sd">    0 (1, 2) {}</span>

<span class="sd">    &gt;&gt;&gt; class Nothing:</span>
<span class="sd">    ...     def __init__(self): self.c = 0</span>
<span class="sd">    ...     def __iter__(self): return self</span>
<span class="sd">    ...     def __next__(self):</span>
<span class="sd">    ...         if self.c == 4:</span>
<span class="sd">    ...             raise StopIteration</span>
<span class="sd">    ...         c = self.c</span>
<span class="sd">    ...         self.c += 1</span>
<span class="sd">    ...         return c</span>
<span class="sd">    ...</span>

<span class="sd">    &gt;&gt;&gt; g(*Nothing())</span>
<span class="sd">    0 (1, 2, 3) {}</span>

<span class="sd">Make sure that the function doesn&#39;t stomp the dictionary</span>

<span class="sd">    &gt;&gt;&gt; d = {&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: 3}</span>
<span class="sd">    &gt;&gt;&gt; d2 = d.copy()</span>
<span class="sd">    &gt;&gt;&gt; g(1, d=4, **d)</span>
<span class="sd">    1 () {&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: 3, &#39;d&#39;: 4}</span>
<span class="sd">    &gt;&gt;&gt; d == d2</span>
<span class="sd">    True</span>

<span class="sd">What about willful misconduct?</span>

<span class="sd">    &gt;&gt;&gt; def saboteur(**kw):</span>
<span class="sd">    ...     kw[&#39;x&#39;] = &#39;m&#39;</span>
<span class="sd">    ...     return kw</span>

<span class="sd">    &gt;&gt;&gt; d = {}</span>
<span class="sd">    &gt;&gt;&gt; kw = saboteur(a=1, **d)</span>
<span class="sd">    &gt;&gt;&gt; d</span>
<span class="sd">    {}</span>


<span class="sd">    &gt;&gt;&gt; g(1, 2, 3, **{&#39;x&#39;: 4, &#39;y&#39;: 5})</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: g() got multiple values for argument &#39;x&#39;</span>

<span class="sd">    &gt;&gt;&gt; f(**{1:2})</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: f() keywords must be strings</span>

<span class="sd">    &gt;&gt;&gt; h(**{&#39;e&#39;: 2})</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: h() got an unexpected keyword argument &#39;e&#39;</span>

<span class="sd">    &gt;&gt;&gt; h(*h)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: h() argument after * must be a sequence, not function</span>

<span class="sd">    &gt;&gt;&gt; dir(*h)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: dir() argument after * must be a sequence, not function</span>

<span class="sd">    &gt;&gt;&gt; None(*h)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: NoneType object argument after * must be a sequence, \</span>
<span class="sd">not function</span>

<span class="sd">    &gt;&gt;&gt; h(**h)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: h() argument after ** must be a mapping, not function</span>

<span class="sd">    &gt;&gt;&gt; dir(**h)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: dir() argument after ** must be a mapping, not function</span>

<span class="sd">    &gt;&gt;&gt; None(**h)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: NoneType object argument after ** must be a mapping, \</span>
<span class="sd">not function</span>

<span class="sd">    &gt;&gt;&gt; dir(b=1, **{&#39;b&#39;: 1})</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: dir() got multiple values for keyword argument &#39;b&#39;</span>

<span class="sd">Another helper function</span>

<span class="sd">    &gt;&gt;&gt; def f2(*a, **b):</span>
<span class="sd">    ...     return a, b</span>


<span class="sd">    &gt;&gt;&gt; d = {}</span>
<span class="sd">    &gt;&gt;&gt; for i in range(512):</span>
<span class="sd">    ...     key = &#39;k%d&#39; % i</span>
<span class="sd">    ...     d[key] = i</span>
<span class="sd">    &gt;&gt;&gt; a, b = f2(1, *(2,3), **d)</span>
<span class="sd">    &gt;&gt;&gt; len(a), len(b), b == d</span>
<span class="sd">    (3, 512, True)</span>

<span class="sd">    &gt;&gt;&gt; class Foo:</span>
<span class="sd">    ...     def method(self, arg1, arg2):</span>
<span class="sd">    ...         return arg1+arg2</span>

<span class="sd">    &gt;&gt;&gt; x = Foo()</span>
<span class="sd">    &gt;&gt;&gt; Foo.method(*(x, 1, 2))</span>
<span class="sd">    3</span>
<span class="sd">    &gt;&gt;&gt; Foo.method(x, *(1, 2))</span>
<span class="sd">    3</span>
<span class="sd">    &gt;&gt;&gt; Foo.method(*(1, 2, 3))</span>
<span class="sd">    5</span>
<span class="sd">    &gt;&gt;&gt; Foo.method(1, *[2, 3])</span>
<span class="sd">    5</span>

<span class="sd">A PyCFunction that takes only positional parameters should allow an</span>
<span class="sd">empty keyword dictionary to pass without a complaint, but raise a</span>
<span class="sd">TypeError if te dictionary is not empty</span>

<span class="sd">    &gt;&gt;&gt; try:</span>
<span class="sd">    ...     silence = id(1, *{})</span>
<span class="sd">    ...     True</span>
<span class="sd">    ... except:</span>
<span class="sd">    ...     False</span>
<span class="sd">    True</span>

<span class="sd">    &gt;&gt;&gt; id(1, **{&#39;foo&#39;: 1})</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: id() takes no keyword arguments</span>

<span class="sd">A corner case of keyword dictionary items being deleted during</span>
<span class="sd">the function call setup. See &lt;http://bugs.python.org/issue2016&gt;.</span>

<span class="sd">    &gt;&gt;&gt; class Name(str):</span>
<span class="sd">    ...     def __eq__(self, other):</span>
<span class="sd">    ...         try:</span>
<span class="sd">    ...              del x[self]</span>
<span class="sd">    ...         except KeyError:</span>
<span class="sd">    ...              pass</span>
<span class="sd">    ...         return str.__eq__(self, other)</span>
<span class="sd">    ...     def __hash__(self):</span>
<span class="sd">    ...         return str.__hash__(self)</span>

<span class="sd">    &gt;&gt;&gt; x = {Name(&quot;a&quot;):1, Name(&quot;b&quot;):2}</span>
<span class="sd">    &gt;&gt;&gt; def f(a, b):</span>
<span class="sd">    ...     print(a,b)</span>
<span class="sd">    &gt;&gt;&gt; f(**x)</span>
<span class="sd">    1 2</span>

<span class="sd">Too many arguments:</span>

<span class="sd">    &gt;&gt;&gt; def f(): pass</span>
<span class="sd">    &gt;&gt;&gt; f(1)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: f() takes 0 positional arguments but 1 was given</span>
<span class="sd">    &gt;&gt;&gt; def f(a): pass</span>
<span class="sd">    &gt;&gt;&gt; f(1, 2)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: f() takes 1 positional argument but 2 were given</span>
<span class="sd">    &gt;&gt;&gt; def f(a, b=1): pass</span>
<span class="sd">    &gt;&gt;&gt; f(1, 2, 3)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: f() takes from 1 to 2 positional arguments but 3 were given</span>
<span class="sd">    &gt;&gt;&gt; def f(*, kw): pass</span>
<span class="sd">    &gt;&gt;&gt; f(1, kw=3)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: f() takes 0 positional arguments but 1 positional argument (and 1 keyword-only argument) were given</span>
<span class="sd">    &gt;&gt;&gt; def f(*, kw, b): pass</span>
<span class="sd">    &gt;&gt;&gt; f(1, 2, 3, b=3, kw=3)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: f() takes 0 positional arguments but 3 positional arguments (and 2 keyword-only arguments) were given</span>
<span class="sd">    &gt;&gt;&gt; def f(a, b=2, *, kw): pass</span>
<span class="sd">    &gt;&gt;&gt; f(2, 3, 4, kw=4)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: f() takes from 1 to 2 positional arguments but 3 positional arguments (and 1 keyword-only argument) were given</span>

<span class="sd">Too few and missing arguments:</span>

<span class="sd">    &gt;&gt;&gt; def f(a): pass</span>
<span class="sd">    &gt;&gt;&gt; f()</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: f() missing 1 required positional argument: &#39;a&#39;</span>
<span class="sd">    &gt;&gt;&gt; def f(a, b): pass</span>
<span class="sd">    &gt;&gt;&gt; f()</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: f() missing 2 required positional arguments: &#39;a&#39; and &#39;b&#39;</span>
<span class="sd">    &gt;&gt;&gt; def f(a, b, c): pass</span>
<span class="sd">    &gt;&gt;&gt; f()</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: f() missing 3 required positional arguments: &#39;a&#39;, &#39;b&#39;, and &#39;c&#39;</span>
<span class="sd">    &gt;&gt;&gt; def f(a, b, c, d, e): pass</span>
<span class="sd">    &gt;&gt;&gt; f()</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: f() missing 5 required positional arguments: &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, and &#39;e&#39;</span>
<span class="sd">    &gt;&gt;&gt; def f(a, b=4, c=5, d=5): pass</span>
<span class="sd">    &gt;&gt;&gt; f(c=12, b=9)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: f() missing 1 required positional argument: &#39;a&#39;</span>

<span class="sd">Same with keyword only args:</span>

<span class="sd">    &gt;&gt;&gt; def f(*, w): pass</span>
<span class="sd">    &gt;&gt;&gt; f()</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: f() missing 1 required keyword-only argument: &#39;w&#39;</span>
<span class="sd">    &gt;&gt;&gt; def f(*, a, b, c, d, e): pass</span>
<span class="sd">    &gt;&gt;&gt; f()</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    TypeError: f() missing 5 required keyword-only arguments: &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, and &#39;e&#39;</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">support</span>

<span class="k">def</span> <span class="nf">test_main</span><span class="p">():</span>
<div class="viewcode-block" id="test_main"><a class="viewcode-back" href="../../test.html#test.test_extcall.test_main">[docs]</a>    <span class="n">support</span><span class="o">.</span><span class="n">run_doctest</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">__name__</span><span class="p">],</span> <span class="bp">True</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span></div>
    <span class="n">test_main</span><span class="p">()</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>