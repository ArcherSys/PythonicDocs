

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_syntax &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_syntax</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_syntax</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;This module tests SyntaxErrors.</span>

<span class="sd">Here&#39;s an example of the sort of thing that is tested.</span>

<span class="sd">&gt;&gt;&gt; def f(x):</span>
<span class="sd">...     global x</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: name &#39;x&#39; is parameter and global</span>

<span class="sd">The tests are all raise SyntaxErrors.  They were created by checking</span>
<span class="sd">each C call that raises SyntaxError.  There are several modules that</span>
<span class="sd">raise these exceptions-- ast.c, compile.c, future.c, pythonrun.c, and</span>
<span class="sd">symtable.c.</span>

<span class="sd">The parser itself outlaws a lot of invalid syntax.  None of these</span>
<span class="sd">errors are tested here at the moment.  We should add some tests; since</span>
<span class="sd">there are infinitely many programs with invalid syntax, we would need</span>
<span class="sd">to be judicious in selecting some.</span>

<span class="sd">The compiler generates a synthetic module name for code executed by</span>
<span class="sd">doctest.  Since all the code comes from the same module, a suffix like</span>
<span class="sd">[1] is appended to the module name, As a consequence, changing the</span>
<span class="sd">order of tests in this module means renumbering all the errors after</span>
<span class="sd">it.  (Maybe we should enable the ellipsis option for these tests.)</span>

<span class="sd">In ast.c, syntax errors are raised by calling ast_error().</span>

<span class="sd">Errors from set_context():</span>

<span class="sd">&gt;&gt;&gt; obj.None = 1</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: invalid syntax</span>

<span class="sd">&gt;&gt;&gt; None = 1</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t assign to keyword</span>

<span class="sd">It&#39;s a syntax error to assign to the empty tuple.  Why isn&#39;t it an</span>
<span class="sd">error to assign to the empty list?  It will always raise some error at</span>
<span class="sd">runtime.</span>

<span class="sd">&gt;&gt;&gt; () = 1</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t assign to ()</span>

<span class="sd">&gt;&gt;&gt; f() = 1</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t assign to function call</span>

<span class="sd">&gt;&gt;&gt; del f()</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t delete function call</span>

<span class="sd">&gt;&gt;&gt; a + 1 = 2</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t assign to operator</span>

<span class="sd">&gt;&gt;&gt; (x for x in x) = 1</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t assign to generator expression</span>

<span class="sd">&gt;&gt;&gt; 1 = 1</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t assign to literal</span>

<span class="sd">&gt;&gt;&gt; &quot;abc&quot; = 1</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t assign to literal</span>

<span class="sd">&gt;&gt;&gt; b&quot;&quot; = 1</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t assign to literal</span>

<span class="sd">&gt;&gt;&gt; `1` = 1</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: invalid syntax</span>

<span class="sd">If the left-hand side of an assignment is a list or tuple, an illegal</span>
<span class="sd">expression inside that contain should still cause a syntax error.</span>
<span class="sd">This test just checks a couple of cases rather than enumerating all of</span>
<span class="sd">them.</span>

<span class="sd">&gt;&gt;&gt; (a, &quot;b&quot;, c) = (1, 2, 3)</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t assign to literal</span>

<span class="sd">&gt;&gt;&gt; [a, b, c + 1] = [1, 2, 3]</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t assign to operator</span>

<span class="sd">&gt;&gt;&gt; a if 1 else b = 1</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t assign to conditional expression</span>

<span class="sd">From compiler_complex_args():</span>

<span class="sd">&gt;&gt;&gt; def f(None=1):</span>
<span class="sd">...     pass</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: invalid syntax</span>


<span class="sd">From ast_for_arguments():</span>

<span class="sd">&gt;&gt;&gt; def f(x, y=1, z):</span>
<span class="sd">...     pass</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: non-default argument follows default argument</span>

<span class="sd">&gt;&gt;&gt; def f(x, None):</span>
<span class="sd">...     pass</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: invalid syntax</span>

<span class="sd">&gt;&gt;&gt; def f(*None):</span>
<span class="sd">...     pass</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: invalid syntax</span>

<span class="sd">&gt;&gt;&gt; def f(**None):</span>
<span class="sd">...     pass</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: invalid syntax</span>


<span class="sd">From ast_for_funcdef():</span>

<span class="sd">&gt;&gt;&gt; def None(x):</span>
<span class="sd">...     pass</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: invalid syntax</span>


<span class="sd">From ast_for_call():</span>

<span class="sd">&gt;&gt;&gt; def f(it, *varargs):</span>
<span class="sd">...     return list(it)</span>
<span class="sd">&gt;&gt;&gt; L = range(10)</span>
<span class="sd">&gt;&gt;&gt; f(x for x in L)</span>
<span class="sd">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
<span class="sd">&gt;&gt;&gt; f(x for x in L, 1)</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: Generator expression must be parenthesized if not sole argument</span>
<span class="sd">&gt;&gt;&gt; f((x for x in L), 1)</span>
<span class="sd">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>

<span class="sd">&gt;&gt;&gt; f(i0,  i1,  i2,  i3,  i4,  i5,  i6,  i7,  i8,  i9,  i10,  i11,</span>
<span class="sd">...   i12,  i13,  i14,  i15,  i16,  i17,  i18,  i19,  i20,  i21,  i22,</span>
<span class="sd">...   i23,  i24,  i25,  i26,  i27,  i28,  i29,  i30,  i31,  i32,  i33,</span>
<span class="sd">...   i34,  i35,  i36,  i37,  i38,  i39,  i40,  i41,  i42,  i43,  i44,</span>
<span class="sd">...   i45,  i46,  i47,  i48,  i49,  i50,  i51,  i52,  i53,  i54,  i55,</span>
<span class="sd">...   i56,  i57,  i58,  i59,  i60,  i61,  i62,  i63,  i64,  i65,  i66,</span>
<span class="sd">...   i67,  i68,  i69,  i70,  i71,  i72,  i73,  i74,  i75,  i76,  i77,</span>
<span class="sd">...   i78,  i79,  i80,  i81,  i82,  i83,  i84,  i85,  i86,  i87,  i88,</span>
<span class="sd">...   i89,  i90,  i91,  i92,  i93,  i94,  i95,  i96,  i97,  i98,  i99,</span>
<span class="sd">...   i100,  i101,  i102,  i103,  i104,  i105,  i106,  i107,  i108,</span>
<span class="sd">...   i109,  i110,  i111,  i112,  i113,  i114,  i115,  i116,  i117,</span>
<span class="sd">...   i118,  i119,  i120,  i121,  i122,  i123,  i124,  i125,  i126,</span>
<span class="sd">...   i127,  i128,  i129,  i130,  i131,  i132,  i133,  i134,  i135,</span>
<span class="sd">...   i136,  i137,  i138,  i139,  i140,  i141,  i142,  i143,  i144,</span>
<span class="sd">...   i145,  i146,  i147,  i148,  i149,  i150,  i151,  i152,  i153,</span>
<span class="sd">...   i154,  i155,  i156,  i157,  i158,  i159,  i160,  i161,  i162,</span>
<span class="sd">...   i163,  i164,  i165,  i166,  i167,  i168,  i169,  i170,  i171,</span>
<span class="sd">...   i172,  i173,  i174,  i175,  i176,  i177,  i178,  i179,  i180,</span>
<span class="sd">...   i181,  i182,  i183,  i184,  i185,  i186,  i187,  i188,  i189,</span>
<span class="sd">...   i190,  i191,  i192,  i193,  i194,  i195,  i196,  i197,  i198,</span>
<span class="sd">...   i199,  i200,  i201,  i202,  i203,  i204,  i205,  i206,  i207,</span>
<span class="sd">...   i208,  i209,  i210,  i211,  i212,  i213,  i214,  i215,  i216,</span>
<span class="sd">...   i217,  i218,  i219,  i220,  i221,  i222,  i223,  i224,  i225,</span>
<span class="sd">...   i226,  i227,  i228,  i229,  i230,  i231,  i232,  i233,  i234,</span>
<span class="sd">...   i235,  i236,  i237,  i238,  i239,  i240,  i241,  i242,  i243,</span>
<span class="sd">...   i244,  i245,  i246,  i247,  i248,  i249,  i250,  i251,  i252,</span>
<span class="sd">...   i253,  i254,  i255)</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: more than 255 arguments</span>

<span class="sd">The actual error cases counts positional arguments, keyword arguments,</span>
<span class="sd">and generator expression arguments separately.  This test combines the</span>
<span class="sd">three.</span>

<span class="sd">&gt;&gt;&gt; f(i0,  i1,  i2,  i3,  i4,  i5,  i6,  i7,  i8,  i9,  i10,  i11,</span>
<span class="sd">...   i12,  i13,  i14,  i15,  i16,  i17,  i18,  i19,  i20,  i21,  i22,</span>
<span class="sd">...   i23,  i24,  i25,  i26,  i27,  i28,  i29,  i30,  i31,  i32,  i33,</span>
<span class="sd">...   i34,  i35,  i36,  i37,  i38,  i39,  i40,  i41,  i42,  i43,  i44,</span>
<span class="sd">...   i45,  i46,  i47,  i48,  i49,  i50,  i51,  i52,  i53,  i54,  i55,</span>
<span class="sd">...   i56,  i57,  i58,  i59,  i60,  i61,  i62,  i63,  i64,  i65,  i66,</span>
<span class="sd">...   i67,  i68,  i69,  i70,  i71,  i72,  i73,  i74,  i75,  i76,  i77,</span>
<span class="sd">...   i78,  i79,  i80,  i81,  i82,  i83,  i84,  i85,  i86,  i87,  i88,</span>
<span class="sd">...   i89,  i90,  i91,  i92,  i93,  i94,  i95,  i96,  i97,  i98,  i99,</span>
<span class="sd">...   i100,  i101,  i102,  i103,  i104,  i105,  i106,  i107,  i108,</span>
<span class="sd">...   i109,  i110,  i111,  i112,  i113,  i114,  i115,  i116,  i117,</span>
<span class="sd">...   i118,  i119,  i120,  i121,  i122,  i123,  i124,  i125,  i126,</span>
<span class="sd">...   i127,  i128,  i129,  i130,  i131,  i132,  i133,  i134,  i135,</span>
<span class="sd">...   i136,  i137,  i138,  i139,  i140,  i141,  i142,  i143,  i144,</span>
<span class="sd">...   i145,  i146,  i147,  i148,  i149,  i150,  i151,  i152,  i153,</span>
<span class="sd">...   i154,  i155,  i156,  i157,  i158,  i159,  i160,  i161,  i162,</span>
<span class="sd">...   i163,  i164,  i165,  i166,  i167,  i168,  i169,  i170,  i171,</span>
<span class="sd">...   i172,  i173,  i174,  i175,  i176,  i177,  i178,  i179,  i180,</span>
<span class="sd">...   i181,  i182,  i183,  i184,  i185,  i186,  i187,  i188,  i189,</span>
<span class="sd">...   i190,  i191,  i192,  i193,  i194,  i195,  i196,  i197,  i198,</span>
<span class="sd">...   i199,  i200,  i201,  i202,  i203,  i204,  i205,  i206,  i207,</span>
<span class="sd">...   i208,  i209,  i210,  i211,  i212,  i213,  i214,  i215,  i216,</span>
<span class="sd">...   i217,  i218,  i219,  i220,  i221,  i222,  i223,  i224,  i225,</span>
<span class="sd">...   i226,  i227,  i228,  i229,  i230,  i231,  i232,  i233,  i234,</span>
<span class="sd">...   i235, i236,  i237,  i238,  i239,  i240,  i241,  i242,  i243,</span>
<span class="sd">...   (x for x in i244),  i245,  i246,  i247,  i248,  i249,  i250,  i251,</span>
<span class="sd">...    i252=1, i253=1,  i254=1,  i255=1)</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: more than 255 arguments</span>

<span class="sd">&gt;&gt;&gt; f(lambda x: x[0] = 3)</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: lambda cannot contain assignment</span>

<span class="sd">The grammar accepts any test (basically, any expression) in the</span>
<span class="sd">keyword slot of a call site.  Test a few different options.</span>

<span class="sd">&gt;&gt;&gt; f(x()=2)</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: keyword can&#39;t be an expression</span>
<span class="sd">&gt;&gt;&gt; f(a or b=1)</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: keyword can&#39;t be an expression</span>
<span class="sd">&gt;&gt;&gt; f(x.y=1)</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: keyword can&#39;t be an expression</span>


<span class="sd">More set_context():</span>

<span class="sd">&gt;&gt;&gt; (x for x in x) += 1</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t assign to generator expression</span>
<span class="sd">&gt;&gt;&gt; None += 1</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t assign to keyword</span>
<span class="sd">&gt;&gt;&gt; f() += 1</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t assign to function call</span>


<span class="sd">Test continue in finally in weird combinations.</span>

<span class="sd">continue in for loop under finally should be ok.</span>

<span class="sd">    &gt;&gt;&gt; def test():</span>
<span class="sd">    ...     try:</span>
<span class="sd">    ...         pass</span>
<span class="sd">    ...     finally:</span>
<span class="sd">    ...         for abc in range(10):</span>
<span class="sd">    ...             continue</span>
<span class="sd">    ...     print(abc)</span>
<span class="sd">    &gt;&gt;&gt; test()</span>
<span class="sd">    9</span>

<span class="sd">Start simple, a continue in a finally should not be allowed.</span>

<span class="sd">    &gt;&gt;&gt; def test():</span>
<span class="sd">    ...    for abc in range(10):</span>
<span class="sd">    ...        try:</span>
<span class="sd">    ...            pass</span>
<span class="sd">    ...        finally:</span>
<span class="sd">    ...            continue</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    SyntaxError: &#39;continue&#39; not supported inside &#39;finally&#39; clause</span>

<span class="sd">This is essentially a continue in a finally which should not be allowed.</span>

<span class="sd">    &gt;&gt;&gt; def test():</span>
<span class="sd">    ...    for abc in range(10):</span>
<span class="sd">    ...        try:</span>
<span class="sd">    ...            pass</span>
<span class="sd">    ...        finally:</span>
<span class="sd">    ...            try:</span>
<span class="sd">    ...                continue</span>
<span class="sd">    ...            except:</span>
<span class="sd">    ...                pass</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    SyntaxError: &#39;continue&#39; not supported inside &#39;finally&#39; clause</span>

<span class="sd">    &gt;&gt;&gt; def foo():</span>
<span class="sd">    ...     try:</span>
<span class="sd">    ...         pass</span>
<span class="sd">    ...     finally:</span>
<span class="sd">    ...         continue</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    SyntaxError: &#39;continue&#39; not supported inside &#39;finally&#39; clause</span>

<span class="sd">    &gt;&gt;&gt; def foo():</span>
<span class="sd">    ...     for a in ():</span>
<span class="sd">    ...       try:</span>
<span class="sd">    ...           pass</span>
<span class="sd">    ...       finally:</span>
<span class="sd">    ...           continue</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    SyntaxError: &#39;continue&#39; not supported inside &#39;finally&#39; clause</span>

<span class="sd">    &gt;&gt;&gt; def foo():</span>
<span class="sd">    ...     for a in ():</span>
<span class="sd">    ...         try:</span>
<span class="sd">    ...             pass</span>
<span class="sd">    ...         finally:</span>
<span class="sd">    ...             try:</span>
<span class="sd">    ...                 continue</span>
<span class="sd">    ...             finally:</span>
<span class="sd">    ...                 pass</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    SyntaxError: &#39;continue&#39; not supported inside &#39;finally&#39; clause</span>

<span class="sd">    &gt;&gt;&gt; def foo():</span>
<span class="sd">    ...  for a in ():</span>
<span class="sd">    ...   try: pass</span>
<span class="sd">    ...   finally:</span>
<span class="sd">    ...    try:</span>
<span class="sd">    ...     pass</span>
<span class="sd">    ...    except:</span>
<span class="sd">    ...     continue</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    SyntaxError: &#39;continue&#39; not supported inside &#39;finally&#39; clause</span>

<span class="sd">There is one test for a break that is not in a loop.  The compiler</span>
<span class="sd">uses a single data structure to keep track of try-finally and loops,</span>
<span class="sd">so we need to be sure that a break is actually inside a loop.  If it</span>
<span class="sd">isn&#39;t, there should be a syntax error.</span>

<span class="sd">   &gt;&gt;&gt; try:</span>
<span class="sd">   ...     print(1)</span>
<span class="sd">   ...     break</span>
<span class="sd">   ...     print(2)</span>
<span class="sd">   ... finally:</span>
<span class="sd">   ...     print(3)</span>
<span class="sd">   Traceback (most recent call last):</span>
<span class="sd">     ...</span>
<span class="sd">   SyntaxError: &#39;break&#39; outside loop</span>

<span class="sd">This should probably raise a better error than a SystemError (or none at all).</span>
<span class="sd">In 2.5 there was a missing exception and an assert was triggered in a debug</span>
<span class="sd">build.  The number of blocks must be greater than CO_MAXBLOCKS.  SF #1565514</span>

<span class="sd">   &gt;&gt;&gt; while 1:</span>
<span class="sd">   ...  while 2:</span>
<span class="sd">   ...   while 3:</span>
<span class="sd">   ...    while 4:</span>
<span class="sd">   ...     while 5:</span>
<span class="sd">   ...      while 6:</span>
<span class="sd">   ...       while 8:</span>
<span class="sd">   ...        while 9:</span>
<span class="sd">   ...         while 10:</span>
<span class="sd">   ...          while 11:</span>
<span class="sd">   ...           while 12:</span>
<span class="sd">   ...            while 13:</span>
<span class="sd">   ...             while 14:</span>
<span class="sd">   ...              while 15:</span>
<span class="sd">   ...               while 16:</span>
<span class="sd">   ...                while 17:</span>
<span class="sd">   ...                 while 18:</span>
<span class="sd">   ...                  while 19:</span>
<span class="sd">   ...                   while 20:</span>
<span class="sd">   ...                    while 21:</span>
<span class="sd">   ...                     while 22:</span>
<span class="sd">   ...                      break</span>
<span class="sd">   Traceback (most recent call last):</span>
<span class="sd">     ...</span>
<span class="sd">   SystemError: too many statically nested blocks</span>

<span class="sd">Misuse of the nonlocal statement can lead to a few unique syntax errors.</span>

<span class="sd">   &gt;&gt;&gt; def f(x):</span>
<span class="sd">   ...     nonlocal x</span>
<span class="sd">   Traceback (most recent call last):</span>
<span class="sd">     ...</span>
<span class="sd">   SyntaxError: name &#39;x&#39; is parameter and nonlocal</span>

<span class="sd">   &gt;&gt;&gt; def f():</span>
<span class="sd">   ...     global x</span>
<span class="sd">   ...     nonlocal x</span>
<span class="sd">   Traceback (most recent call last):</span>
<span class="sd">     ...</span>
<span class="sd">   SyntaxError: name &#39;x&#39; is nonlocal and global</span>

<span class="sd">   &gt;&gt;&gt; def f():</span>
<span class="sd">   ...     nonlocal x</span>
<span class="sd">   Traceback (most recent call last):</span>
<span class="sd">     ...</span>
<span class="sd">   SyntaxError: no binding for nonlocal &#39;x&#39; found</span>

<span class="sd">From SF bug #1705365</span>
<span class="sd">   &gt;&gt;&gt; nonlocal x</span>
<span class="sd">   Traceback (most recent call last):</span>
<span class="sd">     ...</span>
<span class="sd">   SyntaxError: nonlocal declaration not allowed at module level</span>

<span class="sd">TODO(jhylton): Figure out how to test SyntaxWarning with doctest.</span>

<span class="sd">##   &gt;&gt;&gt; def f(x):</span>
<span class="sd">##   ...     def f():</span>
<span class="sd">##   ...         print(x)</span>
<span class="sd">##   ...         nonlocal x</span>
<span class="sd">##   Traceback (most recent call last):</span>
<span class="sd">##     ...</span>
<span class="sd">##   SyntaxWarning: name &#39;x&#39; is assigned to before nonlocal declaration</span>

<span class="sd">##   &gt;&gt;&gt; def f():</span>
<span class="sd">##   ...     x = 1</span>
<span class="sd">##   ...     nonlocal x</span>
<span class="sd">##   Traceback (most recent call last):</span>
<span class="sd">##     ...</span>
<span class="sd">##   SyntaxWarning: name &#39;x&#39; is assigned to before nonlocal declaration</span>


<span class="sd">This tests assignment-context; there was a bug in Python 2.5 where compiling</span>
<span class="sd">a complex &#39;if&#39; (one with &#39;elif&#39;) would fail to notice an invalid suite,</span>
<span class="sd">leading to spurious errors.</span>

<span class="sd">   &gt;&gt;&gt; if 1:</span>
<span class="sd">   ...   x() = 1</span>
<span class="sd">   ... elif 1:</span>
<span class="sd">   ...   pass</span>
<span class="sd">   Traceback (most recent call last):</span>
<span class="sd">     ...</span>
<span class="sd">   SyntaxError: can&#39;t assign to function call</span>

<span class="sd">   &gt;&gt;&gt; if 1:</span>
<span class="sd">   ...   pass</span>
<span class="sd">   ... elif 1:</span>
<span class="sd">   ...   x() = 1</span>
<span class="sd">   Traceback (most recent call last):</span>
<span class="sd">     ...</span>
<span class="sd">   SyntaxError: can&#39;t assign to function call</span>

<span class="sd">   &gt;&gt;&gt; if 1:</span>
<span class="sd">   ...   x() = 1</span>
<span class="sd">   ... elif 1:</span>
<span class="sd">   ...   pass</span>
<span class="sd">   ... else:</span>
<span class="sd">   ...   pass</span>
<span class="sd">   Traceback (most recent call last):</span>
<span class="sd">     ...</span>
<span class="sd">   SyntaxError: can&#39;t assign to function call</span>

<span class="sd">   &gt;&gt;&gt; if 1:</span>
<span class="sd">   ...   pass</span>
<span class="sd">   ... elif 1:</span>
<span class="sd">   ...   x() = 1</span>
<span class="sd">   ... else:</span>
<span class="sd">   ...   pass</span>
<span class="sd">   Traceback (most recent call last):</span>
<span class="sd">     ...</span>
<span class="sd">   SyntaxError: can&#39;t assign to function call</span>

<span class="sd">   &gt;&gt;&gt; if 1:</span>
<span class="sd">   ...   pass</span>
<span class="sd">   ... elif 1:</span>
<span class="sd">   ...   pass</span>
<span class="sd">   ... else:</span>
<span class="sd">   ...   x() = 1</span>
<span class="sd">   Traceback (most recent call last):</span>
<span class="sd">     ...</span>
<span class="sd">   SyntaxError: can&#39;t assign to function call</span>

<span class="sd">Make sure that the old &quot;raise X, Y[, Z]&quot; form is gone:</span>
<span class="sd">   &gt;&gt;&gt; raise X, Y</span>
<span class="sd">   Traceback (most recent call last):</span>
<span class="sd">     ...</span>
<span class="sd">   SyntaxError: invalid syntax</span>
<span class="sd">   &gt;&gt;&gt; raise X, Y, Z</span>
<span class="sd">   Traceback (most recent call last):</span>
<span class="sd">     ...</span>
<span class="sd">   SyntaxError: invalid syntax</span>


<span class="sd">&gt;&gt;&gt; f(a=23, a=234)</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">   ...</span>
<span class="sd">SyntaxError: keyword argument repeated</span>

<span class="sd">&gt;&gt;&gt; del ()</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t delete ()</span>

<span class="sd">&gt;&gt;&gt; {1, 2, 3} = 42</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">SyntaxError: can&#39;t assign to literal</span>

<span class="sd">Corner-cases that used to fail to raise the correct error:</span>

<span class="sd">    &gt;&gt;&gt; def f(*, x=lambda __debug__:0): pass</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    SyntaxError: assignment to keyword</span>

<span class="sd">    &gt;&gt;&gt; def f(*args:(lambda __debug__:0)): pass</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    SyntaxError: assignment to keyword</span>

<span class="sd">    &gt;&gt;&gt; def f(**kwargs:(lambda __debug__:0)): pass</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    SyntaxError: assignment to keyword</span>

<span class="sd">    &gt;&gt;&gt; with (lambda *:0): pass</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    SyntaxError: named arguments must follow bare *</span>

<span class="sd">Corner-cases that used to crash:</span>

<span class="sd">    &gt;&gt;&gt; def f(**__debug__): pass</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    SyntaxError: assignment to keyword</span>

<span class="sd">    &gt;&gt;&gt; def f(*xx, __debug__): pass</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    SyntaxError: assignment to keyword</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">support</span>

<div class="viewcode-block" id="SyntaxTestCase"><a class="viewcode-back" href="../../test.html#test.test_syntax.SyntaxTestCase">[docs]</a><span class="k">class</span> <span class="nc">SyntaxTestCase</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">_check_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">errtext</span><span class="p">,</span>
                     <span class="n">filename</span><span class="o">=</span><span class="s">&quot;&lt;testcase&gt;&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&quot;exec&quot;</span><span class="p">,</span> <span class="n">subclass</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check that compiling code raises SyntaxError with errtext.</span>

<span class="sd">        errtest is a regular expression that must be present in the</span>
<span class="sd">        test of the exception raised.  If subclass is specified it</span>
<span class="sd">        is the expected subclass of SyntaxError (e.g. IndentationError).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">compile</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">SyntaxError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">subclass</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">subclass</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;SyntaxError is not a </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">subclass</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
            <span class="n">mo</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">errtext</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">mo</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;SyntaxError did not contain &#39;</span><span class="si">%r</span><span class="s">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errtext</span><span class="p">,))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;compile() did not raise SyntaxError&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="SyntaxTestCase.test_assign_call"><a class="viewcode-back" href="../../test.html#test.test_syntax.SyntaxTestCase.test_assign_call">[docs]</a>    <span class="k">def</span> <span class="nf">test_assign_call</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_error</span><span class="p">(</span><span class="s">&quot;f() = 1&quot;</span><span class="p">,</span> <span class="s">&quot;assign&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SyntaxTestCase.test_assign_del"><a class="viewcode-back" href="../../test.html#test.test_syntax.SyntaxTestCase.test_assign_del">[docs]</a>    <span class="k">def</span> <span class="nf">test_assign_del</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_error</span><span class="p">(</span><span class="s">&quot;del f()&quot;</span><span class="p">,</span> <span class="s">&quot;delete&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SyntaxTestCase.test_global_err_then_warn"><a class="viewcode-back" href="../../test.html#test.test_syntax.SyntaxTestCase.test_global_err_then_warn">[docs]</a>    <span class="k">def</span> <span class="nf">test_global_err_then_warn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Bug tickler:  The SyntaxError raised for one global statement</span>
        <span class="c"># shouldn&#39;t be clobbered by a SyntaxWarning issued for a later one.</span>
        <span class="n">source</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;if 1:</span>
<span class="s">            def error(a):</span>
<span class="s">                global a  # SyntaxError</span>
<span class="s">            def warning():</span>
<span class="s">                b = 1</span>
<span class="s">                global b  # SyntaxWarning</span>
<span class="s">            &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">SyntaxWarning</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_error</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s">&quot;global&quot;</span><span class="p">)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SyntaxTestCase.test_break_outside_loop"><a class="viewcode-back" href="../../test.html#test.test_syntax.SyntaxTestCase.test_break_outside_loop">[docs]</a>    <span class="k">def</span> <span class="nf">test_break_outside_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_error</span><span class="p">(</span><span class="s">&quot;break&quot;</span><span class="p">,</span> <span class="s">&quot;outside loop&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SyntaxTestCase.test_unexpected_indent"><a class="viewcode-back" href="../../test.html#test.test_syntax.SyntaxTestCase.test_unexpected_indent">[docs]</a>    <span class="k">def</span> <span class="nf">test_unexpected_indent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_error</span><span class="p">(</span><span class="s">&quot;foo()</span><span class="se">\n</span><span class="s"> bar()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&quot;unexpected indent&quot;</span><span class="p">,</span>
                          <span class="n">subclass</span><span class="o">=</span><span class="ne">IndentationError</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SyntaxTestCase.test_no_indent"><a class="viewcode-back" href="../../test.html#test.test_syntax.SyntaxTestCase.test_no_indent">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_indent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_error</span><span class="p">(</span><span class="s">&quot;if 1:</span><span class="se">\n</span><span class="s">foo()&quot;</span><span class="p">,</span> <span class="s">&quot;expected an indented block&quot;</span><span class="p">,</span>
                          <span class="n">subclass</span><span class="o">=</span><span class="ne">IndentationError</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SyntaxTestCase.test_bad_outdent"><a class="viewcode-back" href="../../test.html#test.test_syntax.SyntaxTestCase.test_bad_outdent">[docs]</a>    <span class="k">def</span> <span class="nf">test_bad_outdent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_error</span><span class="p">(</span><span class="s">&quot;if 1:</span><span class="se">\n</span><span class="s">  foo()</span><span class="se">\n</span><span class="s"> bar()&quot;</span><span class="p">,</span>
                          <span class="s">&quot;unindent does not match .* level&quot;</span><span class="p">,</span>
                          <span class="n">subclass</span><span class="o">=</span><span class="ne">IndentationError</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SyntaxTestCase.test_kwargs_last"><a class="viewcode-back" href="../../test.html#test.test_syntax.SyntaxTestCase.test_kwargs_last">[docs]</a>    <span class="k">def</span> <span class="nf">test_kwargs_last</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_error</span><span class="p">(</span><span class="s">&quot;int(base=10, &#39;2&#39;)&quot;</span><span class="p">,</span> <span class="s">&quot;non-keyword arg&quot;</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="test_main"><a class="viewcode-back" href="../../test.html#test.test_syntax.test_main">[docs]</a><span class="k">def</span> <span class="nf">test_main</span><span class="p">():</span>
    <span class="n">support</span><span class="o">.</span><span class="n">run_unittest</span><span class="p">(</span><span class="n">SyntaxTestCase</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">test_syntax</span>
    <span class="n">support</span><span class="o">.</span><span class="n">run_doctest</span><span class="p">(</span><span class="n">test_syntax</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">test_main</span><span class="p">()</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>