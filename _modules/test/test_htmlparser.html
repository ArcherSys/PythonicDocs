

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_htmlparser &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_htmlparser</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_htmlparser</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;Tests for HTMLParser.py.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">html.parser</span>
<span class="kn">import</span> <span class="nn">pprint</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">support</span>


<div class="viewcode-block" id="EventCollector"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollector">[docs]</a><span class="k">class</span> <span class="nc">EventCollector</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">HTMLParser</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">append</span>
        <span class="n">html</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">HTMLParser</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<div class="viewcode-block" id="EventCollector.get_events"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollector.get_events">[docs]</a>    <span class="k">def</span> <span class="nf">get_events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Normalize the list of events so that buffer artefacts don&#39;t</span>
        <span class="c"># separate runs of contiguous characters.</span>
        <span class="n">L</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">prevtype</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">:</span>
            <span class="nb">type</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="n">prevtype</span> <span class="o">==</span> <span class="s">&quot;data&quot;</span><span class="p">:</span>
                <span class="n">L</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">event</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="n">prevtype</span> <span class="o">=</span> <span class="nb">type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="n">L</span>
        <span class="k">return</span> <span class="n">L</span>

    <span class="c"># structure markup</span>
</div>
<div class="viewcode-block" id="EventCollector.handle_starttag"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollector.handle_starttag">[docs]</a>    <span class="k">def</span> <span class="nf">handle_starttag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">attrs</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="EventCollector.handle_startendtag"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollector.handle_startendtag">[docs]</a>    <span class="k">def</span> <span class="nf">handle_startendtag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;startendtag&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">attrs</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="EventCollector.handle_endtag"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollector.handle_endtag">[docs]</a>    <span class="k">def</span> <span class="nf">handle_endtag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;endtag&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="p">))</span>

    <span class="c"># all other markup</span>
</div>
<div class="viewcode-block" id="EventCollector.handle_comment"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollector.handle_comment">[docs]</a>    <span class="k">def</span> <span class="nf">handle_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;comment&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="EventCollector.handle_charref"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollector.handle_charref">[docs]</a>    <span class="k">def</span> <span class="nf">handle_charref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;charref&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="EventCollector.handle_data"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollector.handle_data">[docs]</a>    <span class="k">def</span> <span class="nf">handle_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="EventCollector.handle_decl"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollector.handle_decl">[docs]</a>    <span class="k">def</span> <span class="nf">handle_decl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;decl&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="EventCollector.handle_entityref"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollector.handle_entityref">[docs]</a>    <span class="k">def</span> <span class="nf">handle_entityref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;entityref&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="EventCollector.handle_pi"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollector.handle_pi">[docs]</a>    <span class="k">def</span> <span class="nf">handle_pi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;pi&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="EventCollector.unknown_decl"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollector.unknown_decl">[docs]</a>    <span class="k">def</span> <span class="nf">unknown_decl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">decl</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;unknown decl&quot;</span><span class="p">,</span> <span class="n">decl</span><span class="p">))</span>

</div></div>
<div class="viewcode-block" id="EventCollectorExtra"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollectorExtra">[docs]</a><span class="k">class</span> <span class="nc">EventCollectorExtra</span><span class="p">(</span><span class="n">EventCollector</span><span class="p">):</span>

<div class="viewcode-block" id="EventCollectorExtra.handle_starttag"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollectorExtra.handle_starttag">[docs]</a>    <span class="k">def</span> <span class="nf">handle_starttag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
        <span class="n">EventCollector</span><span class="o">.</span><span class="n">handle_starttag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;starttag_text&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_starttag_text</span><span class="p">()))</span>

</div></div>
<div class="viewcode-block" id="EventCollectorCharrefs"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollectorCharrefs">[docs]</a><span class="k">class</span> <span class="nc">EventCollectorCharrefs</span><span class="p">(</span><span class="n">EventCollector</span><span class="p">):</span>

<div class="viewcode-block" id="EventCollectorCharrefs.get_events"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollectorCharrefs.get_events">[docs]</a>    <span class="k">def</span> <span class="nf">get_events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span>
</div>
<div class="viewcode-block" id="EventCollectorCharrefs.handle_charref"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollectorCharrefs.handle_charref">[docs]</a>    <span class="k">def</span> <span class="nf">handle_charref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&#39;This should never be called with convert_charrefs=True&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EventCollectorCharrefs.handle_entityref"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.EventCollectorCharrefs.handle_entityref">[docs]</a>    <span class="k">def</span> <span class="nf">handle_entityref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&#39;This should never be called with convert_charrefs=True&#39;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="TestCaseBase"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.TestCaseBase">[docs]</a><span class="k">class</span> <span class="nc">TestCaseBase</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="TestCaseBase.get_collector"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.TestCaseBase.get_collector">[docs]</a>    <span class="k">def</span> <span class="nf">get_collector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</div>
    <span class="k">def</span> <span class="nf">_run_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">expected_events</span><span class="p">,</span> <span class="n">collector</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">collector</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">collector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_collector</span><span class="p">()</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">collector</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">source</span><span class="p">:</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">events</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_events</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">events</span> <span class="o">!=</span> <span class="n">expected_events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;received events did not match expected events&quot;</span> <span class="o">+</span>
                      <span class="s">&quot;</span><span class="se">\n</span><span class="s">Source:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">+</span>
                      <span class="s">&quot;</span><span class="se">\n</span><span class="s">Expected:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">pprint</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span><span class="n">expected_events</span><span class="p">)</span> <span class="o">+</span>
                      <span class="s">&quot;</span><span class="se">\n</span><span class="s">Received:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">pprint</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span><span class="n">events</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_run_check_extra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">events</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span>
                        <span class="n">EventCollectorExtra</span><span class="p">(</span><span class="n">convert_charrefs</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_parse_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">):</span>
            <span class="n">parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_collector</span><span class="p">()</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">HTMLParseError</span><span class="p">):</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertWarns</span><span class="p">(</span><span class="ne">DeprecationWarning</span><span class="p">):</span>
                <span class="n">parse</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase">[docs]</a><span class="k">class</span> <span class="nc">HTMLParserStrictTestCase</span><span class="p">(</span><span class="n">TestCaseBase</span><span class="p">):</span>

<div class="viewcode-block" id="HTMLParserStrictTestCase.get_collector"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.get_collector">[docs]</a>    <span class="k">def</span> <span class="nf">get_collector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">support</span><span class="o">.</span><span class="n">check_warnings</span><span class="p">((</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">),</span> <span class="n">quite</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">EventCollector</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">convert_charrefs</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_processing_instruction_only"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_processing_instruction_only">[docs]</a>    <span class="k">def</span> <span class="nf">test_processing_instruction_only</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;?processing instruction&gt;&quot;</span><span class="p">,</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&quot;pi&quot;</span><span class="p">,</span> <span class="s">&quot;processing instruction&quot;</span><span class="p">),</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;?processing instruction ?&gt;&quot;</span><span class="p">,</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&quot;pi&quot;</span><span class="p">,</span> <span class="s">&quot;processing instruction ?&quot;</span><span class="p">),</span>
            <span class="p">])</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_simple_html"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_simple_html">[docs]</a>    <span class="k">def</span> <span class="nf">test_simple_html</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">&lt;!DOCTYPE html PUBLIC &#39;foo&#39;&gt;</span>
<span class="s">&lt;HTML&gt;&amp;entity;&amp;#32;</span>
<span class="s">&lt;!--comment1a</span>
<span class="s">-&gt;&lt;/foo&gt;&lt;bar&gt;&amp;lt;&lt;?pi?&gt;&lt;/foo&lt;bar</span>
<span class="s">comment1b--&gt;</span>
<span class="s">&lt;Img sRc=&#39;Bar&#39; isMAP&gt;sample</span>
<span class="s">text</span>
<span class="s">&amp;#x201C;</span>
<span class="s">&lt;!--comment2a-- --comment2b--&gt;</span>
<span class="s">&lt;/Html&gt;</span>
<span class="s">&quot;&quot;&quot;</span><span class="p">,</span> <span class="p">[</span>
    <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;decl&quot;</span><span class="p">,</span> <span class="s">&quot;DOCTYPE html PUBLIC &#39;foo&#39;&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;html&quot;</span><span class="p">,</span> <span class="p">[]),</span>
    <span class="p">(</span><span class="s">&quot;entityref&quot;</span><span class="p">,</span> <span class="s">&quot;entity&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;charref&quot;</span><span class="p">,</span> <span class="s">&quot;32&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;comment&quot;</span><span class="p">,</span> <span class="s">&quot;comment1a</span><span class="se">\n</span><span class="s">-&gt;&lt;/foo&gt;&lt;bar&gt;&amp;lt;&lt;?pi?&gt;&lt;/foo&lt;bar</span><span class="se">\n</span><span class="s">comment1b&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;img&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;src&quot;</span><span class="p">,</span> <span class="s">&quot;Bar&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;ismap&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]),</span>
    <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;sample</span><span class="se">\n</span><span class="s">text</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;charref&quot;</span><span class="p">,</span> <span class="s">&quot;x201C&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;comment&quot;</span><span class="p">,</span> <span class="s">&quot;comment2a-- --comment2b&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;endtag&quot;</span><span class="p">,</span> <span class="s">&quot;html&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">),</span>
    <span class="p">])</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_malformatted_charref"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_malformatted_charref">[docs]</a>    <span class="k">def</span> <span class="nf">test_malformatted_charref</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;p&gt;&amp;#bad;&lt;/p&gt;&quot;</span><span class="p">,</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;p&quot;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;&amp;#bad;&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&quot;endtag&quot;</span><span class="p">,</span> <span class="s">&quot;p&quot;</span><span class="p">),</span>
        <span class="p">])</span>
        <span class="c"># add the [] as a workaround to avoid buffering (see #20288)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;div&gt;&amp;#bad;&lt;/div&gt;&quot;</span><span class="p">],</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;div&quot;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;&amp;#bad;&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&quot;endtag&quot;</span><span class="p">,</span> <span class="s">&quot;div&quot;</span><span class="p">),</span>
        <span class="p">])</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_unclosed_entityref"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_unclosed_entityref">[docs]</a>    <span class="k">def</span> <span class="nf">test_unclosed_entityref</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&amp;entityref foo&quot;</span><span class="p">,</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&quot;entityref&quot;</span><span class="p">,</span> <span class="s">&quot;entityref&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot; foo&quot;</span><span class="p">),</span>
            <span class="p">])</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_bad_nesting"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_bad_nesting">[docs]</a>    <span class="k">def</span> <span class="nf">test_bad_nesting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Strangely, this *is* supposed to test that overlapping</span>
        <span class="c"># elements are allowed.  HTMLParser is more geared toward</span>
        <span class="c"># lexing the input that parsing the structure.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a&gt;&lt;b&gt;&lt;/a&gt;&lt;/b&gt;&quot;</span><span class="p">,</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&quot;endtag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&quot;endtag&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">),</span>
            <span class="p">])</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_bare_ampersands"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_bare_ampersands">[docs]</a>    <span class="k">def</span> <span class="nf">test_bare_ampersands</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;this text &amp; contains &amp; ampersands &amp;&quot;</span><span class="p">,</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;this text &amp; contains &amp; ampersands &amp;&quot;</span><span class="p">),</span>
            <span class="p">])</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_bare_pointy_brackets"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_bare_pointy_brackets">[docs]</a>    <span class="k">def</span> <span class="nf">test_bare_pointy_brackets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;this &lt; text &gt; contains &lt; bare&gt;pointy&lt; brackets&quot;</span><span class="p">,</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;this &lt; text &gt; contains &lt; bare&gt;pointy&lt; brackets&quot;</span><span class="p">),</span>
            <span class="p">])</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_illegal_declarations"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_illegal_declarations">[docs]</a>    <span class="k">def</span> <span class="nf">test_illegal_declarations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&#39;&lt;!spacer type=&quot;block&quot; height=&quot;25&quot;&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_starttag_end_boundary"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_starttag_end_boundary">[docs]</a>    <span class="k">def</span> <span class="nf">test_starttag_end_boundary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&quot;&quot;&lt;a b=&#39;&lt;&#39;&gt;&quot;&quot;&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;&quot;</span><span class="p">)])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&quot;&quot;&lt;a b=&#39;&gt;&#39;&gt;&quot;&quot;&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;&gt;&quot;</span><span class="p">)])])</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_buffer_artefacts"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_buffer_artefacts">[docs]</a>    <span class="k">def</span> <span class="nf">test_buffer_artefacts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;&quot;</span><span class="p">)])]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;a b=&#39;&lt;&#39;&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;a &quot;</span><span class="p">,</span> <span class="s">&quot;b=&#39;&lt;&#39;&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;a b&quot;</span><span class="p">,</span> <span class="s">&quot;=&#39;&lt;&#39;&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;a b=&quot;</span><span class="p">,</span> <span class="s">&quot;&#39;&lt;&#39;&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;a b=&#39;&lt;&quot;</span><span class="p">,</span> <span class="s">&quot;&#39;&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;a b=&#39;&lt;&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;&gt;&quot;</span><span class="p">)])]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;a b=&#39;&gt;&#39;&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;a &quot;</span><span class="p">,</span> <span class="s">&quot;b=&#39;&gt;&#39;&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;a b&quot;</span><span class="p">,</span> <span class="s">&quot;=&#39;&gt;&#39;&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;a b=&quot;</span><span class="p">,</span> <span class="s">&quot;&#39;&gt;&#39;&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;a b=&#39;&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;&#39;&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;a b=&#39;&gt;&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;comment&quot;</span><span class="p">,</span> <span class="s">&quot;abc&quot;</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;!--abc--&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s">&quot;!--abc--&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;!&quot;</span><span class="p">,</span> <span class="s">&quot;--abc--&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;!-&quot;</span><span class="p">,</span> <span class="s">&quot;-abc--&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;!--&quot;</span><span class="p">,</span> <span class="s">&quot;abc--&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;!--a&quot;</span><span class="p">,</span> <span class="s">&quot;bc--&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;!--ab&quot;</span><span class="p">,</span> <span class="s">&quot;c--&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;!--abc&quot;</span><span class="p">,</span> <span class="s">&quot;--&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;!--abc-&quot;</span><span class="p">,</span> <span class="s">&quot;-&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;!--abc--&quot;</span><span class="p">,</span> <span class="s">&quot;&gt;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">([</span><span class="s">&quot;&lt;!--abc--&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_starttag_junk_chars"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_starttag_junk_chars">[docs]</a>    <span class="k">def</span> <span class="nf">test_starttag_junk_chars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;/&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;/$&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;/&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;/a&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;a&lt;a&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;/a&lt;a&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;a&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;a foo=&#39;bar&#39;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;a foo=&#39;bar&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;a foo=&#39;&gt;&#39;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;a foo=&#39;&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;a$&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;a$b&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;a$b/&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;a$b  &gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;a$b  /&gt;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_valid_doctypes"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_valid_doctypes">[docs]</a>    <span class="k">def</span> <span class="nf">test_valid_doctypes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># from http://www.w3.org/QA/2002/04/valid-dtd-list.html</span>
        <span class="n">dtds</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;HTML&#39;</span><span class="p">,</span>  <span class="c"># HTML5 doctype</span>
                <span class="p">(</span><span class="s">&#39;HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot; &#39;</span>
                 <span class="s">&#39;&quot;http://www.w3.org/TR/html4/strict.dtd&quot;&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &#39;</span>
                 <span class="s">&#39;&quot;http://www.w3.org/TR/html4/loose.dtd&quot;&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &#39;</span>
                 <span class="s">&#39;&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Frameset//EN&quot; &#39;</span>
                 <span class="s">&#39;&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd&quot;&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;math PUBLIC &quot;-//W3C//DTD MathML 2.0//EN&quot; &#39;</span>
                 <span class="s">&#39;&quot;http://www.w3.org/Math/DTD/mathml2/mathml2.dtd&quot;&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;html PUBLIC &quot;-//W3C//DTD &#39;</span>
                 <span class="s">&#39;XHTML 1.1 plus MathML 2.0 plus SVG 1.1//EN&quot; &#39;</span>
                 <span class="s">&#39;&quot;http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg.dtd&quot;&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot; &#39;</span>
                 <span class="s">&#39;&quot;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&quot;&#39;</span><span class="p">),</span>
                <span class="s">&#39;html PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&#39;</span><span class="p">,</span>
                <span class="s">&#39;html PUBLIC &quot;-//W3C//DTD HTML 3.2 Final//EN&quot;&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">dtd</span> <span class="ow">in</span> <span class="n">dtds</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;!DOCTYPE </span><span class="si">%s</span><span class="s">&gt;&quot;</span> <span class="o">%</span> <span class="n">dtd</span><span class="p">,</span>
                            <span class="p">[(</span><span class="s">&#39;decl&#39;</span><span class="p">,</span> <span class="s">&#39;DOCTYPE &#39;</span> <span class="o">+</span> <span class="n">dtd</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_declaration_junk_chars"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_declaration_junk_chars">[docs]</a>    <span class="k">def</span> <span class="nf">test_declaration_junk_chars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_error</span><span class="p">(</span><span class="s">&quot;&lt;!DOCTYPE foo $ &gt;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_startendtag"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_startendtag">[docs]</a>    <span class="k">def</span> <span class="nf">test_startendtag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;p/&gt;&quot;</span><span class="p">,</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&quot;startendtag&quot;</span><span class="p">,</span> <span class="s">&quot;p&quot;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;p&gt;&lt;/p&gt;&quot;</span><span class="p">,</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;p&quot;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&quot;endtag&quot;</span><span class="p">,</span> <span class="s">&quot;p&quot;</span><span class="p">),</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;p&gt;&lt;img src=&#39;foo&#39; /&gt;&lt;/p&gt;&quot;</span><span class="p">,</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;p&quot;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&quot;startendtag&quot;</span><span class="p">,</span> <span class="s">&quot;img&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;src&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&quot;endtag&quot;</span><span class="p">,</span> <span class="s">&quot;p&quot;</span><span class="p">),</span>
            <span class="p">])</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_get_starttag_text"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_get_starttag_text">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_starttag_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;&lt;foo:bar   </span><span class="se">\n</span><span class="s">   one=&quot;1&quot;</span><span class="se">\t</span><span class="s">two=2   &gt;&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check_extra</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;foo:bar&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;one&quot;</span><span class="p">,</span> <span class="s">&quot;1&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;two&quot;</span><span class="p">,</span> <span class="s">&quot;2&quot;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&quot;starttag_text&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_cdata_content"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_cdata_content">[docs]</a>    <span class="k">def</span> <span class="nf">test_cdata_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s">&#39;&lt;!-- not a comment --&gt; &amp;not-an-entity-ref;&#39;</span><span class="p">,</span>
            <span class="s">&quot;&lt;not a=&#39;start tag&#39;&gt;&quot;</span><span class="p">,</span>
            <span class="s">&#39;&lt;a href=&quot;&quot; /&gt; &lt;p&gt; &lt;span&gt;&lt;/span&gt;&#39;</span><span class="p">,</span>
            <span class="s">&#39;foo = &quot;&lt;/scr&quot; + &quot;ipt&gt;&quot;;&#39;</span><span class="p">,</span>
            <span class="s">&#39;foo = &quot;&lt;/SCRIPT&quot; + &quot;&gt;&quot;;&#39;</span><span class="p">,</span>
            <span class="s">&#39;foo = &lt;</span><span class="se">\n</span><span class="s">/script&gt; &#39;</span><span class="p">,</span>
            <span class="s">&#39;&lt;!-- document.write(&quot;&lt;/scr&quot; + &quot;ipt&gt;&quot;); --&gt;&#39;</span><span class="p">,</span>
            <span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">//&lt;![CDATA[</span><span class="se">\n</span><span class="s">&#39;</span>
             <span class="s">&#39;document.write(</span><span class="se">\&#39;</span><span class="s">&lt;s</span><span class="se">\&#39;</span><span class="s">+</span><span class="se">\&#39;</span><span class="s">cript type=&quot;text/javascript&quot; &#39;</span>
             <span class="s">&#39;src=&quot;http://www.example.org/r=</span><span class="se">\&#39;</span><span class="s">+new &#39;</span>
             <span class="s">&#39;Date().getTime()+</span><span class="se">\&#39;</span><span class="s">&quot;&gt;&lt;</span><span class="se">\\</span><span class="s">/s</span><span class="se">\&#39;</span><span class="s">+</span><span class="se">\&#39;</span><span class="s">cript&gt;</span><span class="se">\&#39;</span><span class="s">);</span><span class="se">\n</span><span class="s">//]]&gt;&#39;</span><span class="p">),</span>
            <span class="s">&#39;</span><span class="se">\n</span><span class="s">&lt;!-- //</span><span class="se">\n</span><span class="s">var foo = 3.14;</span><span class="se">\n</span><span class="s">// --&gt;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
            <span class="s">&#39;foo = &quot;&lt;/sty&quot; + &quot;le&gt;&quot;;&#39;</span><span class="p">,</span>
            <span class="s">&#39;&lt;!-- </span><span class="se">\u2603</span><span class="s"> --&gt;&#39;</span><span class="p">,</span>
            <span class="c"># these two should be invalid according to the HTML 5 spec,</span>
            <span class="c"># section 8.1.2.2</span>
            <span class="c">#&#39;foo = &lt;/\nscript&gt;&#39;,</span>
            <span class="c">#&#39;foo = &lt;/ script&gt;&#39;,</span>
        <span class="p">]</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;script&#39;</span><span class="p">,</span> <span class="s">&#39;style&#39;</span><span class="p">,</span> <span class="s">&#39;SCRIPT&#39;</span><span class="p">,</span> <span class="s">&#39;STYLE&#39;</span><span class="p">,</span> <span class="s">&#39;Script&#39;</span><span class="p">,</span> <span class="s">&#39;Style&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">contents</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
                <span class="n">element_lower</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;&lt;{element}&gt;{content}&lt;/{element}&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="n">element</span><span class="p">,</span>
                                                               <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="n">element_lower</span><span class="p">,</span> <span class="p">[]),</span>
                                    <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="n">content</span><span class="p">),</span>
                                    <span class="p">(</span><span class="s">&quot;endtag&quot;</span><span class="p">,</span> <span class="n">element_lower</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_cdata_with_closing_tags"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_cdata_with_closing_tags">[docs]</a>    <span class="k">def</span> <span class="nf">test_cdata_with_closing_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># see issue #13358</span>
        <span class="c"># make sure that HTMLParser calls handle_data only once for each CDATA.</span>
        <span class="c"># The normal event collector normalizes  the events in get_events,</span>
        <span class="c"># so we override it to return the original list of events.</span>
        <span class="k">class</span> <span class="nc">Collector</span><span class="p">(</span><span class="n">EventCollector</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">get_events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span>

        <span class="n">content</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;&lt;!-- not a comment --&gt; &amp;not-an-entity-ref;</span>
<span class="s">                  &lt;a href=&quot;&quot; /&gt; &lt;/p&gt;&lt;p&gt; &lt;span&gt;&lt;/span&gt;&lt;/style&gt;</span>
<span class="s">                  &#39;&lt;/script&#39; + &#39;&gt;&#39;&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39; script&#39;</span><span class="p">,</span> <span class="s">&#39;script &#39;</span><span class="p">,</span> <span class="s">&#39; script &#39;</span><span class="p">,</span>
                        <span class="s">&#39;</span><span class="se">\n</span><span class="s">script&#39;</span><span class="p">,</span> <span class="s">&#39;script</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">script</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">]:</span>
            <span class="n">element_lower</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;&lt;script&gt;{content}&lt;/{element}&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="n">element</span><span class="p">,</span>
                                                       <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="n">element_lower</span><span class="p">,</span> <span class="p">[]),</span>
                                <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="n">content</span><span class="p">),</span>
                                <span class="p">(</span><span class="s">&quot;endtag&quot;</span><span class="p">,</span> <span class="n">element_lower</span><span class="p">)],</span>
                            <span class="n">collector</span><span class="o">=</span><span class="n">Collector</span><span class="p">(</span><span class="n">convert_charrefs</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_comments"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_comments">[docs]</a>    <span class="k">def</span> <span class="nf">test_comments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">html</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;&lt;!-- I&#39;m a valid comment --&gt;&quot;</span>
                <span class="s">&#39;&lt;!--me too!--&gt;&#39;</span>
                <span class="s">&#39;&lt;!------&gt;&#39;</span>
                <span class="s">&#39;&lt;!----&gt;&#39;</span>
                <span class="s">&#39;&lt;!----I have many hyphens----&gt;&#39;</span>
                <span class="s">&#39;&lt;!-- I have a &gt; in the middle --&gt;&#39;</span>
                <span class="s">&#39;&lt;!-- and I have -- in the middle! --&gt;&#39;</span><span class="p">)</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&quot; I&#39;m a valid comment &quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39;me too!&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39;--&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39;--I have many hyphens--&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39; I have a &gt; in the middle &#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39; and I have -- in the middle! &#39;</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_condcoms"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_condcoms">[docs]</a>    <span class="k">def</span> <span class="nf">test_condcoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">html</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;&lt;!--[if IE &amp; !(lte IE 8)]&gt;aren</span><span class="se">\&#39;</span><span class="s">t&lt;![endif]--&gt;&#39;</span>
                <span class="s">&#39;&lt;!--[if IE 8]&gt;condcoms&lt;![endif]--&gt;&#39;</span>
                <span class="s">&#39;&lt;!--[if lte IE 7]&gt;pretty?&lt;![endif]--&gt;&#39;</span><span class="p">)</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&quot;[if IE &amp; !(lte IE 8)]&gt;aren&#39;t&lt;![endif]&quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39;[if IE 8]&gt;condcoms&lt;![endif]&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39;[if lte IE 7]&gt;pretty?&lt;![endif]&#39;</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserStrictTestCase.test_convert_charrefs"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserStrictTestCase.test_convert_charrefs">[docs]</a>    <span class="k">def</span> <span class="nf">test_convert_charrefs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">collector</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">EventCollectorCharrefs</span><span class="p">(</span><span class="n">convert_charrefs</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">collector</span><span class="p">()</span><span class="o">.</span><span class="n">convert_charrefs</span><span class="p">)</span>
        <span class="n">charrefs</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;&amp;quot;&#39;</span><span class="p">,</span> <span class="s">&#39;&amp;#34;&#39;</span><span class="p">,</span> <span class="s">&#39;&amp;#x22;&#39;</span><span class="p">,</span> <span class="s">&#39;&amp;quot&#39;</span><span class="p">,</span> <span class="s">&#39;&amp;#34&#39;</span><span class="p">,</span> <span class="s">&#39;&amp;#x22&#39;</span><span class="p">]</span>
        <span class="c"># check charrefs in the middle of the text/attributes</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;href&#39;</span><span class="p">,</span> <span class="s">&#39;foo&quot;zar&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;a&quot;z&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">charref</span> <span class="ow">in</span> <span class="n">charrefs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&#39;&lt;a href=&quot;foo{0}zar&quot;&gt;a{0}z&lt;/a&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">charref</span><span class="p">),</span>
                            <span class="n">expected</span><span class="p">,</span> <span class="n">collector</span><span class="o">=</span><span class="n">collector</span><span class="p">())</span>
        <span class="c"># check charrefs at the beginning/end of the text/attributes</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;X&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="s">&#39;X&quot;&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">charref</span> <span class="ow">in</span> <span class="n">charrefs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&#39;{0}&lt;a x=&quot;{0}&quot; y=&quot;{0}X&quot; z=&quot;X{0}&quot;&gt;&#39;</span>
                            <span class="s">&#39;{0}&lt;/a&gt;{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">charref</span><span class="p">),</span>
                            <span class="n">expected</span><span class="p">,</span> <span class="n">collector</span><span class="o">=</span><span class="n">collector</span><span class="p">())</span>
        <span class="c"># check charrefs in &lt;script&gt;/&lt;style&gt; elements</span>
        <span class="k">for</span> <span class="n">charref</span> <span class="ow">in</span> <span class="n">charrefs</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s">&#39;X&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">charref</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">expected</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;script&#39;</span><span class="p">,</span> <span class="p">[]),</span> <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">),</span>
                        <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;script&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;style&#39;</span><span class="p">,</span> <span class="p">[]),</span> <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">),</span>
                        <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;style&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&#39;{1}&lt;script&gt;{0}&lt;/script&gt;{1}&#39;</span>
                            <span class="s">&#39;&lt;style&gt;{0}&lt;/style&gt;{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">charref</span><span class="p">),</span>
                            <span class="n">expected</span><span class="p">,</span> <span class="n">collector</span><span class="o">=</span><span class="n">collector</span><span class="p">())</span>
        <span class="c"># check truncated charrefs at the end of the file</span>
        <span class="n">html</span> <span class="o">=</span> <span class="s">&#39;&amp;quo &amp;# &amp;#x&#39;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">html</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">html</span><span class="p">[:</span><span class="n">x</span><span class="p">],</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="n">html</span><span class="p">[:</span><span class="n">x</span><span class="p">])],</span>
                            <span class="n">collector</span><span class="o">=</span><span class="n">collector</span><span class="p">())</span>
        <span class="c"># check a string with no charrefs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&#39;no charrefs here&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;no charrefs here&#39;</span><span class="p">)],</span>
                        <span class="n">collector</span><span class="o">=</span><span class="n">collector</span><span class="p">())</span>

</div></div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase">[docs]</a><span class="k">class</span> <span class="nc">HTMLParserTolerantTestCase</span><span class="p">(</span><span class="n">HTMLParserStrictTestCase</span><span class="p">):</span>

<div class="viewcode-block" id="HTMLParserTolerantTestCase.get_collector"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.get_collector">[docs]</a>    <span class="k">def</span> <span class="nf">get_collector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">EventCollector</span><span class="p">(</span><span class="n">convert_charrefs</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_deprecation_warnings"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_deprecation_warnings">[docs]</a>    <span class="k">def</span> <span class="nf">test_deprecation_warnings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertWarns</span><span class="p">(</span><span class="ne">DeprecationWarning</span><span class="p">):</span>
            <span class="n">EventCollector</span><span class="p">()</span>  <span class="c"># convert_charrefs not passed explicitly</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertWarns</span><span class="p">(</span><span class="ne">DeprecationWarning</span><span class="p">):</span>
            <span class="n">EventCollector</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertWarns</span><span class="p">(</span><span class="ne">DeprecationWarning</span><span class="p">):</span>
            <span class="n">EventCollector</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">HTMLParseError</span><span class="p">):</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertWarns</span><span class="p">(</span><span class="ne">DeprecationWarning</span><span class="p">):</span>
                <span class="n">EventCollector</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&#39;test&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_tolerant_parsing"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_tolerant_parsing">[docs]</a>    <span class="k">def</span> <span class="nf">test_tolerant_parsing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&#39;&lt;html &lt;html&gt;te&gt;&gt;xt&amp;a&lt;&lt;bc&lt;/a&gt;&lt;/html&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
                        <span class="s">&#39;&lt;img src=&quot;URL&gt;&lt;//img&gt;&lt;/html&lt;/html&gt;&#39;</span><span class="p">,</span> <span class="p">[</span>
                            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;html&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;&lt;html&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]),</span>
                            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;te&gt;&gt;xt&#39;</span><span class="p">),</span>
                            <span class="p">(</span><span class="s">&#39;entityref&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span>
                            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;&#39;</span><span class="p">),</span>
                            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;bc&lt;&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]),</span>
                            <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;html&#39;</span><span class="p">),</span>
                            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&lt;img src=&quot;URL&gt;&#39;</span><span class="p">),</span>
                            <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39;/img&#39;</span><span class="p">),</span>
                            <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;html&lt;&#39;</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_starttag_junk_chars"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_starttag_junk_chars">[docs]</a>    <span class="k">def</span> <span class="nf">test_starttag_junk_chars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;/&gt;&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;/$&gt;&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39;$&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;/&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;/&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;/a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;/a&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a&lt;a&gt;&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;a&lt;a&#39;</span><span class="p">,</span> <span class="p">[])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;/a&lt;a&gt;&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;a&lt;a&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;!&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;!&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;a&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a foo=&#39;bar&#39;&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&quot;&lt;a foo=&#39;bar&#39;&quot;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a foo=&#39;bar&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&quot;&lt;a foo=&#39;bar&quot;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a foo=&#39;&gt;&#39;&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&quot;&lt;a foo=&#39;&gt;&#39;&quot;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a foo=&#39;&gt;&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&quot;&lt;a foo=&#39;&gt;&quot;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a$&gt;&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;a$&#39;</span><span class="p">,</span> <span class="p">[])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a$b&gt;&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;a$b&#39;</span><span class="p">,</span> <span class="p">[])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a$b/&gt;&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;startendtag&#39;</span><span class="p">,</span> <span class="s">&#39;a$b&#39;</span><span class="p">,</span> <span class="p">[])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a$b  &gt;&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;a$b&#39;</span><span class="p">,</span> <span class="p">[])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a$b  /&gt;&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;startendtag&#39;</span><span class="p">,</span> <span class="s">&#39;a$b&#39;</span><span class="p">,</span> <span class="p">[])])</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_slashes_in_starttag"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_slashes_in_starttag">[docs]</a>    <span class="k">def</span> <span class="nf">test_slashes_in_starttag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&#39;&lt;a foo=&quot;var&quot;/&gt;&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;startendtag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;var&#39;</span><span class="p">)])])</span>
        <span class="n">html</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;&lt;img width=902 height=250px &#39;</span>
                <span class="s">&#39;src=&quot;/sites/default/files/images/homepage/foo.jpg&quot; &#39;</span>
                <span class="s">&#39;/*what am I doing here*/ /&gt;&#39;</span><span class="p">)</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[(</span>
            <span class="s">&#39;startendtag&#39;</span><span class="p">,</span> <span class="s">&#39;img&#39;</span><span class="p">,</span>
            <span class="p">[(</span><span class="s">&#39;width&#39;</span><span class="p">,</span> <span class="s">&#39;902&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;height&#39;</span><span class="p">,</span> <span class="s">&#39;250px&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;src&#39;</span><span class="p">,</span> <span class="s">&#39;/sites/default/files/images/homepage/foo.jpg&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;*what&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;am&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;doing&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;here*&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span>
        <span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;&lt;a / /foo/ / /=/ / /bar/ / /&gt;&#39;</span>
                <span class="s">&#39;&lt;a / /foo/ / /=/ / /bar/ / &gt;&#39;</span><span class="p">)</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;startendtag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;=&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;bar&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;=&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;bar&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)])</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
        <span class="c">#see issue #14538</span>
        <span class="n">html</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;&lt;meta&gt;&lt;meta / &gt;&lt;meta // &gt;&lt;meta / / &gt;&#39;</span>
                <span class="s">&#39;&lt;meta/&gt;&lt;meta /&gt;&lt;meta //&gt;&lt;meta//&gt;&#39;</span><span class="p">)</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;meta&#39;</span><span class="p">,</span> <span class="p">[]),</span> <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;meta&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;meta&#39;</span><span class="p">,</span> <span class="p">[]),</span> <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;meta&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&#39;startendtag&#39;</span><span class="p">,</span> <span class="s">&#39;meta&#39;</span><span class="p">,</span> <span class="p">[]),</span> <span class="p">(</span><span class="s">&#39;startendtag&#39;</span><span class="p">,</span> <span class="s">&#39;meta&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&#39;startendtag&#39;</span><span class="p">,</span> <span class="s">&#39;meta&#39;</span><span class="p">,</span> <span class="p">[]),</span> <span class="p">(</span><span class="s">&#39;startendtag&#39;</span><span class="p">,</span> <span class="s">&#39;meta&#39;</span><span class="p">,</span> <span class="p">[]),</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_declaration_junk_chars"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_declaration_junk_chars">[docs]</a>    <span class="k">def</span> <span class="nf">test_declaration_junk_chars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;!DOCTYPE foo $ &gt;&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;decl&#39;</span><span class="p">,</span> <span class="s">&#39;DOCTYPE foo $ &#39;</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_illegal_declarations"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_illegal_declarations">[docs]</a>    <span class="k">def</span> <span class="nf">test_illegal_declarations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&#39;&lt;!spacer type=&quot;block&quot; height=&quot;25&quot;&gt;&#39;</span><span class="p">,</span>
                        <span class="p">[(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39;spacer type=&quot;block&quot; height=&quot;25&quot;&#39;</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_with_unquoted_attributes"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_with_unquoted_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">test_with_unquoted_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># see #12008</span>
        <span class="n">html</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;&lt;html&gt;&lt;body bgcolor=d0ca90 text=&#39;181008&#39;&gt;&quot;</span>
                <span class="s">&quot;&lt;table cellspacing=0 cellpadding=1 width=100% &gt;&lt;tr&gt;&quot;</span>
                <span class="s">&quot;&lt;td align=left&gt;&lt;font size=-1&gt;&quot;</span>
                <span class="s">&quot;- &lt;a href=/rabota/&gt;&lt;span class=en&gt; software-and-i&lt;/span&gt;&lt;/a&gt;&quot;</span>
                <span class="s">&quot;- &lt;a href=&#39;/1/&#39;&gt;&lt;span class=en&gt; library&lt;/span&gt;&lt;/a&gt;&lt;/table&gt;&quot;</span><span class="p">)</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;html&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;body&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;bgcolor&#39;</span><span class="p">,</span> <span class="s">&#39;d0ca90&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;181008&#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;table&#39;</span><span class="p">,</span>
                <span class="p">[(</span><span class="s">&#39;cellspacing&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;cellpadding&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;width&#39;</span><span class="p">,</span> <span class="s">&#39;100%&#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;tr&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;td&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;align&#39;</span><span class="p">,</span> <span class="s">&#39;left&#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;font&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;size&#39;</span><span class="p">,</span> <span class="s">&#39;-1&#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;- &#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;href&#39;</span><span class="p">,</span> <span class="s">&#39;/rabota/&#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;span&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;class&#39;</span><span class="p">,</span> <span class="s">&#39;en&#39;</span><span class="p">)]),</span> <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39; software-and-i&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;span&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;- &#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;href&#39;</span><span class="p">,</span> <span class="s">&#39;/1/&#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;span&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;class&#39;</span><span class="p">,</span> <span class="s">&#39;en&#39;</span><span class="p">)]),</span> <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39; library&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;span&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;table&#39;</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_comma_between_attributes"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_comma_between_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">test_comma_between_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&#39;&lt;form action=&quot;/xxx.php?a=1&amp;amp;b=2&amp;amp&quot;, &#39;</span>
                        <span class="s">&#39;method=&quot;post&quot;&gt;&#39;</span><span class="p">,</span> <span class="p">[</span>
                            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;form&#39;</span><span class="p">,</span>
                                <span class="p">[(</span><span class="s">&#39;action&#39;</span><span class="p">,</span> <span class="s">&#39;/xxx.php?a=1&amp;b=2&amp;&#39;</span><span class="p">),</span>
                                 <span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;method&#39;</span><span class="p">,</span> <span class="s">&#39;post&#39;</span><span class="p">)])])</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_weird_chars_in_unquoted_attribute_values"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_weird_chars_in_unquoted_attribute_values">[docs]</a>    <span class="k">def</span> <span class="nf">test_weird_chars_in_unquoted_attribute_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&#39;&lt;form action=bogus|&amp;#()value&gt;&#39;</span><span class="p">,</span> <span class="p">[</span>
                            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;form&#39;</span><span class="p">,</span>
                                <span class="p">[(</span><span class="s">&#39;action&#39;</span><span class="p">,</span> <span class="s">&#39;bogus|&amp;#()value&#39;</span><span class="p">)])])</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_invalid_end_tags"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_invalid_end_tags">[docs]</a>    <span class="k">def</span> <span class="nf">test_invalid_end_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># A collection of broken end tags. &lt;br&gt; is used as separator.</span>
        <span class="c"># see http://www.w3.org/TR/html5/tokenization.html#end-tag-open-state</span>
        <span class="c"># and #13993</span>
        <span class="n">html</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;&lt;br&gt;&lt;/label&lt;/p&gt;&lt;br&gt;&lt;/div end tmAd-leaderBoard&gt;&lt;br&gt;&lt;/&lt;h4&gt;&lt;br&gt;&#39;</span>
                <span class="s">&#39;&lt;/li class=&quot;unit&quot;&gt;&lt;br&gt;&lt;/li</span><span class="se">\r\n\t\t\t\t\t\t</span><span class="s">&lt;/ul&gt;&lt;br&gt;&lt;/&gt;&lt;br&gt;&#39;</span><span class="p">)</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;br&#39;</span><span class="p">,</span> <span class="p">[]),</span>
                    <span class="c"># &lt; is part of the name, / is discarded, p is an attribute</span>
                    <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;label&lt;&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;br&#39;</span><span class="p">,</span> <span class="p">[]),</span>
                    <span class="c"># text and attributes are discarded</span>
                    <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;div&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;br&#39;</span><span class="p">,</span> <span class="p">[]),</span>
                    <span class="c"># comment because the first char after &lt;/ is not a-zA-Z</span>
                    <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;h4&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;br&#39;</span><span class="p">,</span> <span class="p">[]),</span>
                    <span class="c"># attributes are discarded</span>
                    <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;li&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;br&#39;</span><span class="p">,</span> <span class="p">[]),</span>
                    <span class="c"># everything till ul (included) is discarded</span>
                    <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;li&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;br&#39;</span><span class="p">,</span> <span class="p">[]),</span>
                    <span class="c"># &lt;/&gt; is ignored</span>
                    <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;br&#39;</span><span class="p">,</span> <span class="p">[])]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_broken_invalid_end_tag"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_broken_invalid_end_tag">[docs]</a>    <span class="k">def</span> <span class="nf">test_broken_invalid_end_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># This is technically wrong (the &quot;&gt; shouldn&#39;t be included in the &#39;data&#39;)</span>
        <span class="c"># but is probably not worth fixing it (in addition to all the cases of</span>
        <span class="c"># the previous test, it would require a full attribute parsing).</span>
        <span class="c"># see #13993</span>
        <span class="n">html</span> <span class="o">=</span> <span class="s">&#39;&lt;b&gt;This&lt;/b attr=&quot;&gt;&quot;&gt; confuses the parser&#39;</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="p">[]),</span>
                    <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;This&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;&gt; confuses the parser&#39;</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_correct_detection_of_start_tags"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_correct_detection_of_start_tags">[docs]</a>    <span class="k">def</span> <span class="nf">test_correct_detection_of_start_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># see #13273</span>
        <span class="n">html</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;&lt;div style=&quot;&quot;    &gt;&lt;b&gt;The &lt;a href=&quot;some_url&quot;&gt;rain&lt;/a&gt; &#39;</span>
                <span class="s">&#39;&lt;br /&gt; in &lt;span&gt;Spain&lt;/span&gt;&lt;/b&gt;&lt;/div&gt;&#39;</span><span class="p">)</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;div&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;style&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;The &#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;href&#39;</span><span class="p">,</span> <span class="s">&#39;some_url&#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;rain&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;startendtag&#39;</span><span class="p">,</span> <span class="s">&#39;br&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39; in &#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;span&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;Spain&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;span&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;div&#39;</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>

        <span class="n">html</span> <span class="o">=</span> <span class="s">&#39;&lt;div style=&quot;&quot;, foo = &quot;bar&quot; &gt;&lt;b&gt;The &lt;a href=&quot;some_url&quot;&gt;rain&lt;/a&gt;&#39;</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;div&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;style&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;The &#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;href&#39;</span><span class="p">,</span> <span class="s">&#39;some_url&#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;rain&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_EOF_in_charref"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_EOF_in_charref">[docs]</a>    <span class="k">def</span> <span class="nf">test_EOF_in_charref</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># see #17802</span>
        <span class="c"># This test checks that the UnboundLocalError reported in the issue</span>
        <span class="c"># is not raised, however I&#39;m not sure the returned values are correct.</span>
        <span class="c"># Maybe HTMLParser should use self.unescape for these</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;a&amp;&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;a&amp;&#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;a&amp;b&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;ab&#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;a&amp;b &#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;entityref&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;a&amp;b;&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;entityref&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">)]),</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">html</span><span class="p">,</span> <span class="n">expected</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_unescape_method"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_unescape_method">[docs]</a>    <span class="k">def</span> <span class="nf">test_unescape_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">html</span> <span class="kn">import</span> <span class="n">unescape</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_collector</span><span class="p">()</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertWarns</span><span class="p">(</span><span class="ne">DeprecationWarning</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;&amp;quot;&amp;#34;&amp;#x22;&amp;quot&amp;#34&amp;#x22&amp;#bad;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">unescape</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">unescape</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_broken_comments"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_broken_comments">[docs]</a>    <span class="k">def</span> <span class="nf">test_broken_comments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">html</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;&lt;! not really a comment &gt;&#39;</span>
                <span class="s">&#39;&lt;! not a comment either --&gt;&#39;</span>
                <span class="s">&#39;&lt;! -- close enough --&gt;&#39;</span>
                <span class="s">&#39;&lt;!&gt;&lt;!&lt;-- this was an empty comment&gt;&#39;</span>
                <span class="s">&#39;&lt;!!! another bogus comment !!!&gt;&#39;</span><span class="p">)</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39; not really a comment &#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39; not a comment either --&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39; -- close enough --&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;-- this was an empty comment&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39;!! another bogus comment !!!&#39;</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserTolerantTestCase.test_broken_condcoms"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.HTMLParserTolerantTestCase.test_broken_condcoms">[docs]</a>    <span class="k">def</span> <span class="nf">test_broken_condcoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># these condcoms are missing the &#39;--&#39; after &#39;&lt;!&#39; and before the &#39;&gt;&#39;</span>
        <span class="n">html</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;&lt;![if !(IE)]&gt;broken condcom&lt;![endif]&gt;&#39;</span>
                <span class="s">&#39;&lt;![if ! IE]&gt;&lt;link href=&quot;favicon.tiff&quot;/&gt;&lt;![endif]&gt;&#39;</span>
                <span class="s">&#39;&lt;![if !IE 6]&gt;&lt;img src=&quot;firefox.png&quot; /&gt;&lt;![endif]&gt;&#39;</span>
                <span class="s">&#39;&lt;![if !ie 6]&gt;&lt;b&gt;foo&lt;/b&gt;&lt;![endif]&gt;&#39;</span>
                <span class="s">&#39;&lt;![if (!IE)|(lt IE 9)]&gt;&lt;img src=&quot;mammoth.bmp&quot; /&gt;&lt;![endif]&gt;&#39;</span><span class="p">)</span>
        <span class="c"># According to the HTML5 specs sections &quot;8.2.4.44 Bogus comment state&quot;</span>
        <span class="c"># and &quot;8.2.4.45 Markup declaration open state&quot;, comment tokens should</span>
        <span class="c"># be emitted instead of &#39;unknown decl&#39;, but calling unknown_decl</span>
        <span class="c"># provides more flexibility.</span>
        <span class="c"># See also Lib/_markupbase.py:parse_declaration</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;unknown decl&#39;</span><span class="p">,</span> <span class="s">&#39;if !(IE)&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;broken condcom&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;unknown decl&#39;</span><span class="p">,</span> <span class="s">&#39;endif&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;unknown decl&#39;</span><span class="p">,</span> <span class="s">&#39;if ! IE&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;startendtag&#39;</span><span class="p">,</span> <span class="s">&#39;link&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;href&#39;</span><span class="p">,</span> <span class="s">&#39;favicon.tiff&#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;unknown decl&#39;</span><span class="p">,</span> <span class="s">&#39;endif&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;unknown decl&#39;</span><span class="p">,</span> <span class="s">&#39;if !IE 6&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;startendtag&#39;</span><span class="p">,</span> <span class="s">&#39;img&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;src&#39;</span><span class="p">,</span> <span class="s">&#39;firefox.png&#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;unknown decl&#39;</span><span class="p">,</span> <span class="s">&#39;endif&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;unknown decl&#39;</span><span class="p">,</span> <span class="s">&#39;if !ie 6&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;unknown decl&#39;</span><span class="p">,</span> <span class="s">&#39;endif&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;unknown decl&#39;</span><span class="p">,</span> <span class="s">&#39;if (!IE)|(lt IE 9)&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;startendtag&#39;</span><span class="p">,</span> <span class="s">&#39;img&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;src&#39;</span><span class="p">,</span> <span class="s">&#39;mammoth.bmp&#39;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;unknown decl&#39;</span><span class="p">,</span> <span class="s">&#39;endif&#39;</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="AttributesStrictTestCase"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesStrictTestCase">[docs]</a><span class="k">class</span> <span class="nc">AttributesStrictTestCase</span><span class="p">(</span><span class="n">TestCaseBase</span><span class="p">):</span>

<div class="viewcode-block" id="AttributesStrictTestCase.get_collector"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesStrictTestCase.get_collector">[docs]</a>    <span class="k">def</span> <span class="nf">get_collector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">support</span><span class="o">.</span><span class="n">check_warnings</span><span class="p">((</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">),</span> <span class="n">quite</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">EventCollector</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">convert_charrefs</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="AttributesStrictTestCase.test_attr_syntax"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesStrictTestCase.test_attr_syntax">[docs]</a>    <span class="k">def</span> <span class="nf">test_attr_syntax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[</span>
          <span class="p">(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;v&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;v&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;d&quot;</span><span class="p">,</span> <span class="s">&quot;v&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;e&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)])</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&quot;&quot;&lt;a b=&#39;v&#39; c=&quot;v&quot; d=v e&gt;&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&quot;&quot;&lt;a  b = &#39;v&#39; c = &quot;v&quot; d = v e&gt;&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&quot;&quot;&lt;a</span><span class="se">\n</span><span class="s">b</span><span class="se">\n</span><span class="s">=</span><span class="se">\n</span><span class="s">&#39;v&#39;</span><span class="se">\n</span><span class="s">c</span><span class="se">\n</span><span class="s">=</span><span class="se">\n</span><span class="s">&quot;v&quot;</span><span class="se">\n</span><span class="s">d</span><span class="se">\n</span><span class="s">=</span><span class="se">\n</span><span class="s">v</span><span class="se">\n</span><span class="s">e&gt;&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&quot;&quot;&lt;a</span><span class="se">\t</span><span class="s">b</span><span class="se">\t</span><span class="s">=</span><span class="se">\t</span><span class="s">&#39;v&#39;</span><span class="se">\t</span><span class="s">c</span><span class="se">\t</span><span class="s">=</span><span class="se">\t</span><span class="s">&quot;v&quot;</span><span class="se">\t</span><span class="s">d</span><span class="se">\t</span><span class="s">=</span><span class="se">\t</span><span class="s">v</span><span class="se">\t</span><span class="s">e&gt;&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="AttributesStrictTestCase.test_attr_values"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesStrictTestCase.test_attr_values">[docs]</a>    <span class="k">def</span> <span class="nf">test_attr_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&quot;&quot;&lt;a b=&#39;xxx</span><span class="se">\n\t</span><span class="s">xxx&#39; c=&quot;yyy</span><span class="se">\t\n</span><span class="s">yyy&quot; d=&#39;</span><span class="se">\t</span><span class="s">xyz</span><span class="se">\n</span><span class="s">&#39;&gt;&quot;&quot;&quot;</span><span class="p">,</span>
                        <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;xxx</span><span class="se">\n\t</span><span class="s">xxx&quot;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;yyy</span><span class="se">\t\n</span><span class="s">yyy&quot;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s">&quot;d&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">xyz</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&quot;&quot;&lt;a b=&#39;&#39; c=&quot;&quot;&gt;&quot;&quot;&quot;</span><span class="p">,</span>
                        <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)])])</span>
        <span class="c"># Regression test for SF patch #669683.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;e a=rgb(1,2,3)&gt;&quot;</span><span class="p">,</span>
                        <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;e&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;rgb(1,2,3)&quot;</span><span class="p">)])])</span>
        <span class="c"># Regression test for SF bug #921657.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span>
            <span class="s">&quot;&lt;a href=mailto:xyz@example.com&gt;&quot;</span><span class="p">,</span>
            <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;href&quot;</span><span class="p">,</span> <span class="s">&quot;mailto:xyz@example.com&quot;</span><span class="p">)])])</span>
</div>
<div class="viewcode-block" id="AttributesStrictTestCase.test_attr_nonascii"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesStrictTestCase.test_attr_nonascii">[docs]</a>    <span class="k">def</span> <span class="nf">test_attr_nonascii</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># see issue 7311</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span>
            <span class="s">&quot;&lt;img src=/foo/bar.png alt=</span><span class="se">\u4e2d\u6587</span><span class="s">&gt;&quot;</span><span class="p">,</span>
            <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;img&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;src&quot;</span><span class="p">,</span> <span class="s">&quot;/foo/bar.png&quot;</span><span class="p">),</span>
                                  <span class="p">(</span><span class="s">&quot;alt&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\u4e2d\u6587</span><span class="s">&quot;</span><span class="p">)])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span>
            <span class="s">&quot;&lt;a title=&#39;</span><span class="se">\u30c6\u30b9\u30c8</span><span class="s">&#39; href=&#39;</span><span class="se">\u30c6\u30b9\u30c8</span><span class="s">.html&#39;&gt;&quot;</span><span class="p">,</span>
            <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;title&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\u30c6\u30b9\u30c8</span><span class="s">&quot;</span><span class="p">),</span>
                                <span class="p">(</span><span class="s">&quot;href&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\u30c6\u30b9\u30c8</span><span class="s">.html&quot;</span><span class="p">)])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span>
            <span class="s">&#39;&lt;a title=&quot;</span><span class="se">\u30c6\u30b9\u30c8</span><span class="s">&quot; href=&quot;</span><span class="se">\u30c6\u30b9\u30c8</span><span class="s">.html&quot;&gt;&#39;</span><span class="p">,</span>
            <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;title&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\u30c6\u30b9\u30c8</span><span class="s">&quot;</span><span class="p">),</span>
                                <span class="p">(</span><span class="s">&quot;href&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\u30c6\u30b9\u30c8</span><span class="s">.html&quot;</span><span class="p">)])])</span>
</div>
<div class="viewcode-block" id="AttributesStrictTestCase.test_attr_entity_replacement"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesStrictTestCase.test_attr_entity_replacement">[docs]</a>    <span class="k">def</span> <span class="nf">test_attr_entity_replacement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span>
            <span class="s">&quot;&lt;a b=&#39;&amp;amp;&amp;gt;&amp;lt;&amp;quot;&amp;apos;&#39;&gt;&quot;</span><span class="p">,</span>
            <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;&amp;&gt;&lt;</span><span class="se">\&quot;</span><span class="s">&#39;&quot;</span><span class="p">)])])</span>
</div>
<div class="viewcode-block" id="AttributesStrictTestCase.test_attr_funky_names"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesStrictTestCase.test_attr_funky_names">[docs]</a>    <span class="k">def</span> <span class="nf">test_attr_funky_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span>
            <span class="s">&quot;&lt;a a.b=&#39;v&#39; c:d=v e-f=v&gt;&quot;</span><span class="p">,</span>
            <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;a.b&quot;</span><span class="p">,</span> <span class="s">&quot;v&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;c:d&quot;</span><span class="p">,</span> <span class="s">&quot;v&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;e-f&quot;</span><span class="p">,</span> <span class="s">&quot;v&quot;</span><span class="p">)])])</span>
</div>
<div class="viewcode-block" id="AttributesStrictTestCase.test_entityrefs_in_attributes"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesStrictTestCase.test_entityrefs_in_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">test_entityrefs_in_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span>
            <span class="s">&quot;&lt;html foo=&#39;&amp;euro;&amp;amp;&amp;#97;&amp;#x61;&amp;unsupported;&#39;&gt;&quot;</span><span class="p">,</span>
            <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;html&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\u20AC</span><span class="s">&amp;aa&amp;unsupported;&quot;</span><span class="p">)])])</span>


</div></div>
<div class="viewcode-block" id="AttributesTolerantTestCase"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesTolerantTestCase">[docs]</a><span class="k">class</span> <span class="nc">AttributesTolerantTestCase</span><span class="p">(</span><span class="n">AttributesStrictTestCase</span><span class="p">):</span>

<div class="viewcode-block" id="AttributesTolerantTestCase.get_collector"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesTolerantTestCase.get_collector">[docs]</a>    <span class="k">def</span> <span class="nf">get_collector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">EventCollector</span><span class="p">(</span><span class="n">convert_charrefs</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="AttributesTolerantTestCase.test_attr_funky_names2"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesTolerantTestCase.test_attr_funky_names2">[docs]</a>    <span class="k">def</span> <span class="nf">test_attr_funky_names2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span>
            <span class="s">&quot;&lt;a $&gt;&lt;b $=%&gt;&lt;c \=/&gt;&quot;</span><span class="p">,</span>
            <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;$&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]),</span>
             <span class="p">(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;$&quot;</span><span class="p">,</span> <span class="s">&quot;%&quot;</span><span class="p">)]),</span>
             <span class="p">(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&quot;/&quot;</span><span class="p">)])])</span>
</div>
<div class="viewcode-block" id="AttributesTolerantTestCase.test_entities_in_attribute_value"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesTolerantTestCase.test_entities_in_attribute_value">[docs]</a>    <span class="k">def</span> <span class="nf">test_entities_in_attribute_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># see #1200313</span>
        <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;&amp;&#39;</span><span class="p">,</span> <span class="s">&#39;&amp;amp;&#39;</span><span class="p">,</span> <span class="s">&#39;&amp;#38;&#39;</span><span class="p">,</span> <span class="s">&#39;&amp;#x26;&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&#39;&lt;a href=&quot;</span><span class="si">%s</span><span class="s">&quot;&gt;&#39;</span> <span class="o">%</span> <span class="n">entity</span><span class="p">,</span>
                            <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;href&quot;</span><span class="p">,</span> <span class="s">&quot;&amp;&quot;</span><span class="p">)])])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a href=&#39;</span><span class="si">%s</span><span class="s">&#39;&gt;&quot;</span> <span class="o">%</span> <span class="n">entity</span><span class="p">,</span>
                            <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;href&quot;</span><span class="p">,</span> <span class="s">&quot;&amp;&quot;</span><span class="p">)])])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a href=</span><span class="si">%s</span><span class="s">&gt;&quot;</span> <span class="o">%</span> <span class="n">entity</span><span class="p">,</span>
                            <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;href&quot;</span><span class="p">,</span> <span class="s">&quot;&amp;&quot;</span><span class="p">)])])</span>
</div>
<div class="viewcode-block" id="AttributesTolerantTestCase.test_malformed_attributes"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesTolerantTestCase.test_malformed_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">test_malformed_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># see #13357</span>
        <span class="n">html</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s">&quot;&lt;a href=test&#39;style=&#39;color:red;bad1&#39;&gt;test - bad1&lt;/a&gt;&quot;</span>
            <span class="s">&quot;&lt;a href=test&#39;+style=&#39;color:red;ba2&#39;&gt;test - bad2&lt;/a&gt;&quot;</span>
            <span class="s">&quot;&lt;a href=test&#39;&amp;nbsp;style=&#39;color:red;bad3&#39;&gt;test - bad3&lt;/a&gt;&quot;</span>
            <span class="s">&quot;&lt;a href = test&#39;&amp;nbsp;style=&#39;color:red;bad4&#39;  &gt;test - bad4&lt;/a&gt;&quot;</span>
        <span class="p">)</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;href&#39;</span><span class="p">,</span> <span class="s">&quot;test&#39;style=&#39;color:red;bad1&#39;&quot;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;test - bad1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;href&#39;</span><span class="p">,</span> <span class="s">&quot;test&#39;+style=&#39;color:red;ba2&#39;&quot;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;test - bad2&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;href&#39;</span><span class="p">,</span> <span class="s">&quot;test&#39;</span><span class="se">\xa0</span><span class="s">style=&#39;color:red;bad3&#39;&quot;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;test - bad3&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;href&#39;</span><span class="p">,</span> <span class="s">&quot;test&#39;</span><span class="se">\xa0</span><span class="s">style=&#39;color:red;bad4&#39;&quot;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;test - bad4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="AttributesTolerantTestCase.test_malformed_adjacent_attributes"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesTolerantTestCase.test_malformed_adjacent_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">test_malformed_adjacent_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># see #12629</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&#39;&lt;x&gt;&lt;y z=&quot;&quot;o&quot;&quot; /&gt;&lt;/x&gt;&#39;</span><span class="p">,</span>
                        <span class="p">[(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="p">[]),</span>
                            <span class="p">(</span><span class="s">&#39;startendtag&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;o&quot;&quot;&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]),</span>
                            <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&#39;&lt;x&gt;&lt;y z=&quot;&quot;&quot;&quot; /&gt;&lt;/x&gt;&#39;</span><span class="p">,</span>
                        <span class="p">[(</span><span class="s">&#39;starttag&#39;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="p">[]),</span>
                            <span class="p">(</span><span class="s">&#39;startendtag&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;&quot;&quot;&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]),</span>
                            <span class="p">(</span><span class="s">&#39;endtag&#39;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">)])</span>

    <span class="c"># see #755670 for the following 3 tests</span></div>
<div class="viewcode-block" id="AttributesTolerantTestCase.test_adjacent_attributes"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesTolerantTestCase.test_adjacent_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">test_adjacent_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&#39;&lt;a width=&quot;100%&quot;cellspacing=0&gt;&#39;</span><span class="p">,</span>
                        <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span>
                          <span class="p">[(</span><span class="s">&quot;width&quot;</span><span class="p">,</span> <span class="s">&quot;100%&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;cellspacing&quot;</span><span class="p">,</span><span class="s">&quot;0&quot;</span><span class="p">)])])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&#39;&lt;a id=&quot;foo&quot;class=&quot;bar&quot;&gt;&#39;</span><span class="p">,</span>
                        <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span>
                          <span class="p">[(</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;class&quot;</span><span class="p">,</span><span class="s">&quot;bar&quot;</span><span class="p">)])])</span>
</div>
<div class="viewcode-block" id="AttributesTolerantTestCase.test_missing_attribute_value"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesTolerantTestCase.test_missing_attribute_value">[docs]</a>    <span class="k">def</span> <span class="nf">test_missing_attribute_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&#39;&lt;a v=&gt;&#39;</span><span class="p">,</span>
                        <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;v&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)])])</span>
</div>
<div class="viewcode-block" id="AttributesTolerantTestCase.test_javascript_attribute_value"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesTolerantTestCase.test_javascript_attribute_value">[docs]</a>    <span class="k">def</span> <span class="nf">test_javascript_attribute_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a href=javascript:popup(&#39;/popup/help.html&#39;)&gt;&quot;</span><span class="p">,</span>
                        <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span>
                          <span class="p">[(</span><span class="s">&quot;href&quot;</span><span class="p">,</span> <span class="s">&quot;javascript:popup(&#39;/popup/help.html&#39;)&quot;</span><span class="p">)])])</span>
</div>
<div class="viewcode-block" id="AttributesTolerantTestCase.test_end_tag_in_attribute_value"><a class="viewcode-back" href="../../test.html#test.test_htmlparser.AttributesTolerantTestCase.test_end_tag_in_attribute_value">[docs]</a>    <span class="k">def</span> <span class="nf">test_end_tag_in_attribute_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># see #1745761</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_check</span><span class="p">(</span><span class="s">&quot;&lt;a href=&#39;http://www.example.org/</span><span class="se">\&quot;</span><span class="s">&gt;;&#39;&gt;spam&lt;/a&gt;&quot;</span><span class="p">,</span>
                        <span class="p">[(</span><span class="s">&quot;starttag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span>
                          <span class="p">[(</span><span class="s">&quot;href&quot;</span><span class="p">,</span> <span class="s">&quot;http://www.example.org/</span><span class="se">\&quot;</span><span class="s">&gt;;&quot;</span><span class="p">)]),</span>
                         <span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;endtag&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">)])</span>

</div></div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>