

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_cmath &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_cmath</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_cmath</h1><div class="highlight"><pre>
<span class="kn">from</span> <span class="nn">test.support</span> <span class="kn">import</span> <span class="n">run_unittest</span><span class="p">,</span> <span class="n">requires_IEEE_754</span>
<span class="kn">from</span> <span class="nn">test.test_math</span> <span class="kn">import</span> <span class="n">parse_testfile</span><span class="p">,</span> <span class="n">test_file</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">cmath</span><span class="o">,</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">cmath</span> <span class="kn">import</span> <span class="n">phase</span><span class="p">,</span> <span class="n">polar</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">pi</span>
<span class="kn">import</span> <span class="nn">sysconfig</span>

<span class="n">INF</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">&#39;inf&#39;</span><span class="p">)</span>
<span class="n">NAN</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">)</span>

<span class="n">complex_zeros</span> <span class="o">=</span> <span class="p">[</span><span class="nb">complex</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">]]</span>
<span class="n">complex_infinities</span> <span class="o">=</span> <span class="p">[</span><span class="nb">complex</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>  <span class="c"># 1st quadrant</span>
        <span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">),</span>
        <span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="n">INF</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">INF</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">INF</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">INF</span><span class="p">),</span> <span class="c"># 2nd quadrant</span>
        <span class="p">(</span><span class="o">-</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">INF</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="n">INF</span><span class="p">,</span> <span class="n">INF</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="n">INF</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="n">INF</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="n">INF</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">),</span> <span class="c"># 3rd quadrant</span>
        <span class="p">(</span><span class="o">-</span><span class="n">INF</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.3</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="n">INF</span><span class="p">,</span> <span class="o">-</span><span class="n">INF</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mf">2.3</span><span class="p">,</span> <span class="o">-</span><span class="n">INF</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">INF</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">INF</span><span class="p">),</span> <span class="c"># 4th quadrant</span>
        <span class="p">(</span><span class="mf">2.3</span><span class="p">,</span> <span class="o">-</span><span class="n">INF</span><span class="p">),</span>
        <span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="o">-</span><span class="n">INF</span><span class="p">),</span>
        <span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.3</span><span class="p">),</span>
        <span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="p">]]</span>
<span class="n">complex_nans</span> <span class="o">=</span> <span class="p">[</span><span class="nb">complex</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="o">-</span><span class="n">INF</span><span class="p">),</span>
        <span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.3</span><span class="p">),</span>
        <span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">),</span>
        <span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="n">INF</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="n">INF</span><span class="p">,</span> <span class="n">NAN</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">NAN</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">NAN</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">NAN</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">NAN</span><span class="p">),</span>
        <span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="n">NAN</span><span class="p">)</span>
        <span class="p">]]</span>

<div class="viewcode-block" id="CMathTests"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests">[docs]</a><span class="k">class</span> <span class="nc">CMathTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="c"># list of all functions in cmath</span>
    <span class="n">test_functions</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">cmath</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span> <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s">&#39;acos&#39;</span><span class="p">,</span> <span class="s">&#39;acosh&#39;</span><span class="p">,</span> <span class="s">&#39;asin&#39;</span><span class="p">,</span> <span class="s">&#39;asinh&#39;</span><span class="p">,</span> <span class="s">&#39;atan&#39;</span><span class="p">,</span> <span class="s">&#39;atanh&#39;</span><span class="p">,</span>
            <span class="s">&#39;cos&#39;</span><span class="p">,</span> <span class="s">&#39;cosh&#39;</span><span class="p">,</span> <span class="s">&#39;exp&#39;</span><span class="p">,</span> <span class="s">&#39;log&#39;</span><span class="p">,</span> <span class="s">&#39;log10&#39;</span><span class="p">,</span> <span class="s">&#39;sin&#39;</span><span class="p">,</span> <span class="s">&#39;sinh&#39;</span><span class="p">,</span>
            <span class="s">&#39;sqrt&#39;</span><span class="p">,</span> <span class="s">&#39;tan&#39;</span><span class="p">,</span> <span class="s">&#39;tanh&#39;</span><span class="p">]]</span>
    <span class="c"># test first and second arguments independently for 2-argument log</span>
    <span class="n">test_functions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">cmath</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1729.</span> <span class="o">+</span> <span class="mi">0j</span><span class="p">))</span>
    <span class="n">test_functions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">cmath</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">14.</span><span class="o">-</span><span class="mi">27j</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>

<div class="viewcode-block" id="CMathTests.setUp"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_values</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">test_file</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CMathTests.tearDown"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.tearDown">[docs]</a>    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_values</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="CMathTests.assertFloatIdentical"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.assertFloatIdentical">[docs]</a>    <span class="k">def</span> <span class="nf">assertFloatIdentical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fail unless floats x and y are identical, in the sense that:</span>
<span class="sd">        (1) both x and y are nans, or</span>
<span class="sd">        (2) both x and y are infinities, with the same sign, or</span>
<span class="sd">        (3) both x and y are zeros, with the same sign, or</span>
<span class="sd">        (4) x and y are both finite and nonzero, and x == y</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s">&#39;floats {!r} and {!r} are not identical&#39;</span>

        <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">or</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
                <span class="k">return</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="c"># both zero; check that signs match</span>
            <span class="k">elif</span> <span class="n">math</span><span class="o">.</span><span class="n">copysign</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">math</span><span class="o">.</span><span class="n">copysign</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;: zeros have different signs&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="CMathTests.assertComplexIdentical"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.assertComplexIdentical">[docs]</a>    <span class="k">def</span> <span class="nf">assertComplexIdentical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fail unless complex numbers x and y have equal values and signs.</span>

<span class="sd">        In particular, if x and y both have real (or imaginary) part</span>
<span class="sd">        zero, but the zeros have different signs, this test will fail.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFloatIdentical</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFloatIdentical</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CMathTests.rAssertAlmostEqual"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.rAssertAlmostEqual">[docs]</a>    <span class="k">def</span> <span class="nf">rAssertAlmostEqual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">rel_err</span> <span class="o">=</span> <span class="mf">2e-15</span><span class="p">,</span> <span class="n">abs_err</span> <span class="o">=</span> <span class="mf">5e-323</span><span class="p">,</span>
                           <span class="n">msg</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fail if the two floating-point numbers are not almost equal.</span>

<span class="sd">        Determine whether floating-point values a and b are equal to within</span>
<span class="sd">        a (small) rounding error.  The default values for rel_err and</span>
<span class="sd">        abs_err are chosen to be suitable for platforms where a float is</span>
<span class="sd">        represented by an IEEE 754 double.  They allow an error of between</span>
<span class="sd">        9 and 19 ulps.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># special values testing</span>
        <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="n">msg</span> <span class="ow">or</span> <span class="s">&#39;{!r} should be nan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="n">msg</span> <span class="ow">or</span> <span class="s">&#39;finite result where infinity expected: &#39;</span>
                      <span class="s">&#39;expected {!r}, got {!r}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

        <span class="c"># if both a and b are zero, check whether they have the same sign</span>
        <span class="c"># (in theory there are examples where it would be legitimate for a</span>
        <span class="c"># and b to have opposite signs; in practice these hardly ever</span>
        <span class="c"># occur).</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">a</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">b</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">copysign</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="o">!=</span> <span class="n">math</span><span class="o">.</span><span class="n">copysign</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="n">msg</span> <span class="ow">or</span> <span class="s">&#39;zero has wrong sign: expected {!r}, &#39;</span>
                          <span class="s">&#39;got {!r}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

        <span class="c"># if a-b overflows, or b is infinite, return False.  Again, in</span>
        <span class="c"># theory there are examples where a is within a few ulps of the</span>
        <span class="c"># max representable float, and then b could legitimately be</span>
        <span class="c"># infinite.  In practice these examples are rare.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">absolute_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># test passes if either the absolute error or the relative</span>
            <span class="c"># error is sufficiently small.  The defaults amount to an</span>
            <span class="c"># error of between 9 ulps and 19 ulps on an IEEE-754 compliant</span>
            <span class="c"># machine.</span>
            <span class="k">if</span> <span class="n">absolute_error</span> <span class="o">&lt;=</span> <span class="nb">max</span><span class="p">(</span><span class="n">abs_err</span><span class="p">,</span> <span class="n">rel_err</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
                <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="n">msg</span> <span class="ow">or</span>
                  <span class="s">&#39;{!r} and {!r} are not sufficiently close&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="CMathTests.test_constants"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.test_constants">[docs]</a>    <span class="k">def</span> <span class="nf">test_constants</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e_expected</span> <span class="o">=</span> <span class="mf">2.71828182845904523536</span>
        <span class="n">pi_expected</span> <span class="o">=</span> <span class="mf">3.14159265358979323846</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi_expected</span><span class="p">,</span> <span class="n">places</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
            <span class="n">msg</span><span class="o">=</span><span class="s">&quot;cmath.pi is {}; should be {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi_expected</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">e_expected</span><span class="p">,</span> <span class="n">places</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
            <span class="n">msg</span><span class="o">=</span><span class="s">&quot;cmath.e is {}; should be {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">e_expected</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="CMathTests.test_user_object"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.test_user_object">[docs]</a>    <span class="k">def</span> <span class="nf">test_user_object</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test automatic calling of __complex__ and __float__ by cmath</span>
        <span class="c"># functions</span>

        <span class="c"># some random values to use as test values; we avoid values</span>
        <span class="c"># for which any of the functions in cmath is undefined</span>
        <span class="c"># (i.e. 0., 1., -1., 1j, -1j) or would cause overflow</span>
        <span class="n">cx_arg</span> <span class="o">=</span> <span class="mf">4.419414439</span> <span class="o">+</span> <span class="mf">1.497100113j</span>
        <span class="n">flt_arg</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.131677725</span>

        <span class="c"># a variety of non-complex numbers, used to check that</span>
        <span class="c"># non-complex return values from __complex__ give an error</span>
        <span class="n">non_complexes</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;not complex&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
                         <span class="nb">object</span><span class="p">(),</span> <span class="bp">NotImplemented</span><span class="p">]</span>

        <span class="c"># Now we introduce a variety of classes whose instances might</span>
        <span class="c"># end up being passed to the cmath functions</span>

        <span class="c"># usual case: new-style class implementing __complex__</span>
        <span class="k">class</span> <span class="nc">MyComplex</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">def</span> <span class="nf">__complex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>

        <span class="c"># old-style class implementing __complex__</span>
        <span class="k">class</span> <span class="nc">MyComplexOS</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">def</span> <span class="nf">__complex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>

        <span class="c"># classes for which __complex__ raises an exception</span>
        <span class="k">class</span> <span class="nc">SomeException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">MyComplexException</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__complex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">SomeException</span>
        <span class="k">class</span> <span class="nc">MyComplexExceptionOS</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__complex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">SomeException</span>

        <span class="c"># some classes not providing __float__ or __complex__</span>
        <span class="k">class</span> <span class="nc">NeitherComplexNorFloat</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">NeitherComplexNorFloatOS</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">MyInt</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="mi">2</span>
            <span class="k">def</span> <span class="nf">__index__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="mi">2</span>
        <span class="k">class</span> <span class="nc">MyIntOS</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="mi">2</span>
            <span class="k">def</span> <span class="nf">__index__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="mi">2</span>

        <span class="c"># other possible combinations of __float__ and __complex__</span>
        <span class="c"># that should work</span>
        <span class="k">class</span> <span class="nc">FloatAndComplex</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">flt_arg</span>
            <span class="k">def</span> <span class="nf">__complex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">cx_arg</span>
        <span class="k">class</span> <span class="nc">FloatAndComplexOS</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">flt_arg</span>
            <span class="k">def</span> <span class="nf">__complex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">cx_arg</span>
        <span class="k">class</span> <span class="nc">JustFloat</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">flt_arg</span>
        <span class="k">class</span> <span class="nc">JustFloatOS</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">flt_arg</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_functions</span><span class="p">:</span>
            <span class="c"># usual usage</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">MyComplex</span><span class="p">(</span><span class="n">cx_arg</span><span class="p">)),</span> <span class="n">f</span><span class="p">(</span><span class="n">cx_arg</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">MyComplexOS</span><span class="p">(</span><span class="n">cx_arg</span><span class="p">)),</span> <span class="n">f</span><span class="p">(</span><span class="n">cx_arg</span><span class="p">))</span>
            <span class="c"># other combinations of __float__ and __complex__</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">FloatAndComplex</span><span class="p">()),</span> <span class="n">f</span><span class="p">(</span><span class="n">cx_arg</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">FloatAndComplexOS</span><span class="p">()),</span> <span class="n">f</span><span class="p">(</span><span class="n">cx_arg</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">JustFloat</span><span class="p">()),</span> <span class="n">f</span><span class="p">(</span><span class="n">flt_arg</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">JustFloatOS</span><span class="p">()),</span> <span class="n">f</span><span class="p">(</span><span class="n">flt_arg</span><span class="p">))</span>
            <span class="c"># TypeError should be raised for classes not providing</span>
            <span class="c"># either __complex__ or __float__, even if they provide</span>
            <span class="c"># __int__ or __index__.  An old-style class</span>
            <span class="c"># currently raises AttributeError instead of a TypeError;</span>
            <span class="c"># this could be considered a bug.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">NeitherComplexNorFloat</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">MyInt</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">Exception</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">NeitherComplexNorFloatOS</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">Exception</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">MyIntOS</span><span class="p">())</span>
            <span class="c"># non-complex return value from __complex__ -&gt; TypeError</span>
            <span class="k">for</span> <span class="n">bad_complex</span> <span class="ow">in</span> <span class="n">non_complexes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">MyComplex</span><span class="p">(</span><span class="n">bad_complex</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">MyComplexOS</span><span class="p">(</span><span class="n">bad_complex</span><span class="p">))</span>
            <span class="c"># exceptions in __complex__ should be propagated correctly</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">SomeException</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">MyComplexException</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">SomeException</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">MyComplexExceptionOS</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="CMathTests.test_input_type"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.test_input_type">[docs]</a>    <span class="k">def</span> <span class="nf">test_input_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># ints should be acceptable inputs to all cmath</span>
        <span class="c"># functions, by virtue of providing a __float__ method</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_functions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">arg</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">__float__</span><span class="p">()))</span>

        <span class="c"># but strings should give a TypeError</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_functions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;long_string&quot;</span><span class="p">,</span> <span class="s">&quot;0&quot;</span><span class="p">,</span> <span class="s">&quot;1j&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CMathTests.test_cmath_matches_math"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.test_cmath_matches_math">[docs]</a>    <span class="k">def</span> <span class="nf">test_cmath_matches_math</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># check that corresponding cmath and math functions are equal</span>
        <span class="c"># for floats in the appropriate range</span>

        <span class="c"># test_values in (0, 1)</span>
        <span class="n">test_values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">]</span>

        <span class="c"># test_values for functions defined on [-1., 1.]</span>
        <span class="n">unit_interval</span> <span class="o">=</span> <span class="n">test_values</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test_values</span><span class="p">]</span> <span class="o">+</span> \
            <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]</span>

        <span class="c"># test_values for log, log10, sqrt</span>
        <span class="n">positive</span> <span class="o">=</span> <span class="n">test_values</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test_values</span><span class="p">]</span>
        <span class="n">nonnegative</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">]</span> <span class="o">+</span> <span class="n">positive</span>

        <span class="c"># test_values for functions defined on the whole real line</span>
        <span class="n">real_line</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">]</span> <span class="o">+</span> <span class="n">positive</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">positive</span><span class="p">]</span>

        <span class="n">test_functions</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;acos&#39;</span> <span class="p">:</span> <span class="n">unit_interval</span><span class="p">,</span>
            <span class="s">&#39;asin&#39;</span> <span class="p">:</span> <span class="n">unit_interval</span><span class="p">,</span>
            <span class="s">&#39;atan&#39;</span> <span class="p">:</span> <span class="n">real_line</span><span class="p">,</span>
            <span class="s">&#39;cos&#39;</span> <span class="p">:</span> <span class="n">real_line</span><span class="p">,</span>
            <span class="s">&#39;cosh&#39;</span> <span class="p">:</span> <span class="n">real_line</span><span class="p">,</span>
            <span class="s">&#39;exp&#39;</span> <span class="p">:</span> <span class="n">real_line</span><span class="p">,</span>
            <span class="s">&#39;log&#39;</span> <span class="p">:</span> <span class="n">positive</span><span class="p">,</span>
            <span class="s">&#39;log10&#39;</span> <span class="p">:</span> <span class="n">positive</span><span class="p">,</span>
            <span class="s">&#39;sin&#39;</span> <span class="p">:</span> <span class="n">real_line</span><span class="p">,</span>
            <span class="s">&#39;sinh&#39;</span> <span class="p">:</span> <span class="n">real_line</span><span class="p">,</span>
            <span class="s">&#39;sqrt&#39;</span> <span class="p">:</span> <span class="n">nonnegative</span><span class="p">,</span>
            <span class="s">&#39;tan&#39;</span> <span class="p">:</span> <span class="n">real_line</span><span class="p">,</span>
            <span class="s">&#39;tanh&#39;</span> <span class="p">:</span> <span class="n">real_line</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">fn</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">test_functions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">float_fn</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">math</span><span class="p">,</span> <span class="n">fn</span><span class="p">)</span>
            <span class="n">complex_fn</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cmath</span><span class="p">,</span> <span class="n">fn</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                <span class="n">z</span> <span class="o">=</span> <span class="n">complex_fn</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rAssertAlmostEqual</span><span class="p">(</span><span class="n">float_fn</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">z</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>

        <span class="c"># test two-argument version of log with various bases</span>
        <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">positive</span><span class="p">:</span>
                <span class="n">z</span> <span class="o">=</span> <span class="n">cmath</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rAssertAlmostEqual</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">base</span><span class="p">),</span> <span class="n">z</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
</div>
    <span class="nd">@requires_IEEE_754</span>
<div class="viewcode-block" id="CMathTests.test_specific_values"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.test_specific_values">[docs]</a>    <span class="k">def</span> <span class="nf">test_specific_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">rect_complex</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Wrapped version of rect that accepts a complex number instead of</span>
<span class="sd">            two float arguments.&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">cmath</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">polar_complex</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Wrapped version of polar that returns a complex number instead of</span>
<span class="sd">            two floats.&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="nb">complex</span><span class="p">(</span><span class="o">*</span><span class="n">polar</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>

        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ar</span><span class="p">,</span> <span class="n">ai</span><span class="p">,</span> <span class="n">er</span><span class="p">,</span> <span class="n">ei</span><span class="p">,</span> <span class="n">flags</span> <span class="ow">in</span> <span class="n">parse_testfile</span><span class="p">(</span><span class="n">test_file</span><span class="p">):</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ai</span><span class="p">)</span>
            <span class="n">expected</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">er</span><span class="p">,</span> <span class="n">ei</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fn</span> <span class="o">==</span> <span class="s">&#39;rect&#39;</span><span class="p">:</span>
                <span class="n">function</span> <span class="o">=</span> <span class="n">rect_complex</span>
            <span class="k">elif</span> <span class="n">fn</span> <span class="o">==</span> <span class="s">&#39;polar&#39;</span><span class="p">:</span>
                <span class="n">function</span> <span class="o">=</span> <span class="n">polar_complex</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">function</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cmath</span><span class="p">,</span> <span class="n">fn</span><span class="p">)</span>
            <span class="k">if</span> <span class="s">&#39;divide-by-zero&#39;</span> <span class="ow">in</span> <span class="n">flags</span> <span class="ow">or</span> <span class="s">&#39;invalid&#39;</span> <span class="ow">in</span> <span class="n">flags</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actual</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&#39;ValueError not raised in test &#39;</span>
                          <span class="s">&#39;{}: {}(complex({!r}, {!r}))&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ar</span><span class="p">,</span> <span class="n">ai</span><span class="p">))</span>

            <span class="k">if</span> <span class="s">&#39;overflow&#39;</span> <span class="ow">in</span> <span class="n">flags</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actual</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&#39;OverflowError not raised in test &#39;</span>
                          <span class="s">&#39;{}: {}(complex({!r}, {!r}))&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ar</span><span class="p">,</span> <span class="n">ai</span><span class="p">))</span>

            <span class="n">actual</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

            <span class="k">if</span> <span class="s">&#39;ignore-real-sign&#39;</span> <span class="ow">in</span> <span class="n">flags</span><span class="p">:</span>
                <span class="n">actual</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">real</span><span class="p">),</span> <span class="n">actual</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
                <span class="n">expected</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">real</span><span class="p">),</span> <span class="n">expected</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
            <span class="k">if</span> <span class="s">&#39;ignore-imag-sign&#39;</span> <span class="ow">in</span> <span class="n">flags</span><span class="p">:</span>
                <span class="n">actual</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">imag</span><span class="p">))</span>
                <span class="n">expected</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">imag</span><span class="p">))</span>

            <span class="c"># for the real part of the log function, we allow an</span>
            <span class="c"># absolute error of up to 2e-15.</span>
            <span class="k">if</span> <span class="n">fn</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">,</span> <span class="s">&#39;log10&#39;</span><span class="p">):</span>
                <span class="n">real_abs_err</span> <span class="o">=</span> <span class="mf">2e-15</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">real_abs_err</span> <span class="o">=</span> <span class="mf">5e-323</span>

            <span class="n">error_message</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s">&#39;{}: {}(complex({!r}, {!r}))</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;Expected: complex({!r}, {!r})</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;Received: complex({!r}, {!r})</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;Received value insufficiently close to expected value.&#39;</span>
                <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ar</span><span class="p">,</span> <span class="n">ai</span><span class="p">,</span>
                     <span class="n">expected</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">expected</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span>
                     <span class="n">actual</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">actual</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rAssertAlmostEqual</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">actual</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
                                        <span class="n">abs_err</span><span class="o">=</span><span class="n">real_abs_err</span><span class="p">,</span>
                                        <span class="n">msg</span><span class="o">=</span><span class="n">error_message</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rAssertAlmostEqual</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">actual</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span>
                                        <span class="n">msg</span><span class="o">=</span><span class="n">error_message</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CMathTests.assertCISEqual"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.assertCISEqual">[docs]</a>    <span class="k">def</span> <span class="nf">assertCISEqual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">eps</span> <span class="o">=</span> <span class="mf">1E-7</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">eps</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">((</span><span class="n">a</span> <span class="p">,</span><span class="n">b</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="CMathTests.test_polar"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.test_polar">[docs]</a>    <span class="k">def</span> <span class="nf">test_polar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertCISEqual</span><span class="p">(</span><span class="n">polar</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertCISEqual</span><span class="p">(</span><span class="n">polar</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertCISEqual</span><span class="p">(</span><span class="n">polar</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">pi</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertCISEqual</span><span class="p">(</span><span class="n">polar</span><span class="p">(</span><span class="mi">1j</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertCISEqual</span><span class="p">(</span><span class="n">polar</span><span class="p">(</span><span class="o">-</span><span class="mi">1j</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="CMathTests.test_phase"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.test_phase">[docs]</a>    <span class="k">def</span> <span class="nf">test_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">),</span> <span class="n">pi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">1E-300j</span><span class="p">),</span> <span class="n">pi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">-</span><span class="mf">1E-300j</span><span class="p">),</span> <span class="o">-</span><span class="n">pi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="mi">1j</span><span class="p">),</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="o">-</span><span class="mi">1j</span><span class="p">),</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

        <span class="c"># zeros</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">)),</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="n">pi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">)),</span> <span class="o">-</span><span class="n">pi</span><span class="p">)</span>

        <span class="c"># infinities</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="n">INF</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">)),</span> <span class="o">-</span><span class="n">pi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="n">INF</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.3</span><span class="p">)),</span> <span class="o">-</span><span class="n">pi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="n">INF</span><span class="p">,</span> <span class="o">-</span><span class="n">INF</span><span class="p">)),</span> <span class="o">-</span><span class="mf">0.75</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="mf">2.3</span><span class="p">,</span> <span class="o">-</span><span class="n">INF</span><span class="p">)),</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">INF</span><span class="p">)),</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">INF</span><span class="p">)),</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="mf">2.3</span><span class="p">,</span> <span class="o">-</span><span class="n">INF</span><span class="p">)),</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="o">-</span><span class="n">INF</span><span class="p">)),</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.3</span><span class="p">)),</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">)),</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">)),</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="n">INF</span><span class="p">)),</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">INF</span><span class="p">)),</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">INF</span><span class="p">)),</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">INF</span><span class="p">)),</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">INF</span><span class="p">)),</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="n">INF</span><span class="p">,</span> <span class="n">INF</span><span class="p">)),</span> <span class="mf">0.75</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="n">INF</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">)),</span> <span class="n">pi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="n">INF</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="n">pi</span><span class="p">)</span>

        <span class="c"># real or imaginary part NaN</span>
        <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">complex_nans</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">phase</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="CMathTests.test_abs"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.test_abs">[docs]</a>    <span class="k">def</span> <span class="nf">test_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># zeros</span>
        <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">complex_zeros</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)</span>

        <span class="c"># infinities</span>
        <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">complex_infinities</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">INF</span><span class="p">)</span>

        <span class="c"># real or imaginary part NaN</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="o">-</span><span class="n">INF</span><span class="p">)),</span> <span class="n">INF</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.3</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="n">INF</span><span class="p">)),</span> <span class="n">INF</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="n">INF</span><span class="p">,</span> <span class="n">NAN</span><span class="p">)),</span> <span class="n">INF</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">NAN</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">NAN</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">NAN</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">NAN</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="n">NAN</span><span class="p">)),</span> <span class="n">INF</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="n">NAN</span><span class="p">))))</span>

</div>
    <span class="nd">@requires_IEEE_754</span>
<div class="viewcode-block" id="CMathTests.test_abs_overflows"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.test_abs_overflows">[docs]</a>    <span class="k">def</span> <span class="nf">test_abs_overflows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># result overflows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="nb">abs</span><span class="p">,</span> <span class="nb">complex</span><span class="p">(</span><span class="mf">1.4e308</span><span class="p">,</span> <span class="mf">1.4e308</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="CMathTests.assertCEqual"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.assertCEqual">[docs]</a>    <span class="k">def</span> <span class="nf">assertCEqual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">eps</span> <span class="o">=</span> <span class="mf">1E-7</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">real</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">eps</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">imag</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">((</span><span class="n">a</span> <span class="p">,</span><span class="n">b</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="CMathTests.test_rect"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.test_rect">[docs]</a>    <span class="k">def</span> <span class="nf">test_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertCEqual</span><span class="p">(</span><span class="n">rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertCEqual</span><span class="p">(</span><span class="n">rect</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertCEqual</span><span class="p">(</span><span class="n">rect</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertCEqual</span><span class="p">(</span><span class="n">rect</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertCEqual</span><span class="p">(</span><span class="n">rect</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="CMathTests.test_isfinite"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.test_isfinite">[docs]</a>    <span class="k">def</span> <span class="nf">test_isfinite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">real_vals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">),</span> <span class="o">-</span><span class="mf">2.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">,</span>
                     <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s">&#39;inf&#39;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">real_vals</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">real_vals</span><span class="p">:</span>
                <span class="n">z</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">z</span><span class="p">),</span>
                                  <span class="n">math</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">math</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="CMathTests.test_isnan"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.test_isnan">[docs]</a>    <span class="k">def</span> <span class="nf">test_isnan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="mi">1j</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">INF</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">NAN</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">NAN</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="n">NAN</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="n">INF</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="n">NAN</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="CMathTests.test_isinf"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.test_isinf">[docs]</a>    <span class="k">def</span> <span class="nf">test_isinf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="mi">1j</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">NAN</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">INF</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">INF</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="n">INF</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">NAN</span><span class="p">,</span> <span class="n">INF</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">INF</span><span class="p">,</span> <span class="n">NAN</span><span class="p">)))</span>
</div>
    <span class="nd">@requires_IEEE_754</span>
    <span class="nd">@unittest.skipIf</span><span class="p">(</span><span class="n">sysconfig</span><span class="o">.</span><span class="n">get_config_var</span><span class="p">(</span><span class="s">&#39;TANH_PRESERVES_ZERO_SIGN&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
                     <span class="s">&quot;system tanh() function doesn&#39;t copy the sign&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="CMathTests.testTanhSign"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.testTanhSign">[docs]</a>    <span class="k">def</span> <span class="nf">testTanhSign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">complex_zeros</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertComplexIdentical</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">z</span><span class="p">)</span>

    <span class="c"># The algorithm used for atan and atanh makes use of the system</span>
    <span class="c"># log1p function; If that system function doesn&#39;t respect the sign</span>
    <span class="c"># of zero, then atan and atanh will also have difficulties with</span>
    <span class="c"># the sign of complex zeros.</span></div>
    <span class="nd">@requires_IEEE_754</span>
<div class="viewcode-block" id="CMathTests.testAtanSign"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.testAtanSign">[docs]</a>    <span class="k">def</span> <span class="nf">testAtanSign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">complex_zeros</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertComplexIdentical</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">z</span><span class="p">)</span>
</div>
    <span class="nd">@requires_IEEE_754</span>
<div class="viewcode-block" id="CMathTests.testAtanhSign"><a class="viewcode-back" href="../../test.html#test.test_cmath.CMathTests.testAtanhSign">[docs]</a>    <span class="k">def</span> <span class="nf">testAtanhSign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">complex_zeros</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertComplexIdentical</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">atanh</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">z</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="test_main"><a class="viewcode-back" href="../../test.html#test.test_cmath.test_main">[docs]</a><span class="k">def</span> <span class="nf">test_main</span><span class="p">():</span>
    <span class="n">run_unittest</span><span class="p">(</span><span class="n">CMathTests</span><span class="p">)</span>
</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">test_main</span><span class="p">()</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>