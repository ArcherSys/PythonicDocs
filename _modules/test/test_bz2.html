

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_bz2 &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_bz2</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_bz2</h1><div class="highlight"><pre>
<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">support</span>
<span class="kn">from</span> <span class="nn">test.support</span> <span class="kn">import</span> <span class="n">bigmemtest</span><span class="p">,</span> <span class="n">_4G</span>

<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">test.support</span> <span class="kn">import</span> <span class="n">unlink</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">threading</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">threading</span> <span class="o">=</span> <span class="bp">None</span>

<span class="c"># Skip tests if the bz2 module doesn&#39;t exist.</span>
<span class="n">bz2</span> <span class="o">=</span> <span class="n">support</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="s">&#39;bz2&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">bz2</span> <span class="kn">import</span> <span class="n">BZ2File</span><span class="p">,</span> <span class="n">BZ2Compressor</span><span class="p">,</span> <span class="n">BZ2Decompressor</span>


<div class="viewcode-block" id="BaseTest"><a class="viewcode-back" href="../../test.html#test.test_bz2.BaseTest">[docs]</a><span class="k">class</span> <span class="nc">BaseTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="s">&quot;Base for other testcases.&quot;</span>

    <span class="n">TEXT_LINES</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">b</span><span class="s">&#39;root:x:0:0:root:/root:/bin/bash</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;bin:x:1:1:bin:/bin:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;daemon:x:2:2:daemon:/sbin:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;adm:x:3:4:adm:/var/adm:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;lp:x:4:7:lp:/var/spool/lpd:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;sync:x:5:0:sync:/sbin:/bin/sync</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;halt:x:7:0:halt:/sbin:/sbin/halt</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;mail:x:8:12:mail:/var/spool/mail:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;news:x:9:13:news:/var/spool/news:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;uucp:x:10:14:uucp:/var/spool/uucp:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;operator:x:11:0:operator:/root:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;games:x:12:100:games:/usr/games:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;gopher:x:13:30:gopher:/usr/lib/gopher-data:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;ftp:x:14:50:FTP User:/var/ftp:/bin/bash</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;nobody:x:65534:65534:Nobody:/home:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;postfix:x:100:101:postfix:/var/spool/postfix:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;niemeyer:x:500:500::/home/niemeyer:/bin/bash</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;postgres:x:101:102:PostgreSQL Server:/var/lib/pgsql:/bin/bash</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;mysql:x:102:103:MySQL server:/var/lib/mysql:/bin/bash</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="n">b</span><span class="s">&#39;www:x:103:104::/var/www:/bin/false</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="n">TEXT</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">TEXT_LINES</span><span class="p">)</span>
    <span class="n">DATA</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;BZh91AY&amp;SY.</span><span class="se">\xc8</span><span class="s">N</span><span class="se">\x18\x00\x01</span><span class="s">&gt;_</span><span class="se">\x80\x00\x10</span><span class="s">@</span><span class="se">\x02\xff\xf0\x01\x07</span><span class="s">n</span><span class="se">\x00</span><span class="s">?</span><span class="se">\xe7\xff\xe0</span><span class="s">0</span><span class="se">\x01\x99\xaa\x00\xc0\x03</span><span class="s">F</span><span class="se">\x86\x8c</span><span class="s">#&amp;</span><span class="se">\x83</span><span class="s">F</span><span class="se">\x9a\x03\x06\xa6\xd0\xa6\x93</span><span class="s">M</span><span class="se">\x0f</span><span class="s">Q</span><span class="se">\xa7\xa8\x06\x80</span><span class="s">4hh</span><span class="se">\x12</span><span class="s">$</span><span class="se">\x11\xa4</span><span class="s">i4</span><span class="se">\xf1</span><span class="s">4S</span><span class="se">\xd2</span><span class="s">&lt;Q</span><span class="se">\xb5\x0f</span><span class="s">H</span><span class="se">\xd3\xd4\xdd\xd5\x87\xbb\xf8\x94\r\x8f\xaf</span><span class="s">I</span><span class="se">\x12\xe1\xc9\xf8</span><span class="s">/E</span><span class="se">\x00</span><span class="s">pu</span><span class="se">\x89\x12</span><span class="s">]</span><span class="se">\xc9\xbb</span><span class="s">DL</span><span class="se">\n</span><span class="s">Q</span><span class="se">\x0e\t</span><span class="s">1</span><span class="se">\x12\xdf\xa0\xc0\x97\xac</span><span class="s">2O9</span><span class="se">\x89\x13\x94\x0e\x1c</span><span class="s">7</span><span class="se">\x0e</span><span class="s">d</span><span class="se">\x95</span><span class="s">I</span><span class="se">\x0c\xaa</span><span class="s">J</span><span class="se">\xa4\x18</span><span class="s">L</span><span class="se">\x10\x05</span><span class="s">#</span><span class="se">\x9c\xaf\xba\xbc</span><span class="s">/</span><span class="se">\x97\x8a</span><span class="s">#C</span><span class="se">\xc8\xe1\x8c</span><span class="s">W</span><span class="se">\xf9\xe2\xd0\xd6</span><span class="s">M</span><span class="se">\xa7\x8b</span><span class="s">Xa&lt;e</span><span class="se">\x84</span><span class="s">t</span><span class="se">\xcb</span><span class="s">L</span><span class="se">\xb3\xa7\xd9\xcd\xd1\xcb\x84</span><span class="s">.</span><span class="se">\xaf\xb3\xab\xab\xad</span><span class="s">`n}</span><span class="se">\xa0</span><span class="s">lh</span><span class="se">\t</span><span class="s">E,</span><span class="se">\x8e</span><span class="s">Z</span><span class="se">\x15\x17</span><span class="s">VH&gt;</span><span class="se">\x88\xe5\xcd</span><span class="s">9gd6</span><span class="se">\x0b\n\xe9\x9b\xd5\x8a\x99\xf7\x08</span><span class="s">.K</span><span class="se">\x8e</span><span class="s">v</span><span class="se">\xfb\xf7</span><span class="s">xw</span><span class="se">\xbb\xdf\xa1\x92\xf1\xdd</span><span class="s">|/&quot;;</span><span class="se">\xa2\xba\x9f\xd5\xb1</span><span class="s">#A</span><span class="se">\xb6\xf6\xb3</span><span class="s">o</span><span class="se">\xc9\xc5</span><span class="s">y</span><span class="se">\\\xeb</span><span class="s">O</span><span class="se">\xe7\x85\x9a\xbc\xb6</span><span class="s">f8</span><span class="se">\x95</span><span class="s">2</span><span class="se">\xd5\xd7</span><span class="s">&quot;%</span><span class="se">\x89</span><span class="s">&gt;V,</span><span class="se">\xf7\xa6</span><span class="s">z</span><span class="se">\xe2\x9f\xa3\xdf\x11\x11</span><span class="s">&quot;</span><span class="se">\xd6</span><span class="s">E)I</span><span class="se">\xa9\x13</span><span class="s">^</span><span class="se">\xca\xf3</span><span class="s">r</span><span class="se">\xd0\x03</span><span class="s">U</span><span class="se">\x92</span><span class="s">2</span><span class="se">\xf2</span><span class="s">6</span><span class="se">\xec\xb6\xed\x8b\xc3</span><span class="s">U</span><span class="se">\x13\x9d\xc5\x17</span><span class="s">0</span><span class="se">\xa4\xfa</span><span class="s">^</span><span class="se">\x92\xac</span><span class="s">DF</span><span class="se">\x8a\x97\xd6\x19\xfe\xdd\xb8\xbd\x1a\x9a\x19\xa3\x80</span><span class="s">ankR</span><span class="se">\x8b\xe5\xd8</span><span class="s">3]</span><span class="se">\xa9\xc6\x08\x82</span><span class="s">f</span><span class="se">\xf6\xb9</span><span class="s">&quot;6l$</span><span class="se">\xb8</span><span class="s">j@</span><span class="se">\xc0\x8a\xb0</span><span class="s">l1..</span><span class="se">\xba</span><span class="s">k</span><span class="se">\x83</span><span class="s">ls</span><span class="se">\x15\xbc\xf4\xc1\x13\xbe\xf8</span><span class="s">E</span><span class="se">\xb8\x9d\r\xa8\x9d</span><span class="s">k</span><span class="se">\x84\xd3</span><span class="s">n</span><span class="se">\xfa\xac</span><span class="s">Q</span><span class="se">\x07\xb1</span><span class="s">%y</span><span class="se">\xaa</span><span class="s">v</span><span class="se">\xb4\x08\xe0</span><span class="s">z</span><span class="se">\x1b\x16\xf5\x04\xe9\xcc\xb9\x08</span><span class="s">z</span><span class="se">\x1e</span><span class="s">n7.G</span><span class="se">\xfc</span><span class="s">]</span><span class="se">\xc9\x14\xe1</span><span class="s">B@</span><span class="se">\xbb</span><span class="s">!8`&#39;</span>
    <span class="n">EMPTY_DATA</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;BZh9</span><span class="se">\x17</span><span class="s">rE8P</span><span class="se">\x90\x00\x00\x00\x00</span><span class="s">&#39;</span>
    <span class="n">BAD_DATA</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;this is not a valid bzip2 file&#39;</span>

<div class="viewcode-block" id="BaseTest.setUp"><a class="viewcode-back" href="../../test.html#test.test_bz2.BaseTest.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span>
</div>
<div class="viewcode-block" id="BaseTest.tearDown"><a class="viewcode-back" href="../../test.html#test.test_bz2.BaseTest.tearDown">[docs]</a>    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</div>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&quot;win32&quot;</span><span class="p">:</span>
        <span class="c"># bunzip2 isn&#39;t available to run on Windows.</span>
        <span class="k">def</span> <span class="nf">decompress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">bz2</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
<div class="viewcode-block" id="BaseTest.decompress"><a class="viewcode-back" href="../../test.html#test.test_bz2.BaseTest.decompress">[docs]</a>        <span class="k">def</span> <span class="nf">decompress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
            <span class="n">pop</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="s">&quot;bunzip2&quot;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                   <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                                   <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                                   <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">pop</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ret</span>

</div></div>
<div class="viewcode-block" id="BZ2FileTest"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest">[docs]</a><span class="k">class</span> <span class="nc">BZ2FileTest</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
    <span class="s">&quot;Test the BZ2File class.&quot;</span>

<div class="viewcode-block" id="BZ2FileTest.createTempFile"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.createTempFile">[docs]</a>    <span class="k">def</span> <span class="nf">createTempFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">streams</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span> <span class="o">*</span> <span class="n">streams</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testBadArgs"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testBadArgs">[docs]</a>    <span class="k">def</span> <span class="nf">testBadArgs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">BZ2File</span><span class="p">,</span> <span class="mf">123.456</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">BZ2File</span><span class="p">,</span> <span class="s">&quot;/dev/null&quot;</span><span class="p">,</span> <span class="s">&quot;z&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">BZ2File</span><span class="p">,</span> <span class="s">&quot;/dev/null&quot;</span><span class="p">,</span> <span class="s">&quot;rx&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">BZ2File</span><span class="p">,</span> <span class="s">&quot;/dev/null&quot;</span><span class="p">,</span> <span class="s">&quot;rbt&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">BZ2File</span><span class="p">,</span> <span class="s">&quot;/dev/null&quot;</span><span class="p">,</span> <span class="n">compresslevel</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">BZ2File</span><span class="p">,</span> <span class="s">&quot;/dev/null&quot;</span><span class="p">,</span> <span class="n">compresslevel</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testRead"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testRead">[docs]</a>    <span class="k">def</span> <span class="nf">testRead</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testReadBadFile"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testReadBadFile">[docs]</a>    <span class="k">def</span> <span class="nf">testReadBadFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="n">streams</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">BAD_DATA</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testReadMultiStream"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testReadMultiStream">[docs]</a>    <span class="k">def</span> <span class="nf">testReadMultiStream</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="n">streams</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testReadMonkeyMultiStream"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testReadMonkeyMultiStream">[docs]</a>    <span class="k">def</span> <span class="nf">testReadMonkeyMultiStream</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test BZ2File.read() on a multi-stream archive where a stream</span>
        <span class="c"># boundary coincides with the end of the raw read buffer.</span>
        <span class="n">buffer_size</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">_BUFFER_SIZE</span>
        <span class="n">bz2</span><span class="o">.</span><span class="n">_BUFFER_SIZE</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="n">streams</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">bz2</span><span class="o">.</span><span class="n">_BUFFER_SIZE</span> <span class="o">=</span> <span class="n">buffer_size</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testReadTrailingJunk"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testReadTrailingJunk">[docs]</a>    <span class="k">def</span> <span class="nf">testReadTrailingJunk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">BAD_DATA</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testReadMultiStreamTrailingJunk"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testReadMultiStreamTrailingJunk">[docs]</a>    <span class="k">def</span> <span class="nf">testReadMultiStreamTrailingJunk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="n">streams</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">BAD_DATA</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testRead0"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testRead0">[docs]</a>    <span class="k">def</span> <span class="nf">testRead0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testReadChunk10"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testReadChunk10">[docs]</a>    <span class="k">def</span> <span class="nf">testReadChunk10</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;&#39;</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="nb">str</span> <span class="o">=</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="nb">str</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testReadChunk10MultiStream"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testReadChunk10MultiStream">[docs]</a>    <span class="k">def</span> <span class="nf">testReadChunk10MultiStream</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="n">streams</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;&#39;</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="nb">str</span> <span class="o">=</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="nb">str</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testRead100"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testRead100">[docs]</a>    <span class="k">def</span> <span class="nf">testRead100</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">[:</span><span class="mi">100</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testPeek"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testPeek">[docs]</a>    <span class="k">def</span> <span class="nf">testPeek</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">pdata</span> <span class="o">=</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pdata</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">pdata</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testReadInto"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testReadInto">[docs]</a>    <span class="k">def</span> <span class="nf">testReadInto</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">128</span>
            <span class="n">b</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">readinto</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">n</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">[:</span><span class="n">n</span><span class="p">])</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span>
            <span class="n">b</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">readinto</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">n</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">b</span><span class="p">[:</span><span class="n">n</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">[</span><span class="o">-</span><span class="n">n</span><span class="p">:])</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testReadLine"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testReadLine">[docs]</a>    <span class="k">def</span> <span class="nf">testReadLine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">readline</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT_LINES</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">readline</span><span class="p">(),</span> <span class="n">line</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testReadLineMultiStream"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testReadLineMultiStream">[docs]</a>    <span class="k">def</span> <span class="nf">testReadLineMultiStream</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="n">streams</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">readline</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT_LINES</span> <span class="o">*</span> <span class="mi">5</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">readline</span><span class="p">(),</span> <span class="n">line</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testReadLines"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testReadLines">[docs]</a>    <span class="k">def</span> <span class="nf">testReadLines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">readlines</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">readlines</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT_LINES</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testReadLinesMultiStream"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testReadLinesMultiStream">[docs]</a>    <span class="k">def</span> <span class="nf">testReadLinesMultiStream</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="n">streams</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">readlines</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">readlines</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT_LINES</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testIterator"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testIterator">[docs]</a>    <span class="k">def</span> <span class="nf">testIterator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">bz2f</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT_LINES</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testIteratorMultiStream"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testIteratorMultiStream">[docs]</a>    <span class="k">def</span> <span class="nf">testIteratorMultiStream</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="n">streams</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">bz2f</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT_LINES</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testClosedIteratorDeadlock"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testClosedIteratorDeadlock">[docs]</a>    <span class="k">def</span> <span class="nf">testClosedIteratorDeadlock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Issue #3309: Iteration on a closed BZ2File should release the lock.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="n">bz2f</span> <span class="o">=</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">bz2f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">next</span><span class="p">,</span> <span class="n">bz2f</span><span class="p">)</span>
        <span class="c"># This call will deadlock if the above call failed to release the lock.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">readlines</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testWrite"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testWrite">[docs]</a>    <span class="k">def</span> <span class="nf">testWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">write</span><span class="p">)</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testWriteChunks10"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testWriteChunks10">[docs]</a>    <span class="k">def</span> <span class="nf">testWriteChunks10</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">[</span><span class="n">n</span><span class="o">*</span><span class="mi">10</span><span class="p">:(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">bz2f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testWriteNonDefaultCompressLevel"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testWriteNonDefaultCompressLevel">[docs]</a>    <span class="k">def</span> <span class="nf">testWriteNonDefaultCompressLevel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">,</span> <span class="n">compresslevel</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">,</span> <span class="n">compresslevel</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testWriteLines"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testWriteLines">[docs]</a>    <span class="k">def</span> <span class="nf">testWriteLines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">writelines</span><span class="p">)</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT_LINES</span><span class="p">)</span>
        <span class="c"># Issue #1535500: Calling writelines() on a closed BZ2File</span>
        <span class="c"># should raise an exception.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">writelines</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">])</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testWriteMethodsOnReadOnlyFile"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testWriteMethodsOnReadOnlyFile">[docs]</a>    <span class="k">def</span> <span class="nf">testWriteMethodsOnReadOnlyFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;abc&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">write</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;a&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">writelines</span><span class="p">,</span> <span class="p">[</span><span class="n">b</span><span class="s">&quot;a&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testAppend"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testAppend">[docs]</a>    <span class="k">def</span> <span class="nf">testAppend</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">write</span><span class="p">)</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">write</span><span class="p">)</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testSeekForward"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testSeekForward">[docs]</a>    <span class="k">def</span> <span class="nf">testSeekForward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">)</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">[</span><span class="mi">150</span><span class="p">:])</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testSeekForwardAcrossStreams"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testSeekForwardAcrossStreams">[docs]</a>    <span class="k">def</span> <span class="nf">testSeekForwardAcrossStreams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="n">streams</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">)</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span> <span class="o">+</span> <span class="mi">150</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">[</span><span class="mi">150</span><span class="p">:])</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testSeekBackwards"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testSeekBackwards">[docs]</a>    <span class="k">def</span> <span class="nf">testSeekBackwards</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">[</span><span class="mi">500</span><span class="o">-</span><span class="mi">150</span><span class="p">:])</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testSeekBackwardsAcrossStreams"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testSeekBackwardsAcrossStreams">[docs]</a>    <span class="k">def</span> <span class="nf">testSeekBackwardsAcrossStreams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="n">streams</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">readto</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>
            <span class="k">while</span> <span class="n">readto</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">readto</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">readto</span><span class="p">))</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">[</span><span class="mi">100</span><span class="o">-</span><span class="mi">150</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testSeekBackwardsFromEnd"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testSeekBackwardsFromEnd">[docs]</a>    <span class="k">def</span> <span class="nf">testSeekBackwardsFromEnd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span><span class="o">-</span><span class="mi">150</span><span class="p">:])</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testSeekBackwardsFromEndAcrossStreams"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testSeekBackwardsFromEndAcrossStreams">[docs]</a>    <span class="k">def</span> <span class="nf">testSeekBackwardsFromEndAcrossStreams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="n">streams</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)[</span><span class="o">-</span><span class="mi">1000</span><span class="p">:])</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testSeekPostEnd"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testSeekPostEnd">[docs]</a>    <span class="k">def</span> <span class="nf">testSeekPostEnd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">150000</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">tell</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testSeekPostEndMultiStream"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testSeekPostEndMultiStream">[docs]</a>    <span class="k">def</span> <span class="nf">testSeekPostEndMultiStream</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="n">streams</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">150000</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">tell</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testSeekPostEndTwice"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testSeekPostEndTwice">[docs]</a>    <span class="k">def</span> <span class="nf">testSeekPostEndTwice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">150000</span><span class="p">)</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">150000</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">tell</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testSeekPostEndTwiceMultiStream"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testSeekPostEndTwiceMultiStream">[docs]</a>    <span class="k">def</span> <span class="nf">testSeekPostEndTwiceMultiStream</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="n">streams</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">150000</span><span class="p">)</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">150000</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">tell</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testSeekPreStart"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testSeekPreStart">[docs]</a>    <span class="k">def</span> <span class="nf">testSeekPreStart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">tell</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testSeekPreStartMultiStream"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testSeekPreStartMultiStream">[docs]</a>    <span class="k">def</span> <span class="nf">testSeekPreStartMultiStream</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="n">streams</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">tell</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testFileno"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testFileno">[docs]</a>    <span class="k">def</span> <span class="nf">testFileno</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">rawf</span><span class="p">:</span>
            <span class="n">bz2f</span> <span class="o">=</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">rawf</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="n">rawf</span><span class="o">.</span><span class="n">fileno</span><span class="p">())</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="n">bz2f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">fileno</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testSeekable"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testSeekable">[docs]</a>    <span class="k">def</span> <span class="nf">testSeekable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bz2f</span> <span class="o">=</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">seekable</span><span class="p">())</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">seekable</span><span class="p">())</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">seekable</span><span class="p">)</span>

        <span class="n">bz2f</span> <span class="o">=</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(),</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">seekable</span><span class="p">())</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">seekable</span><span class="p">)</span>

        <span class="n">src</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">)</span>
        <span class="n">src</span><span class="o">.</span><span class="n">seekable</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">False</span>
        <span class="n">bz2f</span> <span class="o">=</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">seekable</span><span class="p">())</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">seekable</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testReadable"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testReadable">[docs]</a>    <span class="k">def</span> <span class="nf">testReadable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bz2f</span> <span class="o">=</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">readable</span><span class="p">())</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">readable</span><span class="p">())</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">readable</span><span class="p">)</span>

        <span class="n">bz2f</span> <span class="o">=</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(),</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">readable</span><span class="p">())</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">readable</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testWritable"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testWritable">[docs]</a>    <span class="k">def</span> <span class="nf">testWritable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bz2f</span> <span class="o">=</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">writable</span><span class="p">())</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">writable</span><span class="p">())</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">writable</span><span class="p">)</span>

        <span class="n">bz2f</span> <span class="o">=</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(),</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">writable</span><span class="p">())</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">writable</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testOpenDel"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testOpenDel">[docs]</a>    <span class="k">def</span> <span class="nf">testOpenDel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
            <span class="n">o</span> <span class="o">=</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">o</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testOpenNonexistent"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testOpenNonexistent">[docs]</a>    <span class="k">def</span> <span class="nf">testOpenNonexistent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="n">BZ2File</span><span class="p">,</span> <span class="s">&quot;/non/existent&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testReadlinesNoNewline"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testReadlinesNoNewline">[docs]</a>    <span class="k">def</span> <span class="nf">testReadlinesNoNewline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Issue #1191043: readlines() fails on a file containing no newline.</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;BZh91AY&amp;SY</span><span class="se">\xd9</span><span class="s">b</span><span class="se">\x89</span><span class="s">]</span><span class="se">\x00\x00\x00\x03\x80\x04\x00\x02\x00\x0c\x00</span><span class="s"> </span><span class="se">\x00</span><span class="s">!</span><span class="se">\x9a</span><span class="s">h3M</span><span class="se">\x13</span><span class="s">&lt;]</span><span class="se">\xc9\x14\xe1</span><span class="s">BCe</span><span class="se">\x8a</span><span class="s">%t&#39;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="p">[</span><span class="n">b</span><span class="s">&#39;Test&#39;</span><span class="p">])</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">xlines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">xlines</span><span class="p">,</span> <span class="p">[</span><span class="n">b</span><span class="s">&#39;Test&#39;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testContextProtocol"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testContextProtocol">[docs]</a>    <span class="k">def</span> <span class="nf">testContextProtocol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;xxx&quot;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;__enter__ on a closed file didn&#39;t raise an exception&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="mi">1</span><span class="o">/</span><span class="mi">0</span>
        <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;1/0 didn&#39;t raise an exception&quot;</span><span class="p">)</span>
</div>
    <span class="nd">@unittest.skipUnless</span><span class="p">(</span><span class="n">threading</span><span class="p">,</span> <span class="s">&#39;Threading required for this test.&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="BZ2FileTest.testThreading"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testThreading">[docs]</a>    <span class="k">def</span> <span class="nf">testThreading</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Issue #7205: Using a BZ2File from several threads shouldn&#39;t deadlock.</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;1&quot;</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">20</span>
        <span class="n">nthreads</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">comp</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">threads</span> <span class="o">=</span> <span class="p">[</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">comp</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nthreads</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
                <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
                <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testWithoutThreading"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testWithoutThreading">[docs]</a>    <span class="k">def</span> <span class="nf">testWithoutThreading</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">module</span> <span class="o">=</span> <span class="n">support</span><span class="o">.</span><span class="n">import_fresh_module</span><span class="p">(</span><span class="s">&quot;bz2&quot;</span><span class="p">,</span> <span class="n">blocked</span><span class="o">=</span><span class="p">(</span><span class="s">&quot;threading&quot;</span><span class="p">,))</span>
        <span class="k">with</span> <span class="n">module</span><span class="o">.</span><span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;abc&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">module</span><span class="o">.</span><span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">b</span><span class="s">&quot;abc&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testMixedIterationAndReads"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testMixedIterationAndReads">[docs]</a>    <span class="k">def</span> <span class="nf">testMixedIterationAndReads</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">()</span>
        <span class="n">linelen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT_LINES</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">halflen</span> <span class="o">=</span> <span class="n">linelen</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">halflen</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">bz2f</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT_LINES</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">halflen</span><span class="p">:])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">[</span><span class="n">linelen</span><span class="p">:])</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">bz2f</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT_LINES</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">readline</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT_LINES</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">StopIteration</span><span class="p">,</span> <span class="nb">next</span><span class="p">,</span> <span class="n">bz2f</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">readlines</span><span class="p">(),</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testMultiStreamOrdering"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testMultiStreamOrdering">[docs]</a>    <span class="k">def</span> <span class="nf">testMultiStreamOrdering</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test the ordering of streams when reading a multi-stream archive.</span>
        <span class="n">data1</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;foo&quot;</span> <span class="o">*</span> <span class="mi">1000</span>
        <span class="n">data2</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;bar&quot;</span> <span class="o">*</span> <span class="mi">1000</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="n">bz2f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">data1</span> <span class="o">+</span> <span class="n">data2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testOpenBytesFilename"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testOpenBytesFilename">[docs]</a>    <span class="k">def</span> <span class="nf">testOpenBytesFilename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bytes_filename</span> <span class="o">=</span> <span class="n">str_filename</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;ascii&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">UnicodeEncodeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipTest</span><span class="p">(</span><span class="s">&quot;Temporary file name needs to be ASCII&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">bytes_filename</span><span class="p">,</span> <span class="s">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">bytes_filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">)</span>
        <span class="c"># Sanity check that we are actually operating on the right file.</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">str_filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">)</span>


    <span class="c"># Tests for a BZ2File wrapping another file object:</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testReadBytesIO"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testReadBytesIO">[docs]</a>    <span class="k">def</span> <span class="nf">testReadBytesIO</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">)</span> <span class="k">as</span> <span class="n">bio</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">bio</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">bio</span><span class="o">.</span><span class="n">closed</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testPeekBytesIO"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testPeekBytesIO">[docs]</a>    <span class="k">def</span> <span class="nf">testPeekBytesIO</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">)</span> <span class="k">as</span> <span class="n">bio</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">bio</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
                <span class="n">pdata</span> <span class="o">=</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pdata</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">pdata</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testWriteBytesIO"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testWriteBytesIO">[docs]</a>    <span class="k">def</span> <span class="nf">testWriteBytesIO</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">BytesIO</span><span class="p">()</span> <span class="k">as</span> <span class="n">bio</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">bio</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">write</span><span class="p">)</span>
                <span class="n">bz2f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">bio</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">bio</span><span class="o">.</span><span class="n">closed</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testSeekForwardBytesIO"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testSeekForwardBytesIO">[docs]</a>    <span class="k">def</span> <span class="nf">testSeekForwardBytesIO</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">)</span> <span class="k">as</span> <span class="n">bio</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">bio</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">)</span>
                <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">[</span><span class="mi">150</span><span class="p">:])</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.testSeekBackwardsBytesIO"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.testSeekBackwardsBytesIO">[docs]</a>    <span class="k">def</span> <span class="nf">testSeekBackwardsBytesIO</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">)</span> <span class="k">as</span> <span class="n">bio</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">bio</span><span class="p">)</span> <span class="k">as</span> <span class="n">bz2f</span><span class="p">:</span>
                <span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
                <span class="n">bz2f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">[</span><span class="mi">500</span><span class="o">-</span><span class="mi">150</span><span class="p">:])</span>
</div>
<div class="viewcode-block" id="BZ2FileTest.test_read_truncated"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2FileTest.test_read_truncated">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_truncated</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Drop the eos_magic field (6 bytes) and CRC (4 bytes).</span>
        <span class="n">truncated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">[:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">truncated</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">EOFError</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">truncated</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">EOFError</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c"># Incomplete 4-byte file header, and block header of at least 146 bits.</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">22</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">BZ2File</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">truncated</span><span class="p">[:</span><span class="n">i</span><span class="p">]))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">EOFError</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="BZ2CompressorTest"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2CompressorTest">[docs]</a><span class="k">class</span> <span class="nc">BZ2CompressorTest</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="BZ2CompressorTest.testCompress"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2CompressorTest.testCompress">[docs]</a>    <span class="k">def</span> <span class="nf">testCompress</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bz2c</span> <span class="o">=</span> <span class="n">BZ2Compressor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2c</span><span class="o">.</span><span class="n">compress</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">bz2c</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">+=</span> <span class="n">bz2c</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2CompressorTest.testCompressEmptyString"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2CompressorTest.testCompressEmptyString">[docs]</a>    <span class="k">def</span> <span class="nf">testCompressEmptyString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bz2c</span> <span class="o">=</span> <span class="n">BZ2Compressor</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">bz2c</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">+=</span> <span class="n">bz2c</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">EMPTY_DATA</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2CompressorTest.testCompressChunks10"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2CompressorTest.testCompressChunks10">[docs]</a>    <span class="k">def</span> <span class="nf">testCompressChunks10</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bz2c</span> <span class="o">=</span> <span class="n">BZ2Compressor</span><span class="p">()</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;&#39;</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">[</span><span class="n">n</span><span class="o">*</span><span class="mi">10</span><span class="p">:(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">data</span> <span class="o">+=</span> <span class="n">bz2c</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">data</span> <span class="o">+=</span> <span class="n">bz2c</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
    <span class="nd">@bigmemtest</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">_4G</span> <span class="o">+</span> <span class="mi">100</span><span class="p">,</span> <span class="n">memuse</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">testCompress4G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="c"># &quot;Test BZ2Compressor.compress()/flush() with &gt;4GiB input&quot;</span>
        <span class="n">bz2c</span> <span class="o">=</span> <span class="n">BZ2Compressor</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;x&quot;</span> <span class="o">*</span> <span class="n">size</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">compressed</span> <span class="o">=</span> <span class="n">bz2c</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">compressed</span> <span class="o">+=</span> <span class="n">bz2c</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c"># Release memory</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">compressed</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">size</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;x&quot;</span><span class="p">)),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="BZ2CompressorTest.testPickle"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2CompressorTest.testPickle">[docs]</a>    <span class="k">def</span> <span class="nf">testPickle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">BZ2Compressor</span><span class="p">())</span>

</div></div>
<div class="viewcode-block" id="BZ2DecompressorTest"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2DecompressorTest">[docs]</a><span class="k">class</span> <span class="nc">BZ2DecompressorTest</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="BZ2DecompressorTest.test_Constructor"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2DecompressorTest.test_Constructor">[docs]</a>    <span class="k">def</span> <span class="nf">test_Constructor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">BZ2Decompressor</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2DecompressorTest.testDecompress"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2DecompressorTest.testDecompress">[docs]</a>    <span class="k">def</span> <span class="nf">testDecompress</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bz2d</span> <span class="o">=</span> <span class="n">BZ2Decompressor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">bz2d</span><span class="o">.</span><span class="n">decompress</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">bz2d</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2DecompressorTest.testDecompressChunks10"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2DecompressorTest.testDecompressChunks10">[docs]</a>    <span class="k">def</span> <span class="nf">testDecompressChunks10</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bz2d</span> <span class="o">=</span> <span class="n">BZ2Decompressor</span><span class="p">()</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;&#39;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">[</span><span class="n">n</span><span class="o">*</span><span class="mi">10</span><span class="p">:(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="n">bz2d</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2DecompressorTest.testDecompressUnusedData"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2DecompressorTest.testDecompressUnusedData">[docs]</a>    <span class="k">def</span> <span class="nf">testDecompressUnusedData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bz2d</span> <span class="o">=</span> <span class="n">BZ2Decompressor</span><span class="p">()</span>
        <span class="n">unused_data</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;this is unused data&quot;</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">bz2d</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="o">+</span><span class="n">unused_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bz2d</span><span class="o">.</span><span class="n">unused_data</span><span class="p">,</span> <span class="n">unused_data</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BZ2DecompressorTest.testEOFError"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2DecompressorTest.testEOFError">[docs]</a>    <span class="k">def</span> <span class="nf">testEOFError</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bz2d</span> <span class="o">=</span> <span class="n">BZ2Decompressor</span><span class="p">()</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">bz2d</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">EOFError</span><span class="p">,</span> <span class="n">bz2d</span><span class="o">.</span><span class="n">decompress</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;anything&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">EOFError</span><span class="p">,</span> <span class="n">bz2d</span><span class="o">.</span><span class="n">decompress</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</div>
    <span class="nd">@bigmemtest</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">_4G</span> <span class="o">+</span> <span class="mi">100</span><span class="p">,</span> <span class="n">memuse</span><span class="o">=</span><span class="mf">3.3</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">testDecompress4G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="c"># &quot;Test BZ2Decompressor.decompress() with &gt;4GiB input&quot;</span>
        <span class="n">blocksize</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span>
        <span class="n">block</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">getrandbits</span><span class="p">(</span><span class="n">blocksize</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">blocksize</span><span class="p">,</span> <span class="s">&#39;little&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">block</span> <span class="o">*</span> <span class="p">(</span><span class="n">size</span> <span class="o">//</span> <span class="n">blocksize</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">compressed</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">bz2d</span> <span class="o">=</span> <span class="n">BZ2Decompressor</span><span class="p">()</span>
            <span class="n">decompressed</span> <span class="o">=</span> <span class="n">bz2d</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">compressed</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">decompressed</span> <span class="o">==</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">compressed</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">decompressed</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="BZ2DecompressorTest.testPickle"><a class="viewcode-back" href="../../test.html#test.test_bz2.BZ2DecompressorTest.testPickle">[docs]</a>    <span class="k">def</span> <span class="nf">testPickle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">BZ2Decompressor</span><span class="p">())</span>

</div></div>
<div class="viewcode-block" id="CompressDecompressTest"><a class="viewcode-back" href="../../test.html#test.test_bz2.CompressDecompressTest">[docs]</a><span class="k">class</span> <span class="nc">CompressDecompressTest</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="CompressDecompressTest.testCompress"><a class="viewcode-back" href="../../test.html#test.test_bz2.CompressDecompressTest.testCompress">[docs]</a>    <span class="k">def</span> <span class="nf">testCompress</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CompressDecompressTest.testCompressEmptyString"><a class="viewcode-back" href="../../test.html#test.test_bz2.CompressDecompressTest.testCompressEmptyString">[docs]</a>    <span class="k">def</span> <span class="nf">testCompressEmptyString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">EMPTY_DATA</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CompressDecompressTest.testDecompress"><a class="viewcode-back" href="../../test.html#test.test_bz2.CompressDecompressTest.testDecompress">[docs]</a>    <span class="k">def</span> <span class="nf">testDecompress</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CompressDecompressTest.testDecompressEmpty"><a class="viewcode-back" href="../../test.html#test.test_bz2.CompressDecompressTest.testDecompressEmpty">[docs]</a>    <span class="k">def</span> <span class="nf">testDecompressEmpty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CompressDecompressTest.testDecompressToEmptyString"><a class="viewcode-back" href="../../test.html#test.test_bz2.CompressDecompressTest.testDecompressToEmptyString">[docs]</a>    <span class="k">def</span> <span class="nf">testDecompressToEmptyString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EMPTY_DATA</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CompressDecompressTest.testDecompressIncomplete"><a class="viewcode-back" href="../../test.html#test.test_bz2.CompressDecompressTest.testDecompressIncomplete">[docs]</a>    <span class="k">def</span> <span class="nf">testDecompressIncomplete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">bz2</span><span class="o">.</span><span class="n">decompress</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">[:</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="CompressDecompressTest.testDecompressBadData"><a class="viewcode-back" href="../../test.html#test.test_bz2.CompressDecompressTest.testDecompressBadData">[docs]</a>    <span class="k">def</span> <span class="nf">testDecompressBadData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="n">bz2</span><span class="o">.</span><span class="n">decompress</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">BAD_DATA</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CompressDecompressTest.testDecompressMultiStream"><a class="viewcode-back" href="../../test.html#test.test_bz2.CompressDecompressTest.testDecompressMultiStream">[docs]</a>    <span class="k">def</span> <span class="nf">testDecompressMultiStream</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CompressDecompressTest.testDecompressTrailingJunk"><a class="viewcode-back" href="../../test.html#test.test_bz2.CompressDecompressTest.testDecompressTrailingJunk">[docs]</a>    <span class="k">def</span> <span class="nf">testDecompressTrailingJunk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">BAD_DATA</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CompressDecompressTest.testDecompressMultiStreamTrailingJunk"><a class="viewcode-back" href="../../test.html#test.test_bz2.CompressDecompressTest.testDecompressMultiStreamTrailingJunk">[docs]</a>    <span class="k">def</span> <span class="nf">testDecompressMultiStreamTrailingJunk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">BAD_DATA</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="OpenTest"><a class="viewcode-back" href="../../test.html#test.test_bz2.OpenTest">[docs]</a><span class="k">class</span> <span class="nc">OpenTest</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
    <span class="s">&quot;Test the open function.&quot;</span>

<div class="viewcode-block" id="OpenTest.open"><a class="viewcode-back" href="../../test.html#test.test_bz2.OpenTest.open">[docs]</a>    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">bz2</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OpenTest.test_binary_modes"><a class="viewcode-back" href="../../test.html#test.test_bz2.OpenTest.test_binary_modes">[docs]</a>    <span class="k">def</span> <span class="nf">test_binary_modes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;wb&quot;</span><span class="p">,</span> <span class="s">&quot;xb&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s">&quot;xb&quot;</span><span class="p">:</span>
                <span class="n">unlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">file_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">file_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;ab&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">file_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">file_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OpenTest.test_implicit_binary_modes"><a class="viewcode-back" href="../../test.html#test.test_bz2.OpenTest.test_implicit_binary_modes">[docs]</a>    <span class="k">def</span> <span class="nf">test_implicit_binary_modes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test implicit binary modes (no &quot;b&quot; or &quot;t&quot; in mode string).</span>
        <span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;w&quot;</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s">&quot;x&quot;</span><span class="p">:</span>
                <span class="n">unlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">file_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">file_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">file_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">file_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OpenTest.test_text_modes"><a class="viewcode-back" href="../../test.html#test.test_bz2.OpenTest.test_text_modes">[docs]</a>    <span class="k">def</span> <span class="nf">test_text_modes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;ascii&quot;</span><span class="p">)</span>
        <span class="n">text_native_eol</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;wt&quot;</span><span class="p">,</span> <span class="s">&quot;xt&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s">&quot;xt&quot;</span><span class="p">:</span>
                <span class="n">unlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">file_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;ascii&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">file_data</span><span class="p">,</span> <span class="n">text_native_eol</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">text</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;at&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">file_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;ascii&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">file_data</span><span class="p">,</span> <span class="n">text_native_eol</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OpenTest.test_x_mode"><a class="viewcode-back" href="../../test.html#test.test_bz2.OpenTest.test_x_mode">[docs]</a>    <span class="k">def</span> <span class="nf">test_x_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;xb&quot;</span><span class="p">,</span> <span class="s">&quot;xt&quot;</span><span class="p">):</span>
            <span class="n">unlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">FileExistsError</span><span class="p">):</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="k">pass</span>
</div>
<div class="viewcode-block" id="OpenTest.test_fileobj"><a class="viewcode-back" href="../../test.html#test.test_bz2.OpenTest.test_fileobj">[docs]</a>    <span class="k">def</span> <span class="nf">test_fileobj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">),</span> <span class="s">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">),</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;ascii&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA</span><span class="p">),</span> <span class="s">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">text</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OpenTest.test_bad_params"><a class="viewcode-back" href="../../test.html#test.test_bz2.OpenTest.test_bad_params">[docs]</a>    <span class="k">def</span> <span class="nf">test_bad_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test invalid parameter combinations.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;wbt&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;xbt&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s">&quot;ignore&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OpenTest.test_encoding"><a class="viewcode-back" href="../../test.html#test.test_bz2.OpenTest.test_encoding">[docs]</a>    <span class="k">def</span> <span class="nf">test_encoding</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test non-default encoding.</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;ascii&quot;</span><span class="p">)</span>
        <span class="n">text_native_eol</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;wt&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-16-le&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;utf-16-le&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">file_data</span><span class="p">,</span> <span class="n">text_native_eol</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rt&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-16-le&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">text</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OpenTest.test_encoding_error_handler"><a class="viewcode-back" href="../../test.html#test.test_bz2.OpenTest.test_encoding_error_handler">[docs]</a>    <span class="k">def</span> <span class="nf">test_encoding_error_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test with non-default encoding error handler.</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;foo</span><span class="se">\xff</span><span class="s">bar&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rt&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;ascii&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s">&quot;ignore&quot;</span><span class="p">)</span> \
                <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="s">&quot;foobar&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OpenTest.test_newline"><a class="viewcode-back" href="../../test.html#test.test_bz2.OpenTest.test_newline">[docs]</a>    <span class="k">def</span> <span class="nf">test_newline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test with explicit newline (universal newline mode disabled).</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;ascii&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;wt&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rt&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">(),</span> <span class="p">[</span><span class="n">text</span><span class="p">])</span>

</div></div>
<div class="viewcode-block" id="test_main"><a class="viewcode-back" href="../../test.html#test.test_bz2.test_main">[docs]</a><span class="k">def</span> <span class="nf">test_main</span><span class="p">():</span>
    <span class="n">support</span><span class="o">.</span><span class="n">run_unittest</span><span class="p">(</span>
        <span class="n">BZ2FileTest</span><span class="p">,</span>
        <span class="n">BZ2CompressorTest</span><span class="p">,</span>
        <span class="n">BZ2DecompressorTest</span><span class="p">,</span>
        <span class="n">CompressDecompressTest</span><span class="p">,</span>
        <span class="n">OpenTest</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">support</span><span class="o">.</span><span class="n">reap_children</span><span class="p">()</span>
</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">test_main</span><span class="p">()</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>