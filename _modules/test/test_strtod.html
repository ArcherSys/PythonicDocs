

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_strtod &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_strtod</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_strtod</h1><div class="highlight"><pre>
<span class="c"># Tests for the correctly-rounded string -&gt; float conversions</span>
<span class="c"># introduced in Python 2.7 and 3.1.</span>

<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">test.support</span>

<span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">&#39;float_repr_style&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s">&#39;short&#39;</span><span class="p">:</span>
    <span class="k">raise</span> <span class="n">unittest</span><span class="o">.</span><span class="n">SkipTest</span><span class="p">(</span><span class="s">&#39;correctly-rounded string-&gt;float conversions &#39;</span>
                            <span class="s">&#39;not available on this system&#39;</span><span class="p">)</span>

<span class="c"># Correctly rounded str -&gt; float in pure Python, for comparison.</span>

<span class="n">strtod_parser</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;&quot;&quot;    # A numeric string consists of:</span>
<span class="s">    (?P&lt;sign&gt;[-+])?          # an optional sign, followed by</span>
<span class="s">    (?=\d|\.\d)              # a number with at least one digit</span>
<span class="s">    (?P&lt;int&gt;\d*)             # having a (possibly empty) integer part</span>
<span class="s">    (?:\.(?P&lt;frac&gt;\d*))?     # followed by an optional fractional part</span>
<span class="s">    (?:E(?P&lt;exp&gt;[-+]?\d+))?  # and an optional exponent</span>
<span class="s">    \Z</span>
<span class="s">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span><span class="o">.</span><span class="n">match</span>

<span class="c"># Pure Python version of correctly rounded string-&gt;float conversion.</span>
<span class="c"># Avoids any use of floating-point by returning the result as a hex string.</span>
<div class="viewcode-block" id="strtod"><a class="viewcode-back" href="../../test.html#test.test_strtod.strtod">[docs]</a><span class="k">def</span> <span class="nf">strtod</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">mant_dig</span><span class="o">=</span><span class="mi">53</span><span class="p">,</span> <span class="n">min_exp</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1021</span><span class="p">,</span> <span class="n">max_exp</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a finite decimal string to a hex string representing an</span>
<span class="sd">    IEEE 754 binary64 float.  Return &#39;inf&#39; or &#39;-inf&#39; on overflow.</span>
<span class="sd">    This function makes no use of floating-point arithmetic at any</span>
<span class="sd">    stage.&quot;&quot;&quot;</span>

    <span class="c"># parse string into a pair of integers &#39;a&#39; and &#39;b&#39; such that</span>
    <span class="c"># abs(decimal value) = a/b, along with a boolean &#39;negative&#39;.</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">strtod_parser</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;invalid numeric string&#39;</span><span class="p">)</span>
    <span class="n">fraction</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;frac&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s">&#39;&#39;</span>
    <span class="n">intpart</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;int&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">fraction</span><span class="p">)</span>
    <span class="n">exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;exp&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s">&#39;0&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
    <span class="n">negative</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;sign&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;-&#39;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">intpart</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="nb">max</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">10</span><span class="o">**</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">exp</span><span class="p">)</span>

    <span class="c"># quick return for zeros</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">a</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&#39;-0x0.0p+0&#39;</span> <span class="k">if</span> <span class="n">negative</span> <span class="k">else</span> <span class="s">&#39;0x0.0p+0&#39;</span>

    <span class="c"># compute exponent e for result; may be one too small in the case</span>
    <span class="c"># that the rounded value of a/b lies in a different binade from a/b</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">+=</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="n">d</span> <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="o">-</span><span class="n">d</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">b</span>
    <span class="n">e</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">min_exp</span><span class="p">)</span> <span class="o">-</span> <span class="n">mant_dig</span>

    <span class="c"># approximate a/b by number of the form q * 2**e; adjust e if necessary</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span> <span class="o">&gt;</span> <span class="n">b</span> <span class="ow">or</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span> <span class="o">==</span> <span class="n">b</span> <span class="ow">and</span> <span class="n">q</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">q</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">q</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">==</span> <span class="n">mant_dig</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">q</span> <span class="o">//=</span> <span class="mi">2</span>
            <span class="n">e</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c"># double check that (q, e) has the right form</span>
    <span class="k">assert</span> <span class="n">q</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">mant_dig</span> <span class="ow">and</span> <span class="n">e</span> <span class="o">&gt;=</span> <span class="n">min_exp</span> <span class="o">-</span> <span class="n">mant_dig</span>
    <span class="k">assert</span> <span class="n">q</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">==</span> <span class="n">mant_dig</span> <span class="ow">or</span> <span class="n">e</span> <span class="o">==</span> <span class="n">min_exp</span> <span class="o">-</span> <span class="n">mant_dig</span>

    <span class="c"># check for overflow and underflow</span>
    <span class="k">if</span> <span class="n">e</span> <span class="o">+</span> <span class="n">q</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">max_exp</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&#39;-inf&#39;</span> <span class="k">if</span> <span class="n">negative</span> <span class="k">else</span> <span class="s">&#39;inf&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">q</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&#39;-0x0.0p+0&#39;</span> <span class="k">if</span> <span class="n">negative</span> <span class="k">else</span> <span class="s">&#39;0x0.0p+0&#39;</span>

    <span class="c"># for hex representation, shift so # bits after point is a multiple of 4</span>
    <span class="n">hexdigs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">mant_dig</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">//</span><span class="mi">4</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">-</span> <span class="p">(</span><span class="n">mant_dig</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">%</span><span class="mi">4</span>
    <span class="n">q</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">q</span> <span class="o">&lt;&lt;</span> <span class="n">shift</span><span class="p">,</span> <span class="n">e</span> <span class="o">-</span> <span class="n">shift</span>
    <span class="k">return</span> <span class="s">&#39;{}0x{:x}.{:0{}x}p{:+d}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="s">&#39;-&#39;</span> <span class="k">if</span> <span class="n">negative</span> <span class="k">else</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
        <span class="n">q</span> <span class="o">//</span> <span class="mi">16</span><span class="o">**</span><span class="n">hexdigs</span><span class="p">,</span>
        <span class="n">q</span> <span class="o">%</span> <span class="mi">16</span><span class="o">**</span><span class="n">hexdigs</span><span class="p">,</span>
        <span class="n">hexdigs</span><span class="p">,</span>
        <span class="n">e</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">hexdigs</span><span class="p">)</span>
</div>
<span class="n">TEST_SIZE</span> <span class="o">=</span> <span class="mi">10</span>

<div class="viewcode-block" id="StrtodTests"><a class="viewcode-back" href="../../test.html#test.test_strtod.StrtodTests">[docs]</a><span class="k">class</span> <span class="nc">StrtodTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="StrtodTests.check_strtod"><a class="viewcode-back" href="../../test.html#test.test_strtod.StrtodTests.check_strtod">[docs]</a>    <span class="k">def</span> <span class="nf">check_strtod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compare the result of Python&#39;s builtin correctly rounded</span>
<span class="sd">        string-&gt;float conversion (using float) to a pure Python</span>
<span class="sd">        correctly rounded string-&gt;float implementation.  Fail if the</span>
<span class="sd">        two methods give different results.&quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">fs</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
            <span class="n">got</span> <span class="o">=</span> <span class="s">&#39;-inf&#39;</span> <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;-&#39;</span> <span class="k">else</span> <span class="s">&#39;inf&#39;</span>
        <span class="k">except</span> <span class="ne">MemoryError</span><span class="p">:</span>
            <span class="n">got</span> <span class="o">=</span> <span class="s">&#39;memory error&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">got</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="n">strtod</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">got</span><span class="p">,</span>
                         <span class="s">&quot;Incorrectly rounded str-&gt;float conversion for {}: &quot;</span>
                         <span class="s">&quot;expected {}, got {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span> <span class="n">got</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="StrtodTests.test_short_halfway_cases"><a class="viewcode-back" href="../../test.html#test.test_strtod.StrtodTests.test_short_halfway_cases">[docs]</a>    <span class="k">def</span> <span class="nf">test_short_halfway_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># exact halfway cases with a small number of significant digits</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span>
            <span class="c"># upper = smallest integer &gt;= 2**54/5**k</span>
            <span class="n">upper</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">**</span><span class="mi">54</span><span class="o">//</span><span class="mi">5</span><span class="o">**</span><span class="n">k</span><span class="p">)</span>
            <span class="c"># lower = smallest odd number &gt;= 2**53/5**k</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">**</span><span class="mi">53</span><span class="o">//</span><span class="mi">5</span><span class="o">**</span><span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">lower</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">lower</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">TEST_SIZE</span><span class="p">):</span>
                <span class="c"># Select a random odd n in [2**53/5**k,</span>
                <span class="c"># 2**54/5**k). Then n * 10**k gives a halfway case</span>
                <span class="c"># with small number of significant digits.</span>
                <span class="n">n</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">k</span>

                <span class="c"># Remove any additional powers of 5.</span>
                <span class="k">while</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">n</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">5</span><span class="p">,</span> <span class="n">e</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">assert</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">10</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

                <span class="c"># Try numbers of the form n * 2**p2 * 10**e, p2 &gt;= 0,</span>
                <span class="c"># until n * 2**p2 has more than 20 significant digits.</span>
                <span class="n">digits</span><span class="p">,</span> <span class="n">exponent</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">e</span>
                <span class="k">while</span> <span class="n">digits</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">**</span><span class="mi">20</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;{}e{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">digits</span><span class="p">,</span> <span class="n">exponent</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">check_strtod</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                    <span class="c"># Same again, but with extra trailing zeros.</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;{}e{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">digits</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">40</span><span class="p">,</span> <span class="n">exponent</span> <span class="o">-</span> <span class="mi">40</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">check_strtod</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                    <span class="n">digits</span> <span class="o">*=</span> <span class="mi">2</span>

                <span class="c"># Try numbers of the form n * 5**p2 * 10**(e - p5), p5</span>
                <span class="c"># &gt;= 0, with n * 5**p5 &lt; 10**20.</span>
                <span class="n">digits</span><span class="p">,</span> <span class="n">exponent</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">e</span>
                <span class="k">while</span> <span class="n">digits</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">**</span><span class="mi">20</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;{}e{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">digits</span><span class="p">,</span> <span class="n">exponent</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">check_strtod</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                    <span class="c"># Same again, but with extra trailing zeros.</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;{}e{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">digits</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">40</span><span class="p">,</span> <span class="n">exponent</span> <span class="o">-</span> <span class="mi">40</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">check_strtod</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                    <span class="n">digits</span> <span class="o">*=</span> <span class="mi">5</span>
                    <span class="n">exponent</span> <span class="o">-=</span> <span class="mi">1</span>
</div>
<div class="viewcode-block" id="StrtodTests.test_halfway_cases"><a class="viewcode-back" href="../../test.html#test.test_strtod.StrtodTests.test_halfway_cases">[docs]</a>    <span class="k">def</span> <span class="nf">test_halfway_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># test halfway cases for the round-half-to-even rule</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">TEST_SIZE</span><span class="p">):</span>
            <span class="c"># bit pattern for a random finite positive (or +0.0) float</span>
            <span class="n">bits</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">2047</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="mi">52</span><span class="p">)</span>

            <span class="c"># convert bit pattern to a number of the form m * 2**e</span>
            <span class="n">e</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">52</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">m</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">2</span><span class="o">**</span><span class="mi">52</span><span class="p">,</span> <span class="n">e</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">e</span> <span class="o">-=</span> <span class="mi">1074</span>

            <span class="c"># add 0.5 ulps</span>
            <span class="n">m</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">e</span> <span class="o">-</span> <span class="mi">1</span>

            <span class="c"># convert to a decimal string</span>
            <span class="k">if</span> <span class="n">e</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">digits</span> <span class="o">=</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="n">e</span>
                <span class="n">exponent</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># m * 2**e = (m * 5**-e) * 10**e</span>
                <span class="n">digits</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="mi">5</span><span class="o">**-</span><span class="n">e</span>
                <span class="n">exponent</span> <span class="o">=</span> <span class="n">e</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;{}e{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">digits</span><span class="p">,</span> <span class="n">exponent</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_strtod</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrtodTests.test_boundaries"><a class="viewcode-back" href="../../test.html#test.test_strtod.StrtodTests.test_boundaries">[docs]</a>    <span class="k">def</span> <span class="nf">test_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># boundaries expressed as triples (n, e, u), where</span>
        <span class="c"># n*10**e is an approximation to the boundary value and</span>
        <span class="c"># u*10**e is 1ulp</span>
        <span class="n">boundaries</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="mi">10000000000000000000</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span><span class="p">,</span> <span class="mi">1110</span><span class="p">),</span>   <span class="c"># a power of 2 boundary (1.0)</span>
            <span class="p">(</span><span class="mi">17976931348623159077</span><span class="p">,</span> <span class="mi">289</span><span class="p">,</span> <span class="mi">1995</span><span class="p">),</span>   <span class="c"># overflow boundary (2.**1024)</span>
            <span class="p">(</span><span class="mi">22250738585072013831</span><span class="p">,</span> <span class="o">-</span><span class="mi">327</span><span class="p">,</span> <span class="mi">4941</span><span class="p">),</span>  <span class="c"># normal/subnormal (2.**-1022)</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">327</span><span class="p">,</span> <span class="mi">4941</span><span class="p">),</span>                     <span class="c"># zero</span>
            <span class="p">]</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
                <span class="n">digits</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">u</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">u</span><span class="p">)</span>
                <span class="n">exponent</span> <span class="o">=</span> <span class="n">e</span>
                <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;{}e{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">digits</span><span class="p">,</span> <span class="n">exponent</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">check_strtod</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                <span class="n">n</span> <span class="o">*=</span> <span class="mi">10</span>
                <span class="n">u</span> <span class="o">*=</span> <span class="mi">10</span>
                <span class="n">e</span> <span class="o">-=</span> <span class="mi">1</span>
</div>
<div class="viewcode-block" id="StrtodTests.test_underflow_boundary"><a class="viewcode-back" href="../../test.html#test.test_strtod.StrtodTests.test_underflow_boundary">[docs]</a>    <span class="k">def</span> <span class="nf">test_underflow_boundary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># test values close to 2**-1075, the underflow boundary; similar</span>
        <span class="c"># to boundary_tests, except that the random error doesn&#39;t scale</span>
        <span class="c"># with n</span>
        <span class="k">for</span> <span class="n">exponent</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span> <span class="o">-</span><span class="mi">320</span><span class="p">):</span>
            <span class="n">base</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**-</span><span class="n">exponent</span> <span class="o">//</span> <span class="mi">2</span><span class="o">**</span><span class="mi">1075</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">TEST_SIZE</span><span class="p">):</span>
                <span class="n">digits</span> <span class="o">=</span> <span class="n">base</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
                <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;{}e{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">digits</span><span class="p">,</span> <span class="n">exponent</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">check_strtod</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrtodTests.test_bigcomp"><a class="viewcode-back" href="../../test.html#test.test_strtod.StrtodTests.test_bigcomp">[docs]</a>    <span class="k">def</span> <span class="nf">test_bigcomp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ndigs</span> <span class="ow">in</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">50</span><span class="p">:</span>
            <span class="n">dig10</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">ndigs</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">TEST_SIZE</span><span class="p">):</span>
                <span class="n">digits</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">dig10</span><span class="p">)</span>
                <span class="n">exponent</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
                <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;{}e{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">digits</span><span class="p">,</span> <span class="n">exponent</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">check_strtod</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrtodTests.test_parsing"><a class="viewcode-back" href="../../test.html#test.test_strtod.StrtodTests.test_parsing">[docs]</a>    <span class="k">def</span> <span class="nf">test_parsing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># make &#39;0&#39; more likely to be chosen than other digits</span>
        <span class="n">digits</span> <span class="o">=</span> <span class="s">&#39;000000123456789&#39;</span>
        <span class="n">signs</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;+&#39;</span><span class="p">,</span> <span class="s">&#39;-&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>

        <span class="c"># put together random short valid strings</span>
        <span class="c"># \d*[.\d*]?e</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">TEST_SIZE</span><span class="p">):</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">signs</span><span class="p">)</span>
                <span class="n">intpart_len</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">intpart_len</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]):</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;.&#39;</span>
                    <span class="n">fracpart_len</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
                                 <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">fracpart_len</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fracpart_len</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]):</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;E&#39;</span><span class="p">])</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">signs</span><span class="p">)</span>
                    <span class="n">exponent_len</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
                                 <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">exponent_len</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">intpart_len</span> <span class="o">+</span> <span class="n">fracpart_len</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">check_strtod</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">assert</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&quot;expected ValueError&quot;</span>
</div>
    <span class="nd">@test.support.bigmemtest</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="n">support</span><span class="o">.</span><span class="n">_2G</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="n">memuse</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dry_run</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_oversized_digit_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maxsize</span><span class="p">):</span>
        <span class="c"># Input string whose length doesn&#39;t fit in an INT.</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;1.&quot;</span> <span class="o">+</span> <span class="s">&quot;1&quot;</span> <span class="o">*</span> <span class="n">maxsize</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">s</span>

        <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;0.&quot;</span> <span class="o">+</span> <span class="s">&quot;0&quot;</span> <span class="o">*</span> <span class="n">maxsize</span> <span class="o">+</span> <span class="s">&quot;1&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">s</span>

<div class="viewcode-block" id="StrtodTests.test_large_exponents"><a class="viewcode-back" href="../../test.html#test.test_strtod.StrtodTests.test_large_exponents">[docs]</a>    <span class="k">def</span> <span class="nf">test_large_exponents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Verify that the clipping of the exponent in strtod doesn&#39;t affect the</span>
        <span class="c"># output values.</span>
        <span class="k">def</span> <span class="nf">positive_exp</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; Long string with value 1.0 and exponent n&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="s">&#39;0.{}1e+{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">n</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">negative_exp</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; Long string with value 1.0 and exponent -n&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="s">&#39;1{}e-{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">positive_exp</span><span class="p">(</span><span class="mi">10000</span><span class="p">)),</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">positive_exp</span><span class="p">(</span><span class="mi">20000</span><span class="p">)),</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">positive_exp</span><span class="p">(</span><span class="mi">30000</span><span class="p">)),</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">negative_exp</span><span class="p">(</span><span class="mi">10000</span><span class="p">)),</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">negative_exp</span><span class="p">(</span><span class="mi">20000</span><span class="p">)),</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">negative_exp</span><span class="p">(</span><span class="mi">30000</span><span class="p">)),</span> <span class="mf">1.0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrtodTests.test_particular"><a class="viewcode-back" href="../../test.html#test.test_strtod.StrtodTests.test_particular">[docs]</a>    <span class="k">def</span> <span class="nf">test_particular</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># inputs that produced crashes or incorrectly rounded results with</span>
        <span class="c"># previous versions of dtoa.c, for various reasons</span>
        <span class="n">test_strings</span> <span class="o">=</span> <span class="p">[</span>
            <span class="c"># issue 7632 bug 1, originally reported failing case</span>
            <span class="s">&#39;2183167012312112312312.23538020374420446192e-370&#39;</span><span class="p">,</span>
            <span class="c"># 5 instances of issue 7632 bug 2</span>
            <span class="s">&#39;12579816049008305546974391768996369464963024663104e-357&#39;</span><span class="p">,</span>
            <span class="s">&#39;17489628565202117263145367596028389348922981857013e-357&#39;</span><span class="p">,</span>
            <span class="s">&#39;18487398785991994634182916638542680759613590482273e-357&#39;</span><span class="p">,</span>
            <span class="s">&#39;32002864200581033134358724675198044527469366773928e-358&#39;</span><span class="p">,</span>
            <span class="s">&#39;94393431193180696942841837085033647913224148539854e-358&#39;</span><span class="p">,</span>
            <span class="s">&#39;73608278998966969345824653500136787876436005957953e-358&#39;</span><span class="p">,</span>
            <span class="s">&#39;64774478836417299491718435234611299336288082136054e-358&#39;</span><span class="p">,</span>
            <span class="s">&#39;13704940134126574534878641876947980878824688451169e-357&#39;</span><span class="p">,</span>
            <span class="s">&#39;46697445774047060960624497964425416610480524760471e-358&#39;</span><span class="p">,</span>
            <span class="c"># failing case for bug introduced by METD in r77451 (attempted</span>
            <span class="c"># fix for issue 7632, bug 2), and fixed in r77482.</span>
            <span class="s">&#39;28639097178261763178489759107321392745108491825303e-311&#39;</span><span class="p">,</span>
            <span class="c"># two numbers demonstrating a flaw in the bigcomp &#39;dig == 0&#39;</span>
            <span class="c"># correction block (issue 7632, bug 3)</span>
            <span class="s">&#39;1.00000000000000001e44&#39;</span><span class="p">,</span>
            <span class="s">&#39;1.0000000000000000100000000000000000000001e44&#39;</span><span class="p">,</span>
            <span class="c"># dtoa.c bug for numbers just smaller than a power of 2 (issue</span>
            <span class="c"># 7632, bug 4)</span>
            <span class="s">&#39;99999999999999994487665465554760717039532578546e-47&#39;</span><span class="p">,</span>
            <span class="c"># failing case for off-by-one error introduced by METD in</span>
            <span class="c"># r77483 (dtoa.c cleanup), fixed in r77490</span>
            <span class="s">&#39;965437176333654931799035513671997118345570045914469&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;6213413350821416312194420007991306908470147322020121018368e0&#39;</span><span class="p">,</span>
            <span class="c"># incorrect lsb detection for round-half-to-even when</span>
            <span class="c"># bc-&gt;scale != 0 (issue 7632, bug 6).</span>
            <span class="s">&#39;104308485241983990666713401708072175773165034278685&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;682646111762292409330928739751702404658197872319129&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;036519947435319418387839758990478549477777586673075&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;945844895981012024387992135617064532141489278815239&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;849108105951619997829153633535314849999674266169258&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;928940692239684771590065027025835804863585454872499&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;320500023126142553932654370362024104462255244034053&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;203998964360882487378334860197725139151265590832887&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;433736189468858614521708567646743455601905935595381&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;852723723645799866672558576993978025033590728687206&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;296379801363024094048327273913079612469982585674824&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;156000783167963081616214710691759864332339239688734&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;656548790656486646106983450809073750535624894296242&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;072010195710276073042036425579852459556183541199012&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;652571123898996574563824424330960027873516082763671875e-1075&#39;</span><span class="p">,</span>
            <span class="c"># demonstration that original fix for issue 7632 bug 1 was</span>
            <span class="c"># buggy; the exit condition was too strong</span>
            <span class="s">&#39;247032822920623295e-341&#39;</span><span class="p">,</span>
            <span class="c"># demonstrate similar problem to issue 7632 bug1: crash</span>
            <span class="c"># with &#39;oversized quotient in quorem&#39; message.</span>
            <span class="s">&#39;99037485700245683102805043437346965248029601286431e-373&#39;</span><span class="p">,</span>
            <span class="s">&#39;99617639833743863161109961162881027406769510558457e-373&#39;</span><span class="p">,</span>
            <span class="s">&#39;98852915025769345295749278351563179840130565591462e-372&#39;</span><span class="p">,</span>
            <span class="s">&#39;99059944827693569659153042769690930905148015876788e-373&#39;</span><span class="p">,</span>
            <span class="s">&#39;98914979205069368270421829889078356254059760327101e-372&#39;</span><span class="p">,</span>
            <span class="c"># issue 7632 bug 5: the following 2 strings convert differently</span>
            <span class="s">&#39;1000000000000000000000000000000000000000e-16&#39;</span><span class="p">,</span>
            <span class="s">&#39;10000000000000000000000000000000000000000e-17&#39;</span><span class="p">,</span>
            <span class="c"># issue 7632 bug 7</span>
            <span class="s">&#39;991633793189150720000000000000000000000000000000000000000e-33&#39;</span><span class="p">,</span>
            <span class="c"># And another, similar, failing halfway case</span>
            <span class="s">&#39;4106250198039490000000000000000000000000000000000000000e-38&#39;</span><span class="p">,</span>
            <span class="c"># issue 7632 bug 8:  the following produced 10.0</span>
            <span class="s">&#39;10.900000000000000012345678912345678912345&#39;</span><span class="p">,</span>

            <span class="c"># two humongous values from issue 7743</span>
            <span class="s">&#39;116512874940594195638617907092569881519034793229385&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;228569165191541890846564669771714896916084883987920&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;473321268100296857636200926065340769682863349205363&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;349247637660671783209907949273683040397979984107806&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;461822693332712828397617946036239581632976585100633&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;520260770761060725403904123144384571612073732754774&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;588211944406465572591022081973828448927338602556287&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;851831745419397433012491884869454462440536895047499&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;436551974649731917170099387762871020403582994193439&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;761933412166821484015883631622539314203799034497982&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;130038741741727907429575673302461380386596501187482&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;006257527709842179336488381672818798450229339123527&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;858844448336815912020452294624916993546388956561522&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;161875352572590420823607478788399460162228308693742&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;05287663441403533948204085390898399055004119873046875e-1075&#39;</span><span class="p">,</span>

            <span class="s">&#39;525440653352955266109661060358202819561258984964913&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;892256527849758956045218257059713765874251436193619&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;443248205998870001633865657517447355992225852945912&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;016668660000210283807209850662224417504752264995360&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;631512007753855801075373057632157738752800840302596&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;237050247910530538250008682272783660778181628040733&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;653121492436408812668023478001208529190359254322340&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;397575185248844788515410722958784640926528544043090&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;115352513640884988017342469275006999104519620946430&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;818767147966495485406577703972687838176778993472989&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;561959000047036638938396333146685137903018376496408&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;319705333868476925297317136513970189073693314710318&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;991252811050501448326875232850600451776091303043715&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;157191292827614046876950225714743118291034780466325&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;085141343734564915193426994587206432697337118211527&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;278968731294639353354774788602467795167875117481660&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;4738791256853675690543663283782215866825e-1180&#39;</span><span class="p">,</span>

            <span class="c"># exercise exit conditions in bigcomp comparison loop</span>
            <span class="s">&#39;2602129298404963083833853479113577253105939995688e2&#39;</span><span class="p">,</span>
            <span class="s">&#39;260212929840496308383385347911357725310593999568896e0&#39;</span><span class="p">,</span>
            <span class="s">&#39;26021292984049630838338534791135772531059399956889601e-2&#39;</span><span class="p">,</span>
            <span class="s">&#39;260212929840496308383385347911357725310593999568895e0&#39;</span><span class="p">,</span>
            <span class="s">&#39;260212929840496308383385347911357725310593999568897e0&#39;</span><span class="p">,</span>
            <span class="s">&#39;260212929840496308383385347911357725310593999568996e0&#39;</span><span class="p">,</span>
            <span class="s">&#39;260212929840496308383385347911357725310593999568866e0&#39;</span><span class="p">,</span>
            <span class="c"># 2**53</span>
            <span class="s">&#39;9007199254740992.00&#39;</span><span class="p">,</span>
            <span class="c"># 2**1024 - 2**970:  exact overflow boundary.  All values</span>
            <span class="c"># smaller than this should round to something finite;  any value</span>
            <span class="c"># greater than or equal to this one overflows.</span>
            <span class="s">&#39;179769313486231580793728971405303415079934132710037&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;826936173778980444968292764750946649017977587207096&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;330286416692887910946555547851940402630657488671505&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;820681908902000708383676273854845817711531764475730&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;270069855571366959622842914819860834936475292719074&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;168444365510704342711559699508093042880177904174497792&#39;</span><span class="p">,</span>
            <span class="c"># 2**1024 - 2**970 - tiny</span>
            <span class="s">&#39;179769313486231580793728971405303415079934132710037&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;826936173778980444968292764750946649017977587207096&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;330286416692887910946555547851940402630657488671505&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;820681908902000708383676273854845817711531764475730&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;270069855571366959622842914819860834936475292719074&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;168444365510704342711559699508093042880177904174497791.999&#39;</span><span class="p">,</span>
            <span class="c"># 2**1024 - 2**970 + tiny</span>
            <span class="s">&#39;179769313486231580793728971405303415079934132710037&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;826936173778980444968292764750946649017977587207096&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;330286416692887910946555547851940402630657488671505&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;820681908902000708383676273854845817711531764475730&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;270069855571366959622842914819860834936475292719074&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;168444365510704342711559699508093042880177904174497792.001&#39;</span><span class="p">,</span>
            <span class="c"># 1 - 2**-54, +-tiny</span>
            <span class="s">&#39;999999999999999944488848768742172978818416595458984375e-54&#39;</span><span class="p">,</span>
            <span class="s">&#39;9999999999999999444888487687421729788184165954589843749999999e-54&#39;</span><span class="p">,</span>
            <span class="s">&#39;9999999999999999444888487687421729788184165954589843750000001e-54&#39;</span><span class="p">,</span>
            <span class="c"># Value found by Rick Regan that gives a result of 2**-968</span>
            <span class="c"># under Gay&#39;s dtoa.c (as of Nov 04, 2010);  since fixed.</span>
            <span class="c"># (Fixed some time ago in Python&#39;s dtoa.c.)</span>
            <span class="s">&#39;0.0000000000000000000000000000000000000000100000000&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;000000000576129113423785429971690421191214034235435&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;087147763178149762956868991692289869941246658073194&#39;</span> <span class="c">#...</span>
            <span class="s">&#39;51982237978882039897143840789794921875&#39;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">test_strings</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_strtod</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="test_main"><a class="viewcode-back" href="../../test.html#test.test_strtod.test_main">[docs]</a><span class="k">def</span> <span class="nf">test_main</span><span class="p">():</span>
    <span class="n">test</span><span class="o">.</span><span class="n">support</span><span class="o">.</span><span class="n">run_unittest</span><span class="p">(</span><span class="n">StrtodTests</span><span class="p">)</span>
</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">test_main</span><span class="p">()</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>