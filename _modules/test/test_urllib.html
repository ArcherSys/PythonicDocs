

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_urllib &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_urllib</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_urllib</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;Regresssion tests for urllib&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">urllib.parse</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">urllib.error</span>
<span class="kn">import</span> <span class="nn">http.client</span>
<span class="kn">import</span> <span class="nn">email.message</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">from</span> <span class="nn">unittest.mock</span> <span class="kn">import</span> <span class="n">patch</span>
<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">support</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">from</span> <span class="nn">nturl2path</span> <span class="kn">import</span> <span class="n">url2pathname</span><span class="p">,</span> <span class="n">pathname2url</span>

<span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span>
<span class="kn">import</span> <span class="nn">collections</span>


<div class="viewcode-block" id="hexescape"><a class="viewcode-back" href="../../test.html#test.test_urllib.hexescape">[docs]</a><span class="k">def</span> <span class="nf">hexescape</span><span class="p">(</span><span class="n">char</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Escape char as RFC 2396 specifies&quot;&quot;&quot;</span>
    <span class="n">hex_repr</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hex_repr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">hex_repr</span> <span class="o">=</span> <span class="s">&quot;0</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">hex_repr</span>
    <span class="k">return</span> <span class="s">&quot;%&quot;</span> <span class="o">+</span> <span class="n">hex_repr</span>

<span class="c"># Shortcut for testing FancyURLopener</span></div>
<span class="n">_urlopener</span> <span class="o">=</span> <span class="bp">None</span>


<div class="viewcode-block" id="urlopen"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen">[docs]</a><span class="k">def</span> <span class="nf">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;urlopen(url [, data]) -&gt; open file-like object&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">_urlopener</span>
    <span class="k">if</span> <span class="n">proxies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">opener</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">FancyURLopener</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">_urlopener</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">support</span><span class="o">.</span><span class="n">check_warnings</span><span class="p">(</span>
                <span class="p">(</span><span class="s">&#39;FancyURLopener style of invoking requests is deprecated.&#39;</span><span class="p">,</span>
                <span class="ne">DeprecationWarning</span><span class="p">)):</span>
            <span class="n">opener</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">FancyURLopener</span><span class="p">()</span>
        <span class="n">_urlopener</span> <span class="o">=</span> <span class="n">opener</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">opener</span> <span class="o">=</span> <span class="n">_urlopener</span>
    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">opener</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">opener</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="fakehttp"><a class="viewcode-back" href="../../test.html#test.test_urllib.fakehttp">[docs]</a><span class="k">def</span> <span class="nf">fakehttp</span><span class="p">(</span><span class="n">fakedata</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">FakeSocket</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">):</span>
        <span class="n">io_refs</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">def</span> <span class="nf">sendall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
            <span class="n">FakeHTTPConnection</span><span class="o">.</span><span class="n">buf</span> <span class="o">=</span> <span class="n">data</span>

        <span class="k">def</span> <span class="nf">makefile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">io_refs</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amt</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">b</span><span class="s">&quot;&quot;</span>
            <span class="k">return</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amt</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">readline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">b</span><span class="s">&quot;&quot;</span>
            <span class="k">return</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="o">.</span><span class="n">readline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">io_refs</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">io_refs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">FakeHTTPConnection</span><span class="p">(</span><span class="n">http</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">HTTPConnection</span><span class="p">):</span>

        <span class="c"># buffer to store data for verification in urlopen tests.</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">fakesock</span> <span class="o">=</span> <span class="n">FakeSocket</span><span class="p">(</span><span class="n">fakedata</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sock</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fakesock</span>

    <span class="k">return</span> <span class="n">FakeHTTPConnection</span>

</div>
<div class="viewcode-block" id="FakeHTTPMixin"><a class="viewcode-back" href="../../test.html#test.test_urllib.FakeHTTPMixin">[docs]</a><span class="k">class</span> <span class="nc">FakeHTTPMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<div class="viewcode-block" id="FakeHTTPMixin.fakehttp"><a class="viewcode-back" href="../../test.html#test.test_urllib.FakeHTTPMixin.fakehttp">[docs]</a>    <span class="k">def</span> <span class="nf">fakehttp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fakedata</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connection_class</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">HTTPConnection</span>
        <span class="n">http</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">HTTPConnection</span> <span class="o">=</span> <span class="n">fakehttp</span><span class="p">(</span><span class="n">fakedata</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FakeHTTPMixin.unfakehttp"><a class="viewcode-back" href="../../test.html#test.test_urllib.FakeHTTPMixin.unfakehttp">[docs]</a>    <span class="k">def</span> <span class="nf">unfakehttp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">http</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">HTTPConnection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connection_class</span>

</div></div>
<div class="viewcode-block" id="FakeFTPMixin"><a class="viewcode-back" href="../../test.html#test.test_urllib.FakeFTPMixin">[docs]</a><span class="k">class</span> <span class="nc">FakeFTPMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<div class="viewcode-block" id="FakeFTPMixin.fakeftp"><a class="viewcode-back" href="../../test.html#test.test_urllib.FakeFTPMixin.fakeftp">[docs]</a>    <span class="k">def</span> <span class="nf">fakeftp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">FakeFtpWrapper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="n">user</span><span class="p">,</span> <span class="n">passwd</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                     <span class="n">persistent</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
                <span class="k">pass</span>

            <span class="k">def</span> <span class="nf">retrfile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">file</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(),</span> <span class="mi">0</span>

            <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ftpwrapper_class</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">ftpwrapper</span>
        <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">ftpwrapper</span> <span class="o">=</span> <span class="n">FakeFtpWrapper</span>
</div>
<div class="viewcode-block" id="FakeFTPMixin.unfakeftp"><a class="viewcode-back" href="../../test.html#test.test_urllib.FakeFTPMixin.unfakeftp">[docs]</a>    <span class="k">def</span> <span class="nf">unfakeftp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">ftpwrapper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ftpwrapper_class</span>

</div></div>
<div class="viewcode-block" id="urlopen_FileTests"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_FileTests">[docs]</a><span class="k">class</span> <span class="nc">urlopen_FileTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test urlopen() opening a temporary file.</span>

<span class="sd">    Try to test as much functionality as possible so as to cut down on reliance</span>
<span class="sd">    on connecting to the Net for testing.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="urlopen_FileTests.setUp"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_FileTests.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Create a temp file to use for testing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="s">&quot;test_urllib: </span><span class="si">%s</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span>
                          <span class="s">&quot;ascii&quot;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pathname</span> <span class="o">=</span> <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">returned_obj</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="s">&quot;file:</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathname</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_FileTests.tearDown"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_FileTests.tearDown">[docs]</a>    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shut down the open object&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">returned_obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_FileTests.test_interface"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_FileTests.test_interface">[docs]</a>    <span class="k">def</span> <span class="nf">test_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure object returned by urlopen() has the specified methods</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;read&quot;</span><span class="p">,</span> <span class="s">&quot;readline&quot;</span><span class="p">,</span> <span class="s">&quot;readlines&quot;</span><span class="p">,</span> <span class="s">&quot;fileno&quot;</span><span class="p">,</span>
                     <span class="s">&quot;close&quot;</span><span class="p">,</span> <span class="s">&quot;info&quot;</span><span class="p">,</span> <span class="s">&quot;geturl&quot;</span><span class="p">,</span> <span class="s">&quot;getcode&quot;</span><span class="p">,</span> <span class="s">&quot;__iter__&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">returned_obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">),</span>
                         <span class="s">&quot;object returned by urlopen() lacks </span><span class="si">%s</span><span class="s"> attribute&quot;</span> <span class="o">%</span>
                         <span class="n">attr</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_FileTests.test_read"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_FileTests.test_read">[docs]</a>    <span class="k">def</span> <span class="nf">test_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">returned_obj</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="urlopen_FileTests.test_readline"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_FileTests.test_readline">[docs]</a>    <span class="k">def</span> <span class="nf">test_readline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">returned_obj</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">returned_obj</span><span class="o">.</span><span class="n">readline</span><span class="p">(),</span>
                         <span class="s">&quot;calling readline() after exhausting the file did not&quot;</span>
                         <span class="s">&quot; return an empty string&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_FileTests.test_readlines"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_FileTests.test_readlines">[docs]</a>    <span class="k">def</span> <span class="nf">test_readlines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lines_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">returned_obj</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines_list</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span>
                         <span class="s">&quot;readlines() returned the wrong number of lines&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">lines_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                         <span class="s">&quot;readlines() returned improper text&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_FileTests.test_fileno"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_FileTests.test_fileno">[docs]</a>    <span class="k">def</span> <span class="nf">test_fileno</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">file_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">returned_obj</span><span class="o">.</span><span class="n">fileno</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">file_num</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="s">&quot;fileno() did not return an int&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">file_num</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                         <span class="s">&quot;Reading on the file descriptor returned by fileno() &quot;</span>
                         <span class="s">&quot;did not return the expected text&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_FileTests.test_close"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_FileTests.test_close">[docs]</a>    <span class="k">def</span> <span class="nf">test_close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test close() by calling it here and then having it be called again</span>
        <span class="c"># by the tearDown() method for the test</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">returned_obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="urlopen_FileTests.test_info"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_FileTests.test_info">[docs]</a>    <span class="k">def</span> <span class="nf">test_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">returned_obj</span><span class="o">.</span><span class="n">info</span><span class="p">(),</span> <span class="n">email</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">Message</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_FileTests.test_geturl"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_FileTests.test_geturl">[docs]</a>    <span class="k">def</span> <span class="nf">test_geturl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">returned_obj</span><span class="o">.</span><span class="n">geturl</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathname</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_FileTests.test_getcode"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_FileTests.test_getcode">[docs]</a>    <span class="k">def</span> <span class="nf">test_getcode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">returned_obj</span><span class="o">.</span><span class="n">getcode</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="urlopen_FileTests.test_iter"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_FileTests.test_iter">[docs]</a>    <span class="k">def</span> <span class="nf">test_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test iterator</span>
        <span class="c"># Don&#39;t need to count number of iterations since test would fail the</span>
        <span class="c"># instant it returned anything beyond the first line from the</span>
        <span class="c"># comparison.</span>
        <span class="c"># Use the iterator in the usual implicit way to test for ticket #4608.</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">returned_obj</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_FileTests.test_relativelocalfile"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_FileTests.test_relativelocalfile">[docs]</a>    <span class="k">def</span> <span class="nf">test_relativelocalfile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span><span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">,</span><span class="s">&#39;./&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathname</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="ProxyTests"><a class="viewcode-back" href="../../test.html#test.test_urllib.ProxyTests">[docs]</a><span class="k">class</span> <span class="nc">ProxyTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="ProxyTests.setUp"><a class="viewcode-back" href="../../test.html#test.test_urllib.ProxyTests.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Records changes to env vars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">support</span><span class="o">.</span><span class="n">EnvironmentVarGuard</span><span class="p">()</span>
        <span class="c"># Delete all proxy related env vars</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">):</span>
            <span class="k">if</span> <span class="s">&#39;proxy&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">unset</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ProxyTests.tearDown"><a class="viewcode-back" href="../../test.html#test.test_urllib.ProxyTests.tearDown">[docs]</a>    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Restore all proxy related env vars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">__exit__</span><span class="p">()</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span>
</div>
<div class="viewcode-block" id="ProxyTests.test_getproxies_environment_keep_no_proxies"><a class="viewcode-back" href="../../test.html#test.test_urllib.ProxyTests.test_getproxies_environment_keep_no_proxies">[docs]</a>    <span class="k">def</span> <span class="nf">test_getproxies_environment_keep_no_proxies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;NO_PROXY&#39;</span><span class="p">,</span> <span class="s">&#39;localhost&#39;</span><span class="p">)</span>
        <span class="n">proxies</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">getproxies_environment</span><span class="p">()</span>
        <span class="c"># getproxies_environment use lowered case truncated (no &#39;_proxy&#39;) keys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">proxies</span><span class="p">[</span><span class="s">&#39;no&#39;</span><span class="p">])</span>
        <span class="c"># List of no_proxies with space.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;NO_PROXY&#39;</span><span class="p">,</span> <span class="s">&#39;localhost, anotherdomain.com, newdomain.com&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">proxy_bypass_environment</span><span class="p">(</span><span class="s">&#39;anotherdomain.com&#39;</span><span class="p">))</span>
</div></div>
<div class="viewcode-block" id="urlopen_HttpTests"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests">[docs]</a><span class="k">class</span> <span class="nc">urlopen_HttpTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">,</span> <span class="n">FakeHTTPMixin</span><span class="p">,</span> <span class="n">FakeFTPMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test urlopen() opening a fake http connection.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="urlopen_HttpTests.check_read"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.check_read">[docs]</a>    <span class="k">def</span> <span class="nf">check_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ver</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fakehttp</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;HTTP/&quot;</span> <span class="o">+</span> <span class="n">ver</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot; 200 OK</span><span class="se">\r\n\r\n</span><span class="s">Hello!&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="s">&quot;http://python.org/&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">(),</span> <span class="n">b</span><span class="s">&quot;Hello!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">(),</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">geturl</span><span class="p">(),</span> <span class="s">&#39;http://python.org/&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">getcode</span><span class="p">(),</span> <span class="mi">200</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unfakehttp</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="urlopen_HttpTests.test_url_fragment"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_url_fragment">[docs]</a>    <span class="k">def</span> <span class="nf">test_url_fragment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Issue #11703: geturl() omits fragments in the original URL.</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s">&#39;http://docs.python.org/library/urllib.html#OK&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fakehttp</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;HTTP/1.1 200 OK</span><span class="se">\r\n\r\n</span><span class="s">Hello!&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">geturl</span><span class="p">(),</span> <span class="n">url</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unfakehttp</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="urlopen_HttpTests.test_willclose"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_willclose">[docs]</a>    <span class="k">def</span> <span class="nf">test_willclose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fakehttp</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;HTTP/1.1 200 OK</span><span class="se">\r\n\r\n</span><span class="s">Hello!&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="s">&quot;http://www.python.org&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">will_close</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unfakehttp</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="urlopen_HttpTests.test_read_0_9"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_read_0_9">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_0_9</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># &quot;0.9&quot; response accepted (but not &quot;simple responses&quot; without</span>
        <span class="c"># a status line)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_read</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;0.9&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_HttpTests.test_read_1_0"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_read_1_0">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_1_0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_read</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;1.0&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_HttpTests.test_read_1_1"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_read_1_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_1_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_read</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;1.1&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_HttpTests.test_read_bogus"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_read_bogus">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_bogus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># urlopen() should raise OSError for many error codes.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fakehttp</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;&#39;&#39;HTTP/1.1 401 Authentication Required</span>
<span class="s">Date: Wed, 02 Jan 2008 03:03:54 GMT</span>
<span class="s">Server: Apache/1.3.33 (Debian GNU/Linux) mod_ssl/2.8.22 OpenSSL/0.9.7e</span>
<span class="s">Connection: close</span>
<span class="s">Content-Type: text/html; charset=iso-8859-1</span>
<span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="n">urlopen</span><span class="p">,</span> <span class="s">&quot;http://python.org/&quot;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unfakehttp</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="urlopen_HttpTests.test_invalid_redirect"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_invalid_redirect">[docs]</a>    <span class="k">def</span> <span class="nf">test_invalid_redirect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># urlopen() should raise OSError for many error codes.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fakehttp</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;&#39;&#39;HTTP/1.1 302 Found</span>
<span class="s">Date: Wed, 02 Jan 2008 03:03:54 GMT</span>
<span class="s">Server: Apache/1.3.33 (Debian GNU/Linux) mod_ssl/2.8.22 OpenSSL/0.9.7e</span>
<span class="s">Location: file://guidocomputer.athome.com:/python/license</span>
<span class="s">Connection: close</span>
<span class="s">Content-Type: text/html; charset=iso-8859-1</span>
<span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">,</span> <span class="n">urlopen</span><span class="p">,</span>
                              <span class="s">&quot;http://python.org/&quot;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unfakehttp</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="urlopen_HttpTests.test_empty_socket"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_empty_socket">[docs]</a>    <span class="k">def</span> <span class="nf">test_empty_socket</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># urlopen() raises OSError if the underlying socket does not send any</span>
        <span class="c"># data. (#1680230)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fakehttp</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="n">urlopen</span><span class="p">,</span> <span class="s">&quot;http://something&quot;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unfakehttp</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="urlopen_HttpTests.test_missing_localfile"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_missing_localfile">[docs]</a>    <span class="k">def</span> <span class="nf">test_missing_localfile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test for #10836</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">URLError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">urlopen</span><span class="p">(</span><span class="s">&#39;file://localhost/a/file/which/doesnot/exists.py&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">exception</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">exception</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_HttpTests.test_file_notexists"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_file_notexists">[docs]</a>    <span class="k">def</span> <span class="nf">test_file_notexists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fd</span><span class="p">,</span> <span class="n">tmp_file</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">()</span>
        <span class="n">tmp_fileurl</span> <span class="o">=</span> <span class="s">&#39;file://localhost/&#39;</span> <span class="o">+</span> <span class="n">tmp_file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s">&#39;/&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">))</span>
            <span class="k">with</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">tmp_fileurl</span><span class="p">)</span> <span class="k">as</span> <span class="n">fobj</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">fobj</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">))</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">URLError</span><span class="p">):</span>
            <span class="n">urlopen</span><span class="p">(</span><span class="n">tmp_fileurl</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_HttpTests.test_ftp_nohost"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_ftp_nohost">[docs]</a>    <span class="k">def</span> <span class="nf">test_ftp_nohost</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">test_ftp_url</span> <span class="o">=</span> <span class="s">&#39;ftp:///path&#39;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">URLError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">urlopen</span><span class="p">(</span><span class="n">test_ftp_url</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">exception</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">exception</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_HttpTests.test_ftp_nonexisting"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_ftp_nonexisting">[docs]</a>    <span class="k">def</span> <span class="nf">test_ftp_nonexisting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">URLError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">urlopen</span><span class="p">(</span><span class="s">&#39;ftp://localhost/a/file/which/doesnot/exists.py&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">exception</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">exception</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
</div>
    <span class="nd">@patch.object</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="s">&#39;MAXFTPCACHE&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<div class="viewcode-block" id="urlopen_HttpTests.test_ftp_cache_pruning"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_ftp_cache_pruning">[docs]</a>    <span class="k">def</span> <span class="nf">test_ftp_cache_pruning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fakeftp</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">ftpcache</span><span class="p">[</span><span class="s">&#39;test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">ftpwrapper</span><span class="p">(</span><span class="s">&#39;user&#39;</span><span class="p">,</span> <span class="s">&#39;pass&#39;</span><span class="p">,</span> <span class="s">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">urlopen</span><span class="p">(</span><span class="s">&#39;ftp://localhost&#39;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unfakeftp</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="urlopen_HttpTests.test_userpass_inurl"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_userpass_inurl">[docs]</a>    <span class="k">def</span> <span class="nf">test_userpass_inurl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fakehttp</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;HTTP/1.0 200 OK</span><span class="se">\r\n\r\n</span><span class="s">Hello!&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="s">&quot;http://user:pass@python.org/&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">(),</span> <span class="n">b</span><span class="s">&quot;Hello!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">(),</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">geturl</span><span class="p">(),</span> <span class="s">&#39;http://user:pass@python.org/&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">getcode</span><span class="p">(),</span> <span class="mi">200</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unfakehttp</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="urlopen_HttpTests.test_userpass_inurl_w_spaces"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_userpass_inurl_w_spaces">[docs]</a>    <span class="k">def</span> <span class="nf">test_userpass_inurl_w_spaces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fakehttp</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;HTTP/1.0 200 OK</span><span class="se">\r\n\r\n</span><span class="s">Hello!&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">userpass</span> <span class="o">=</span> <span class="s">&quot;a b:c d&quot;</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s">&quot;http://{}@python.org/&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">userpass</span><span class="p">)</span>
            <span class="n">fakehttp_wrapper</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">HTTPConnection</span>
            <span class="n">authorization</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Authorization: Basic </span><span class="si">%s</span><span class="se">\r\n</span><span class="s">&quot;</span> <span class="o">%</span>
                             <span class="n">b64encode</span><span class="p">(</span><span class="n">userpass</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;ASCII&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;ASCII&quot;</span><span class="p">))</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="c"># The authorization header must be in place</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">authorization</span><span class="p">,</span> <span class="n">fakehttp_wrapper</span><span class="o">.</span><span class="n">buf</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;UTF-8&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">(),</span> <span class="n">b</span><span class="s">&quot;Hello!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">(),</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">)</span>
            <span class="c"># the spaces are quoted in URL so no match</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">geturl</span><span class="p">(),</span> <span class="n">url</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">getcode</span><span class="p">(),</span> <span class="mi">200</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unfakehttp</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="urlopen_HttpTests.test_URLopener_deprecation"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_HttpTests.test_URLopener_deprecation">[docs]</a>    <span class="k">def</span> <span class="nf">test_URLopener_deprecation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">support</span><span class="o">.</span><span class="n">check_warnings</span><span class="p">((</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="ne">DeprecationWarning</span><span class="p">)):</span>
            <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">URLopener</span><span class="p">()</span>
</div></div>
<div class="viewcode-block" id="urlopen_DataTests"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_DataTests">[docs]</a><span class="k">class</span> <span class="nc">urlopen_DataTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test urlopen() opening a data URL.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="urlopen_DataTests.setUp"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_DataTests.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># text containing URL special- and unicode-characters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">&quot;test data URLs :;,%=&amp; </span><span class="se">\u00f6</span><span class="s"> </span><span class="se">\u00c4</span><span class="s"> &quot;</span>
        <span class="c"># 2x1 pixel RGB PNG image with one black and one white pixel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">b</span><span class="s">&#39;</span><span class="se">\x89</span><span class="s">PNG</span><span class="se">\r\n\x1a\n\x00\x00\x00\r</span><span class="s">IHDR</span><span class="se">\x00\x00\x00\x02\x00\x00\x00</span><span class="s">&#39;</span>
            <span class="n">b</span><span class="s">&#39;</span><span class="se">\x01\x08\x02\x00\x00\x00</span><span class="s">{@</span><span class="se">\xe8\xdd\x00\x00\x00\x01</span><span class="s">sRGB</span><span class="se">\x00\xae</span><span class="s">&#39;</span>
            <span class="n">b</span><span class="s">&#39;</span><span class="se">\xce\x1c\xe9\x00\x00\x00\x0f</span><span class="s">IDAT</span><span class="se">\x08\xd7</span><span class="s">c```</span><span class="se">\xf8\xff\xff</span><span class="s">?</span><span class="se">\x00</span><span class="s">&#39;</span>
            <span class="n">b</span><span class="s">&#39;</span><span class="se">\x06\x01\x02\xfe\n</span><span class="s">o/</span><span class="se">\x1e\x00\x00\x00\x00</span><span class="s">IEND</span><span class="se">\xae</span><span class="s">B`</span><span class="se">\x82</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">text_url</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s">&quot;data:text/plain;charset=UTF-8,test</span><span class="si">%20d</span><span class="s">ata%20URLs</span><span class="si">%20%</span><span class="s">3A%3B%2C</span><span class="si">%25%</span><span class="s">3&quot;</span>
            <span class="s">&quot;D</span><span class="si">%26%</span><span class="s">20%C3%B6</span><span class="si">%20%</span><span class="s">C3</span><span class="si">%84%</span><span class="s">20&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_url_base64</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s">&quot;data:text/plain;charset=ISO-8859-1;base64,dGVzdCBkYXRhIFVSTHMgOjs&quot;</span>
            <span class="s">&quot;sJT0mIPYgxCA%3D&quot;</span><span class="p">)</span>
        <span class="c"># base64 encoded data URL that contains ignorable spaces,</span>
        <span class="c"># such as &quot;\n&quot;, &quot; &quot;, &quot;%0A&quot;, and &quot;%20&quot;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_url</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s">&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAABCAIAAAB7</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="s">&quot;QOjdAAAAAXNSR0IArs4c6QAAAA9JREFUCNdj%0AYGBg%2BP//PwAGAQL%2BCm8 &quot;</span>
            <span class="s">&quot;vHgAAAABJRU5ErkJggg%3D%3D%0A%20&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">text_url_resp</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_url</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_url_base64_resp</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_url_base64</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_url_resp</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_url</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_DataTests.test_interface"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_DataTests.test_interface">[docs]</a>    <span class="k">def</span> <span class="nf">test_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure object returned by urlopen() has the specified methods</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;read&quot;</span><span class="p">,</span> <span class="s">&quot;readline&quot;</span><span class="p">,</span> <span class="s">&quot;readlines&quot;</span><span class="p">,</span>
                     <span class="s">&quot;close&quot;</span><span class="p">,</span> <span class="s">&quot;info&quot;</span><span class="p">,</span> <span class="s">&quot;geturl&quot;</span><span class="p">,</span> <span class="s">&quot;getcode&quot;</span><span class="p">,</span> <span class="s">&quot;__iter__&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_url_resp</span><span class="p">,</span> <span class="n">attr</span><span class="p">),</span>
                         <span class="s">&quot;object returned by urlopen() lacks </span><span class="si">%s</span><span class="s"> attribute&quot;</span> <span class="o">%</span>
                         <span class="n">attr</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_DataTests.test_info"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_DataTests.test_info">[docs]</a>    <span class="k">def</span> <span class="nf">test_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_url_resp</span><span class="o">.</span><span class="n">info</span><span class="p">(),</span> <span class="n">email</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">Message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_url_base64_resp</span><span class="o">.</span><span class="n">info</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">(),</span>
            <span class="p">[(</span><span class="s">&#39;text/plain&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;charset&#39;</span><span class="p">,</span> <span class="s">&#39;ISO-8859-1&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_url_resp</span><span class="o">.</span><span class="n">info</span><span class="p">()[</span><span class="s">&#39;content-length&#39;</span><span class="p">],</span>
            <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s">&quot;data:,&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">(),</span>
            <span class="p">[(</span><span class="s">&#39;text/plain&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;charset&#39;</span><span class="p">,</span> <span class="s">&#39;US-ASCII&#39;</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="urlopen_DataTests.test_geturl"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_DataTests.test_geturl">[docs]</a>    <span class="k">def</span> <span class="nf">test_geturl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_url_resp</span><span class="o">.</span><span class="n">geturl</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_url</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_url_base64_resp</span><span class="o">.</span><span class="n">geturl</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_url_base64</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_url_resp</span><span class="o">.</span><span class="n">geturl</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_url</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_DataTests.test_read_text"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_DataTests.test_read_text">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_url_resp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span>
            <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_url_resp</span><span class="o">.</span><span class="n">info</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">())[</span><span class="s">&#39;charset&#39;</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_DataTests.test_read_text_base64"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_DataTests.test_read_text_base64">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_text_base64</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_url_base64_resp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span>
            <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_url_base64_resp</span><span class="o">.</span><span class="n">info</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">())[</span><span class="s">&#39;charset&#39;</span><span class="p">]),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_DataTests.test_read_image"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_DataTests.test_read_image">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_url_resp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_DataTests.test_missing_comma"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_DataTests.test_missing_comma">[docs]</a>    <span class="k">def</span> <span class="nf">test_missing_comma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span><span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">,</span><span class="s">&#39;data:text/plain&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlopen_DataTests.test_invalid_base64_data"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlopen_DataTests.test_invalid_base64_data">[docs]</a>    <span class="k">def</span> <span class="nf">test_invalid_base64_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># missing padding character</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span><span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">,</span><span class="s">&#39;data:;base64,Cg=&#39;</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="urlretrieve_FileTests"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlretrieve_FileTests">[docs]</a><span class="k">class</span> <span class="nc">urlretrieve_FileTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test urllib.urlretrieve() on local files&quot;&quot;&quot;</span>

<div class="viewcode-block" id="urlretrieve_FileTests.setUp"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlretrieve_FileTests.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Create a list of temporary files. Each item in the list is a file</span>
        <span class="c"># name (absolute path or relative to the current working directory).</span>
        <span class="c"># All files in this list will be deleted in the tearDown method. Note,</span>
        <span class="c"># this only helps to makes sure temporary files get deleted, but it</span>
        <span class="c"># does nothing about trying to close files that may still be open. It</span>
        <span class="c"># is the responsibility of the developer to properly close files even</span>
        <span class="c"># when exceptional conditions occur.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tempFiles</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c"># Create a temporary file.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registerFileForCleanUp</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;testing urllib.urlretrieve&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">FILE</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span>
            <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">FILE</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span> <span class="n">FILE</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
</div>
<div class="viewcode-block" id="urlretrieve_FileTests.tearDown"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlretrieve_FileTests.tearDown">[docs]</a>    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Delete the temporary files.</span>
        <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tempFiles</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">each</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
</div>
<div class="viewcode-block" id="urlretrieve_FileTests.constructLocalFileUrl"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlretrieve_FileTests.constructLocalFileUrl">[docs]</a>    <span class="k">def</span> <span class="nf">constructLocalFileUrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filePath</span><span class="p">):</span>
        <span class="n">filePath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">filePath</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">UnicodeEncodeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">unittest</span><span class="o">.</span><span class="n">SkipTest</span><span class="p">(</span><span class="s">&quot;filePath is not encodable to utf8&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;file://</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">pathname2url</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlretrieve_FileTests.createNewTempFile"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlretrieve_FileTests.createNewTempFile">[docs]</a>    <span class="k">def</span> <span class="nf">createNewTempFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a new temporary file containing the specified data,</span>
<span class="sd">        registers the file for deletion during the test fixture tear down, and</span>
<span class="sd">        returns the absolute path of the file.&quot;&quot;&quot;</span>

        <span class="n">newFd</span><span class="p">,</span> <span class="n">newFilePath</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">registerFileForCleanUp</span><span class="p">(</span><span class="n">newFilePath</span><span class="p">)</span>
            <span class="n">newFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fdopen</span><span class="p">(</span><span class="n">newFd</span><span class="p">,</span> <span class="s">&quot;wb&quot;</span><span class="p">)</span>
            <span class="n">newFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">newFile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span> <span class="n">newFile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
        <span class="k">return</span> <span class="n">newFilePath</span>
</div>
<div class="viewcode-block" id="urlretrieve_FileTests.registerFileForCleanUp"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlretrieve_FileTests.registerFileForCleanUp">[docs]</a>    <span class="k">def</span> <span class="nf">registerFileForCleanUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileName</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tempFiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlretrieve_FileTests.test_basic"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlretrieve_FileTests.test_basic">[docs]</a>    <span class="k">def</span> <span class="nf">test_basic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure that a local file just gets its own location returned and</span>
        <span class="c"># a headers value is returned.</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="s">&quot;file:</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">email</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span>
                              <span class="s">&quot;did not get a email.message.Message instance &quot;</span>
                              <span class="s">&quot;as second returned value&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlretrieve_FileTests.test_copy"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlretrieve_FileTests.test_copy">[docs]</a>    <span class="k">def</span> <span class="nf">test_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test that setting the filename argument works.</span>
        <span class="n">second_temp</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">.2&quot;</span> <span class="o">%</span> <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registerFileForCleanUp</span><span class="p">(</span><span class="n">second_temp</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constructLocalFileUrl</span><span class="p">(</span>
            <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">),</span> <span class="n">second_temp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">second_temp</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">second_temp</span><span class="p">),</span> <span class="s">&quot;copy of the file was not &quot;</span>
                                                  <span class="s">&quot;made&quot;</span><span class="p">)</span>
        <span class="n">FILE</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">second_temp</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">FILE</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">FILE</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span> <span class="n">FILE</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlretrieve_FileTests.test_reporthook"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlretrieve_FileTests.test_reporthook">[docs]</a>    <span class="k">def</span> <span class="nf">test_reporthook</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure that the reporthook works.</span>
        <span class="k">def</span> <span class="nf">hooktester</span><span class="p">(</span><span class="n">block_count</span><span class="p">,</span> <span class="n">block_read_size</span><span class="p">,</span> <span class="n">file_size</span><span class="p">,</span> <span class="n">count_holder</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">block_count</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">block_read_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">file_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">block_count</span><span class="p">,</span> <span class="n">count_holder</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">count_holder</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">count_holder</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">second_temp</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">.2&quot;</span> <span class="o">%</span> <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registerFileForCleanUp</span><span class="p">(</span><span class="n">second_temp</span><span class="p">)</span>
        <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">constructLocalFileUrl</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">),</span>
            <span class="n">second_temp</span><span class="p">,</span> <span class="n">hooktester</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlretrieve_FileTests.test_reporthook_0_bytes"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlretrieve_FileTests.test_reporthook_0_bytes">[docs]</a>    <span class="k">def</span> <span class="nf">test_reporthook_0_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test on zero length file. Should call reporthook only 1 time.</span>
        <span class="n">report</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">def</span> <span class="nf">hooktester</span><span class="p">(</span><span class="n">block_count</span><span class="p">,</span> <span class="n">block_read_size</span><span class="p">,</span> <span class="n">file_size</span><span class="p">,</span> <span class="n">_report</span><span class="o">=</span><span class="n">report</span><span class="p">):</span>
            <span class="n">_report</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">block_count</span><span class="p">,</span> <span class="n">block_read_size</span><span class="p">,</span> <span class="n">file_size</span><span class="p">))</span>
        <span class="n">srcFileName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createNewTempFile</span><span class="p">()</span>
        <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constructLocalFileUrl</span><span class="p">(</span><span class="n">srcFileName</span><span class="p">),</span>
            <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">,</span> <span class="n">hooktester</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">report</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">report</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlretrieve_FileTests.test_reporthook_5_bytes"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlretrieve_FileTests.test_reporthook_5_bytes">[docs]</a>    <span class="k">def</span> <span class="nf">test_reporthook_5_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test on 5 byte file. Should call reporthook only 2 times (once when</span>
        <span class="c"># the &quot;network connection&quot; is established and once when the block is</span>
        <span class="c"># read).</span>
        <span class="n">report</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">def</span> <span class="nf">hooktester</span><span class="p">(</span><span class="n">block_count</span><span class="p">,</span> <span class="n">block_read_size</span><span class="p">,</span> <span class="n">file_size</span><span class="p">,</span> <span class="n">_report</span><span class="o">=</span><span class="n">report</span><span class="p">):</span>
            <span class="n">_report</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">block_count</span><span class="p">,</span> <span class="n">block_read_size</span><span class="p">,</span> <span class="n">file_size</span><span class="p">))</span>
        <span class="n">srcFileName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createNewTempFile</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;x&quot;</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constructLocalFileUrl</span><span class="p">(</span><span class="n">srcFileName</span><span class="p">),</span>
            <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">,</span> <span class="n">hooktester</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">report</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">report</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">report</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlretrieve_FileTests.test_reporthook_8193_bytes"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlretrieve_FileTests.test_reporthook_8193_bytes">[docs]</a>    <span class="k">def</span> <span class="nf">test_reporthook_8193_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test on 8193 byte file. Should call reporthook only 3 times (once</span>
        <span class="c"># when the &quot;network connection&quot; is established, once for the next 8192</span>
        <span class="c"># bytes, and once for the last byte).</span>
        <span class="n">report</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">def</span> <span class="nf">hooktester</span><span class="p">(</span><span class="n">block_count</span><span class="p">,</span> <span class="n">block_read_size</span><span class="p">,</span> <span class="n">file_size</span><span class="p">,</span> <span class="n">_report</span><span class="o">=</span><span class="n">report</span><span class="p">):</span>
            <span class="n">_report</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">block_count</span><span class="p">,</span> <span class="n">block_read_size</span><span class="p">,</span> <span class="n">file_size</span><span class="p">))</span>
        <span class="n">srcFileName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createNewTempFile</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;x&quot;</span> <span class="o">*</span> <span class="mi">8193</span><span class="p">)</span>
        <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constructLocalFileUrl</span><span class="p">(</span><span class="n">srcFileName</span><span class="p">),</span>
            <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">,</span> <span class="n">hooktester</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">report</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">report</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="mi">8193</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">report</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mi">8192</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">report</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mi">8192</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">report</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mi">8192</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="urlretrieve_HttpTests"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlretrieve_HttpTests">[docs]</a><span class="k">class</span> <span class="nc">urlretrieve_HttpTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">,</span> <span class="n">FakeHTTPMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test urllib.urlretrieve() using fake http connections&quot;&quot;&quot;</span>

<div class="viewcode-block" id="urlretrieve_HttpTests.test_short_content_raises_ContentTooShortError"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlretrieve_HttpTests.test_short_content_raises_ContentTooShortError">[docs]</a>    <span class="k">def</span> <span class="nf">test_short_content_raises_ContentTooShortError</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fakehttp</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;&#39;&#39;HTTP/1.1 200 OK</span>
<span class="s">Date: Wed, 02 Jan 2008 03:03:54 GMT</span>
<span class="s">Server: Apache/1.3.33 (Debian GNU/Linux) mod_ssl/2.8.22 OpenSSL/0.9.7e</span>
<span class="s">Connection: close</span>
<span class="s">Content-Length: 100</span>
<span class="s">Content-Type: text/html; charset=iso-8859-1</span>

<span class="s">FF</span>
<span class="s">&#39;&#39;&#39;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">_reporthook</span><span class="p">(</span><span class="n">par1</span><span class="p">,</span> <span class="n">par2</span><span class="p">,</span> <span class="n">par3</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">ContentTooShortError</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="s">&#39;http://example.com/&#39;</span><span class="p">,</span>
                                           <span class="n">reporthook</span><span class="o">=</span><span class="n">_reporthook</span><span class="p">)</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unfakehttp</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="urlretrieve_HttpTests.test_short_content_raises_ContentTooShortError_without_reporthook"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlretrieve_HttpTests.test_short_content_raises_ContentTooShortError_without_reporthook">[docs]</a>    <span class="k">def</span> <span class="nf">test_short_content_raises_ContentTooShortError_without_reporthook</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fakehttp</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;&#39;&#39;HTTP/1.1 200 OK</span>
<span class="s">Date: Wed, 02 Jan 2008 03:03:54 GMT</span>
<span class="s">Server: Apache/1.3.33 (Debian GNU/Linux) mod_ssl/2.8.22 OpenSSL/0.9.7e</span>
<span class="s">Connection: close</span>
<span class="s">Content-Length: 100</span>
<span class="s">Content-Type: text/html; charset=iso-8859-1</span>

<span class="s">FF</span>
<span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">ContentTooShortError</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="s">&#39;http://example.com/&#39;</span><span class="p">)</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unfakehttp</span><span class="p">()</span>

</div></div>
<div class="viewcode-block" id="QuotingTests"><a class="viewcode-back" href="../../test.html#test.test_urllib.QuotingTests">[docs]</a><span class="k">class</span> <span class="nc">QuotingTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tests for urllib.quote() and urllib.quote_plus()</span>

<span class="sd">    According to RFC 2396 (Uniform Resource Identifiers), to escape a</span>
<span class="sd">    character you write it as &#39;%&#39; + &lt;2 character US-ASCII hex value&gt;.</span>
<span class="sd">    The Python code of ``&#39;%&#39; + hex(ord(&lt;character&gt;))[2:]`` escapes a</span>
<span class="sd">    character properly. Case does not matter on the hex letters.</span>

<span class="sd">    The various character sets specified are:</span>

<span class="sd">    Reserved characters : &quot;;/?:@&amp;=+$,&quot;</span>
<span class="sd">        Have special meaning in URIs and must be escaped if not being used for</span>
<span class="sd">        their special meaning</span>
<span class="sd">    Data characters : letters, digits, and &quot;-_.!~*&#39;()&quot;</span>
<span class="sd">        Unreserved and do not need to be escaped; can be, though, if desired</span>
<span class="sd">    Control characters : 0x00 - 0x1F, 0x7F</span>
<span class="sd">        Have no use in URIs so must be escaped</span>
<span class="sd">    space : 0x20</span>
<span class="sd">        Must be escaped</span>
<span class="sd">    Delimiters : &#39;&lt;&gt;#%&quot;&#39;</span>
<span class="sd">        Must be escaped</span>
<span class="sd">    Unwise : &quot;{}|\^[]`&quot;</span>
<span class="sd">        Must be escaped</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="QuotingTests.test_never_quote"><a class="viewcode-back" href="../../test.html#test.test_urllib.QuotingTests.test_never_quote">[docs]</a>    <span class="k">def</span> <span class="nf">test_never_quote</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure quote() does not quote letters, digits, and &quot;_,.-&quot;</span>
        <span class="n">do_not_quote</span> <span class="o">=</span> <span class="s">&#39;&#39;</span> <span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span><span class="p">,</span>
                                 <span class="s">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span><span class="p">,</span>
                                 <span class="s">&quot;0123456789&quot;</span><span class="p">,</span>
                                 <span class="s">&quot;_.-&quot;</span><span class="p">])</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">do_not_quote</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">do_not_quote</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">do_not_quote</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="n">do_not_quote</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">do_not_quote</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                        <span class="s">&quot;using quote_plus(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">do_not_quote</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="QuotingTests.test_default_safe"><a class="viewcode-back" href="../../test.html#test.test_urllib.QuotingTests.test_default_safe">[docs]</a>    <span class="k">def</span> <span class="nf">test_default_safe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test &#39;/&#39; is default value for &#39;safe&#39; parameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="o">.</span><span class="n">__defaults__</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&#39;/&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="QuotingTests.test_safe"><a class="viewcode-back" href="../../test.html#test.test_urllib.QuotingTests.test_safe">[docs]</a>    <span class="k">def</span> <span class="nf">test_safe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test setting &#39;safe&#39; parameter does what it should do</span>
        <span class="n">quote_by_default</span> <span class="o">=</span> <span class="s">&quot;&lt;&gt;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">quote_by_default</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="n">quote_by_default</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">quote_by_default</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quote_by_default</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="n">quote_by_default</span><span class="p">,</span>
                                         <span class="n">safe</span><span class="o">=</span><span class="n">quote_by_default</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">quote_by_default</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote_plus(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">quote_by_default</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="c"># Safe expressed as bytes rather than str</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">quote_by_default</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="n">b</span><span class="s">&quot;&lt;&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">quote_by_default</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quote_by_default</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="c"># &quot;Safe&quot; non-ASCII characters should have no effect</span>
        <span class="c"># (Since URIs are not allowed to have non-ASCII characters)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="s">&quot;a</span><span class="se">\xfc</span><span class="s">b&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\xfc</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="s">&quot;a</span><span class="se">\xfc</span><span class="s">b&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="c"># Same as above, but using a bytes rather than str</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="s">&quot;a</span><span class="se">\xfc</span><span class="s">b&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="n">b</span><span class="s">&quot;</span><span class="se">\xfc</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="s">&quot;a</span><span class="se">\xfc</span><span class="s">b&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="QuotingTests.test_default_quoting"><a class="viewcode-back" href="../../test.html#test.test_urllib.QuotingTests.test_default_quoting">[docs]</a>    <span class="k">def</span> <span class="nf">test_default_quoting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure all characters that should be quoted are by default sans</span>
        <span class="c"># space (separate test for that).</span>
        <span class="n">should_quote</span> <span class="o">=</span> <span class="p">[</span><span class="nb">chr</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)]</span> <span class="c"># For 0x00 - 0x1F</span>
        <span class="n">should_quote</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;&lt;&gt;#%&quot;{}|\^[]`&#39;</span><span class="p">)</span>
        <span class="n">should_quote</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="mi">127</span><span class="p">))</span> <span class="c"># For 0x7F</span>
        <span class="n">should_quote</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">should_quote</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">should_quote</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">hexescape</span><span class="p">(</span><span class="n">char</span><span class="p">),</span> <span class="n">result</span><span class="p">,</span>
                             <span class="s">&quot;using quote(): &quot;</span>
                             <span class="s">&quot;</span><span class="si">%s</span><span class="s"> should be escaped to </span><span class="si">%s</span><span class="s">, not </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                             <span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="n">hexescape</span><span class="p">(</span><span class="n">char</span><span class="p">),</span> <span class="n">result</span><span class="p">))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">hexescape</span><span class="p">(</span><span class="n">char</span><span class="p">),</span> <span class="n">result</span><span class="p">,</span>
                             <span class="s">&quot;using quote_plus(): &quot;</span>
                             <span class="s">&quot;</span><span class="si">%s</span><span class="s"> should be escapes to </span><span class="si">%s</span><span class="s">, not </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                             <span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="n">hexescape</span><span class="p">(</span><span class="n">char</span><span class="p">),</span> <span class="n">result</span><span class="p">))</span>
        <span class="k">del</span> <span class="n">should_quote</span>
        <span class="n">partial_quote</span> <span class="o">=</span> <span class="s">&quot;ab[]cd&quot;</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="s">&quot;ab%5B%5Dcd&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">partial_quote</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="n">partial_quote</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote_plus(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="QuotingTests.test_quoting_space"><a class="viewcode-back" href="../../test.html#test.test_urllib.QuotingTests.test_quoting_space">[docs]</a>    <span class="k">def</span> <span class="nf">test_quoting_space</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure quote() and quote_plus() handle spaces as specified in</span>
        <span class="c"># their unique way</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">hexescape</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">),</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">hexescape</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s">&#39;+&#39;</span><span class="p">,</span>
                         <span class="s">&quot;using quote_plus(): </span><span class="si">%r</span><span class="s"> != +&quot;</span> <span class="o">%</span> <span class="n">result</span><span class="p">)</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&quot;a b cd e f&quot;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">given</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span> <span class="n">hexescape</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">given</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span> <span class="s">&#39;+&#39;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote_plus(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="QuotingTests.test_quoting_plus"><a class="viewcode-back" href="../../test.html#test.test_urllib.QuotingTests.test_quoting_plus">[docs]</a>    <span class="k">def</span> <span class="nf">test_quoting_plus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="s">&#39;alpha+beta gamma&#39;</span><span class="p">),</span>
                         <span class="s">&#39;alpha%2Bbeta+gamma&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="s">&#39;alpha+beta gamma&#39;</span><span class="p">,</span> <span class="s">&#39;+&#39;</span><span class="p">),</span>
                         <span class="s">&#39;alpha+beta+gamma&#39;</span><span class="p">)</span>
        <span class="c"># Test with bytes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;alpha+beta gamma&#39;</span><span class="p">),</span>
                         <span class="s">&#39;alpha%2Bbeta+gamma&#39;</span><span class="p">)</span>
        <span class="c"># Test with safe bytes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="s">&#39;alpha+beta gamma&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;+&#39;</span><span class="p">),</span>
                         <span class="s">&#39;alpha+beta+gamma&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="QuotingTests.test_quote_bytes"><a class="viewcode-back" href="../../test.html#test.test_urllib.QuotingTests.test_quote_bytes">[docs]</a>    <span class="k">def</span> <span class="nf">test_quote_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Bytes should quote directly to percent-encoded values</span>
        <span class="n">given</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\xa2\xd8</span><span class="s">ab</span><span class="se">\xff</span><span class="s">&quot;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;%A2%D8ab</span><span class="si">%F</span><span class="s">F&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="c"># Encoding argument should raise type error on bytes input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">,</span> <span class="n">given</span><span class="p">,</span>
                            <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">)</span>
        <span class="c"># quote_from_bytes should work the same</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote_from_bytes</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote_from_bytes(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="QuotingTests.test_quote_with_unicode"><a class="viewcode-back" href="../../test.html#test.test_urllib.QuotingTests.test_quote_with_unicode">[docs]</a>    <span class="k">def</span> <span class="nf">test_quote_with_unicode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Characters in Latin-1 range, encoded by default in UTF-8</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\xa2\xd8</span><span class="s">ab</span><span class="se">\xff</span><span class="s">&quot;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;%C2%A2%C3%98ab%C3%BF&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="c"># Characters in Latin-1 range, encoded by with None (default)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="c"># Characters in Latin-1 range, encoded with Latin-1</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\xa2\xd8</span><span class="s">ab</span><span class="se">\xff</span><span class="s">&quot;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;%A2%D8ab</span><span class="si">%F</span><span class="s">F&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="c"># Characters in BMP, encoded by default in UTF-8</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\u6f22\u5b57</span><span class="s">&quot;</span>              <span class="c"># &quot;Kanji&quot;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%E</span><span class="s">6%BC%A2</span><span class="si">%E</span><span class="s">5%AD%97&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="c"># Characters in BMP, encoded with Latin-1</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\u6f22\u5b57</span><span class="s">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">UnicodeEncodeError</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">,</span> <span class="n">given</span><span class="p">,</span>
                                    <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">)</span>
        <span class="c"># Characters in BMP, encoded with Latin-1, with replace error handling</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\u6f22\u5b57</span><span class="s">&quot;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%3F%3F</span><span class="s">&quot;</span>                   <span class="c"># &quot;??&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">,</span>
                                    <span class="n">errors</span><span class="o">=</span><span class="s">&quot;replace&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="c"># Characters in BMP, Latin-1, with xmlcharref error handling</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\u6f22\u5b57</span><span class="s">&quot;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%26%</span><span class="s">2328450%3B</span><span class="si">%26%</span><span class="s">2323383%3B&quot;</span>     <span class="c"># &quot;&amp;#28450;&amp;#23383;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">,</span>
                                    <span class="n">errors</span><span class="o">=</span><span class="s">&quot;xmlcharrefreplace&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="QuotingTests.test_quote_plus_with_unicode"><a class="viewcode-back" href="../../test.html#test.test_urllib.QuotingTests.test_quote_plus_with_unicode">[docs]</a>    <span class="k">def</span> <span class="nf">test_quote_plus_with_unicode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Encoding (latin-1) test for quote_plus</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\xa2\xd8</span><span class="s"> </span><span class="se">\xff</span><span class="s">&quot;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;%A2%D8+</span><span class="si">%F</span><span class="s">F&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote_plus(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="c"># Errors test for quote_plus</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&quot;ab</span><span class="se">\u6f22\u5b57</span><span class="s"> cd&quot;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;ab</span><span class="si">%3F%3F</span><span class="s">+cd&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">,</span>
                                         <span class="n">errors</span><span class="o">=</span><span class="s">&quot;replace&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote_plus(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>

</div></div>
<div class="viewcode-block" id="UnquotingTests"><a class="viewcode-back" href="../../test.html#test.test_urllib.UnquotingTests">[docs]</a><span class="k">class</span> <span class="nc">UnquotingTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tests for unquote() and unquote_plus()</span>

<span class="sd">    See the doc string for quoting_Tests for details on quoting and such.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="UnquotingTests.test_unquoting"><a class="viewcode-back" href="../../test.html#test.test_urllib.UnquotingTests.test_unquoting">[docs]</a>    <span class="k">def</span> <span class="nf">test_unquoting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure unquoting of all ASCII values works</span>
        <span class="n">escape_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
            <span class="n">given</span> <span class="o">=</span> <span class="n">hexescape</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
            <span class="n">expect</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                             <span class="s">&quot;using unquote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote_plus</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                             <span class="s">&quot;using unquote_plus(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span>
                             <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
            <span class="n">escape_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="n">escape_string</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">escape_list</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">escape_list</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">escape_string</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&#39;%&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span>
                         <span class="s">&quot;using unquote(): not all characters escaped: &quot;</span>
                         <span class="s">&quot;</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">result</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">((</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">),</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">((</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">),</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">,</span> <span class="p">())</span>
        <span class="k">with</span> <span class="n">support</span><span class="o">.</span><span class="n">check_warnings</span><span class="p">((</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">BytesWarning</span><span class="p">),</span> <span class="n">quiet</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">((</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">),</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="UnquotingTests.test_unquoting_badpercent"><a class="viewcode-back" href="../../test.html#test.test_urllib.UnquotingTests.test_unquoting_badpercent">[docs]</a>    <span class="k">def</span> <span class="nf">test_unquoting_badpercent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test unquoting on bad percent-escapes</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%x</span><span class="s">ab&#39;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">given</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="s">&quot;using unquote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%x</span><span class="s">&#39;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">given</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="s">&quot;using unquote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&#39;%&#39;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">given</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="s">&quot;using unquote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="c"># unquote_to_bytes</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%x</span><span class="s">ab&#39;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="s">&#39;ascii&#39;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote_to_bytes</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="s">&quot;using unquote_to_bytes(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%x</span><span class="s">&#39;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="s">&#39;ascii&#39;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote_to_bytes</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="s">&quot;using unquote_to_bytes(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&#39;%&#39;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="s">&#39;ascii&#39;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote_to_bytes</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="s">&quot;using unquote_to_bytes(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">((</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">),</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote_to_bytes</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">((</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">),</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote_to_bytes</span><span class="p">,</span> <span class="p">())</span>
</div>
<div class="viewcode-block" id="UnquotingTests.test_unquoting_mixed_case"><a class="viewcode-back" href="../../test.html#test.test_urllib.UnquotingTests.test_unquoting_mixed_case">[docs]</a>    <span class="k">def</span> <span class="nf">test_unquoting_mixed_case</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test unquoting on mixed-case hex digits in the percent-escapes</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&#39;%Ab</span><span class="si">%e</span><span class="s">A&#39;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xab\xea</span><span class="s">&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote_to_bytes</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote_to_bytes(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="UnquotingTests.test_unquoting_parts"><a class="viewcode-back" href="../../test.html#test.test_urllib.UnquotingTests.test_unquoting_parts">[docs]</a>    <span class="k">def</span> <span class="nf">test_unquoting_parts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure unquoting works when have non-quoted characters</span>
        <span class="c"># interspersed</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&#39;ab</span><span class="si">%s</span><span class="s">d&#39;</span> <span class="o">%</span> <span class="n">hexescape</span><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;abcd&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using quote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote_plus</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote_plus(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="UnquotingTests.test_unquoting_plus"><a class="viewcode-back" href="../../test.html#test.test_urllib.UnquotingTests.test_unquoting_plus">[docs]</a>    <span class="k">def</span> <span class="nf">test_unquoting_plus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test difference between unquote() and unquote_plus()</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&quot;are+there+spaces...&quot;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">given</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">given</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;+&#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote_plus</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote_plus(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="UnquotingTests.test_unquote_to_bytes"><a class="viewcode-back" href="../../test.html#test.test_urllib.UnquotingTests.test_unquote_to_bytes">[docs]</a>    <span class="k">def</span> <span class="nf">test_unquote_to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&#39;br%C3%BCckner_sapporo_20050930.doc&#39;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;br</span><span class="se">\xc3\xbc</span><span class="s">ckner_sapporo_20050930.doc&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote_to_bytes</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote_to_bytes(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="c"># Test on a string with unescaped non-ASCII characters</span>
        <span class="c"># (Technically an invalid URI; expect those characters to be UTF-8</span>
        <span class="c"># encoded).</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote_to_bytes</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\u6f22</span><span class="s">%C3%BC&quot;</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xe6\xbc\xa2\xc3\xbc</span><span class="s">&#39;</span>    <span class="c"># UTF-8 for &quot;\u6f22\u00fc&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote_to_bytes(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="c"># Test with a bytes as input</span>
        <span class="n">given</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;%A2%D8ab</span><span class="si">%F</span><span class="s">F&#39;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xa2\xd8</span><span class="s">ab</span><span class="se">\xff</span><span class="s">&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote_to_bytes</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote_to_bytes(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="c"># Test with a bytes as input, with unescaped non-ASCII bytes</span>
        <span class="c"># (Technically an invalid URI; expect those bytes to be preserved)</span>
        <span class="n">given</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;%A2</span><span class="se">\xd8</span><span class="s">ab</span><span class="si">%F</span><span class="s">F&#39;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xa2\xd8</span><span class="s">ab</span><span class="se">\xff</span><span class="s">&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote_to_bytes</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote_to_bytes(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="UnquotingTests.test_unquote_with_unicode"><a class="viewcode-back" href="../../test.html#test.test_urllib.UnquotingTests.test_unquote_with_unicode">[docs]</a>    <span class="k">def</span> <span class="nf">test_unquote_with_unicode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Characters in the Latin-1 range, encoded with UTF-8</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&#39;br%C3%BCckner_sapporo_20050930.doc&#39;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;br</span><span class="se">\u00fc</span><span class="s">ckner_sapporo_20050930.doc&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="c"># Characters in the Latin-1 range, encoded with None (default)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>

        <span class="c"># Characters in the Latin-1 range, encoded with Latin-1</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="s">&#39;br</span><span class="si">%F</span><span class="s">Cckner_sapporo_20050930.doc&#39;</span><span class="p">,</span>
                                      <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;br</span><span class="se">\u00fc</span><span class="s">ckner_sapporo_20050930.doc&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>

        <span class="c"># Characters in BMP, encoded with UTF-8</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%E</span><span class="s">6%BC%A2</span><span class="si">%E</span><span class="s">5%AD%97&quot;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\u6f22\u5b57</span><span class="s">&quot;</span>             <span class="c"># &quot;Kanji&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>

        <span class="c"># Decode with UTF-8, invalid sequence</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%F</span><span class="s">3%B1&quot;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\ufffd</span><span class="s">&quot;</span>                   <span class="c"># Replacement character</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>

        <span class="c"># Decode with UTF-8, invalid sequence, replace errors</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s">&quot;replace&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>

        <span class="c"># Decode with UTF-8, invalid sequence, ignoring errors</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%F</span><span class="s">3%B1&quot;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s">&quot;ignore&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>

        <span class="c"># A mix of non-ASCII and percent-encoded characters, UTF-8</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\u6f22</span><span class="s">%C3%BC&quot;</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\u6f22\u00fc</span><span class="s">&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>

        <span class="c"># A mix of non-ASCII and percent-encoded characters, Latin-1</span>
        <span class="c"># (Note, the string contains non-Latin-1-representable characters)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\u6f22</span><span class="si">%F</span><span class="s">C&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\u6f22\u00fc</span><span class="s">&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;using unquote(): </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div></div>
<div class="viewcode-block" id="urlencode_Tests"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlencode_Tests">[docs]</a><span class="k">class</span> <span class="nc">urlencode_Tests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tests for urlencode()&quot;&quot;&quot;</span>

<div class="viewcode-block" id="urlencode_Tests.help_inputtype"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlencode_Tests.help_inputtype">[docs]</a>    <span class="k">def</span> <span class="nf">help_inputtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">given</span><span class="p">,</span> <span class="n">test_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Helper method for testing different input types.</span>

<span class="sd">        &#39;given&#39; must lead to only the pairs:</span>
<span class="sd">            * 1st, 1</span>
<span class="sd">            * 2nd, 2</span>
<span class="sd">            * 3rd, 3</span>

<span class="sd">        Test cannot assume anything about order.  Docs make no guarantee and</span>
<span class="sd">        have possible dictionary input.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">expect_somewhere</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;1st=1&quot;</span><span class="p">,</span> <span class="s">&quot;2nd=2&quot;</span><span class="p">,</span> <span class="s">&quot;3rd=3&quot;</span><span class="p">]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">expected</span> <span class="ow">in</span> <span class="n">expect_somewhere</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;testing </span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s"> not found in </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">test_type</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&#39;&amp;&#39;</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span>
                         <span class="s">&quot;testing </span><span class="si">%s</span><span class="s">: expected 2 &#39;&amp;&#39;s; got </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">test_type</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&#39;&amp;&#39;</span><span class="p">)))</span>
        <span class="n">amp_location</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&#39;&amp;&#39;</span><span class="p">)</span>
        <span class="n">on_amp_left</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">amp_location</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">on_amp_right</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">amp_location</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">on_amp_left</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">and</span> <span class="n">on_amp_right</span><span class="o">.</span><span class="n">isdigit</span><span class="p">(),</span>
                     <span class="s">&quot;testing </span><span class="si">%s</span><span class="s">: &#39;&amp;&#39; not located in proper place in </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                     <span class="p">(</span><span class="n">test_type</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="c">#5 chars per thing and amps</span>
                         <span class="s">&quot;testing </span><span class="si">%s</span><span class="s">: &quot;</span>
                         <span class="s">&quot;unexpected number of characters: </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">test_type</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="urlencode_Tests.test_using_mapping"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlencode_Tests.test_using_mapping">[docs]</a>    <span class="k">def</span> <span class="nf">test_using_mapping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test passing in a mapping object as an argument.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">help_inputtype</span><span class="p">({</span><span class="s">&quot;1st&quot;</span><span class="p">:</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&quot;2nd&quot;</span><span class="p">:</span><span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&quot;3rd&quot;</span><span class="p">:</span><span class="s">&#39;3&#39;</span><span class="p">},</span>
                            <span class="s">&quot;using dict as input type&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlencode_Tests.test_using_sequence"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlencode_Tests.test_using_sequence">[docs]</a>    <span class="k">def</span> <span class="nf">test_using_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test passing in a sequence of two-item sequences as an argument.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">help_inputtype</span><span class="p">([(</span><span class="s">&#39;1st&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;2nd&#39;</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;3rd&#39;</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">)],</span>
                            <span class="s">&quot;using sequence of two-item tuples as input&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlencode_Tests.test_quoting"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlencode_Tests.test_quoting">[docs]</a>    <span class="k">def</span> <span class="nf">test_quoting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure keys and values are quoted using quote_plus()</span>
        <span class="n">given</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;&amp;&quot;</span><span class="p">:</span><span class="s">&quot;=&quot;</span><span class="p">}</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">hexescape</span><span class="p">(</span><span class="s">&#39;&amp;&#39;</span><span class="p">),</span> <span class="n">hexescape</span><span class="p">(</span><span class="s">&#39;=&#39;</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
        <span class="n">given</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;key name&quot;</span><span class="p">:</span><span class="s">&quot;A bunch of pluses&quot;</span><span class="p">}</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;key+name=A+bunch+of+pluses&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlencode_Tests.test_doseq"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlencode_Tests.test_doseq">[docs]</a>    <span class="k">def</span> <span class="nf">test_doseq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test that passing True for &#39;doseq&#39; parameter works correctly</span>
        <span class="n">given</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;sequence&#39;</span><span class="p">:[</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">]}</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;sequence=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="nb">str</span><span class="p">([</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">]))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">given</span><span class="p">[</span><span class="s">&quot;sequence&quot;</span><span class="p">]:</span>
            <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;sequence=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&#39;&amp;&#39;</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span>
                         <span class="s">&quot;Expected 2 &#39;&amp;&#39;s, got </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">result</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&#39;&amp;&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="urlencode_Tests.test_empty_sequence"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlencode_Tests.test_empty_sequence">[docs]</a>    <span class="k">def</span> <span class="nf">test_empty_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">({}))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">([]))</span>
</div>
<div class="viewcode-block" id="urlencode_Tests.test_nonstring_values"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlencode_Tests.test_nonstring_values">[docs]</a>    <span class="k">def</span> <span class="nf">test_nonstring_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&quot;a=1&quot;</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">({</span><span class="s">&quot;a&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&quot;a=None&quot;</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">({</span><span class="s">&quot;a&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">}))</span>
</div>
<div class="viewcode-block" id="urlencode_Tests.test_nonstring_seq_values"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlencode_Tests.test_nonstring_seq_values">[docs]</a>    <span class="k">def</span> <span class="nf">test_nonstring_seq_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&quot;a=1&amp;a=2&quot;</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">({</span><span class="s">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span> <span class="bp">True</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&quot;a=None&amp;a=a&quot;</span><span class="p">,</span>
                         <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">({</span><span class="s">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">]},</span> <span class="bp">True</span><span class="p">))</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&quot;a=a&amp;a=b&quot;</span><span class="p">,</span>
                         <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">({</span><span class="s">&quot;a&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">},</span> <span class="bp">True</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="urlencode_Tests.test_urlencode_encoding"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlencode_Tests.test_urlencode_encoding">[docs]</a>    <span class="k">def</span> <span class="nf">test_urlencode_encoding</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># ASCII encoding. Expect %3F with errors=&quot;replace&#39;</span>
        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="s">&#39;</span><span class="se">\u00a0</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\u00c1</span><span class="s">&#39;</span><span class="p">),)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%3F</span><span class="s">=</span><span class="si">%3F</span><span class="s">&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;ASCII&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s">&quot;replace&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

        <span class="c"># Default is UTF-8 encoding.</span>
        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="s">&#39;</span><span class="se">\u00a0</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\u00c1</span><span class="s">&#39;</span><span class="p">),)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;%C2%A0=%C3%81&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

        <span class="c"># Latin-1 encoding.</span>
        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="s">&#39;</span><span class="se">\u00a0</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\u00c1</span><span class="s">&#39;</span><span class="p">),)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;%A0=%C1&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlencode_Tests.test_urlencode_encoding_doseq"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlencode_Tests.test_urlencode_encoding_doseq">[docs]</a>    <span class="k">def</span> <span class="nf">test_urlencode_encoding_doseq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># ASCII Encoding. Expect %3F with errors=&quot;replace&#39;</span>
        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="s">&#39;</span><span class="se">\u00a0</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\u00c1</span><span class="s">&#39;</span><span class="p">),)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%3F</span><span class="s">=</span><span class="si">%3F</span><span class="s">&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                        <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;ASCII&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s">&quot;replace&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

        <span class="c"># ASCII Encoding. On a sequence of values.</span>
        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="s">&quot;</span><span class="se">\u00a0</span><span class="s">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\u00c1</span><span class="s">&quot;</span><span class="p">)),)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%3F</span><span class="s">=1&amp;</span><span class="si">%3F</span><span class="s">=</span><span class="si">%3F</span><span class="s">&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span>
                                        <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;ASCII&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s">&quot;replace&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

        <span class="c"># Utf-8</span>
        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="s">&quot;</span><span class="se">\u00a0</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\u00c1</span><span class="s">&quot;</span><span class="p">),)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;%C2%A0=%C3%81&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="s">&quot;</span><span class="se">\u00a0</span><span class="s">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\u00c1</span><span class="s">&quot;</span><span class="p">)),)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;%C2%A0=42&amp;%C2%A0=%C3%81&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

        <span class="c"># latin-1</span>
        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="s">&quot;</span><span class="se">\u00a0</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\u00c1</span><span class="s">&quot;</span><span class="p">),)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;%A0=%C1&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="s">&quot;</span><span class="se">\u00a0</span><span class="s">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\u00c1</span><span class="s">&quot;</span><span class="p">)),)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;%A0=42&amp;%A0=%C1&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlencode_Tests.test_urlencode_bytes"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlencode_Tests.test_urlencode_bytes">[docs]</a>    <span class="k">def</span> <span class="nf">test_urlencode_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="n">b</span><span class="s">&#39;</span><span class="se">\xa0\x24</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xc1\x24</span><span class="s">&#39;</span><span class="p">),)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;%A0%24=%C1%24&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

        <span class="c"># Sequence of values</span>
        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="n">b</span><span class="s">&#39;</span><span class="se">\xa0\x24</span><span class="s">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xc1\x24</span><span class="s">&#39;</span><span class="p">)),)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;%A0%24=42&amp;%A0%24=%C1%24&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="urlencode_Tests.test_urlencode_encoding_safe_parameter"><a class="viewcode-back" href="../../test.html#test.test_urllib.urlencode_Tests.test_urlencode_encoding_safe_parameter">[docs]</a>    <span class="k">def</span> <span class="nf">test_urlencode_encoding_safe_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c"># Send &#39;$&#39; (\x24) as safe character</span>
        <span class="c"># Default utf-8 encoding</span>

        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="n">b</span><span class="s">&#39;</span><span class="se">\xa0\x24</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xc1\x24</span><span class="s">&#39;</span><span class="p">),)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="s">&quot;:$&quot;</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;%A0$=%C1$&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="n">b</span><span class="s">&#39;</span><span class="se">\xa0\x24</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xc1\x24</span><span class="s">&#39;</span><span class="p">),)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="s">&quot;:$&quot;</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;%A0$=%C1$&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

        <span class="c"># Safe parameter in sequence</span>
        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="n">b</span><span class="s">&#39;</span><span class="se">\xa0\x24</span><span class="s">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">b</span><span class="s">&#39;</span><span class="se">\xc1\x24</span><span class="s">&#39;</span><span class="p">,</span> <span class="mh">0xd</span><span class="p">,</span> <span class="mi">42</span><span class="p">)),)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;%A0$=%C1$&amp;%A0$=13&amp;%A0$=42&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="s">&quot;:$&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

        <span class="c"># Test all above in latin-1 encoding</span>

        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="n">b</span><span class="s">&#39;</span><span class="se">\xa0\x24</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xc1\x24</span><span class="s">&#39;</span><span class="p">),)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="s">&quot;:$&quot;</span><span class="p">,</span>
                                        <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;%A0$=%C1$&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="n">b</span><span class="s">&#39;</span><span class="se">\xa0\x24</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xc1\x24</span><span class="s">&#39;</span><span class="p">),)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;%A0$=%C1$&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="s">&quot;:$&quot;</span><span class="p">,</span>
                                        <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">)</span>

        <span class="n">given</span> <span class="o">=</span> <span class="p">((</span><span class="n">b</span><span class="s">&#39;</span><span class="se">\xa0\x24</span><span class="s">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">b</span><span class="s">&#39;</span><span class="se">\xc1\x24</span><span class="s">&#39;</span><span class="p">,</span> <span class="mh">0xd</span><span class="p">,</span> <span class="mi">42</span><span class="p">)),)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;%A0$=%C1$&amp;%A0$=13&amp;%A0$=42&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">given</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="s">&quot;:$&quot;</span><span class="p">,</span>
                                        <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;latin-1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="Pathname_Tests"><a class="viewcode-back" href="../../test.html#test.test_urllib.Pathname_Tests">[docs]</a><span class="k">class</span> <span class="nc">Pathname_Tests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test pathname2url() and url2pathname()&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Pathname_Tests.test_basic"><a class="viewcode-back" href="../../test.html#test.test_urllib.Pathname_Tests.test_basic">[docs]</a>    <span class="k">def</span> <span class="nf">test_basic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure simple tests pass</span>
        <span class="n">expected_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&quot;parts&quot;</span><span class="p">,</span> <span class="s">&quot;of&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;path&quot;</span><span class="p">)</span>
        <span class="n">expected_url</span> <span class="o">=</span> <span class="s">&quot;parts/of/a/path&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">pathname2url</span><span class="p">(</span><span class="n">expected_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expected_url</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;pathname2url() failed; </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_url</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url2pathname</span><span class="p">(</span><span class="n">expected_url</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expected_path</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;url2pathame() failed; </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_path</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Pathname_Tests.test_quoting"><a class="viewcode-back" href="../../test.html#test.test_urllib.Pathname_Tests.test_quoting">[docs]</a>    <span class="k">def</span> <span class="nf">test_quoting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test automatic quoting and unquoting works for pathnam2url() and</span>
        <span class="c"># url2pathname() respectively</span>
        <span class="n">given</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&quot;needs&quot;</span><span class="p">,</span> <span class="s">&quot;quot=ing&quot;</span><span class="p">,</span> <span class="s">&quot;here&quot;</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;needs/</span><span class="si">%s</span><span class="s">/here&quot;</span> <span class="o">%</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="s">&quot;quot=ing&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">pathname2url</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;pathname2url() failed; </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">given</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url2pathname</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;url2pathname() failed; </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="n">given</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&quot;make sure&quot;</span><span class="p">,</span> <span class="s">&quot;using_quote&quot;</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">/using_quote&quot;</span> <span class="o">%</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="s">&quot;make sure&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">pathname2url</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;pathname2url() failed; </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&quot;make+sure/using_unquote&quot;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&quot;make+sure&quot;</span><span class="p">,</span> <span class="s">&quot;using_unquote&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url2pathname</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&quot;url2pathname() failed; </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div>
    <span class="nd">@unittest.skipUnless</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&#39;win32&#39;</span><span class="p">,</span>
                         <span class="s">&#39;test specific to the urllib.url2path function.&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="Pathname_Tests.test_ntpath"><a class="viewcode-back" href="../../test.html#test.test_urllib.Pathname_Tests.test_ntpath">[docs]</a>    <span class="k">def</span> <span class="nf">test_ntpath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">given</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;/C:/&#39;</span><span class="p">,</span> <span class="s">&#39;///C:/&#39;</span><span class="p">,</span> <span class="s">&#39;/C|//&#39;</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;C:</span><span class="se">\\</span><span class="s">&#39;</span>
        <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">given</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url2pathname</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                             <span class="s">&#39;urllib.request..url2pathname() failed; </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span>
                             <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s">&#39;///C|/path&#39;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&#39;C:</span><span class="se">\\</span><span class="s">path&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url2pathname</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span>
                         <span class="s">&#39;urllib.request.url2pathname() failed; </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">expect</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div></div>
<div class="viewcode-block" id="Utility_Tests"><a class="viewcode-back" href="../../test.html#test.test_urllib.Utility_Tests">[docs]</a><span class="k">class</span> <span class="nc">Utility_Tests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Testcase to test the various utility functions in the urllib.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Utility_Tests.test_splitpasswd"><a class="viewcode-back" href="../../test.html#test.test_urllib.Utility_Tests.test_splitpasswd">[docs]</a>    <span class="k">def</span> <span class="nf">test_splitpasswd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Some of password examples are not sensible, but it is added to</span>
<span class="sd">        confirming to RFC2617 and addressing issue4675.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s">&#39;user&#39;</span><span class="p">,</span> <span class="s">&#39;ab&#39;</span><span class="p">),</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">splitpasswd</span><span class="p">(</span><span class="s">&#39;user:ab&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s">&#39;user&#39;</span><span class="p">,</span> <span class="s">&#39;a</span><span class="se">\n</span><span class="s">b&#39;</span><span class="p">),</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">splitpasswd</span><span class="p">(</span><span class="s">&#39;user:a</span><span class="se">\n</span><span class="s">b&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s">&#39;user&#39;</span><span class="p">,</span> <span class="s">&#39;a</span><span class="se">\t</span><span class="s">b&#39;</span><span class="p">),</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">splitpasswd</span><span class="p">(</span><span class="s">&#39;user:a</span><span class="se">\t</span><span class="s">b&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s">&#39;user&#39;</span><span class="p">,</span> <span class="s">&#39;a</span><span class="se">\r</span><span class="s">b&#39;</span><span class="p">),</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">splitpasswd</span><span class="p">(</span><span class="s">&#39;user:a</span><span class="se">\r</span><span class="s">b&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s">&#39;user&#39;</span><span class="p">,</span> <span class="s">&#39;a</span><span class="se">\f</span><span class="s">b&#39;</span><span class="p">),</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">splitpasswd</span><span class="p">(</span><span class="s">&#39;user:a</span><span class="se">\f</span><span class="s">b&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s">&#39;user&#39;</span><span class="p">,</span> <span class="s">&#39;a</span><span class="se">\v</span><span class="s">b&#39;</span><span class="p">),</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">splitpasswd</span><span class="p">(</span><span class="s">&#39;user:a</span><span class="se">\v</span><span class="s">b&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s">&#39;user&#39;</span><span class="p">,</span> <span class="s">&#39;a:b&#39;</span><span class="p">),</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">splitpasswd</span><span class="p">(</span><span class="s">&#39;user:a:b&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s">&#39;user&#39;</span><span class="p">,</span> <span class="s">&#39;a b&#39;</span><span class="p">),</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">splitpasswd</span><span class="p">(</span><span class="s">&#39;user:a b&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s">&#39;user 2&#39;</span><span class="p">,</span> <span class="s">&#39;ab&#39;</span><span class="p">),</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">splitpasswd</span><span class="p">(</span><span class="s">&#39;user 2:ab&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s">&#39;user+1&#39;</span><span class="p">,</span> <span class="s">&#39;a+b&#39;</span><span class="p">),</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">splitpasswd</span><span class="p">(</span><span class="s">&#39;user+1:a+b&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Utility_Tests.test_thishost"><a class="viewcode-back" href="../../test.html#test.test_urllib.Utility_Tests.test_thishost">[docs]</a>    <span class="k">def</span> <span class="nf">test_thishost</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Test the urllib.request.thishost utility function returns a tuple&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">thishost</span><span class="p">(),</span> <span class="nb">tuple</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="URLopener_Tests"><a class="viewcode-back" href="../../test.html#test.test_urllib.URLopener_Tests">[docs]</a><span class="k">class</span> <span class="nc">URLopener_Tests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Testcase to test the open method of URLopener class.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="URLopener_Tests.test_quoted_open"><a class="viewcode-back" href="../../test.html#test.test_urllib.URLopener_Tests.test_quoted_open">[docs]</a>    <span class="k">def</span> <span class="nf">test_quoted_open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">DummyURLopener</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">URLopener</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">open_spam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">url</span>
        <span class="k">with</span> <span class="n">support</span><span class="o">.</span><span class="n">check_warnings</span><span class="p">(</span>
                <span class="p">(</span><span class="s">&#39;DummyURLopener style of invoking requests is deprecated.&#39;</span><span class="p">,</span>
                <span class="ne">DeprecationWarning</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">DummyURLopener</span><span class="p">()</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
                <span class="s">&#39;spam://example/ /&#39;</span><span class="p">),</span><span class="s">&#39;//example/%20/&#39;</span><span class="p">)</span>

            <span class="c"># test the safe characters are not quoted by urlopen</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">DummyURLopener</span><span class="p">()</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
                <span class="s">&quot;spam://c:|windows%/:=&amp;?~#+!$,;&#39;@()*[]|/path/&quot;</span><span class="p">),</span>
                <span class="s">&quot;//c:|windows%/:=&amp;?~#+!$,;&#39;@()*[]|/path/&quot;</span><span class="p">)</span>

<span class="c"># Just commented them out.</span>
<span class="c"># Can&#39;t really tell why keep failing in windows and sparc.</span>
<span class="c"># Everywhere else they work ok, but on those machines, sometimes</span>
<span class="c"># fail in one of the tests, sometimes in other. I have a linux, and</span>
<span class="c"># the tests go ok.</span>
<span class="c"># If anybody has one of the problematic environments, please help!</span>
<span class="c"># .   Facundo</span>
<span class="c">#</span>
<span class="c"># def server(evt):</span>
<span class="c">#     import socket, time</span>
<span class="c">#     serv = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span>
<span class="c">#     serv.settimeout(3)</span>
<span class="c">#     serv.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)</span>
<span class="c">#     serv.bind((&quot;&quot;, 9093))</span>
<span class="c">#     serv.listen(5)</span>
<span class="c">#     try:</span>
<span class="c">#         conn, addr = serv.accept()</span>
<span class="c">#         conn.send(&quot;1 Hola mundo\n&quot;)</span>
<span class="c">#         cantdata = 0</span>
<span class="c">#         while cantdata &lt; 13:</span>
<span class="c">#             data = conn.recv(13-cantdata)</span>
<span class="c">#             cantdata += len(data)</span>
<span class="c">#             time.sleep(.3)</span>
<span class="c">#         conn.send(&quot;2 No more lines\n&quot;)</span>
<span class="c">#         conn.close()</span>
<span class="c">#     except socket.timeout:</span>
<span class="c">#         pass</span>
<span class="c">#     finally:</span>
<span class="c">#         serv.close()</span>
<span class="c">#         evt.set()</span>
<span class="c">#</span>
<span class="c"># class FTPWrapperTests(unittest.TestCase):</span>
<span class="c">#</span>
<span class="c">#     def setUp(self):</span>
<span class="c">#         import ftplib, time, threading</span>
<span class="c">#         ftplib.FTP.port = 9093</span>
<span class="c">#         self.evt = threading.Event()</span>
<span class="c">#         threading.Thread(target=server, args=(self.evt,)).start()</span>
<span class="c">#         time.sleep(.1)</span>
<span class="c">#</span>
<span class="c">#     def tearDown(self):</span>
<span class="c">#         self.evt.wait()</span>
<span class="c">#</span>
<span class="c">#     def testBasic(self):</span>
<span class="c">#         # connects</span>
<span class="c">#         ftp = urllib.ftpwrapper(&quot;myuser&quot;, &quot;mypass&quot;, &quot;localhost&quot;, 9093, [])</span>
<span class="c">#         ftp.close()</span>
<span class="c">#</span>
<span class="c">#     def testTimeoutNone(self):</span>
<span class="c">#         # global default timeout is ignored</span>
<span class="c">#         import socket</span>
<span class="c">#         self.assertIsNone(socket.getdefaulttimeout())</span>
<span class="c">#         socket.setdefaulttimeout(30)</span>
<span class="c">#         try:</span>
<span class="c">#             ftp = urllib.ftpwrapper(&quot;myuser&quot;, &quot;mypass&quot;, &quot;localhost&quot;, 9093, [])</span>
<span class="c">#         finally:</span>
<span class="c">#             socket.setdefaulttimeout(None)</span>
<span class="c">#         self.assertEqual(ftp.ftp.sock.gettimeout(), 30)</span>
<span class="c">#         ftp.close()</span>
<span class="c">#</span>
<span class="c">#     def testTimeoutDefault(self):</span>
<span class="c">#         # global default timeout is used</span>
<span class="c">#         import socket</span>
<span class="c">#         self.assertIsNone(socket.getdefaulttimeout())</span>
<span class="c">#         socket.setdefaulttimeout(30)</span>
<span class="c">#         try:</span>
<span class="c">#             ftp = urllib.ftpwrapper(&quot;myuser&quot;, &quot;mypass&quot;, &quot;localhost&quot;, 9093, [])</span>
<span class="c">#         finally:</span>
<span class="c">#             socket.setdefaulttimeout(None)</span>
<span class="c">#         self.assertEqual(ftp.ftp.sock.gettimeout(), 30)</span>
<span class="c">#         ftp.close()</span>
<span class="c">#</span>
<span class="c">#     def testTimeoutValue(self):</span>
<span class="c">#         ftp = urllib.ftpwrapper(&quot;myuser&quot;, &quot;mypass&quot;, &quot;localhost&quot;, 9093, [],</span>
<span class="c">#                                 timeout=30)</span>
<span class="c">#         self.assertEqual(ftp.ftp.sock.gettimeout(), 30)</span>
<span class="c">#         ftp.close()</span>

</div></div>
<div class="viewcode-block" id="RequestTests"><a class="viewcode-back" href="../../test.html#test.test_urllib.RequestTests">[docs]</a><span class="k">class</span> <span class="nc">RequestTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unit tests for urllib.request.Request.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="RequestTests.test_default_values"><a class="viewcode-back" href="../../test.html#test.test_urllib.RequestTests.test_default_values">[docs]</a>    <span class="k">def</span> <span class="nf">test_default_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Request</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">Request</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s">&quot;http://www.python.org&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">get_method</span><span class="p">(),</span> <span class="s">&#39;GET&#39;</span><span class="p">)</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s">&quot;http://www.python.org&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">get_method</span><span class="p">(),</span> <span class="s">&#39;POST&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="RequestTests.test_with_method_arg"><a class="viewcode-back" href="../../test.html#test.test_urllib.RequestTests.test_with_method_arg">[docs]</a>    <span class="k">def</span> <span class="nf">test_with_method_arg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Request</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">Request</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s">&quot;http://www.python.org&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;HEAD&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s">&#39;HEAD&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">get_method</span><span class="p">(),</span> <span class="s">&#39;HEAD&#39;</span><span class="p">)</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s">&quot;http://www.python.org&quot;</span><span class="p">,</span> <span class="p">{},</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;HEAD&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s">&#39;HEAD&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">get_method</span><span class="p">(),</span> <span class="s">&#39;HEAD&#39;</span><span class="p">)</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s">&quot;http://www.python.org&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;GET&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">get_method</span><span class="p">(),</span> <span class="s">&#39;GET&#39;</span><span class="p">)</span>
        <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="s">&#39;HEAD&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">get_method</span><span class="p">(),</span> <span class="s">&#39;HEAD&#39;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="URL2PathNameTests"><a class="viewcode-back" href="../../test.html#test.test_urllib.URL2PathNameTests">[docs]</a><span class="k">class</span> <span class="nc">URL2PathNameTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="URL2PathNameTests.test_converting_drive_letter"><a class="viewcode-back" href="../../test.html#test.test_urllib.URL2PathNameTests.test_converting_drive_letter">[docs]</a>    <span class="k">def</span> <span class="nf">test_converting_drive_letter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">url2pathname</span><span class="p">(</span><span class="s">&quot;///C|&quot;</span><span class="p">),</span> <span class="s">&#39;C:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">url2pathname</span><span class="p">(</span><span class="s">&quot;///C:&quot;</span><span class="p">),</span> <span class="s">&#39;C:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">url2pathname</span><span class="p">(</span><span class="s">&quot;///C|/&quot;</span><span class="p">),</span> <span class="s">&#39;C:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="URL2PathNameTests.test_converting_when_no_drive_letter"><a class="viewcode-back" href="../../test.html#test.test_urllib.URL2PathNameTests.test_converting_when_no_drive_letter">[docs]</a>    <span class="k">def</span> <span class="nf">test_converting_when_no_drive_letter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># cannot end a raw string in \</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">url2pathname</span><span class="p">(</span><span class="s">&quot;///C/test/&quot;</span><span class="p">),</span> <span class="s">r&#39;</span><span class="se">\\</span><span class="s">\C\test&#39;</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">url2pathname</span><span class="p">(</span><span class="s">&quot;////C/test/&quot;</span><span class="p">),</span> <span class="s">r&#39;</span><span class="se">\\</span><span class="s">C\test&#39;</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="URL2PathNameTests.test_simple_compare"><a class="viewcode-back" href="../../test.html#test.test_urllib.URL2PathNameTests.test_simple_compare">[docs]</a>    <span class="k">def</span> <span class="nf">test_simple_compare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">url2pathname</span><span class="p">(</span><span class="s">&quot;///C|/foo/bar/spam.foo&quot;</span><span class="p">),</span>
                         <span class="s">r&#39;C:\foo\bar\spam.foo&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="URL2PathNameTests.test_non_ascii_drive_letter"><a class="viewcode-back" href="../../test.html#test.test_urllib.URL2PathNameTests.test_non_ascii_drive_letter">[docs]</a>    <span class="k">def</span> <span class="nf">test_non_ascii_drive_letter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="n">url2pathname</span><span class="p">,</span> <span class="s">&quot;///</span><span class="se">\u00e8</span><span class="s">|/&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="URL2PathNameTests.test_roundtrip_url2pathname"><a class="viewcode-back" href="../../test.html#test.test_urllib.URL2PathNameTests.test_roundtrip_url2pathname">[docs]</a>    <span class="k">def</span> <span class="nf">test_roundtrip_url2pathname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_of_paths</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;C:&#39;</span><span class="p">,</span>
                         <span class="s">r&#39;</span><span class="se">\\</span><span class="s">\C\test</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span>
                         <span class="s">r&#39;C:\foo\bar\spam.foo&#39;</span>
                         <span class="p">]</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">list_of_paths</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">url2pathname</span><span class="p">(</span><span class="n">pathname2url</span><span class="p">(</span><span class="n">path</span><span class="p">)),</span> <span class="n">path</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="PathName2URLTests"><a class="viewcode-back" href="../../test.html#test.test_urllib.PathName2URLTests">[docs]</a><span class="k">class</span> <span class="nc">PathName2URLTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="PathName2URLTests.test_converting_drive_letter"><a class="viewcode-back" href="../../test.html#test.test_urllib.PathName2URLTests.test_converting_drive_letter">[docs]</a>    <span class="k">def</span> <span class="nf">test_converting_drive_letter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pathname2url</span><span class="p">(</span><span class="s">&quot;C:&quot;</span><span class="p">),</span> <span class="s">&#39;///C:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pathname2url</span><span class="p">(</span><span class="s">&quot;C:</span><span class="se">\\</span><span class="s">&quot;</span><span class="p">),</span> <span class="s">&#39;///C:&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PathName2URLTests.test_converting_when_no_drive_letter"><a class="viewcode-back" href="../../test.html#test.test_urllib.PathName2URLTests.test_converting_when_no_drive_letter">[docs]</a>    <span class="k">def</span> <span class="nf">test_converting_when_no_drive_letter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pathname2url</span><span class="p">(</span><span class="s">r&quot;</span><span class="se">\\</span><span class="s">\folder\test&quot;</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span><span class="p">),</span>
                         <span class="s">&#39;/////folder/test/&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pathname2url</span><span class="p">(</span><span class="s">r&quot;</span><span class="se">\\</span><span class="s">folder\test&quot;</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span><span class="p">),</span>
                         <span class="s">&#39;////folder/test/&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pathname2url</span><span class="p">(</span><span class="s">r&quot;\folder\test&quot;</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span><span class="p">),</span>
                         <span class="s">&#39;/folder/test/&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PathName2URLTests.test_simple_compare"><a class="viewcode-back" href="../../test.html#test.test_urllib.PathName2URLTests.test_simple_compare">[docs]</a>    <span class="k">def</span> <span class="nf">test_simple_compare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pathname2url</span><span class="p">(</span><span class="s">r&#39;C:\foo\bar\spam.foo&#39;</span><span class="p">),</span>
                         <span class="s">&quot;///C:/foo/bar/spam.foo&quot;</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="PathName2URLTests.test_long_drive_letter"><a class="viewcode-back" href="../../test.html#test.test_urllib.PathName2URLTests.test_long_drive_letter">[docs]</a>    <span class="k">def</span> <span class="nf">test_long_drive_letter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="n">pathname2url</span><span class="p">,</span> <span class="s">&quot;XX:</span><span class="se">\\</span><span class="s">&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PathName2URLTests.test_roundtrip_pathname2url"><a class="viewcode-back" href="../../test.html#test.test_urllib.PathName2URLTests.test_roundtrip_pathname2url">[docs]</a>    <span class="k">def</span> <span class="nf">test_roundtrip_pathname2url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_of_paths</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;///C:&#39;</span><span class="p">,</span>
                         <span class="s">&#39;/////folder/test/&#39;</span><span class="p">,</span>
                         <span class="s">&#39;///C:/foo/bar/spam.foo&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">list_of_paths</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pathname2url</span><span class="p">(</span><span class="n">url2pathname</span><span class="p">(</span><span class="n">path</span><span class="p">)),</span> <span class="n">path</span><span class="p">)</span>
</div></div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>