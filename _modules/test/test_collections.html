

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_collections &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_collections</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_collections</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;Unit tests for collections.py.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">unittest</span><span class="o">,</span> <span class="nn">doctest</span><span class="o">,</span> <span class="nn">operator</span>
<span class="kn">from</span> <span class="nn">test.support</span> <span class="kn">import</span> <span class="n">TESTFN</span><span class="p">,</span> <span class="n">forget</span><span class="p">,</span> <span class="n">unlink</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">support</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span><span class="p">,</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">,</span> <span class="n">_count_elements</span>
<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">mapping_tests</span>
<span class="kn">import</span> <span class="nn">pickle</span><span class="o">,</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randrange</span><span class="p">,</span> <span class="n">shuffle</span>
<span class="kn">import</span> <span class="nn">keyword</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">UserDict</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">ChainMap</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Hashable</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Iterator</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Sized</span><span class="p">,</span> <span class="n">Container</span><span class="p">,</span> <span class="n">Callable</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Set</span><span class="p">,</span> <span class="n">MutableSet</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">MutableMapping</span><span class="p">,</span> <span class="n">KeysView</span><span class="p">,</span> <span class="n">ItemsView</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">MutableSequence</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">ByteString</span>


<span class="c">################################################################################</span>
<span class="c">### ChainMap (helper class for configparser and the string module)</span>
<span class="c">################################################################################</span>

<div class="viewcode-block" id="TestChainMap"><a class="viewcode-back" href="../../test.html#test.test_collections.TestChainMap">[docs]</a><span class="k">class</span> <span class="nc">TestChainMap</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="TestChainMap.test_basics"><a class="viewcode-back" href="../../test.html#test.test_collections.TestChainMap.test_basics">[docs]</a>    <span class="k">def</span> <span class="nf">test_basics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">ChainMap</span><span class="p">()</span>
        <span class="n">c</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">c</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">new_child</span><span class="p">()</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">maps</span><span class="p">,</span> <span class="p">[{</span><span class="s">&#39;b&#39;</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">:</span><span class="mi">30</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}])</span>  <span class="c"># check internal state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>    <span class="c"># check items/iter/getitem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>                                   <span class="c"># check len</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="s">&#39;abc&#39;</span><span class="p">:</span>                                             <span class="c"># check contains</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>             <span class="c"># check get</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span>

        <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]</span>                                                    <span class="c"># unmask a value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">maps</span><span class="p">,</span> <span class="p">[{</span><span class="s">&#39;c&#39;</span><span class="p">:</span><span class="mi">30</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}])</span>          <span class="c"># check internal state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>     <span class="c"># check items/iter/getitem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>                                   <span class="c"># check len</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="s">&#39;abc&#39;</span><span class="p">:</span>                                             <span class="c"># check contains</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>              <span class="c"># check get</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="p">[</span>                                      <span class="c"># check repr</span>
            <span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span> <span class="o">+</span> <span class="s">&quot;({&#39;c&#39;: 30}, {&#39;a&#39;: 1, &#39;b&#39;: 2})&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span> <span class="o">+</span> <span class="s">&quot;({&#39;c&#39;: 30}, {&#39;b&#39;: 2, &#39;a&#39;: 1})&quot;</span>
        <span class="p">])</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>                               <span class="c"># check shallow copies</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">maps</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">maps</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">maps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="o">.</span><span class="n">maps</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">maps</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">e</span><span class="o">.</span><span class="n">maps</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="p">[</span><span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">d</span><span class="p">)),</span>
                  <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">d</span><span class="p">),</span>
                  <span class="nb">eval</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
                <span class="p">]:</span>                                                    <span class="c"># check deep copies</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">maps</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">maps</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">maps</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">maps</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">new_child</span><span class="p">()</span>
        <span class="n">f</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">maps</span><span class="p">,</span> <span class="p">[{</span><span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;c&#39;</span><span class="p">:</span><span class="mi">30</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">parents</span><span class="o">.</span><span class="n">maps</span><span class="p">,</span> <span class="p">[{</span><span class="s">&#39;c&#39;</span><span class="p">:</span><span class="mi">30</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}])</span>   <span class="c"># check parents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>                                    <span class="c"># find first in chain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>                            <span class="c"># look beyond maps[0]</span>
</div>
<div class="viewcode-block" id="TestChainMap.test_contructor"><a class="viewcode-back" href="../../test.html#test.test_collections.TestChainMap.test_contructor">[docs]</a>    <span class="k">def</span> <span class="nf">test_contructor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ChainMap</span><span class="p">()</span><span class="o">.</span><span class="n">maps</span><span class="p">,</span> <span class="p">[{}])</span>                        <span class="c"># no-args --&gt; one new dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ChainMap</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span><span class="o">.</span><span class="n">maps</span><span class="p">,</span> <span class="p">[{</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">}])</span>                <span class="c"># 1 arg --&gt; list</span>
</div>
<div class="viewcode-block" id="TestChainMap.test_bool"><a class="viewcode-back" href="../../test.html#test.test_collections.TestChainMap.test_bool">[docs]</a>    <span class="k">def</span> <span class="nf">test_bool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">ChainMap</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">ChainMap</span><span class="p">({},</span> <span class="p">{}))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">ChainMap</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span> <span class="p">{}))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">ChainMap</span><span class="p">({},</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">}))</span>
</div>
<div class="viewcode-block" id="TestChainMap.test_missing"><a class="viewcode-back" href="../../test.html#test.test_collections.TestChainMap.test_missing">[docs]</a>    <span class="k">def</span> <span class="nf">test_missing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">DefaultChainMap</span><span class="p">(</span><span class="n">ChainMap</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__missing__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">999</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">DefaultChainMap</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">999</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>                                  <span class="c"># check __getitem__ w/missing</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">77</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">77</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span>                          <span class="c"># check get() w/ missing</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="n">d</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>                                <span class="c"># check __contains__ w/missing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1001</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1002</span><span class="p">),</span> <span class="mi">1002</span><span class="p">)</span>                       <span class="c"># check pop() w/missing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">popitem</span><span class="p">(),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>                        <span class="c"># check popitem() w/missing</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">):</span>
            <span class="n">d</span><span class="o">.</span><span class="n">popitem</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TestChainMap.test_dict_coercion"><a class="viewcode-back" href="../../test.html#test.test_collections.TestChainMap.test_dict_coercion">[docs]</a>    <span class="k">def</span> <span class="nf">test_dict_coercion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">ChainMap</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestChainMap.test_new_child"><a class="viewcode-back" href="../../test.html#test.test_collections.TestChainMap.test_new_child">[docs]</a>    <span class="k">def</span> <span class="nf">test_new_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&#39;Tests for changes for issue #16613.&#39;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">ChainMap</span><span class="p">()</span>
        <span class="n">c</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">c</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">m</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;b&#39;</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">new_child</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">maps</span><span class="p">,</span> <span class="p">[{</span><span class="s">&#39;b&#39;</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">:</span><span class="mi">30</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}])</span>  <span class="c"># check internal state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">maps</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c"># Use a different map than a dict</span>
        <span class="k">class</span> <span class="nc">lowerdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">ChainMap</span><span class="p">()</span>
        <span class="n">c</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">c</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">lowerdict</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">new_child</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">maps</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="s">&#39;abc&#39;</span><span class="p">:</span>                                             <span class="c"># check contains</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>             <span class="c"># check get</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span>


<span class="c">################################################################################</span>
<span class="c">### Named Tuples</span>
<span class="c">################################################################################</span>
</div></div>
<span class="n">TestNT</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;TestNT&#39;</span><span class="p">,</span> <span class="s">&#39;x y z&#39;</span><span class="p">)</span>    <span class="c"># type used for pickle tests</span>

<div class="viewcode-block" id="TestNamedTuple"><a class="viewcode-back" href="../../test.html#test.test_collections.TestNamedTuple">[docs]</a><span class="k">class</span> <span class="nc">TestNamedTuple</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="TestNamedTuple.test_factory"><a class="viewcode-back" href="../../test.html#test.test_collections.TestNamedTuple.test_factory">[docs]</a>    <span class="k">def</span> <span class="nf">test_factory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Point</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Point&#39;</span><span class="p">,</span> <span class="s">&#39;x y&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Point</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="s">&#39;Point&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Point</span><span class="o">.</span><span class="n">__slots__</span><span class="p">,</span> <span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Point</span><span class="o">.</span><span class="n">__module__</span><span class="p">,</span> <span class="n">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Point</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">,</span> <span class="nb">tuple</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Point</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&#39;class Point(tuple)&#39;</span><span class="p">,</span> <span class="n">Point</span><span class="o">.</span><span class="n">_source</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">namedtuple</span><span class="p">,</span> <span class="s">&#39;abc%&#39;</span><span class="p">,</span> <span class="s">&#39;efg ghi&#39;</span><span class="p">)</span>       <span class="c"># type has non-alpha char</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">namedtuple</span><span class="p">,</span> <span class="s">&#39;class&#39;</span><span class="p">,</span> <span class="s">&#39;efg ghi&#39;</span><span class="p">)</span>      <span class="c"># type has keyword</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">namedtuple</span><span class="p">,</span> <span class="s">&#39;9abc&#39;</span><span class="p">,</span> <span class="s">&#39;efg ghi&#39;</span><span class="p">)</span>       <span class="c"># type starts with digit</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">namedtuple</span><span class="p">,</span> <span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="s">&#39;efg g</span><span class="si">%hi</span><span class="s">&#39;</span><span class="p">)</span>       <span class="c"># field with non-alpha char</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">namedtuple</span><span class="p">,</span> <span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="s">&#39;abc class&#39;</span><span class="p">)</span>      <span class="c"># field has keyword</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">namedtuple</span><span class="p">,</span> <span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="s">&#39;8efg 9ghi&#39;</span><span class="p">)</span>      <span class="c"># field starts with digit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">namedtuple</span><span class="p">,</span> <span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="s">&#39;_efg ghi&#39;</span><span class="p">)</span>       <span class="c"># field with leading underscore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">namedtuple</span><span class="p">,</span> <span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="s">&#39;efg efg ghi&#39;</span><span class="p">)</span>    <span class="c"># duplicate field</span>

        <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Point0&#39;</span><span class="p">,</span> <span class="s">&#39;x1 y2&#39;</span><span class="p">)</span>   <span class="c"># Verify that numbers are allowed in names</span>
        <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">,</span> <span class="s">&#39;a b c&#39;</span><span class="p">)</span>        <span class="c"># Test leading underscores in a typename</span>

        <span class="n">nt</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;nt&#39;</span><span class="p">,</span> <span class="s">&#39;the quick brown fox&#39;</span><span class="p">)</span>                       <span class="c"># check unicode input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="s">&quot;u&#39;&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">nt</span><span class="o">.</span><span class="n">_fields</span><span class="p">))</span>
        <span class="n">nt</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;nt&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;the&#39;</span><span class="p">,</span> <span class="s">&#39;quick&#39;</span><span class="p">))</span>                           <span class="c"># check unicode input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="s">&quot;u&#39;&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">nt</span><span class="o">.</span><span class="n">_fields</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Point</span><span class="o">.</span><span class="n">_make</span><span class="p">,</span> <span class="p">[</span><span class="mi">11</span><span class="p">])</span>                     <span class="c"># catch too few args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Point</span><span class="o">.</span><span class="n">_make</span><span class="p">,</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">33</span><span class="p">])</span>             <span class="c"># catch too many args</span>
</div>
    <span class="nd">@unittest.skipIf</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">optimize</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">,</span>
                     <span class="s">&quot;Docstrings are omitted with -O2 and above&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="TestNamedTuple.test_factory_doc_attr"><a class="viewcode-back" href="../../test.html#test.test_collections.TestNamedTuple.test_factory_doc_attr">[docs]</a>    <span class="k">def</span> <span class="nf">test_factory_doc_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Point</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Point&#39;</span><span class="p">,</span> <span class="s">&#39;x y&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Point</span><span class="o">.</span><span class="n">__doc__</span><span class="p">,</span> <span class="s">&#39;Point(x, y)&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestNamedTuple.test_name_fixer"><a class="viewcode-back" href="../../test.html#test.test_collections.TestNamedTuple.test_name_fixer">[docs]</a>    <span class="k">def</span> <span class="nf">test_name_fixer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">spec</span><span class="p">,</span> <span class="n">renamed</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="p">[(</span><span class="s">&#39;efg&#39;</span><span class="p">,</span> <span class="s">&#39;g</span><span class="si">%hi</span><span class="s">&#39;</span><span class="p">),</span>  <span class="p">(</span><span class="s">&#39;efg&#39;</span><span class="p">,</span> <span class="s">&#39;_1&#39;</span><span class="p">)],</span>                              <span class="c"># field with non-alpha char</span>
            <span class="p">[(</span><span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="s">&#39;class&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="s">&#39;_1&#39;</span><span class="p">)],</span>                              <span class="c"># field has keyword</span>
            <span class="p">[(</span><span class="s">&#39;8efg&#39;</span><span class="p">,</span> <span class="s">&#39;9ghi&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;_0&#39;</span><span class="p">,</span> <span class="s">&#39;_1&#39;</span><span class="p">)],</span>                               <span class="c"># field starts with digit</span>
            <span class="p">[(</span><span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="s">&#39;_efg&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="s">&#39;_1&#39;</span><span class="p">)],</span>                               <span class="c"># field with leading underscore</span>
            <span class="p">[(</span><span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="s">&#39;efg&#39;</span><span class="p">,</span> <span class="s">&#39;efg&#39;</span><span class="p">,</span> <span class="s">&#39;ghi&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="s">&#39;efg&#39;</span><span class="p">,</span> <span class="s">&#39;_2&#39;</span><span class="p">,</span> <span class="s">&#39;ghi&#39;</span><span class="p">)],</span>    <span class="c"># duplicate field</span>
            <span class="p">[(</span><span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="s">&#39;_1&#39;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">)],</span>                         <span class="c"># fieldname is a space</span>
        <span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;NT&#39;</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">rename</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="n">renamed</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestNamedTuple.test_instance"><a class="viewcode-back" href="../../test.html#test.test_collections.TestNamedTuple.test_instance">[docs]</a>    <span class="k">def</span> <span class="nf">test_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Point</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Point&#39;</span><span class="p">,</span> <span class="s">&#39;x y&#39;</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">22</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">22</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">11</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">22</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Point</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>                              <span class="c"># too few args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Point</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                        <span class="c"># too many args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">eval</span><span class="p">,</span> <span class="s">&#39;Point(XXX=1, y=2)&#39;</span><span class="p">,</span> <span class="nb">locals</span><span class="p">())</span>   <span class="c"># wrong keyword argument</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">eval</span><span class="p">,</span> <span class="s">&#39;Point(x=1)&#39;</span><span class="p">,</span> <span class="nb">locals</span><span class="p">())</span>          <span class="c"># missing keyword argument</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="s">&#39;Point(x=11, y=22)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="s">&#39;__weakref__&#39;</span><span class="p">,</span> <span class="nb">dir</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Point</span><span class="o">.</span><span class="n">_make</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">]))</span>                          <span class="c"># test _make classmethod</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">))</span>                             <span class="c"># test _fields attribute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>                          <span class="c"># test _replace method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">_asdict</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">22</span><span class="p">))</span>                     <span class="c"># test _asdict method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">p</span><span class="o">.</span><span class="n">_asdict</span><span class="p">())</span>                              <span class="c"># verify that vars() works</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fail</span><span class="p">(</span><span class="s">&#39;Did not detect an incorrect fieldname&#39;</span><span class="p">)</span>

        <span class="c"># verify that field string can have commas</span>
        <span class="n">Point</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Point&#39;</span><span class="p">,</span> <span class="s">&#39;x, y&#39;</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="s">&#39;Point(x=11, y=22)&#39;</span><span class="p">)</span>

        <span class="c"># verify that fieldspec can be a non-string sequence</span>
        <span class="n">Point</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Point&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">))</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="s">&#39;Point(x=11, y=22)&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestNamedTuple.test_tupleness"><a class="viewcode-back" href="../../test.html#test.test_collections.TestNamedTuple.test_tupleness">[docs]</a>    <span class="k">def</span> <span class="nf">test_tupleness</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Point</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Point&#39;</span><span class="p">,</span> <span class="s">&#39;x y&#39;</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>                                       <span class="c"># matches a real tuple</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>                                <span class="c"># coercable to a real tuple</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">])</span>                                 <span class="c"># coercable to a list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="mi">22</span><span class="p">)</span>                                        <span class="c"># iterable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">),</span> <span class="mi">22</span><span class="p">)</span>                                       <span class="c"># star-able</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">p</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>                                         <span class="c"># unpacks like a tuple</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>                            <span class="c"># indexable like a tuple</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">eval</span><span class="p">,</span> <span class="s">&#39;p.z&#39;</span><span class="p">,</span> <span class="nb">locals</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="TestNamedTuple.test_odd_sizes"><a class="viewcode-back" href="../../test.html#test.test_collections.TestNamedTuple.test_odd_sizes">[docs]</a>    <span class="k">def</span> <span class="nf">test_odd_sizes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Zero</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Zero&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Zero</span><span class="p">(),</span> <span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Zero</span><span class="o">.</span><span class="n">_make</span><span class="p">([]),</span> <span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">Zero</span><span class="p">()),</span> <span class="s">&#39;Zero()&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Zero</span><span class="p">()</span><span class="o">.</span><span class="n">_asdict</span><span class="p">(),</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Zero</span><span class="p">()</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="p">())</span>

        <span class="n">Dot</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Dot&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Dot</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Dot</span><span class="o">.</span><span class="n">_make</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Dot</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">Dot</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="s">&#39;Dot(d=1)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Dot</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">_asdict</span><span class="p">(),</span> <span class="p">{</span><span class="s">&#39;d&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Dot</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="mi">999</span><span class="p">),</span> <span class="p">(</span><span class="mi">999</span><span class="p">,))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Dot</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,))</span>

        <span class="c"># n = 5000</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">254</span> <span class="c"># SyntaxError: more than 255 arguments:</span>
        <span class="kn">import</span> <span class="nn">string</span><span class="o">,</span> <span class="nn">random</span>
        <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">)</span>
                                  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="n">Big</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Big&#39;</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">Big</span><span class="p">(</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Big</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)),</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="n">pos</span><span class="p">)</span>
        <span class="nb">repr</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>                                 <span class="c"># make sure repr() doesn&#39;t blow-up</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">_asdict</span><span class="p">()</span>
        <span class="n">d_expected</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">d_expected</span><span class="p">)</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="o">**</span><span class="nb">dict</span><span class="p">([(</span><span class="n">names</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">999</span><span class="p">),(</span><span class="n">names</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="mi">42</span><span class="p">)]))</span>
        <span class="n">b2_expected</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">b2_expected</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">999</span>
        <span class="n">b2_expected</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">b2</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">b2_expected</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">names</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestNamedTuple.test_pickle"><a class="viewcode-back" href="../../test.html#test.test_collections.TestNamedTuple.test_pickle">[docs]</a>    <span class="k">def</span> <span class="nf">test_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">TestNT</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="p">(</span><span class="n">pickle</span><span class="p">,):</span>
            <span class="n">loads</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s">&#39;loads&#39;</span><span class="p">)</span>
            <span class="n">dumps</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s">&#39;dumps&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">protocol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">module</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">q</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">protocol</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="n">q</span><span class="o">.</span><span class="n">_fields</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;OrderedDict&#39;</span><span class="p">,</span> <span class="n">dumps</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">protocol</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestNamedTuple.test_copy"><a class="viewcode-back" href="../../test.html#test.test_collections.TestNamedTuple.test_copy">[docs]</a>    <span class="k">def</span> <span class="nf">test_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">TestNT</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">copier</span> <span class="ow">in</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">:</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">copier</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="n">q</span><span class="o">.</span><span class="n">_fields</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestNamedTuple.test_name_conflicts"><a class="viewcode-back" href="../../test.html#test.test_collections.TestNamedTuple.test_name_conflicts">[docs]</a>    <span class="k">def</span> <span class="nf">test_name_conflicts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Some names like &quot;self&quot;, &quot;cls&quot;, &quot;tuple&quot;, &quot;itemgetter&quot;, and &quot;property&quot;</span>
        <span class="c"># failed when used as field names.  Test to make sure these now work.</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="s">&#39;itemgetter property self cls tuple&#39;</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">newt</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">itemgetter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">property</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="bp">self</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cls</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="nb">tuple</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">newt</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">))</span>

        <span class="c"># Broader test of all interesting names in a template</span>
        <span class="k">with</span> <span class="n">support</span><span class="o">.</span><span class="n">captured_stdout</span><span class="p">()</span> <span class="k">as</span> <span class="n">template</span><span class="p">:</span>
            <span class="n">T</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;[A-Za-z]+&#39;</span><span class="p">,</span> <span class="n">template</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()))</span>
        <span class="n">words</span> <span class="o">-=</span> <span class="nb">set</span><span class="p">(</span><span class="n">keyword</span><span class="o">.</span><span class="n">kwlist</span><span class="p">)</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">)</span>
        <span class="c"># test __new__</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)))</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="n">values</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
        <span class="c"># test _make</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
        <span class="c"># exercise __repr__</span>
        <span class="nb">repr</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="c"># test _asdict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">_asdict</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="n">values</span><span class="p">)))</span>
        <span class="c"># test _replace</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="n">newvalues</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="o">*</span><span class="mi">10</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>
        <span class="n">newt</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="n">newvalues</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">newt</span><span class="p">,</span> <span class="n">newvalues</span><span class="p">)</span>
        <span class="c"># test _fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">words</span><span class="p">))</span>
        <span class="c"># test __getnewargs__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(),</span> <span class="n">values</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestNamedTuple.test_repr"><a class="viewcode-back" href="../../test.html#test.test_collections.TestNamedTuple.test_repr">[docs]</a>    <span class="k">def</span> <span class="nf">test_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">support</span><span class="o">.</span><span class="n">captured_stdout</span><span class="p">()</span> <span class="k">as</span> <span class="n">template</span><span class="p">:</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="s">&#39;A(x=1)&#39;</span><span class="p">)</span>
        <span class="c"># repr should show the name of the subclass</span>
        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="s">&#39;B(x=1)&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestNamedTuple.test_source"><a class="viewcode-back" href="../../test.html#test.test_collections.TestNamedTuple.test_source">[docs]</a>    <span class="k">def</span> <span class="nf">test_source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># verify that _source can be run through exec()</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;NTColor&#39;</span><span class="p">,</span> <span class="s">&#39;red green blue&#39;</span><span class="p">)</span>
        <span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;NTColor&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>          <span class="c"># remove artifacts from other tests</span>
        <span class="k">exec</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">_source</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&#39;NTColor&#39;</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">NTColor</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="n">c</span><span class="o">.</span><span class="n">red</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">green</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">blue</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">NTColor</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="s">&#39;green&#39;</span><span class="p">,</span> <span class="s">&#39;blue&#39;</span><span class="p">))</span>
        <span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;NTColor&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>          <span class="c"># clean-up after this test</span>


<span class="c">################################################################################</span>
<span class="c">### Abstract Base Classes</span>
<span class="c">################################################################################</span>
</div></div>
<div class="viewcode-block" id="ABCTestCase"><a class="viewcode-back" href="../../test.html#test.test_collections.ABCTestCase">[docs]</a><span class="k">class</span> <span class="nc">ABCTestCase</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="ABCTestCase.validate_abstract_methods"><a class="viewcode-back" href="../../test.html#test.test_collections.ABCTestCase.validate_abstract_methods">[docs]</a>    <span class="k">def</span> <span class="nf">validate_abstract_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abc</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">):</span>
        <span class="n">methodstubs</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c"># everything should work will all required methods are present</span>
        <span class="n">C</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">abc</span><span class="p">,),</span> <span class="n">methodstubs</span><span class="p">)</span>
        <span class="n">C</span><span class="p">()</span>

        <span class="c"># instantiation should fail if a required method is missing</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="n">stubs</span> <span class="o">=</span> <span class="n">methodstubs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">del</span> <span class="n">stubs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">C</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">abc</span><span class="p">,),</span> <span class="n">stubs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ABCTestCase.validate_isinstance"><a class="viewcode-back" href="../../test.html#test.test_collections.ABCTestCase.validate_isinstance">[docs]</a>    <span class="k">def</span> <span class="nf">validate_isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abc</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">stub</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="mi">0</span>

        <span class="n">C</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nb">object</span><span class="p">,),</span> <span class="p">{</span><span class="s">&#39;__hash__&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">})</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">stub</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">C</span><span class="p">(),</span> <span class="n">abc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">abc</span><span class="p">))</span>

        <span class="n">C</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nb">object</span><span class="p">,),</span> <span class="p">{</span><span class="s">&#39;__hash__&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="n">C</span><span class="p">(),</span> <span class="n">abc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">abc</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ABCTestCase.validate_comparison"><a class="viewcode-back" href="../../test.html#test.test_collections.ABCTestCase.validate_comparison">[docs]</a>    <span class="k">def</span> <span class="nf">validate_comparison</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
        <span class="n">ops</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;lt&#39;</span><span class="p">,</span> <span class="s">&#39;gt&#39;</span><span class="p">,</span> <span class="s">&#39;le&#39;</span><span class="p">,</span> <span class="s">&#39;ge&#39;</span><span class="p">,</span> <span class="s">&#39;ne&#39;</span><span class="p">,</span> <span class="s">&#39;or&#39;</span><span class="p">,</span> <span class="s">&#39;and&#39;</span><span class="p">,</span> <span class="s">&#39;xor&#39;</span><span class="p">,</span> <span class="s">&#39;sub&#39;</span><span class="p">]</span>
        <span class="n">operators</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">ops</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;__&#39;</span> <span class="o">+</span> <span class="n">op</span> <span class="o">+</span> <span class="s">&#39;__&#39;</span>
            <span class="n">operators</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">operator</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">Other</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">right_side</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">right_side</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">return</span> <span class="bp">True</span>
            <span class="n">__lt__</span> <span class="o">=</span> <span class="n">__eq__</span>
            <span class="n">__gt__</span> <span class="o">=</span> <span class="n">__eq__</span>
            <span class="n">__le__</span> <span class="o">=</span> <span class="n">__eq__</span>
            <span class="n">__ge__</span> <span class="o">=</span> <span class="n">__eq__</span>
            <span class="n">__ne__</span> <span class="o">=</span> <span class="n">__eq__</span>
            <span class="n">__ror__</span> <span class="o">=</span> <span class="n">__eq__</span>
            <span class="n">__rand__</span> <span class="o">=</span> <span class="n">__eq__</span>
            <span class="n">__rxor__</span> <span class="o">=</span> <span class="n">__eq__</span>
            <span class="n">__rsub__</span> <span class="o">=</span> <span class="n">__eq__</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">operators</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">Other</span><span class="p">()</span>
            <span class="n">op</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">right_side</span><span class="p">,</span><span class="s">&#39;Right side not called for </span><span class="si">%s</span><span class="s">.</span><span class="si">%s</span><span class="s">&#39;</span>
                            <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">instance</span><span class="p">),</span> <span class="n">name</span><span class="p">))</span>
</div></div>
<div class="viewcode-block" id="TestOneTrickPonyABCs"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOneTrickPonyABCs">[docs]</a><span class="k">class</span> <span class="nc">TestOneTrickPonyABCs</span><span class="p">(</span><span class="n">ABCTestCase</span><span class="p">):</span>

<div class="viewcode-block" id="TestOneTrickPonyABCs.test_Hashable"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOneTrickPonyABCs.test_Hashable">[docs]</a>    <span class="k">def</span> <span class="nf">test_Hashable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Check some non-hashables</span>
        <span class="n">non_samples</span> <span class="o">=</span> <span class="p">[</span><span class="nb">bytearray</span><span class="p">(),</span> <span class="nb">list</span><span class="p">(),</span> <span class="nb">set</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">()]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">non_samples</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Hashable</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Hashable</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="c"># Check some hashables</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span>
                   <span class="nb">int</span><span class="p">(),</span> <span class="nb">float</span><span class="p">(),</span> <span class="nb">complex</span><span class="p">(),</span>
                   <span class="nb">str</span><span class="p">(),</span>
                   <span class="nb">tuple</span><span class="p">(),</span> <span class="nb">frozenset</span><span class="p">(),</span>
                   <span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">()</span>
                   <span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Hashable</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Hashable</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Hashable</span><span class="p">)</span>
        <span class="c"># Check direct subclassing</span>
        <span class="k">class</span> <span class="nc">H</span><span class="p">(</span><span class="n">Hashable</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__hash__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">H</span><span class="p">()),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">H</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_abstract_methods</span><span class="p">(</span><span class="n">Hashable</span><span class="p">,</span> <span class="s">&#39;__hash__&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_isinstance</span><span class="p">(</span><span class="n">Hashable</span><span class="p">,</span> <span class="s">&#39;__hash__&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOneTrickPonyABCs.test_Iterable"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOneTrickPonyABCs.test_Iterable">[docs]</a>    <span class="k">def</span> <span class="nf">test_Iterable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Check some non-iterables</span>
        <span class="n">non_samples</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mi">1j</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">non_samples</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Iterable</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="c"># Check some iterables</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="nb">bytes</span><span class="p">(),</span> <span class="nb">str</span><span class="p">(),</span>
                   <span class="nb">tuple</span><span class="p">(),</span> <span class="nb">list</span><span class="p">(),</span> <span class="nb">set</span><span class="p">(),</span> <span class="nb">frozenset</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">(),</span>
                   <span class="nb">dict</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
                   <span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="p">(</span><span class="k">yield</span><span class="p">))(),</span>
                   <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[]),</span>
                   <span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Iterable</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="c"># Check direct subclassing</span>
        <span class="k">class</span> <span class="nc">I</span><span class="p">(</span><span class="n">Iterable</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__iter__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="p">()),</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">I</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_abstract_methods</span><span class="p">(</span><span class="n">Iterable</span><span class="p">,</span> <span class="s">&#39;__iter__&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_isinstance</span><span class="p">(</span><span class="n">Iterable</span><span class="p">,</span> <span class="s">&#39;__iter__&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOneTrickPonyABCs.test_Iterator"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOneTrickPonyABCs.test_Iterator">[docs]</a>    <span class="k">def</span> <span class="nf">test_Iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">non_samples</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mi">1j</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="p">(),</span> <span class="p">[],</span> <span class="p">{},</span> <span class="nb">set</span><span class="p">()]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">non_samples</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Iterator</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="nb">iter</span><span class="p">(</span><span class="nb">bytes</span><span class="p">()),</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">str</span><span class="p">()),</span>
                   <span class="nb">iter</span><span class="p">(</span><span class="nb">tuple</span><span class="p">()),</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">list</span><span class="p">()),</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">dict</span><span class="p">()),</span>
                   <span class="nb">iter</span><span class="p">(</span><span class="nb">set</span><span class="p">()),</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">()),</span>
                   <span class="nb">iter</span><span class="p">(</span><span class="nb">dict</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">dict</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span>
                   <span class="nb">iter</span><span class="p">(</span><span class="nb">dict</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                   <span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="p">(</span><span class="k">yield</span><span class="p">))(),</span>
                   <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[]),</span>
                   <span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Iterator</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_abstract_methods</span><span class="p">(</span><span class="n">Iterator</span><span class="p">,</span> <span class="s">&#39;__next__&#39;</span><span class="p">,</span> <span class="s">&#39;__iter__&#39;</span><span class="p">)</span>

        <span class="c"># Issue 10565</span>
        <span class="k">class</span> <span class="nc">NextOnly</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">yield</span> <span class="mi">1</span>
                <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="n">NextOnly</span><span class="p">(),</span> <span class="n">Iterator</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOneTrickPonyABCs.test_Sized"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOneTrickPonyABCs.test_Sized">[docs]</a>    <span class="k">def</span> <span class="nf">test_Sized</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">non_samples</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mi">1j</span><span class="p">,</span>
                       <span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="p">(</span><span class="k">yield</span><span class="p">))(),</span>
                       <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[]),</span>
                       <span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">non_samples</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Sized</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Sized</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="nb">bytes</span><span class="p">(),</span> <span class="nb">str</span><span class="p">(),</span>
                   <span class="nb">tuple</span><span class="p">(),</span> <span class="nb">list</span><span class="p">(),</span> <span class="nb">set</span><span class="p">(),</span> <span class="nb">frozenset</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">(),</span>
                   <span class="nb">dict</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
                   <span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Sized</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Sized</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_abstract_methods</span><span class="p">(</span><span class="n">Sized</span><span class="p">,</span> <span class="s">&#39;__len__&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_isinstance</span><span class="p">(</span><span class="n">Sized</span><span class="p">,</span> <span class="s">&#39;__len__&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOneTrickPonyABCs.test_Container"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOneTrickPonyABCs.test_Container">[docs]</a>    <span class="k">def</span> <span class="nf">test_Container</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">non_samples</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mi">1j</span><span class="p">,</span>
                       <span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="p">(</span><span class="k">yield</span><span class="p">))(),</span>
                       <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[]),</span>
                       <span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">non_samples</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Container</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="nb">bytes</span><span class="p">(),</span> <span class="nb">str</span><span class="p">(),</span>
                   <span class="nb">tuple</span><span class="p">(),</span> <span class="nb">list</span><span class="p">(),</span> <span class="nb">set</span><span class="p">(),</span> <span class="nb">frozenset</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">(),</span>
                   <span class="nb">dict</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
                   <span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Container</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_abstract_methods</span><span class="p">(</span><span class="n">Container</span><span class="p">,</span> <span class="s">&#39;__contains__&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_isinstance</span><span class="p">(</span><span class="n">Container</span><span class="p">,</span> <span class="s">&#39;__contains__&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOneTrickPonyABCs.test_Callable"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOneTrickPonyABCs.test_Callable">[docs]</a>    <span class="k">def</span> <span class="nf">test_Callable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">non_samples</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mi">1j</span><span class="p">,</span>
                       <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="p">(),</span> <span class="p">[],</span> <span class="p">{},</span> <span class="nb">set</span><span class="p">(),</span>
                       <span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="p">(</span><span class="k">yield</span><span class="p">))(),</span>
                       <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[]),</span>
                       <span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">non_samples</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Callable</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Callable</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                   <span class="nb">type</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span>
                   <span class="nb">len</span><span class="p">,</span>
                   <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">,</span> <span class="p">[]</span><span class="o">.</span><span class="n">append</span><span class="p">,</span>
                   <span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Callable</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Callable</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_abstract_methods</span><span class="p">(</span><span class="n">Callable</span><span class="p">,</span> <span class="s">&#39;__call__&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_isinstance</span><span class="p">(</span><span class="n">Callable</span><span class="p">,</span> <span class="s">&#39;__call__&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOneTrickPonyABCs.test_direct_subclassing"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOneTrickPonyABCs.test_direct_subclassing">[docs]</a>    <span class="k">def</span> <span class="nf">test_direct_subclassing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">B</span> <span class="ow">in</span> <span class="n">Hashable</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">Sized</span><span class="p">,</span> <span class="n">Container</span><span class="p">,</span> <span class="n">Callable</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">C</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestOneTrickPonyABCs.test_registration"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOneTrickPonyABCs.test_registration">[docs]</a>    <span class="k">def</span> <span class="nf">test_registration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">B</span> <span class="ow">in</span> <span class="n">Hashable</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">Sized</span><span class="p">,</span> <span class="n">Container</span><span class="p">,</span> <span class="n">Callable</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
                <span class="n">__hash__</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c"># Make sure it isn&#39;t hashable by default</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">B</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
            <span class="n">B</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span>
</div></div>
<div class="viewcode-block" id="WithSet"><a class="viewcode-back" href="../../test.html#test.test_collections.WithSet">[docs]</a><span class="k">class</span> <span class="nc">WithSet</span><span class="p">(</span><span class="n">MutableSet</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">it</span><span class="o">=</span><span class="p">()):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

<div class="viewcode-block" id="WithSet.add"><a class="viewcode-back" href="../../test.html#test.test_collections.WithSet.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="WithSet.discard"><a class="viewcode-back" href="../../test.html#test.test_collections.WithSet.discard">[docs]</a>    <span class="k">def</span> <span class="nf">discard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="TestCollectionABCs"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs">[docs]</a><span class="k">class</span> <span class="nc">TestCollectionABCs</span><span class="p">(</span><span class="n">ABCTestCase</span><span class="p">):</span>

    <span class="c"># XXX For now, we only test some virtual inheritance properties.</span>
    <span class="c"># We should also test the proper behavior of the collection ABCs</span>
    <span class="c"># as real base classes or mix-in classes.</span>

<div class="viewcode-block" id="TestCollectionABCs.test_Set"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.test_Set">[docs]</a>    <span class="k">def</span> <span class="nf">test_Set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">set</span><span class="p">,</span> <span class="nb">frozenset</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">sample</span><span class="p">(),</span> <span class="n">Set</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">Set</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_abstract_methods</span><span class="p">(</span><span class="n">Set</span><span class="p">,</span> <span class="s">&#39;__contains__&#39;</span><span class="p">,</span> <span class="s">&#39;__iter__&#39;</span><span class="p">,</span> <span class="s">&#39;__len__&#39;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">MySet</span><span class="p">(</span><span class="n">Set</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">iter</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_comparison</span><span class="p">(</span><span class="n">MySet</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="TestCollectionABCs.test_hash_Set"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.test_hash_Set">[docs]</a>    <span class="k">def</span> <span class="nf">test_hash_Set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">OneTwoThreeSet</span><span class="p">(</span><span class="n">Set</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">contents</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
            <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span>
            <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hash</span><span class="p">()</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">OneTwoThreeSet</span><span class="p">(),</span> <span class="n">OneTwoThreeSet</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="nb">hash</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestCollectionABCs.test_MutableSet"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.test_MutableSet">[docs]</a>    <span class="k">def</span> <span class="nf">test_MutableSet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="nb">set</span><span class="p">(),</span> <span class="n">MutableSet</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="n">MutableSet</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(),</span> <span class="n">MutableSet</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">,</span> <span class="n">MutableSet</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_abstract_methods</span><span class="p">(</span><span class="n">MutableSet</span><span class="p">,</span> <span class="s">&#39;__contains__&#39;</span><span class="p">,</span> <span class="s">&#39;__iter__&#39;</span><span class="p">,</span> <span class="s">&#39;__len__&#39;</span><span class="p">,</span>
            <span class="s">&#39;add&#39;</span><span class="p">,</span> <span class="s">&#39;discard&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCollectionABCs.test_issue_5647"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.test_issue_5647">[docs]</a>    <span class="k">def</span> <span class="nf">test_issue_5647</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># MutableSet.__iand__ mutated the set during iteration</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">WithSet</span><span class="p">(</span><span class="s">&#39;abcd&#39;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">&amp;=</span> <span class="n">WithSet</span><span class="p">(</span><span class="s">&#39;cdef&#39;</span><span class="p">)</span>            <span class="c"># This used to fail</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="nb">set</span><span class="p">(</span><span class="s">&#39;cd&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestCollectionABCs.test_issue_4920"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.test_issue_4920">[docs]</a>    <span class="k">def</span> <span class="nf">test_issue_4920</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># MutableSet.pop() method did not work</span>
        <span class="k">class</span> <span class="nc">MySet</span><span class="p">(</span><span class="n">MutableSet</span><span class="p">):</span>
            <span class="n">__slots__</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;__s&#39;</span><span class="p">]</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">items</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">items</span><span class="o">=</span><span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__s</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__s</span>
            <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__s</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__s</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="p">):</span>
                <span class="n">result</span><span class="o">=</span><span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__s</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__s</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">result</span>
            <span class="k">def</span> <span class="nf">discard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="p">):</span>
                <span class="n">result</span><span class="o">=</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__s</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__s</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">result</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;MySet(</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">MySet</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">pop</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCollectionABCs.test_issue8750"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.test_issue8750">[docs]</a>    <span class="k">def</span> <span class="nf">test_issue8750</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">empty</span> <span class="o">=</span> <span class="n">WithSet</span><span class="p">()</span>
        <span class="n">full</span> <span class="o">=</span> <span class="n">WithSet</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">WithSet</span><span class="p">(</span><span class="n">full</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">-=</span> <span class="n">s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">empty</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">WithSet</span><span class="p">(</span><span class="n">full</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">^=</span> <span class="n">s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">empty</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">WithSet</span><span class="p">(</span><span class="n">full</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">&amp;=</span> <span class="n">s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">full</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">|=</span> <span class="n">s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">full</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCollectionABCs.test_issue16373"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.test_issue16373">[docs]</a>    <span class="k">def</span> <span class="nf">test_issue16373</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Recursion error comparing comparable and noncomparable</span>
        <span class="c"># Set instances</span>
        <span class="k">class</span> <span class="nc">MyComparableSet</span><span class="p">(</span><span class="n">Set</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">iter</span><span class="p">([])</span>
        <span class="k">class</span> <span class="nc">MyNonComparableSet</span><span class="p">(</span><span class="n">Set</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">iter</span><span class="p">([])</span>
            <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">NotImplemented</span>
            <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">NotImplemented</span>

        <span class="n">cs</span> <span class="o">=</span> <span class="n">MyComparableSet</span><span class="p">()</span>
        <span class="n">ncs</span> <span class="o">=</span> <span class="n">MyNonComparableSet</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">ncs</span> <span class="o">&lt;</span> <span class="n">cs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">ncs</span> <span class="o">&lt;=</span> <span class="n">cs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">ncs</span> <span class="o">&gt;</span> <span class="n">cs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">ncs</span> <span class="o">&gt;=</span> <span class="n">cs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCollectionABCs.assertSameSet"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.assertSameSet">[docs]</a>    <span class="k">def</span> <span class="nf">assertSameSet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
        <span class="c"># coerce both to a real set then check equality</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSetEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">s1</span><span class="p">),</span> <span class="nb">set</span><span class="p">(</span><span class="n">s2</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestCollectionABCs.test_Set_interoperability_with_real_sets"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.test_Set_interoperability_with_real_sets">[docs]</a>    <span class="k">def</span> <span class="nf">test_Set_interoperability_with_real_sets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Issue: 8743</span>
        <span class="k">class</span> <span class="nc">ListSet</span><span class="p">(</span><span class="n">Set</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">elem</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&#39;Set({!r})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="n">r1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">)</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s">&#39;bcd&#39;</span><span class="p">)</span>
        <span class="n">r3</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s">&#39;abcde&#39;</span><span class="p">)</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="n">ListSet</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">)</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="n">ListSet</span><span class="p">(</span><span class="s">&#39;bcd&#39;</span><span class="p">)</span>
        <span class="n">f3</span> <span class="o">=</span> <span class="n">ListSet</span><span class="p">(</span><span class="s">&#39;abcde&#39;</span><span class="p">)</span>
        <span class="n">l1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s">&#39;abccba&#39;</span><span class="p">)</span>
        <span class="n">l2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s">&#39;bcddcb&#39;</span><span class="p">)</span>
        <span class="n">l3</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s">&#39;abcdeedcba&#39;</span><span class="p">)</span>

        <span class="n">target</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">&amp;</span> <span class="n">r2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">f1</span> <span class="o">&amp;</span> <span class="n">f2</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">f1</span> <span class="o">&amp;</span> <span class="n">r2</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">r2</span> <span class="o">&amp;</span> <span class="n">f1</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">f1</span> <span class="o">&amp;</span> <span class="n">l2</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>

        <span class="n">target</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">|</span> <span class="n">r2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">f1</span> <span class="o">|</span> <span class="n">f2</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">f1</span> <span class="o">|</span> <span class="n">r2</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">r2</span> <span class="o">|</span> <span class="n">f1</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">f1</span> <span class="o">|</span> <span class="n">l2</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>

        <span class="n">fwd_target</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>
        <span class="n">rev_target</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">r1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">f1</span> <span class="o">-</span> <span class="n">f2</span><span class="p">,</span> <span class="n">fwd_target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">f2</span> <span class="o">-</span> <span class="n">f1</span><span class="p">,</span> <span class="n">rev_target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">f1</span> <span class="o">-</span> <span class="n">r2</span><span class="p">,</span> <span class="n">fwd_target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">f2</span> <span class="o">-</span> <span class="n">r1</span><span class="p">,</span> <span class="n">rev_target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">r1</span> <span class="o">-</span> <span class="n">f2</span><span class="p">,</span> <span class="n">fwd_target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">r2</span> <span class="o">-</span> <span class="n">f1</span><span class="p">,</span> <span class="n">rev_target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">f1</span> <span class="o">-</span> <span class="n">l2</span><span class="p">,</span> <span class="n">fwd_target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">f2</span> <span class="o">-</span> <span class="n">l1</span><span class="p">,</span> <span class="n">rev_target</span><span class="p">)</span>

        <span class="n">target</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">^</span> <span class="n">r2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">f1</span> <span class="o">^</span> <span class="n">f2</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">f1</span> <span class="o">^</span> <span class="n">r2</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">r2</span> <span class="o">^</span> <span class="n">f1</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSameSet</span><span class="p">(</span><span class="n">f1</span> <span class="o">^</span> <span class="n">l2</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>

        <span class="c"># Don&#39;t change the following to use assertLess or other</span>
        <span class="c"># &quot;more specific&quot; unittest assertions.  The current</span>
        <span class="c"># assertTrue/assertFalse style makes the pattern of test</span>
        <span class="c"># case combinations clear and allows us to know for sure</span>
        <span class="c"># the exact operator being invoked.</span>

        <span class="c"># proper subset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">f1</span> <span class="o">&lt;</span> <span class="n">f3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f1</span> <span class="o">&lt;</span> <span class="n">f1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f1</span> <span class="o">&lt;</span> <span class="n">f2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">r1</span> <span class="o">&lt;</span> <span class="n">f3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">r1</span> <span class="o">&lt;</span> <span class="n">f1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">r1</span> <span class="o">&lt;</span> <span class="n">f2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">r1</span> <span class="o">&lt;</span> <span class="n">r3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">r1</span> <span class="o">&lt;</span> <span class="n">r1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">r1</span> <span class="o">&lt;</span> <span class="n">r2</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">f1</span> <span class="o">&lt;</span> <span class="n">l3</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">f1</span> <span class="o">&lt;</span> <span class="n">l1</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">f1</span> <span class="o">&lt;</span> <span class="n">l2</span>

        <span class="c"># any subset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">f1</span> <span class="o">&lt;=</span> <span class="n">f3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">f1</span> <span class="o">&lt;=</span> <span class="n">f1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f1</span> <span class="o">&lt;=</span> <span class="n">f2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">r1</span> <span class="o">&lt;=</span> <span class="n">f3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">r1</span> <span class="o">&lt;=</span> <span class="n">f1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">r1</span> <span class="o">&lt;=</span> <span class="n">f2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">r1</span> <span class="o">&lt;=</span> <span class="n">r3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">r1</span> <span class="o">&lt;=</span> <span class="n">r1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">r1</span> <span class="o">&lt;=</span> <span class="n">r2</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">f1</span> <span class="o">&lt;=</span> <span class="n">l3</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">f1</span> <span class="o">&lt;=</span> <span class="n">l1</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">f1</span> <span class="o">&lt;=</span> <span class="n">l2</span>

        <span class="c"># proper superset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">f3</span> <span class="o">&gt;</span> <span class="n">f1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f1</span> <span class="o">&gt;</span> <span class="n">f1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f2</span> <span class="o">&gt;</span> <span class="n">f1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">r3</span> <span class="o">&gt;</span> <span class="n">r1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f1</span> <span class="o">&gt;</span> <span class="n">r1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f2</span> <span class="o">&gt;</span> <span class="n">r1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">r3</span> <span class="o">&gt;</span> <span class="n">r1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">r1</span> <span class="o">&gt;</span> <span class="n">r1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">r2</span> <span class="o">&gt;</span> <span class="n">r1</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">f1</span> <span class="o">&gt;</span> <span class="n">l3</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">f1</span> <span class="o">&gt;</span> <span class="n">l1</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">f1</span> <span class="o">&gt;</span> <span class="n">l2</span>

        <span class="c"># any superset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">f3</span> <span class="o">&gt;=</span> <span class="n">f1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">f1</span> <span class="o">&gt;=</span> <span class="n">f1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f2</span> <span class="o">&gt;=</span> <span class="n">f1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">r3</span> <span class="o">&gt;=</span> <span class="n">r1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">f1</span> <span class="o">&gt;=</span> <span class="n">r1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f2</span> <span class="o">&gt;=</span> <span class="n">r1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">r3</span> <span class="o">&gt;=</span> <span class="n">r1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">r1</span> <span class="o">&gt;=</span> <span class="n">r1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">r2</span> <span class="o">&gt;=</span> <span class="n">r1</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">f1</span> <span class="o">&gt;=</span> <span class="n">l3</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">f1</span> <span class="o">&gt;=</span><span class="n">l1</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">f1</span> <span class="o">&gt;=</span> <span class="n">l2</span>

        <span class="c"># equality</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">f1</span> <span class="o">==</span> <span class="n">f1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">r1</span> <span class="o">==</span> <span class="n">f1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">f1</span> <span class="o">==</span> <span class="n">r1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f1</span> <span class="o">==</span> <span class="n">f3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">r1</span> <span class="o">==</span> <span class="n">f3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f1</span> <span class="o">==</span> <span class="n">r3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f1</span> <span class="o">==</span> <span class="n">l3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f1</span> <span class="o">==</span> <span class="n">l1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f1</span> <span class="o">==</span> <span class="n">l2</span><span class="p">)</span>

        <span class="c"># inequality</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f1</span> <span class="o">!=</span> <span class="n">f1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">r1</span> <span class="o">!=</span> <span class="n">f1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f1</span> <span class="o">!=</span> <span class="n">r1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">f1</span> <span class="o">!=</span> <span class="n">f3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">r1</span> <span class="o">!=</span> <span class="n">f3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">f1</span> <span class="o">!=</span> <span class="n">r3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">f1</span> <span class="o">!=</span> <span class="n">l3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">f1</span> <span class="o">!=</span> <span class="n">l1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">f1</span> <span class="o">!=</span> <span class="n">l2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCollectionABCs.test_Mapping"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.test_Mapping">[docs]</a>    <span class="k">def</span> <span class="nf">test_Mapping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">sample</span><span class="p">(),</span> <span class="n">Mapping</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_abstract_methods</span><span class="p">(</span><span class="n">Mapping</span><span class="p">,</span> <span class="s">&#39;__contains__&#39;</span><span class="p">,</span> <span class="s">&#39;__iter__&#39;</span><span class="p">,</span> <span class="s">&#39;__len__&#39;</span><span class="p">,</span>
            <span class="s">&#39;__getitem__&#39;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">MyMapping</span><span class="p">(</span><span class="n">Mapping</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">IndexError</span>
            <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">iter</span><span class="p">(())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_comparison</span><span class="p">(</span><span class="n">MyMapping</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="TestCollectionABCs.test_MutableMapping"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.test_MutableMapping">[docs]</a>    <span class="k">def</span> <span class="nf">test_MutableMapping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">sample</span><span class="p">(),</span> <span class="n">MutableMapping</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">MutableMapping</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_abstract_methods</span><span class="p">(</span><span class="n">MutableMapping</span><span class="p">,</span> <span class="s">&#39;__contains__&#39;</span><span class="p">,</span> <span class="s">&#39;__iter__&#39;</span><span class="p">,</span> <span class="s">&#39;__len__&#39;</span><span class="p">,</span>
            <span class="s">&#39;__getitem__&#39;</span><span class="p">,</span> <span class="s">&#39;__setitem__&#39;</span><span class="p">,</span> <span class="s">&#39;__delitem__&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCollectionABCs.test_MutableMapping_subclass"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.test_MutableMapping_subclass">[docs]</a>    <span class="k">def</span> <span class="nf">test_MutableMapping_subclass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test issue 9214</span>
        <span class="n">mymap</span> <span class="o">=</span> <span class="n">UserDict</span><span class="p">()</span>
        <span class="n">mymap</span><span class="p">[</span><span class="s">&#39;red&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">mymap</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">Set</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">mymap</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">KeysView</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">mymap</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">Set</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">mymap</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">ItemsView</span><span class="p">)</span>

        <span class="n">mymap</span> <span class="o">=</span> <span class="n">UserDict</span><span class="p">()</span>
        <span class="n">mymap</span><span class="p">[</span><span class="s">&#39;red&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">mymap</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">|</span> <span class="p">{</span><span class="s">&#39;orange&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="nb">set</span><span class="p">)</span>
        <span class="nb">list</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">mymap</span><span class="p">[</span><span class="s">&#39;blue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span>               <span class="c"># Shouldn&#39;t affect &#39;z&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;orange&#39;</span><span class="p">,</span> <span class="s">&#39;red&#39;</span><span class="p">])</span>

        <span class="n">mymap</span> <span class="o">=</span> <span class="n">UserDict</span><span class="p">()</span>
        <span class="n">mymap</span><span class="p">[</span><span class="s">&#39;red&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">mymap</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="o">|</span> <span class="p">{(</span><span class="s">&#39;orange&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="nb">set</span><span class="p">)</span>
        <span class="nb">list</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">mymap</span><span class="p">[</span><span class="s">&#39;blue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span>               <span class="c"># Shouldn&#39;t affect &#39;z&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="p">[(</span><span class="s">&#39;orange&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="TestCollectionABCs.test_Sequence"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.test_Sequence">[docs]</a>    <span class="k">def</span> <span class="nf">test_Sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">sample</span><span class="p">(),</span> <span class="n">Sequence</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">Sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">range</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">memoryview</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">),</span> <span class="n">Sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">memoryview</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_abstract_methods</span><span class="p">(</span><span class="n">Sequence</span><span class="p">,</span> <span class="s">&#39;__contains__&#39;</span><span class="p">,</span> <span class="s">&#39;__iter__&#39;</span><span class="p">,</span> <span class="s">&#39;__len__&#39;</span><span class="p">,</span>
            <span class="s">&#39;__getitem__&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCollectionABCs.test_ByteString"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.test_ByteString">[docs]</a>    <span class="k">def</span> <span class="nf">test_ByteString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytearray</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">sample</span><span class="p">(),</span> <span class="n">ByteString</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">ByteString</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="n">sample</span><span class="p">(),</span> <span class="n">ByteString</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">ByteString</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="n">memoryview</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">),</span> <span class="n">ByteString</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">memoryview</span><span class="p">,</span> <span class="n">ByteString</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestCollectionABCs.test_MutableSequence"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.test_MutableSequence">[docs]</a>    <span class="k">def</span> <span class="nf">test_MutableSequence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="n">sample</span><span class="p">(),</span> <span class="n">MutableSequence</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">MutableSequence</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">bytearray</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">sample</span><span class="p">(),</span> <span class="n">MutableSequence</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">MutableSequence</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">MutableSequence</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_abstract_methods</span><span class="p">(</span><span class="n">MutableSequence</span><span class="p">,</span> <span class="s">&#39;__contains__&#39;</span><span class="p">,</span> <span class="s">&#39;__iter__&#39;</span><span class="p">,</span>
            <span class="s">&#39;__len__&#39;</span><span class="p">,</span> <span class="s">&#39;__getitem__&#39;</span><span class="p">,</span> <span class="s">&#39;__setitem__&#39;</span><span class="p">,</span> <span class="s">&#39;__delitem__&#39;</span><span class="p">,</span> <span class="s">&#39;insert&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCollectionABCs.test_MutableSequence_mixins"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCollectionABCs.test_MutableSequence_mixins">[docs]</a>    <span class="k">def</span> <span class="nf">test_MutableSequence_mixins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test the mixins of MutableSequence by creating a miminal concrete</span>
        <span class="c"># class inherited from it.</span>
        <span class="k">class</span> <span class="nc">MutableSequenceSubclass</span><span class="p">(</span><span class="n">MutableSequence</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lst</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

            <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lst</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

            <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lst</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">lst</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

            <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lst</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="n">mss</span> <span class="o">=</span> <span class="n">MutableSequenceSubclass</span><span class="p">()</span>
        <span class="n">mss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">mss</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mss</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mss</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">mss</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mss</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">mss</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mss</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">mss</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mss</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">mss</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mss</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">30</span><span class="p">)</span>
        <span class="n">mss</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mss</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

<span class="c">################################################################################</span>
<span class="c">### Counter</span>
<span class="c">################################################################################</span>
</div></div>
<div class="viewcode-block" id="CounterSubclassWithSetItem"><a class="viewcode-back" href="../../test.html#test.test_collections.CounterSubclassWithSetItem">[docs]</a><span class="k">class</span> <span class="nc">CounterSubclassWithSetItem</span><span class="p">(</span><span class="n">Counter</span><span class="p">):</span>
    <span class="c"># Test a counter subclass that overrides __setitem__</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">called</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">Counter</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">called</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">Counter</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CounterSubclassWithGet"><a class="viewcode-back" href="../../test.html#test.test_collections.CounterSubclassWithGet">[docs]</a><span class="k">class</span> <span class="nc">CounterSubclassWithGet</span><span class="p">(</span><span class="n">Counter</span><span class="p">):</span>
    <span class="c"># Test a counter subclass that overrides get()</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">called</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">Counter</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<div class="viewcode-block" id="CounterSubclassWithGet.get"><a class="viewcode-back" href="../../test.html#test.test_collections.CounterSubclassWithGet.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">called</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="n">Counter</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="TestCounter"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCounter">[docs]</a><span class="k">class</span> <span class="nc">TestCounter</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="TestCounter.test_basics"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCounter.test_basics">[docs]</a>    <span class="k">def</span> <span class="nf">test_basics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s">&#39;abcaba&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Counter</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="mi">3</span> <span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">Counter</span><span class="p">,</span> <span class="nb">dict</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">Counter</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span>
                         <span class="p">[(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s">&#39;z&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">__contains__</span><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">),</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">__contains__</span><span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">),</span> <span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="s">&quot;Counter({&#39;a&#39;: 3, &#39;b&#39;: 2, &#39;c&#39;: 1})&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">most_common</span><span class="p">(),</span> <span class="p">[(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                             <span class="p">[(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)][:</span><span class="n">i</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">elements</span><span class="p">())),</span> <span class="s">&#39;aaabbc&#39;</span><span class="p">)</span>
        <span class="n">c</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>         <span class="c"># increment an existing value</span>
        <span class="n">c</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">2</span>         <span class="c"># sub existing value to zero</span>
        <span class="k">del</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">]</span>          <span class="c"># remove an entry</span>
        <span class="k">del</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">]</span>          <span class="c"># make sure that del doesn&#39;t raise KeyError</span>
        <span class="n">c</span><span class="p">[</span><span class="s">&#39;d&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">2</span>         <span class="c"># sub from a missing value</span>
        <span class="n">c</span><span class="p">[</span><span class="s">&#39;e&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>         <span class="c"># directly assign a missing value</span>
        <span class="n">c</span><span class="p">[</span><span class="s">&#39;f&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">4</span>         <span class="c"># add to a missing value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">e</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">elements</span><span class="p">())),</span> <span class="s">&#39;aaaaffff&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">elem</span><span class="p">,</span> <span class="n">cnt</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">popitem</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="s">&#39;Counter()&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">NotImplementedError</span><span class="p">,</span> <span class="n">Counter</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">,</span> <span class="s">&#39;abc&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">hash</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
        <span class="n">c</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="s">&#39;a&#39;</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="s">&#39;b&#39;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">))</span>
        <span class="n">c</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>          <span class="c"># test case with no args</span>
        <span class="n">c</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;a&#39;</span> <span class="o">*</span> <span class="mi">500</span> <span class="o">+</span> <span class="s">&#39;b&#39;</span> <span class="o">*</span> <span class="mi">300</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;cdc&#39;</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">555</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">333</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s">&#39;d&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s">&#39;e&#39;</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCounter.test_copying"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCounter.test_copying">[docs]</a>    <span class="k">def</span> <span class="nf">test_copying</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Check that counters are copyable, deepcopyable, picklable, and</span>
        <span class="c">#have a repr/eval round-trip</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s">&#39;which witch had which witches wrist watch&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="n">update_test</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
        <span class="n">update_test</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">dup</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="p">(</span><span class="s">&#39;words.copy()&#39;</span><span class="p">,</span> <span class="n">words</span><span class="o">.</span><span class="n">copy</span><span class="p">()),</span>
                    <span class="p">(</span><span class="s">&#39;copy.copy(words)&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">words</span><span class="p">)),</span>
                    <span class="p">(</span><span class="s">&#39;copy.deepcopy(words)&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">words</span><span class="p">)),</span>
                    <span class="p">(</span><span class="s">&#39;pickle.loads(pickle.dumps(words, 0))&#39;</span><span class="p">,</span>
                        <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="mi">0</span><span class="p">))),</span>
                    <span class="p">(</span><span class="s">&#39;pickle.loads(pickle.dumps(words, 1))&#39;</span><span class="p">,</span>
                        <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="mi">1</span><span class="p">))),</span>
                    <span class="p">(</span><span class="s">&#39;pickle.loads(pickle.dumps(words, 2))&#39;</span><span class="p">,</span>
                        <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="mi">2</span><span class="p">))),</span>
                    <span class="p">(</span><span class="s">&#39;pickle.loads(pickle.dumps(words, -1))&#39;</span><span class="p">,</span>
                        <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))),</span>
                    <span class="p">(</span><span class="s">&#39;eval(repr(words))&#39;</span><span class="p">,</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">words</span><span class="p">))),</span>
                    <span class="p">(</span><span class="s">&#39;update_test&#39;</span><span class="p">,</span> <span class="n">update_test</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;Counter(words)&#39;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">words</span><span class="p">)),</span>
                    <span class="p">]:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">subTest</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">):</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">copy: </span><span class="si">%s</span><span class="se">\n</span><span class="s">words: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dup</span><span class="p">,</span> <span class="n">words</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">dup</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dup</span><span class="p">,</span> <span class="n">words</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCounter.test_copy_subclass"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCounter.test_copy_subclass">[docs]</a>    <span class="k">def</span> <span class="nf">test_copy_subclass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">MyCounter</span><span class="p">(</span><span class="n">Counter</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">MyCounter</span><span class="p">(</span><span class="s">&#39;slartibartfast&#39;</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestCounter.test_conversions"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCounter.test_conversions">[docs]</a>    <span class="k">def</span> <span class="nf">test_conversions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Convert to: set, list, dict</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;she sells sea shells by the sea shore&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">elements</span><span class="p">()),</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="nb">set</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestCounter.test_invariant_for_the_in_operator"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCounter.test_invariant_for_the_in_operator">[docs]</a>    <span class="k">def</span> <span class="nf">test_invariant_for_the_in_operator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">b</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">elem</span> <span class="ow">in</span> <span class="n">c</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCounter.test_multiset_operations"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCounter.test_multiset_operations">[docs]</a>    <span class="k">def</span> <span class="nf">test_multiset_operations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Verify that adding a zero counter will strip zeros and negatives</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">b</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Counter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>

        <span class="n">elements</span> <span class="o">=</span> <span class="s">&#39;abcd&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
            <span class="c"># test random pairs of multisets</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="nb">dict</span><span class="p">((</span><span class="n">elem</span><span class="p">,</span> <span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">))</span>
            <span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">e</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="nb">dict</span><span class="p">((</span><span class="n">elem</span><span class="p">,</span> <span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">))</span>
            <span class="n">q</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">counterop</span><span class="p">,</span> <span class="n">numberop</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="p">(</span><span class="n">Counter</span><span class="o">.</span><span class="n">__add__</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)),</span>
                <span class="p">(</span><span class="n">Counter</span><span class="o">.</span><span class="n">__sub__</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)),</span>
                <span class="p">(</span><span class="n">Counter</span><span class="o">.</span><span class="n">__or__</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)),</span>
                <span class="p">(</span><span class="n">Counter</span><span class="o">.</span><span class="n">__and__</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))),</span>
            <span class="p">]:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">counterop</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">numberop</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="n">x</span><span class="p">]),</span> <span class="n">result</span><span class="p">[</span><span class="n">x</span><span class="p">],</span>
                                     <span class="p">(</span><span class="n">counterop</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>
                <span class="c"># verify that results exclude non-positive counts</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="n">elements</span> <span class="o">=</span> <span class="s">&#39;abcdef&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
            <span class="c"># verify that random multisets with no repeats are exactly like sets</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="nb">dict</span><span class="p">((</span><span class="n">elem</span><span class="p">,</span> <span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">))</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="nb">dict</span><span class="p">((</span><span class="n">elem</span><span class="p">,</span> <span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">counterop</span><span class="p">,</span> <span class="n">setop</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="p">(</span><span class="n">Counter</span><span class="o">.</span><span class="n">__sub__</span><span class="p">,</span> <span class="nb">set</span><span class="o">.</span><span class="n">__sub__</span><span class="p">),</span>
                <span class="p">(</span><span class="n">Counter</span><span class="o">.</span><span class="n">__or__</span><span class="p">,</span> <span class="nb">set</span><span class="o">.</span><span class="n">__or__</span><span class="p">),</span>
                <span class="p">(</span><span class="n">Counter</span><span class="o">.</span><span class="n">__and__</span><span class="p">,</span> <span class="nb">set</span><span class="o">.</span><span class="n">__and__</span><span class="p">),</span>
            <span class="p">]:</span>
                <span class="n">counter_result</span> <span class="o">=</span> <span class="n">counterop</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
                <span class="n">set_result</span> <span class="o">=</span> <span class="n">setop</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">elements</span><span class="p">()),</span> <span class="nb">set</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">elements</span><span class="p">()))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">counter_result</span><span class="p">,</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">set_result</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestCounter.test_inplace_operations"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCounter.test_inplace_operations">[docs]</a>    <span class="k">def</span> <span class="nf">test_inplace_operations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="s">&#39;abcd&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
            <span class="c"># test random pairs of multisets</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="nb">dict</span><span class="p">((</span><span class="n">elem</span><span class="p">,</span> <span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">))</span>
            <span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">e</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="nb">dict</span><span class="p">((</span><span class="n">elem</span><span class="p">,</span> <span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">))</span>
            <span class="n">q</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">inplace_op</span><span class="p">,</span> <span class="n">regular_op</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="p">(</span><span class="n">Counter</span><span class="o">.</span><span class="n">__iadd__</span><span class="p">,</span> <span class="n">Counter</span><span class="o">.</span><span class="n">__add__</span><span class="p">),</span>
                <span class="p">(</span><span class="n">Counter</span><span class="o">.</span><span class="n">__isub__</span><span class="p">,</span> <span class="n">Counter</span><span class="o">.</span><span class="n">__sub__</span><span class="p">),</span>
                <span class="p">(</span><span class="n">Counter</span><span class="o">.</span><span class="n">__ior__</span><span class="p">,</span> <span class="n">Counter</span><span class="o">.</span><span class="n">__or__</span><span class="p">),</span>
                <span class="p">(</span><span class="n">Counter</span><span class="o">.</span><span class="n">__iand__</span><span class="p">,</span> <span class="n">Counter</span><span class="o">.</span><span class="n">__and__</span><span class="p">),</span>
            <span class="p">]:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">c_id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
                <span class="n">regular_result</span> <span class="o">=</span> <span class="n">regular_op</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
                <span class="n">inplace_result</span> <span class="o">=</span> <span class="n">inplace_op</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">inplace_result</span><span class="p">,</span> <span class="n">regular_result</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">inplace_result</span><span class="p">),</span> <span class="n">c_id</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCounter.test_subtract"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCounter.test_subtract">[docs]</a>    <span class="k">def</span> <span class="nf">test_subtract</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">g</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">h</span><span class="o">=-</span><span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span> <span class="n">b</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">e</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">f</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">g</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">h</span><span class="o">=-</span><span class="mi">50</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span> <span class="n">b</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">e</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">f</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s">&#39;aaabbcd&#39;</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="s">&#39;aaaabbcce&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestCounter.test_unary"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCounter.test_unary">[docs]</a>    <span class="k">def</span> <span class="nf">test_unary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">g</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="o">+</span><span class="n">c</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">40</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestCounter.test_repr_nonsortable"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCounter.test_repr_nonsortable">[docs]</a>    <span class="k">def</span> <span class="nf">test_repr_nonsortable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;&#39;a&#39;: 2&quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;&#39;b&#39;: None&quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCounter.test_helper_function"><a class="viewcode-back" href="../../test.html#test.test_collections.TestCounter.test_helper_function">[docs]</a>    <span class="k">def</span> <span class="nf">test_helper_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># two paths, one for real dicts and one for other mappings</span>
        <span class="n">elems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s">&#39;abracadabra&#39;</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">_count_elements</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">elems</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">_count_elements</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">elems</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m</span><span class="p">,</span>
             <span class="n">OrderedDict</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]))</span>

        <span class="c"># test fidelity to the pure python version</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">CounterSubclassWithSetItem</span><span class="p">(</span><span class="s">&#39;abracadabra&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">called</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">:</span><span class="mi">2</span> <span class="p">})</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">CounterSubclassWithGet</span><span class="p">(</span><span class="s">&#39;abracadabra&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">called</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">:</span><span class="mi">2</span> <span class="p">})</span>


<span class="c">################################################################################</span>
<span class="c">### OrderedDict</span>
<span class="c">################################################################################</span>
</div></div>
<div class="viewcode-block" id="TestOrderedDict"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict">[docs]</a><span class="k">class</span> <span class="nc">TestOrderedDict</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="TestOrderedDict.test_init"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_init">[docs]</a>    <span class="k">def</span> <span class="nf">test_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">OrderedDict</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="bp">None</span><span class="p">)</span>                                 <span class="c"># too many args</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">pairs</span><span class="p">))</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">pairs</span><span class="p">)</span>           <span class="c"># dict input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">(</span><span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">pairs</span><span class="p">))</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">pairs</span><span class="p">)</span>         <span class="c"># kwds input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">pairs</span><span class="p">)</span>                   <span class="c"># pairs input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span>
                                          <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">pairs</span><span class="p">)</span>                <span class="c"># mixed input</span>

        <span class="c"># make sure no positional args conflict with possible kwdargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getargspec</span><span class="p">(</span><span class="n">OrderedDict</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__init__&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">args</span><span class="p">,</span>
                         <span class="p">[</span><span class="s">&#39;self&#39;</span><span class="p">])</span>

        <span class="c"># Make sure that direct calls to __init__ do not clear previous contents</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">44</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">55</span><span class="p">)])</span>
        <span class="n">d</span><span class="o">.</span><span class="n">__init__</span><span class="p">([(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)],</span> <span class="n">g</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span>
            <span class="p">[(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_update"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_update">[docs]</a>    <span class="k">def</span> <span class="nf">test_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">OrderedDict</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="bp">None</span><span class="p">)</span>                        <span class="c"># too many args</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">pairs</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">pairs</span><span class="p">)</span>                                 <span class="c"># dict input</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">pairs</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">pairs</span><span class="p">)</span>                                 <span class="c"># kwds input</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">pairs</span><span class="p">)</span>                                   <span class="c"># pairs input</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">pairs</span><span class="p">)</span>                                   <span class="c"># mixed input</span>

        <span class="c"># Issue 9137: Named argument called &#39;other&#39; or &#39;self&#39;</span>
        <span class="c"># shouldn&#39;t be treated specially.</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="p">[(</span><span class="s">&#39;self&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">)])</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">=</span><span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="p">[(</span><span class="s">&#39;other&#39;</span><span class="p">,</span> <span class="p">{})])</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">red</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">blue</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="bp">self</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">items</span><span class="p">())),</span>
                         <span class="p">[(</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;other&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;self&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)])</span>

        <span class="c"># Make sure that direct calls to update do not clear previous contents</span>
        <span class="c"># add that updates items are not moved to the end</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">44</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">55</span><span class="p">)])</span>
        <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">([(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)],</span> <span class="n">g</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span>
            <span class="p">[(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_abc"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_abc">[docs]</a>    <span class="k">def</span> <span class="nf">test_abc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">(),</span> <span class="n">MutableMapping</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">,</span> <span class="n">MutableMapping</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_clear"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_clear">[docs]</a>    <span class="k">def</span> <span class="nf">test_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
        <span class="n">shuffle</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">od</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">pairs</span><span class="p">))</span>
        <span class="n">od</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">od</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_delitem"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_delitem">[docs]</a>    <span class="k">def</span> <span class="nf">test_delitem</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">od</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="n">od</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">od</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">pairs</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">pairs</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_setitem"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_setitem">[docs]</a>    <span class="k">def</span> <span class="nf">test_setitem</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)])</span>
        <span class="n">od</span><span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>           <span class="c"># existing element</span>
        <span class="n">od</span><span class="p">[</span><span class="s">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>           <span class="c"># new element</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span>
                         <span class="p">[(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_iterators"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_iterators">[docs]</a>    <span class="k">def</span> <span class="nf">test_iterators</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
        <span class="n">shuffle</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="p">),</span> <span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">pairs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">od</span><span class="p">)),</span>
                         <span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">pairs</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_popitem"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_popitem">[docs]</a>    <span class="k">def</span> <span class="nf">test_popitem</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
        <span class="n">shuffle</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">pairs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">popitem</span><span class="p">(),</span> <span class="n">pairs</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">):</span>
            <span class="n">od</span><span class="o">.</span><span class="n">popitem</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">od</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_pop"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_pop">[docs]</a>    <span class="k">def</span> <span class="nf">test_pop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
        <span class="n">shuffle</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="n">shuffle</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">pairs</span><span class="p">:</span>
            <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">pairs</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">):</span>
            <span class="n">od</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;xyz&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">od</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">12345</span><span class="p">),</span> <span class="mi">12345</span><span class="p">)</span>

        <span class="c"># make sure pop still works when __missing__ is defined</span>
        <span class="k">class</span> <span class="nc">Missing</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__missing__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">0</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">Missing</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">):</span>
            <span class="n">m</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_equality"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_equality">[docs]</a>    <span class="k">def</span> <span class="nf">test_equality</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
        <span class="n">shuffle</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="n">od1</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="n">od2</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">od1</span><span class="p">,</span> <span class="n">od2</span><span class="p">)</span>          <span class="c"># same order implies equality</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="n">pairs</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">+</span> <span class="n">pairs</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">od2</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">od1</span><span class="p">,</span> <span class="n">od2</span><span class="p">)</span>       <span class="c"># different order implies inequality</span>
        <span class="c"># comparison to regular dict is not order sensitive</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">od1</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">od2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">od2</span><span class="p">),</span> <span class="n">od1</span><span class="p">)</span>
        <span class="c"># different length implied inequality</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">od1</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">pairs</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_copying"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_copying">[docs]</a>    <span class="k">def</span> <span class="nf">test_copying</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Check that ordered dicts are copyable, deepcopyable, picklable,</span>
        <span class="c"># and have a repr/eval round-trip</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="n">update_test</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">update_test</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">od</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">dup</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="p">(</span><span class="s">&#39;od.copy()&#39;</span><span class="p">,</span> <span class="n">od</span><span class="o">.</span><span class="n">copy</span><span class="p">()),</span>
                    <span class="p">(</span><span class="s">&#39;copy.copy(od)&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">od</span><span class="p">)),</span>
                    <span class="p">(</span><span class="s">&#39;copy.deepcopy(od)&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">od</span><span class="p">)),</span>
                    <span class="p">(</span><span class="s">&#39;pickle.loads(pickle.dumps(od, 0))&#39;</span><span class="p">,</span>
                        <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="mi">0</span><span class="p">))),</span>
                    <span class="p">(</span><span class="s">&#39;pickle.loads(pickle.dumps(od, 1))&#39;</span><span class="p">,</span>
                        <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="mi">1</span><span class="p">))),</span>
                    <span class="p">(</span><span class="s">&#39;pickle.loads(pickle.dumps(od, 2))&#39;</span><span class="p">,</span>
                        <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="mi">2</span><span class="p">))),</span>
                    <span class="p">(</span><span class="s">&#39;pickle.loads(pickle.dumps(od, 3))&#39;</span><span class="p">,</span>
                        <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="mi">3</span><span class="p">))),</span>
                    <span class="p">(</span><span class="s">&#39;pickle.loads(pickle.dumps(od, -1))&#39;</span><span class="p">,</span>
                        <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))),</span>
                    <span class="p">(</span><span class="s">&#39;eval(repr(od))&#39;</span><span class="p">,</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">od</span><span class="p">))),</span>
                    <span class="p">(</span><span class="s">&#39;update_test&#39;</span><span class="p">,</span> <span class="n">update_test</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;OrderedDict(od)&#39;</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">od</span><span class="p">)),</span>
                    <span class="p">]:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">subTest</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">):</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">copy: </span><span class="si">%s</span><span class="se">\n</span><span class="s">od: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dup</span><span class="p">,</span> <span class="n">od</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">dup</span><span class="p">,</span> <span class="n">od</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dup</span><span class="p">,</span> <span class="n">od</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_yaml_linkage"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_yaml_linkage">[docs]</a>    <span class="k">def</span> <span class="nf">test_yaml_linkage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Verify that __reduce__ is setup in a way that supports PyYAML&#39;s dump() feature.</span>
        <span class="c"># In yaml, lists are native but tuples are not.</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="c"># yaml.dump(od) --&gt;</span>
        <span class="c"># &#39;!!python/object/apply:__main__.OrderedDict\n- - [a, 1]\n  - [b, 2]\n&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">all</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span><span class="o">==</span><span class="nb">list</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">od</span><span class="o">.</span><span class="n">__reduce__</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_reduce_not_too_fat"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_reduce_not_too_fat">[docs]</a>    <span class="k">def</span> <span class="nf">test_reduce_not_too_fat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># do not save instance dictionary if not needed</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">__reduce__</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">od</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNotNone</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">__reduce__</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_pickle_recursive"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_pickle_recursive">[docs]</a>    <span class="k">def</span> <span class="nf">test_pickle_recursive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">od</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span>
        <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">dup</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="n">proto</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">dup</span><span class="p">,</span> <span class="n">od</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dup</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">dup</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dup</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_repr"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_repr">[docs]</a>    <span class="k">def</span> <span class="nf">test_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">od</span><span class="p">),</span>
            <span class="s">&quot;OrderedDict([(&#39;c&#39;, 1), (&#39;b&#39;, 2), (&#39;a&#39;, 3), (&#39;d&#39;, 4), (&#39;e&#39;, 5), (&#39;f&#39;, 6)])&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">od</span><span class="p">)),</span> <span class="n">od</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">()),</span> <span class="s">&quot;OrderedDict()&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_repr_recursive"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_repr_recursive">[docs]</a>    <span class="k">def</span> <span class="nf">test_repr_recursive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># See issue #9826</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">)</span>
        <span class="n">od</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">od</span><span class="p">),</span>
            <span class="s">&quot;OrderedDict([(&#39;a&#39;, None), (&#39;b&#39;, None), (&#39;c&#39;, None), (&#39;x&#39;, ...)])&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_setdefault"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_setdefault">[docs]</a>    <span class="k">def</span> <span class="nf">test_setdefault</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
        <span class="n">shuffle</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="n">pair_order</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="c"># make sure order didn&#39;t change</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">pair_order</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
        <span class="c"># make sure &#39;x&#39; is added to the end</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

        <span class="c"># make sure setdefault still works when __missing__ is defined</span>
        <span class="k">class</span> <span class="nc">Missing</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__missing__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Missing</span><span class="p">()</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="mi">9</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_reinsert"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_reinsert">[docs]</a>    <span class="k">def</span> <span class="nf">test_reinsert</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Given insert a, insert b, delete a, re-insert a,</span>
        <span class="c"># verify that a is now later than b.</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">od</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">od</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">del</span> <span class="n">od</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span>
        <span class="n">od</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="p">[(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_move_to_end"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_move_to_end">[docs]</a>    <span class="k">def</span> <span class="nf">test_move_to_end</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="s">&#39;abcde&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="s">&#39;abcde&#39;</span><span class="p">))</span>
        <span class="n">od</span><span class="o">.</span><span class="n">move_to_end</span><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="s">&#39;abdec&#39;</span><span class="p">))</span>
        <span class="n">od</span><span class="o">.</span><span class="n">move_to_end</span><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="s">&#39;cabde&#39;</span><span class="p">))</span>
        <span class="n">od</span><span class="o">.</span><span class="n">move_to_end</span><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="s">&#39;cabde&#39;</span><span class="p">))</span>
        <span class="n">od</span><span class="o">.</span><span class="n">move_to_end</span><span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">od</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="s">&#39;cabde&#39;</span><span class="p">))</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">):</span>
            <span class="n">od</span><span class="o">.</span><span class="n">move_to_end</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_sizeof"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_sizeof">[docs]</a>    <span class="k">def</span> <span class="nf">test_sizeof</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Wimpy test: Just verify the reported size is larger than a regular dict</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="o">**</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">od</span><span class="p">),</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestOrderedDict.test_override_update"><a class="viewcode-back" href="../../test.html#test.test_collections.TestOrderedDict.test_override_update">[docs]</a>    <span class="k">def</span> <span class="nf">test_override_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Verify that subclasses can override update() without breaking __init__()</span>
        <span class="k">class</span> <span class="nc">MyOD</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">()</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">MyOD</span><span class="p">(</span><span class="n">items</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">items</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="GeneralMappingTests"><a class="viewcode-back" href="../../test.html#test.test_collections.GeneralMappingTests">[docs]</a><span class="k">class</span> <span class="nc">GeneralMappingTests</span><span class="p">(</span><span class="n">mapping_tests</span><span class="o">.</span><span class="n">BasicTestMappingProtocol</span><span class="p">):</span>
    <span class="n">type2test</span> <span class="o">=</span> <span class="n">OrderedDict</span>

<div class="viewcode-block" id="GeneralMappingTests.test_popitem"><a class="viewcode-back" href="../../test.html#test.test_collections.GeneralMappingTests.test_popitem">[docs]</a>    <span class="k">def</span> <span class="nf">test_popitem</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_empty_mapping</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">popitem</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="MyOrderedDict"><a class="viewcode-back" href="../../test.html#test.test_collections.MyOrderedDict">[docs]</a><span class="k">class</span> <span class="nc">MyOrderedDict</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">):</span>
    <span class="k">pass</span>
</div>
<div class="viewcode-block" id="SubclassMappingTests"><a class="viewcode-back" href="../../test.html#test.test_collections.SubclassMappingTests">[docs]</a><span class="k">class</span> <span class="nc">SubclassMappingTests</span><span class="p">(</span><span class="n">mapping_tests</span><span class="o">.</span><span class="n">BasicTestMappingProtocol</span><span class="p">):</span>
    <span class="n">type2test</span> <span class="o">=</span> <span class="n">MyOrderedDict</span>

<div class="viewcode-block" id="SubclassMappingTests.test_popitem"><a class="viewcode-back" href="../../test.html#test.test_collections.SubclassMappingTests.test_popitem">[docs]</a>    <span class="k">def</span> <span class="nf">test_popitem</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_empty_mapping</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">popitem</span><span class="p">)</span>


<span class="c">################################################################################</span>
<span class="c">### Run tests</span>
<span class="c">################################################################################</span>
</div></div>
<span class="kn">import</span> <span class="nn">doctest</span><span class="o">,</span> <span class="nn">collections</span>

<div class="viewcode-block" id="test_main"><a class="viewcode-back" href="../../test.html#test.test_collections.test_main">[docs]</a><span class="k">def</span> <span class="nf">test_main</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">NamedTupleDocs</span> <span class="o">=</span> <span class="n">doctest</span><span class="o">.</span><span class="n">DocTestSuite</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">collections</span><span class="p">)</span>
    <span class="n">test_classes</span> <span class="o">=</span> <span class="p">[</span><span class="n">TestNamedTuple</span><span class="p">,</span> <span class="n">NamedTupleDocs</span><span class="p">,</span> <span class="n">TestOneTrickPonyABCs</span><span class="p">,</span>
                    <span class="n">TestCollectionABCs</span><span class="p">,</span> <span class="n">TestCounter</span><span class="p">,</span> <span class="n">TestChainMap</span><span class="p">,</span>
                    <span class="n">TestOrderedDict</span><span class="p">,</span> <span class="n">GeneralMappingTests</span><span class="p">,</span> <span class="n">SubclassMappingTests</span><span class="p">]</span>
    <span class="n">support</span><span class="o">.</span><span class="n">run_unittest</span><span class="p">(</span><span class="o">*</span><span class="n">test_classes</span><span class="p">)</span>
    <span class="n">support</span><span class="o">.</span><span class="n">run_doctest</span><span class="p">(</span><span class="n">collections</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>

</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">test_main</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>