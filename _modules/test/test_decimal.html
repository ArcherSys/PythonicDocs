

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_decimal &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_decimal</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_decimal</h1><div class="highlight"><pre>
<span class="c"># Copyright (c) 2004 Python Software Foundation.</span>
<span class="c"># All rights reserved.</span>

<span class="c"># Written by Eric Price &lt;eprice at tjhsst.edu&gt;</span>
<span class="c">#    and Facundo Batista &lt;facundo at taniquetil.com.ar&gt;</span>
<span class="c">#    and Raymond Hettinger &lt;python at rcn.com&gt;</span>
<span class="c">#    and Aahz (aahz at pobox.com)</span>
<span class="c">#    and Tim Peters</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">These are the test cases for the Decimal module.</span>

<span class="sd">There are two groups of tests, Arithmetic and Behaviour. The former test</span>
<span class="sd">the Decimal arithmetic using the tests provided by Mike Cowlishaw. The latter</span>
<span class="sd">test the pythonic behaviour according to PEP 327.</span>

<span class="sd">Cowlishaw&#39;s tests can be downloaded from:</span>

<span class="sd">   http://speleotrove.com/decimal/dectest.zip</span>

<span class="sd">This test module can be called from command line with one parameter (Arithmetic</span>
<span class="sd">or Behaviour) to test each part, or without parameter to test both parts. If</span>
<span class="sd">you&#39;re working through IDLE, you can import this test module and call test_main()</span>
<span class="sd">with the corresponding argument.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">pickle</span><span class="o">,</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">numbers</span>
<span class="kn">import</span> <span class="nn">locale</span>
<span class="kn">from</span> <span class="nn">test.support</span> <span class="kn">import</span> <span class="p">(</span><span class="n">run_unittest</span><span class="p">,</span> <span class="n">run_doctest</span><span class="p">,</span> <span class="n">is_resource_enabled</span><span class="p">,</span>
                          <span class="n">requires_IEEE_754</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">test.support</span> <span class="kn">import</span> <span class="p">(</span><span class="n">check_warnings</span><span class="p">,</span> <span class="n">import_fresh_module</span><span class="p">,</span> <span class="n">TestFailed</span><span class="p">,</span>
                          <span class="n">run_with_locale</span><span class="p">,</span> <span class="n">cpython_only</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">threading</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">threading</span> <span class="o">=</span> <span class="bp">None</span>


<span class="n">C</span> <span class="o">=</span> <span class="n">import_fresh_module</span><span class="p">(</span><span class="s">&#39;decimal&#39;</span><span class="p">,</span> <span class="n">fresh</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;_decimal&#39;</span><span class="p">])</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">import_fresh_module</span><span class="p">(</span><span class="s">&#39;decimal&#39;</span><span class="p">,</span> <span class="n">blocked</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;_decimal&#39;</span><span class="p">])</span>
<span class="n">orig_sys_decimal</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span>

<span class="c"># fractions module must import the correct decimal module.</span>
<span class="n">cfractions</span> <span class="o">=</span> <span class="n">import_fresh_module</span><span class="p">(</span><span class="s">&#39;fractions&#39;</span><span class="p">,</span> <span class="n">fresh</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;fractions&#39;</span><span class="p">])</span>
<span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span>
<span class="n">pfractions</span> <span class="o">=</span> <span class="n">import_fresh_module</span><span class="p">(</span><span class="s">&#39;fractions&#39;</span><span class="p">,</span> <span class="n">fresh</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;fractions&#39;</span><span class="p">])</span>
<span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span>
<span class="n">fractions</span> <span class="o">=</span> <span class="p">{</span><span class="n">C</span><span class="p">:</span><span class="n">cfractions</span><span class="p">,</span> <span class="n">P</span><span class="p">:</span><span class="n">pfractions</span><span class="p">}</span>
<span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">orig_sys_decimal</span>


<span class="c"># Useful Test Constant</span>
<span class="n">Signals</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">C</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">if</span> <span class="n">C</span> <span class="k">else</span> <span class="bp">None</span><span class="p">,</span>
  <span class="n">P</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="p">}</span>
<span class="c"># Signals ordered with respect to precedence: when an operation</span>
<span class="c"># produces multiple signals, signals occurring later in the list</span>
<span class="c"># should be handled before those occurring earlier in the list.</span>
<span class="n">OrderedSignals</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">C</span><span class="p">:</span> <span class="p">[</span><span class="n">C</span><span class="o">.</span><span class="n">Clamped</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">Rounded</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">Inexact</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">Subnormal</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">Underflow</span><span class="p">,</span>
      <span class="n">C</span><span class="o">.</span><span class="n">Overflow</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DivisionByZero</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">InvalidOperation</span><span class="p">,</span>
      <span class="n">C</span><span class="o">.</span><span class="n">FloatOperation</span><span class="p">]</span> <span class="k">if</span> <span class="n">C</span> <span class="k">else</span> <span class="bp">None</span><span class="p">,</span>
  <span class="n">P</span><span class="p">:</span> <span class="p">[</span><span class="n">P</span><span class="o">.</span><span class="n">Clamped</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">Rounded</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">Inexact</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">Subnormal</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">Underflow</span><span class="p">,</span>
      <span class="n">P</span><span class="o">.</span><span class="n">Overflow</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">DivisionByZero</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">InvalidOperation</span><span class="p">,</span>
      <span class="n">P</span><span class="o">.</span><span class="n">FloatOperation</span><span class="p">]</span>
<span class="p">}</span>
<div class="viewcode-block" id="assert_signals"><a class="viewcode-back" href="../../test.html#test.test_decimal.assert_signals">[docs]</a><span class="k">def</span> <span class="nf">assert_signals</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
    <span class="n">cls</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">all</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">expected</span> <span class="k">else</span> <span class="ow">not</span> <span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">d</span><span class="p">))</span>
</div>
<span class="n">ROUND_UP</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_UP</span>
<span class="n">ROUND_DOWN</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_DOWN</span>
<span class="n">ROUND_CEILING</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_CEILING</span>
<span class="n">ROUND_FLOOR</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_FLOOR</span>
<span class="n">ROUND_HALF_UP</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_HALF_UP</span>
<span class="n">ROUND_HALF_DOWN</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_HALF_DOWN</span>
<span class="n">ROUND_HALF_EVEN</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_HALF_EVEN</span>
<span class="n">ROUND_05UP</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_05UP</span>

<span class="n">RoundingModes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="n">ROUND_UP</span><span class="p">,</span> <span class="n">ROUND_DOWN</span><span class="p">,</span> <span class="n">ROUND_CEILING</span><span class="p">,</span> <span class="n">ROUND_FLOOR</span><span class="p">,</span>
  <span class="n">ROUND_HALF_UP</span><span class="p">,</span> <span class="n">ROUND_HALF_DOWN</span><span class="p">,</span> <span class="n">ROUND_HALF_EVEN</span><span class="p">,</span>
  <span class="n">ROUND_05UP</span>
<span class="p">]</span>

<span class="c"># Tests are built around these assumed context defaults.</span>
<span class="c"># test_main() restores the original context.</span>
<span class="n">ORIGINAL_CONTEXT</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">C</span><span class="p">:</span> <span class="n">C</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="n">C</span> <span class="k">else</span> <span class="bp">None</span><span class="p">,</span>
  <span class="n">P</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="p">}</span>
<div class="viewcode-block" id="init"><a class="viewcode-back" href="../../test.html#test.test_decimal.init">[docs]</a><span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">m</span><span class="p">:</span> <span class="k">return</span>
    <span class="n">DefaultTestContext</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">Context</span><span class="p">(</span>
       <span class="n">prec</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_HALF_EVEN</span><span class="p">,</span> <span class="n">traps</span><span class="o">=</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">Signals</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">setcontext</span><span class="p">(</span><span class="n">DefaultTestContext</span><span class="p">)</span>
</div>
<span class="n">TESTDATADIR</span> <span class="o">=</span> <span class="s">&#39;decimaltestdata&#39;</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="n">__file__</span>
<span class="n">testdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">curdir</span>
<span class="n">directory</span> <span class="o">=</span> <span class="n">testdir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">TESTDATADIR</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span>

<span class="n">skip_expected</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>

<span class="c"># Make sure it actually raises errors when not expected and caught in flags</span>
<span class="c"># Slower, since it runs some things several times.</span>
<span class="n">EXTENDEDERRORTEST</span> <span class="o">=</span> <span class="bp">False</span>

<span class="c"># Test extra functionality in the C version (-DEXTRA_FUNCTIONALITY).</span>
<span class="n">EXTRA_FUNCTIONALITY</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="s">&#39;DecClamped&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
<span class="n">requires_extra_functionality</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">skipUnless</span><span class="p">(</span>
  <span class="n">EXTRA_FUNCTIONALITY</span><span class="p">,</span> <span class="s">&quot;test requires build with -DEXTRA_FUNCTIONALITY&quot;</span><span class="p">)</span>
<span class="n">skip_if_extra_functionality</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">skipIf</span><span class="p">(</span>
  <span class="n">EXTRA_FUNCTIONALITY</span><span class="p">,</span> <span class="s">&quot;test requires regular build&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="IBMTestCases"><a class="viewcode-back" href="../../test.html#test.test_decimal.IBMTestCases">[docs]</a><span class="k">class</span> <span class="nc">IBMTestCases</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class which tests the Decimal class against the IBM test cases.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="IBMTestCases.setUp"><a class="viewcode-back" href="../../test.html#test.test_decimal.IBMTestCases.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;#&#39;</span><span class="p">]</span>

        <span class="c"># List of individual .decTest test ids that correspond to tests that</span>
        <span class="c"># we&#39;re skipping for one reason or another.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skipped_test_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span>
            <span class="c"># Skip implementation-specific scaleb tests.</span>
            <span class="s">&#39;scbx164&#39;</span><span class="p">,</span>
            <span class="s">&#39;scbx165&#39;</span><span class="p">,</span>

            <span class="c"># For some operations (currently exp, ln, log10, power), the decNumber</span>
            <span class="c"># reference implementation imposes additional restrictions on the context</span>
            <span class="c"># and operands.  These restrictions are not part of the specification;</span>
            <span class="c"># however, the effect of these restrictions does show up in some of the</span>
            <span class="c"># testcases.  We skip testcases that violate these restrictions, since</span>
            <span class="c"># Decimal behaves differently from decNumber for these testcases so these</span>
            <span class="c"># testcases would otherwise fail.</span>
            <span class="s">&#39;expx901&#39;</span><span class="p">,</span>
            <span class="s">&#39;expx902&#39;</span><span class="p">,</span>
            <span class="s">&#39;expx903&#39;</span><span class="p">,</span>
            <span class="s">&#39;expx905&#39;</span><span class="p">,</span>
            <span class="s">&#39;lnx901&#39;</span><span class="p">,</span>
            <span class="s">&#39;lnx902&#39;</span><span class="p">,</span>
            <span class="s">&#39;lnx903&#39;</span><span class="p">,</span>
            <span class="s">&#39;lnx905&#39;</span><span class="p">,</span>
            <span class="s">&#39;logx901&#39;</span><span class="p">,</span>
            <span class="s">&#39;logx902&#39;</span><span class="p">,</span>
            <span class="s">&#39;logx903&#39;</span><span class="p">,</span>
            <span class="s">&#39;logx905&#39;</span><span class="p">,</span>
            <span class="s">&#39;powx1183&#39;</span><span class="p">,</span>
            <span class="s">&#39;powx1184&#39;</span><span class="p">,</span>
            <span class="s">&#39;powx4001&#39;</span><span class="p">,</span>
            <span class="s">&#39;powx4002&#39;</span><span class="p">,</span>
            <span class="s">&#39;powx4003&#39;</span><span class="p">,</span>
            <span class="s">&#39;powx4005&#39;</span><span class="p">,</span>
            <span class="s">&#39;powx4008&#39;</span><span class="p">,</span>
            <span class="s">&#39;powx4010&#39;</span><span class="p">,</span>
            <span class="s">&#39;powx4012&#39;</span><span class="p">,</span>
            <span class="s">&#39;powx4014&#39;</span><span class="p">,</span>
            <span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span> <span class="o">==</span> <span class="n">C</span><span class="p">:</span>
            <span class="c"># status has additional Subnormal, Underflow</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipped_test_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;pwsx803&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipped_test_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;pwsx805&#39;</span><span class="p">)</span>
            <span class="c"># Correct rounding (skipped for decNumber, too)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipped_test_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;powx4302&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipped_test_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;powx4303&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipped_test_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;powx4342&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipped_test_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;powx4343&#39;</span><span class="p">)</span>
            <span class="c"># http://bugs.python.org/issue7049</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipped_test_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;pwmx325&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipped_test_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;pwmx326&#39;</span><span class="p">)</span>

        <span class="c"># Map test directives to setter functions.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ChangeDict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;precision&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_precision</span><span class="p">,</span>
                           <span class="s">&#39;rounding&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_rounding_method</span><span class="p">,</span>
                           <span class="s">&#39;maxexponent&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_max_exponent</span><span class="p">,</span>
                           <span class="s">&#39;minexponent&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_min_exponent</span><span class="p">,</span>
                           <span class="s">&#39;clamp&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_clamp</span><span class="p">}</span>

        <span class="c"># Name adapter to be able to change the Decimal and Context</span>
        <span class="c"># interface without changing the test files from Cowlishaw.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NameAdapter</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;and&#39;</span><span class="p">:</span><span class="s">&#39;logical_and&#39;</span><span class="p">,</span>
                            <span class="s">&#39;apply&#39;</span><span class="p">:</span><span class="s">&#39;_apply&#39;</span><span class="p">,</span>
                            <span class="s">&#39;class&#39;</span><span class="p">:</span><span class="s">&#39;number_class&#39;</span><span class="p">,</span>
                            <span class="s">&#39;comparesig&#39;</span><span class="p">:</span><span class="s">&#39;compare_signal&#39;</span><span class="p">,</span>
                            <span class="s">&#39;comparetotal&#39;</span><span class="p">:</span><span class="s">&#39;compare_total&#39;</span><span class="p">,</span>
                            <span class="s">&#39;comparetotmag&#39;</span><span class="p">:</span><span class="s">&#39;compare_total_mag&#39;</span><span class="p">,</span>
                            <span class="s">&#39;copy&#39;</span><span class="p">:</span><span class="s">&#39;copy_decimal&#39;</span><span class="p">,</span>
                            <span class="s">&#39;copyabs&#39;</span><span class="p">:</span><span class="s">&#39;copy_abs&#39;</span><span class="p">,</span>
                            <span class="s">&#39;copynegate&#39;</span><span class="p">:</span><span class="s">&#39;copy_negate&#39;</span><span class="p">,</span>
                            <span class="s">&#39;copysign&#39;</span><span class="p">:</span><span class="s">&#39;copy_sign&#39;</span><span class="p">,</span>
                            <span class="s">&#39;divideint&#39;</span><span class="p">:</span><span class="s">&#39;divide_int&#39;</span><span class="p">,</span>
                            <span class="s">&#39;invert&#39;</span><span class="p">:</span><span class="s">&#39;logical_invert&#39;</span><span class="p">,</span>
                            <span class="s">&#39;iscanonical&#39;</span><span class="p">:</span><span class="s">&#39;is_canonical&#39;</span><span class="p">,</span>
                            <span class="s">&#39;isfinite&#39;</span><span class="p">:</span><span class="s">&#39;is_finite&#39;</span><span class="p">,</span>
                            <span class="s">&#39;isinfinite&#39;</span><span class="p">:</span><span class="s">&#39;is_infinite&#39;</span><span class="p">,</span>
                            <span class="s">&#39;isnan&#39;</span><span class="p">:</span><span class="s">&#39;is_nan&#39;</span><span class="p">,</span>
                            <span class="s">&#39;isnormal&#39;</span><span class="p">:</span><span class="s">&#39;is_normal&#39;</span><span class="p">,</span>
                            <span class="s">&#39;isqnan&#39;</span><span class="p">:</span><span class="s">&#39;is_qnan&#39;</span><span class="p">,</span>
                            <span class="s">&#39;issigned&#39;</span><span class="p">:</span><span class="s">&#39;is_signed&#39;</span><span class="p">,</span>
                            <span class="s">&#39;issnan&#39;</span><span class="p">:</span><span class="s">&#39;is_snan&#39;</span><span class="p">,</span>
                            <span class="s">&#39;issubnormal&#39;</span><span class="p">:</span><span class="s">&#39;is_subnormal&#39;</span><span class="p">,</span>
                            <span class="s">&#39;iszero&#39;</span><span class="p">:</span><span class="s">&#39;is_zero&#39;</span><span class="p">,</span>
                            <span class="s">&#39;maxmag&#39;</span><span class="p">:</span><span class="s">&#39;max_mag&#39;</span><span class="p">,</span>
                            <span class="s">&#39;minmag&#39;</span><span class="p">:</span><span class="s">&#39;min_mag&#39;</span><span class="p">,</span>
                            <span class="s">&#39;nextminus&#39;</span><span class="p">:</span><span class="s">&#39;next_minus&#39;</span><span class="p">,</span>
                            <span class="s">&#39;nextplus&#39;</span><span class="p">:</span><span class="s">&#39;next_plus&#39;</span><span class="p">,</span>
                            <span class="s">&#39;nexttoward&#39;</span><span class="p">:</span><span class="s">&#39;next_toward&#39;</span><span class="p">,</span>
                            <span class="s">&#39;or&#39;</span><span class="p">:</span><span class="s">&#39;logical_or&#39;</span><span class="p">,</span>
                            <span class="s">&#39;reduce&#39;</span><span class="p">:</span><span class="s">&#39;normalize&#39;</span><span class="p">,</span>
                            <span class="s">&#39;remaindernear&#39;</span><span class="p">:</span><span class="s">&#39;remainder_near&#39;</span><span class="p">,</span>
                            <span class="s">&#39;samequantum&#39;</span><span class="p">:</span><span class="s">&#39;same_quantum&#39;</span><span class="p">,</span>
                            <span class="s">&#39;squareroot&#39;</span><span class="p">:</span><span class="s">&#39;sqrt&#39;</span><span class="p">,</span>
                            <span class="s">&#39;toeng&#39;</span><span class="p">:</span><span class="s">&#39;to_eng_string&#39;</span><span class="p">,</span>
                            <span class="s">&#39;tointegral&#39;</span><span class="p">:</span><span class="s">&#39;to_integral_value&#39;</span><span class="p">,</span>
                            <span class="s">&#39;tointegralx&#39;</span><span class="p">:</span><span class="s">&#39;to_integral_exact&#39;</span><span class="p">,</span>
                            <span class="s">&#39;tosci&#39;</span><span class="p">:</span><span class="s">&#39;to_sci_string&#39;</span><span class="p">,</span>
                            <span class="s">&#39;xor&#39;</span><span class="p">:</span><span class="s">&#39;logical_xor&#39;</span><span class="p">}</span>

        <span class="c"># Map test-case names to roundings.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RoundingDict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;ceiling&#39;</span> <span class="p">:</span> <span class="n">ROUND_CEILING</span><span class="p">,</span>
                             <span class="s">&#39;down&#39;</span> <span class="p">:</span> <span class="n">ROUND_DOWN</span><span class="p">,</span>
                             <span class="s">&#39;floor&#39;</span> <span class="p">:</span> <span class="n">ROUND_FLOOR</span><span class="p">,</span>
                             <span class="s">&#39;half_down&#39;</span> <span class="p">:</span> <span class="n">ROUND_HALF_DOWN</span><span class="p">,</span>
                             <span class="s">&#39;half_even&#39;</span> <span class="p">:</span> <span class="n">ROUND_HALF_EVEN</span><span class="p">,</span>
                             <span class="s">&#39;half_up&#39;</span> <span class="p">:</span> <span class="n">ROUND_HALF_UP</span><span class="p">,</span>
                             <span class="s">&#39;up&#39;</span> <span class="p">:</span> <span class="n">ROUND_UP</span><span class="p">,</span>
                             <span class="s">&#39;05up&#39;</span> <span class="p">:</span> <span class="n">ROUND_05UP</span><span class="p">}</span>

        <span class="c"># Map the test cases&#39; error names to the actual errors.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ErrorNames</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;clamped&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Clamped</span><span class="p">,</span>
                           <span class="s">&#39;conversion_syntax&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span><span class="p">,</span>
                           <span class="s">&#39;division_by_zero&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">DivisionByZero</span><span class="p">,</span>
                           <span class="s">&#39;division_impossible&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span><span class="p">,</span>
                           <span class="s">&#39;division_undefined&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span><span class="p">,</span>
                           <span class="s">&#39;inexact&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Inexact</span><span class="p">,</span>
                           <span class="s">&#39;invalid_context&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span><span class="p">,</span>
                           <span class="s">&#39;invalid_operation&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span><span class="p">,</span>
                           <span class="s">&#39;overflow&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Overflow</span><span class="p">,</span>
                           <span class="s">&#39;rounded&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Rounded</span><span class="p">,</span>
                           <span class="s">&#39;subnormal&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Subnormal</span><span class="p">,</span>
                           <span class="s">&#39;underflow&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Underflow</span><span class="p">}</span>

        <span class="c"># The following functions return True/False rather than a</span>
        <span class="c"># Decimal instance.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LogicalFunctions</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;is_canonical&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;is_finite&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;is_infinite&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;is_nan&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;is_normal&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;is_qnan&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;is_signed&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;is_snan&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;is_subnormal&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;is_zero&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;same_quantum&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IBMTestCases.read_unlimited"><a class="viewcode-back" href="../../test.html#test.test_decimal.IBMTestCases.read_unlimited">[docs]</a>    <span class="k">def</span> <span class="nf">read_unlimited</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Work around the limitations of the 32-bit _decimal version. The</span>
<span class="sd">           guaranteed maximum values for prec, Emax etc. are 425000000,</span>
<span class="sd">           but higher values usually work, except for rare corner cases.</span>
<span class="sd">           In particular, all of the IBM tests pass with maximum values</span>
<span class="sd">           of 1070000000.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span> <span class="o">==</span> <span class="n">C</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">MAX_EMAX</span> <span class="o">==</span> <span class="mi">425000000</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">readcontext</span><span class="o">.</span><span class="n">_unsafe_setprec</span><span class="p">(</span><span class="mi">1070000000</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">readcontext</span><span class="o">.</span><span class="n">_unsafe_setemax</span><span class="p">(</span><span class="mi">1070000000</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">readcontext</span><span class="o">.</span><span class="n">_unsafe_setemin</span><span class="p">(</span><span class="o">-</span><span class="mi">1070000000</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">readcontext</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IBMTestCases.eval_file"><a class="viewcode-back" href="../../test.html#test.test_decimal.IBMTestCases.eval_file">[docs]</a>    <span class="k">def</span> <span class="nf">eval_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">file</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">skip_expected</span>
        <span class="k">if</span> <span class="n">skip_expected</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">unittest</span><span class="o">.</span><span class="n">SkipTest</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
                <span class="c">#print line</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">DecimalException</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
                    <span class="c">#Exception raised where there shouldn&#39;t have been one.</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&#39;Exception &quot;&#39;</span><span class="o">+</span><span class="n">exception</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span> <span class="o">+</span> <span class="s">&#39;&quot; raised on line &#39;</span><span class="o">+</span><span class="n">line</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="IBMTestCases.eval_line"><a class="viewcode-back" href="../../test.html#test.test_decimal.IBMTestCases.eval_line">[docs]</a>    <span class="k">def</span> <span class="nf">eval_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39; -&gt; &#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;--&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;  --&#39;</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;-&gt;&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;-&gt;&#39;</span> <span class="o">+</span>
                 <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;-&gt;&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;--&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;--&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">ignore</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">ignore</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c">#print s.split()[0], &#39;NotImplemented--&#39;, ignore</span>
                <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="s">&#39;:&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval_directive</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval_equation</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IBMTestCases.eval_directive"><a class="viewcode-back" href="../../test.html#test.test_decimal.IBMTestCases.eval_directive">[docs]</a>    <span class="k">def</span> <span class="nf">eval_directive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="n">funct</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">funct</span> <span class="o">==</span> <span class="s">&#39;rounding&#39;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RoundingDict</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="n">funct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ChangeDict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">funct</span><span class="p">,</span> <span class="p">(</span><span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="bp">None</span><span class="p">))</span>
        <span class="n">funct</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IBMTestCases.eval_equation"><a class="viewcode-back" href="../../test.html#test.test_decimal.IBMTestCases.eval_equation">[docs]</a>    <span class="k">def</span> <span class="nf">eval_equation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">TEST_ALL</span> <span class="ow">and</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.90</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">Sides</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;-&gt;&#39;</span><span class="p">)</span>
            <span class="n">L</span> <span class="o">=</span> <span class="n">Sides</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;Test &quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">&quot; &quot;</span><span class="p">)</span>
            <span class="n">funct</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">valstemp</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
            <span class="n">L</span> <span class="o">=</span> <span class="n">Sides</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">exceptions</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="k">def</span> <span class="nf">FixQuotes</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;&#39;&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;SingleQuote&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;&quot;&quot;&#39;</span><span class="p">,</span> <span class="s">&#39;DoubleQuote&#39;</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;SingleQuote&#39;</span><span class="p">,</span> <span class="s">&quot;&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;DoubleQuote&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">val</span>

        <span class="k">if</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skipped_test_ids</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">fname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NameAdapter</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">funct</span><span class="p">,</span> <span class="n">funct</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fname</span> <span class="o">==</span> <span class="s">&#39;rescale&#39;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">funct</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">conglomerate</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="n">quote</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">theirexceptions</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ErrorNames</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">exceptions</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">exception</span> <span class="ow">in</span> <span class="n">Signals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">exception</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">#Catch these bugs...</span>
        <span class="k">for</span> <span class="n">exception</span> <span class="ow">in</span> <span class="n">theirexceptions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">exception</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">valstemp</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">quote</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">quote</span>
            <span class="k">if</span> <span class="n">quote</span><span class="p">:</span>
                <span class="n">conglomerate</span> <span class="o">=</span> <span class="n">conglomerate</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="n">val</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">conglomerate</span> <span class="o">+</span> <span class="n">val</span>
                <span class="n">conglomerate</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">FixQuotes</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fname</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;to_sci_string&#39;</span><span class="p">,</span> <span class="s">&#39;to_eng_string&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">EXTENDEDERRORTEST</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">theirexceptions</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">error</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">funct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
                        <span class="k">except</span> <span class="n">error</span><span class="p">:</span>
                            <span class="k">pass</span>
                        <span class="k">except</span> <span class="n">Signals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="p">]</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Raised </span><span class="si">%s</span><span class="s"> in </span><span class="si">%s</span><span class="s"> when </span><span class="si">%s</span><span class="s"> disabled&quot;</span> <span class="o">%</span> \
                                      <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">error</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Did not raise </span><span class="si">%s</span><span class="s"> in </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">error</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_unlimited</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
            <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="n">FixQuotes</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">EXTENDEDERRORTEST</span> <span class="ow">and</span> <span class="n">fname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;to_sci_string&#39;</span><span class="p">,</span> <span class="s">&#39;to_eng_string&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">theirexceptions</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">error</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">funct</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">error</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">except</span> <span class="n">Signals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="p">]</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Raised </span><span class="si">%s</span><span class="s"> in </span><span class="si">%s</span><span class="s"> when </span><span class="si">%s</span><span class="s"> disabled&quot;</span> <span class="o">%</span> \
                              <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">error</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Did not raise </span><span class="si">%s</span><span class="s"> in </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">error</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c"># as above, but add traps cumulatively, to check precedence</span>
            <span class="n">ordered_errors</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">OrderedSignals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="p">]</span> <span class="k">if</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">theirexceptions</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">ordered_errors</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">error</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">funct</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">error</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">except</span> <span class="n">Signals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="p">]</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Raised </span><span class="si">%s</span><span class="s"> in </span><span class="si">%s</span><span class="s">; expected </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                              <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">s</span><span class="p">,</span> <span class="n">error</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Did not raise </span><span class="si">%s</span><span class="s"> in </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
            <span class="c"># reset traps</span>
            <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">ordered_errors</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">error</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>


        <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;--&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">funct</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">fname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LogicalFunctions</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span> <span class="c"># &#39;True&#39;, &#39;False&#39; -&gt; &#39;1&#39;, &#39;0&#39;</span>
        <span class="k">except</span> <span class="n">Signals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="p">]</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Raised </span><span class="si">%s</span><span class="s"> in </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span> <span class="c">#Catch any error long enough to state the test case.</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;ERROR:&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
            <span class="k">raise</span>

        <span class="n">myexceptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getexceptions</span><span class="p">()</span>

        <span class="n">myexceptions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="nb">repr</span><span class="p">)</span>
        <span class="n">theirexceptions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="nb">repr</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">ans</span><span class="p">,</span>
                         <span class="s">&#39;Incorrect answer for &#39;</span> <span class="o">+</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39; -- got &#39;</span> <span class="o">+</span> <span class="n">result</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">myexceptions</span><span class="p">,</span> <span class="n">theirexceptions</span><span class="p">,</span>
              <span class="s">&#39;Incorrect flags set in &#39;</span> <span class="o">+</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39; -- got &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">myexceptions</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="IBMTestCases.getexceptions"><a class="viewcode-back" href="../../test.html#test.test_decimal.IBMTestCases.getexceptions">[docs]</a>    <span class="k">def</span> <span class="nf">getexceptions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">Signals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">e</span><span class="p">]]</span>
</div>
<div class="viewcode-block" id="IBMTestCases.change_precision"><a class="viewcode-back" href="../../test.html#test.test_decimal.IBMTestCases.change_precision">[docs]</a>    <span class="k">def</span> <span class="nf">change_precision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span> <span class="o">==</span> <span class="n">C</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">MAX_PREC</span> <span class="o">==</span> <span class="mi">425000000</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">_unsafe_setprec</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">prec</span></div>
<div class="viewcode-block" id="IBMTestCases.change_rounding_method"><a class="viewcode-back" href="../../test.html#test.test_decimal.IBMTestCases.change_rounding_method">[docs]</a>    <span class="k">def</span> <span class="nf">change_rounding_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rounding</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">rounding</span></div>
<div class="viewcode-block" id="IBMTestCases.change_min_exponent"><a class="viewcode-back" href="../../test.html#test.test_decimal.IBMTestCases.change_min_exponent">[docs]</a>    <span class="k">def</span> <span class="nf">change_min_exponent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exp</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span> <span class="o">==</span> <span class="n">C</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">MAX_PREC</span> <span class="o">==</span> <span class="mi">425000000</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">_unsafe_setemin</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="n">exp</span></div>
<div class="viewcode-block" id="IBMTestCases.change_max_exponent"><a class="viewcode-back" href="../../test.html#test.test_decimal.IBMTestCases.change_max_exponent">[docs]</a>    <span class="k">def</span> <span class="nf">change_max_exponent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exp</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span> <span class="o">==</span> <span class="n">C</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">MAX_PREC</span> <span class="o">==</span> <span class="mi">425000000</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">_unsafe_setemax</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="n">exp</span></div>
<div class="viewcode-block" id="IBMTestCases.change_clamp"><a class="viewcode-back" href="../../test.html#test.test_decimal.IBMTestCases.change_clamp">[docs]</a>    <span class="k">def</span> <span class="nf">change_clamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clamp</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">clamp</span> <span class="o">=</span> <span class="n">clamp</span>
</div></div>
<div class="viewcode-block" id="CIBMTestCases"><a class="viewcode-back" href="../../test.html#test.test_decimal.CIBMTestCases">[docs]</a><span class="k">class</span> <span class="nc">CIBMTestCases</span><span class="p">(</span><span class="n">IBMTestCases</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">C</span></div>
<div class="viewcode-block" id="PyIBMTestCases"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyIBMTestCases">[docs]</a><span class="k">class</span> <span class="nc">PyIBMTestCases</span><span class="p">(</span><span class="n">IBMTestCases</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">P</span>

<span class="c"># The following classes test the behaviour of Decimal according to PEP 327</span>
</div>
<div class="viewcode-block" id="ExplicitConstructionTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.ExplicitConstructionTest">[docs]</a><span class="k">class</span> <span class="nc">ExplicitConstructionTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Unit tests for Explicit Construction cases of Decimal.&#39;&#39;&#39;</span>

<div class="viewcode-block" id="ExplicitConstructionTest.test_explicit_empty"><a class="viewcode-back" href="../../test.html#test.test_decimal.ExplicitConstructionTest.test_explicit_empty">[docs]</a>    <span class="k">def</span> <span class="nf">test_explicit_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ExplicitConstructionTest.test_explicit_from_None"><a class="viewcode-back" href="../../test.html#test.test_decimal.ExplicitConstructionTest.test_explicit_from_None">[docs]</a>    <span class="k">def</span> <span class="nf">test_explicit_from_None</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ExplicitConstructionTest.test_explicit_from_int"><a class="viewcode-back" href="../../test.html#test.test_decimal.ExplicitConstructionTest.test_explicit_from_int">[docs]</a>    <span class="k">def</span> <span class="nf">test_explicit_from_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="c">#positive</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;45&#39;</span><span class="p">)</span>

        <span class="c">#very large positive</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">500000123</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;500000123&#39;</span><span class="p">)</span>

        <span class="c">#negative</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;-45&#39;</span><span class="p">)</span>

        <span class="c">#zero</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;0&#39;</span><span class="p">)</span>

        <span class="c"># single word longs</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">sign</span> <span class="ow">in</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="n">sign</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">n</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ExplicitConstructionTest.test_explicit_from_string"><a class="viewcode-back" href="../../test.html#test.test_decimal.ExplicitConstructionTest.test_explicit_from_string">[docs]</a>    <span class="k">def</span> <span class="nf">test_explicit_from_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="c">#empty</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)),</span> <span class="s">&#39;NaN&#39;</span><span class="p">)</span>

        <span class="c">#int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;45&#39;</span><span class="p">)),</span> <span class="s">&#39;45&#39;</span><span class="p">)</span>

        <span class="c">#float</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;45.34&#39;</span><span class="p">)),</span> <span class="s">&#39;45.34&#39;</span><span class="p">)</span>

        <span class="c">#engineer notation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;45e2&#39;</span><span class="p">)),</span> <span class="s">&#39;4.5E+3&#39;</span><span class="p">)</span>

        <span class="c">#just not a number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;ugly&#39;</span><span class="p">)),</span> <span class="s">&#39;NaN&#39;</span><span class="p">)</span>

        <span class="c">#leading and trailing whitespace permitted</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.3E4 </span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)),</span> <span class="s">&#39;1.3E+4&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;  -7.89&#39;</span><span class="p">)),</span> <span class="s">&#39;-7.89&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;  3.45679  &quot;</span><span class="p">)),</span> <span class="s">&#39;3.45679&#39;</span><span class="p">)</span>

        <span class="c"># unicode whitespace</span>
        <span class="k">for</span> <span class="n">lead</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\u00a0</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\u205f</span><span class="s">&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">trail</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\u00a0</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\u205f</span><span class="s">&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">lead</span> <span class="o">+</span> <span class="s">&#39;9.311E+28&#39;</span> <span class="o">+</span> <span class="n">trail</span><span class="p">)),</span>
                                 <span class="s">&#39;9.311E+28&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="c"># Invalid string</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="s">&quot;xyz&quot;</span><span class="p">)</span>
            <span class="c"># Two arguments max</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="s">&quot;1234&quot;</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">)</span>

            <span class="c"># space within the numeric part</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="s">&quot;1</span><span class="se">\u00a0</span><span class="s">2</span><span class="se">\u00a0</span><span class="s">3&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\u00a0</span><span class="s">1</span><span class="se">\u00a0</span><span class="s">2</span><span class="se">\u00a0</span><span class="s">&quot;</span><span class="p">)</span>

            <span class="c"># unicode whitespace</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\u00a0</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\u00a0\u00a0</span><span class="s">&quot;</span><span class="p">)</span>

            <span class="c"># embedded NUL</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="s">&quot;12</span><span class="se">\u0000</span><span class="s">3&quot;</span><span class="p">)</span>
</div>
    <span class="nd">@cpython_only</span>
<div class="viewcode-block" id="ExplicitConstructionTest.test_from_legacy_strings"><a class="viewcode-back" href="../../test.html#test.test_decimal.ExplicitConstructionTest.test_from_legacy_strings">[docs]</a>    <span class="k">def</span> <span class="nf">test_from_legacy_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">_testcapi</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span><span class="p">()</span>

        <span class="n">s</span> <span class="o">=</span> <span class="n">_testcapi</span><span class="o">.</span><span class="n">unicode_legacy_string</span><span class="p">(</span><span class="s">&#39;9.999999&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="s">&#39;9.999999&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="s">&#39;9.999999&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ExplicitConstructionTest.test_explicit_from_tuples"><a class="viewcode-back" href="../../test.html#test.test_decimal.ExplicitConstructionTest.test_explicit_from_tuples">[docs]</a>    <span class="k">def</span> <span class="nf">test_explicit_from_tuples</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="c">#zero</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;0&#39;</span><span class="p">)</span>

        <span class="c">#int</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;-45&#39;</span><span class="p">)</span>

        <span class="c">#float</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;45.34&#39;</span><span class="p">)</span>

        <span class="c">#weird</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">25</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;-4.34913534E-17&#39;</span><span class="p">)</span>

        <span class="c">#inf</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(),</span> <span class="s">&quot;F&quot;</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;Infinity&#39;</span><span class="p">)</span>

        <span class="c">#wrong number of items</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">)</span>

        <span class="c">#bad sign</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>

        <span class="c">#bad exp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s">&#39;wrong!&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mf">0.</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s">&#39;1&#39;</span><span class="p">)</span> <span class="p">)</span>

        <span class="c">#bad coefficients</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;xyz&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="ExplicitConstructionTest.test_explicit_from_list"><a class="viewcode-back" href="../../test.html#test.test_decimal.ExplicitConstructionTest.test_explicit_from_list">[docs]</a>    <span class="k">def</span> <span class="nf">test_explicit_from_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;0&#39;</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="o">-</span><span class="mi">25</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;-4.34913534E-17&#39;</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">25</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;-4.34913534E-17&#39;</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="o">-</span><span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;-4.34913534E-17&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ExplicitConstructionTest.test_explicit_from_bool"><a class="viewcode-back" href="../../test.html#test.test_decimal.ExplicitConstructionTest.test_explicit_from_bool">[docs]</a>    <span class="k">def</span> <span class="nf">test_explicit_from_bool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="bp">False</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="bp">True</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ExplicitConstructionTest.test_explicit_from_Decimal"><a class="viewcode-back" href="../../test.html#test.test_decimal.ExplicitConstructionTest.test_explicit_from_Decimal">[docs]</a>    <span class="k">def</span> <span class="nf">test_explicit_from_Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="c">#positive</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s">&#39;45&#39;</span><span class="p">)</span>

        <span class="c">#very large positive</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">500000123</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s">&#39;500000123&#39;</span><span class="p">)</span>

        <span class="c">#negative</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s">&#39;-45&#39;</span><span class="p">)</span>

        <span class="c">#zero</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s">&#39;0&#39;</span><span class="p">)</span>
</div>
    <span class="nd">@requires_IEEE_754</span>
<div class="viewcode-block" id="ExplicitConstructionTest.test_explicit_from_float"><a class="viewcode-back" href="../../test.html#test.test_decimal.ExplicitConstructionTest.test_explicit_from_float">[docs]</a>    <span class="k">def</span> <span class="nf">test_explicit_from_float</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">r</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">),</span>
                <span class="s">&#39;0.1000000000000000055511151231257827021181583404541015625&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">is_qnan</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;inf&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">))),</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;NaN&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;inf&#39;</span><span class="p">))),</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;Infinity&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">))),</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-Infinity&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-0.0&#39;</span><span class="p">))),</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-0&#39;</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">expovariate</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span> <span class="c"># roundtrip</span>
</div>
<div class="viewcode-block" id="ExplicitConstructionTest.test_explicit_context_create_decimal"><a class="viewcode-back" href="../../test.html#test.test_decimal.ExplicitConstructionTest.test_explicit_context_create_decimal">[docs]</a>    <span class="k">def</span> <span class="nf">test_explicit_context_create_decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">Rounded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Rounded</span>

        <span class="n">nc</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span><span class="p">())</span>
        <span class="n">nc</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">3</span>

        <span class="c"># empty</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;0&#39;</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;0&#39;</span><span class="p">)</span>

        <span class="c"># from None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="c"># from int</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="mi">456</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="mi">45678</span><span class="p">),</span>
                         <span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="s">&#39;457E+2&#39;</span><span class="p">))</span>

        <span class="c"># from string</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;456789&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;456789&#39;</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="s">&#39;456789&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;4.57E+5&#39;</span><span class="p">)</span>
        <span class="c"># leading and trailing whitespace should result in a NaN;</span>
        <span class="c"># spaces are already checked in Cowlishaw&#39;s test-suite, so</span>
        <span class="c"># here we just check that a trailing newline results in a NaN</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="s">&#39;3.14</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)),</span> <span class="s">&#39;NaN&#39;</span><span class="p">)</span>

        <span class="c"># from tuples</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">25</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;-4.34913534E-17&#39;</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">25</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;-4.35E-17&#39;</span><span class="p">)</span>

        <span class="c"># from Decimal</span>
        <span class="n">prevdec</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">500000123</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">prevdec</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;500000123&#39;</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="n">prevdec</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;5.00E+8&#39;</span><span class="p">)</span>

        <span class="c"># more integers</span>
        <span class="n">nc</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">28</span>
        <span class="n">nc</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">**</span><span class="mi">63</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">**</span><span class="mi">63</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">**</span><span class="mi">31</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">**</span><span class="mi">31</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                   <span class="mi">2</span><span class="o">**</span><span class="mi">31</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">31</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">63</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">63</span><span class="p">]:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span>

        <span class="n">nc</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">nc</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">Rounded</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Rounded</span><span class="p">,</span> <span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">,</span> <span class="mi">1234</span><span class="p">)</span>

        <span class="c"># from string</span>
        <span class="n">nc</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">28</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="s">&#39;0E-017&#39;</span><span class="p">)),</span> <span class="s">&#39;0E-17&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="s">&#39;45&#39;</span><span class="p">)),</span> <span class="s">&#39;45&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="s">&#39;-Inf&#39;</span><span class="p">)),</span> <span class="s">&#39;-Infinity&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="s">&#39;NaN123&#39;</span><span class="p">)),</span> <span class="s">&#39;NaN123&#39;</span><span class="p">)</span>

        <span class="c"># invalid arguments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">,</span> <span class="s">&quot;xyz&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;xyz&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">,</span> <span class="s">&quot;1234&quot;</span><span class="p">,</span> <span class="s">&quot;5678&quot;</span><span class="p">)</span>

        <span class="c"># too many NaN payload digits</span>
        <span class="n">nc</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">,</span> <span class="s">&#39;NaN12345&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">,</span>
                          <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;NaN12345&#39;</span><span class="p">))</span>

        <span class="n">nc</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="s">&#39;NaN12345&#39;</span><span class="p">)),</span> <span class="s">&#39;NaN&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

        <span class="n">nc</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;NaN12345&#39;</span><span class="p">))),</span> <span class="s">&#39;NaN&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="ExplicitConstructionTest.test_explicit_context_create_from_float"><a class="viewcode-back" href="../../test.html#test.test_decimal.ExplicitConstructionTest.test_explicit_context_create_from_float">[docs]</a>    <span class="k">def</span> <span class="nf">test_explicit_context_create_from_float</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span><span class="p">()</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="s">&#39;0.1000000000000000055511151231&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">is_qnan</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;inf&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">))),</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="s">&#39;NaN&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;inf&#39;</span><span class="p">))),</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="s">&#39;Infinity&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">))),</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="s">&#39;-Infinity&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-0.0&#39;</span><span class="p">))),</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="s">&#39;-0&#39;</span><span class="p">)))</span>
        <span class="n">nc</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">expovariate</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span> <span class="c"># roundtrip</span>
</div>
<div class="viewcode-block" id="ExplicitConstructionTest.test_unicode_digits"><a class="viewcode-back" href="../../test.html#test.test_decimal.ExplicitConstructionTest.test_unicode_digits">[docs]</a>    <span class="k">def</span> <span class="nf">test_unicode_digits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">test_values</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;</span><span class="se">\uff11</span><span class="s">&#39;</span><span class="p">:</span> <span class="s">&#39;1&#39;</span><span class="p">,</span>
            <span class="s">&#39;</span><span class="se">\u0660</span><span class="s">.</span><span class="se">\u0660\u0663\u0667\u0662</span><span class="s">e-</span><span class="se">\u0663</span><span class="s">&#39;</span> <span class="p">:</span> <span class="s">&#39;0.0000372&#39;</span><span class="p">,</span>
            <span class="s">&#39;-nan</span><span class="se">\u0c68\u0c6a\u0c66\u0c66</span><span class="s">&#39;</span> <span class="p">:</span> <span class="s">&#39;-NaN2400&#39;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="k">for</span> <span class="nb">input</span><span class="p">,</span> <span class="n">expected</span> <span class="ow">in</span> <span class="n">test_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">input</span><span class="p">)),</span> <span class="n">expected</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="CExplicitConstructionTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.CExplicitConstructionTest">[docs]</a><span class="k">class</span> <span class="nc">CExplicitConstructionTest</span><span class="p">(</span><span class="n">ExplicitConstructionTest</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">C</span></div>
<div class="viewcode-block" id="PyExplicitConstructionTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyExplicitConstructionTest">[docs]</a><span class="k">class</span> <span class="nc">PyExplicitConstructionTest</span><span class="p">(</span><span class="n">ExplicitConstructionTest</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">P</span>
</div>
<div class="viewcode-block" id="ImplicitConstructionTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.ImplicitConstructionTest">[docs]</a><span class="k">class</span> <span class="nc">ImplicitConstructionTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Unit tests for Implicit Construction cases of Decimal.&#39;&#39;&#39;</span>

<div class="viewcode-block" id="ImplicitConstructionTest.test_implicit_from_None"><a class="viewcode-back" href="../../test.html#test.test_decimal.ImplicitConstructionTest.test_implicit_from_None">[docs]</a>    <span class="k">def</span> <span class="nf">test_implicit_from_None</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">eval</span><span class="p">,</span> <span class="s">&#39;Decimal(5) + None&#39;</span><span class="p">,</span> <span class="nb">locals</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="ImplicitConstructionTest.test_implicit_from_int"><a class="viewcode-back" href="../../test.html#test.test_decimal.ImplicitConstructionTest.test_implicit_from_int">[docs]</a>    <span class="k">def</span> <span class="nf">test_implicit_from_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="c">#normal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">45</span><span class="p">),</span> <span class="s">&#39;50&#39;</span><span class="p">)</span>
        <span class="c">#exceeding precision</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">123456789000</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">123456789000</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ImplicitConstructionTest.test_implicit_from_string"><a class="viewcode-back" href="../../test.html#test.test_decimal.ImplicitConstructionTest.test_implicit_from_string">[docs]</a>    <span class="k">def</span> <span class="nf">test_implicit_from_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">eval</span><span class="p">,</span> <span class="s">&#39;Decimal(5) + &quot;3&quot;&#39;</span><span class="p">,</span> <span class="nb">locals</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="ImplicitConstructionTest.test_implicit_from_float"><a class="viewcode-back" href="../../test.html#test.test_decimal.ImplicitConstructionTest.test_implicit_from_float">[docs]</a>    <span class="k">def</span> <span class="nf">test_implicit_from_float</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">eval</span><span class="p">,</span> <span class="s">&#39;Decimal(5) + 2.2&#39;</span><span class="p">,</span> <span class="nb">locals</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="ImplicitConstructionTest.test_implicit_from_Decimal"><a class="viewcode-back" href="../../test.html#test.test_decimal.ImplicitConstructionTest.test_implicit_from_Decimal">[docs]</a>    <span class="k">def</span> <span class="nf">test_implicit_from_Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ImplicitConstructionTest.test_rop"><a class="viewcode-back" href="../../test.html#test.test_decimal.ImplicitConstructionTest.test_rop">[docs]</a>    <span class="k">def</span> <span class="nf">test_rop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="c"># Allow other classes to be trained to interact with Decimals</span>
        <span class="k">class</span> <span class="nc">E</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__divmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&#39;divmod &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__rdivmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; rdivmod&#39;</span>
            <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&#39;lt &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&#39;gt &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&#39;le &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&#39;ge &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&#39;eq &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&#39;ne &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">divmod</span><span class="p">(</span><span class="n">E</span><span class="p">(),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span> <span class="s">&#39;divmod 10&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">divmod</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">E</span><span class="p">()),</span> <span class="s">&#39;10 rdivmod&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s">&#39;Decimal(10) &lt; E()&#39;</span><span class="p">),</span> <span class="s">&#39;gt 10&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s">&#39;Decimal(10) &gt; E()&#39;</span><span class="p">),</span> <span class="s">&#39;lt 10&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s">&#39;Decimal(10) &lt;= E()&#39;</span><span class="p">),</span> <span class="s">&#39;ge 10&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s">&#39;Decimal(10) &gt;= E()&#39;</span><span class="p">),</span> <span class="s">&#39;le 10&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s">&#39;Decimal(10) == E()&#39;</span><span class="p">),</span> <span class="s">&#39;eq 10&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s">&#39;Decimal(10) != E()&#39;</span><span class="p">),</span> <span class="s">&#39;ne 10&#39;</span><span class="p">)</span>

        <span class="c"># insert operator methods and then exercise them</span>
        <span class="n">oplist</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;+&#39;</span><span class="p">,</span> <span class="s">&#39;__add__&#39;</span><span class="p">,</span> <span class="s">&#39;__radd__&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">,</span> <span class="s">&#39;__sub__&#39;</span><span class="p">,</span> <span class="s">&#39;__rsub__&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;*&#39;</span><span class="p">,</span> <span class="s">&#39;__mul__&#39;</span><span class="p">,</span> <span class="s">&#39;__rmul__&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="s">&#39;__truediv__&#39;</span><span class="p">,</span> <span class="s">&#39;__rtruediv__&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;%&#39;</span><span class="p">,</span> <span class="s">&#39;__mod__&#39;</span><span class="p">,</span> <span class="s">&#39;__rmod__&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;//&#39;</span><span class="p">,</span> <span class="s">&#39;__floordiv__&#39;</span><span class="p">,</span> <span class="s">&#39;__rfloordiv__&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;**&#39;</span><span class="p">,</span> <span class="s">&#39;__pow__&#39;</span><span class="p">,</span> <span class="s">&#39;__rpow__&#39;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">sym</span><span class="p">,</span> <span class="n">lop</span><span class="p">,</span> <span class="n">rop</span> <span class="ow">in</span> <span class="n">oplist</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">lop</span><span class="p">,</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s">&#39;str&#39;</span> <span class="o">+</span> <span class="n">lop</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">rop</span><span class="p">,</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">+</span> <span class="n">rop</span> <span class="o">+</span> <span class="s">&#39;str&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s">&#39;E()&#39;</span> <span class="o">+</span> <span class="n">sym</span> <span class="o">+</span> <span class="s">&#39;Decimal(10)&#39;</span><span class="p">),</span>
                             <span class="s">&#39;str&#39;</span> <span class="o">+</span> <span class="n">lop</span> <span class="o">+</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s">&#39;Decimal(10)&#39;</span> <span class="o">+</span> <span class="n">sym</span> <span class="o">+</span> <span class="s">&#39;E()&#39;</span><span class="p">),</span>
                             <span class="s">&#39;10&#39;</span> <span class="o">+</span> <span class="n">rop</span> <span class="o">+</span> <span class="s">&#39;str&#39;</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="CImplicitConstructionTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.CImplicitConstructionTest">[docs]</a><span class="k">class</span> <span class="nc">CImplicitConstructionTest</span><span class="p">(</span><span class="n">ImplicitConstructionTest</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">C</span></div>
<div class="viewcode-block" id="PyImplicitConstructionTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyImplicitConstructionTest">[docs]</a><span class="k">class</span> <span class="nc">PyImplicitConstructionTest</span><span class="p">(</span><span class="n">ImplicitConstructionTest</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">P</span>
</div>
<div class="viewcode-block" id="FormatTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.FormatTest">[docs]</a><span class="k">class</span> <span class="nc">FormatTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Unit tests for the format function.&#39;&#39;&#39;</span>
<div class="viewcode-block" id="FormatTest.test_formatting"><a class="viewcode-back" href="../../test.html#test.test_decimal.FormatTest.test_formatting">[docs]</a>    <span class="k">def</span> <span class="nf">test_formatting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="c"># triples giving a format, a Decimal, and the expected result</span>
        <span class="n">test_values</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;0E-15&#39;</span><span class="p">,</span> <span class="s">&#39;0e-15&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;2.3E-15&#39;</span><span class="p">,</span> <span class="s">&#39;2.3e-15&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;2.30E+2&#39;</span><span class="p">,</span> <span class="s">&#39;2.30e+2&#39;</span><span class="p">),</span> <span class="c"># preserve significant zeros</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;2.30000E-15&#39;</span><span class="p">,</span> <span class="s">&#39;2.30000e-15&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;1.23456789123456789e40&#39;</span><span class="p">,</span> <span class="s">&#39;1.23456789123456789e+40&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;1.5&#39;</span><span class="p">,</span> <span class="s">&#39;1.5e+0&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;0.15&#39;</span><span class="p">,</span> <span class="s">&#39;1.5e-1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;0.015&#39;</span><span class="p">,</span> <span class="s">&#39;1.5e-2&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;0.0000000000015&#39;</span><span class="p">,</span> <span class="s">&#39;1.5e-12&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;15.0&#39;</span><span class="p">,</span> <span class="s">&#39;1.50e+1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;-15&#39;</span><span class="p">,</span> <span class="s">&#39;-1.5e+1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">,</span> <span class="s">&#39;0e+0&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;0E1&#39;</span><span class="p">,</span> <span class="s">&#39;0e+1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;0.0&#39;</span><span class="p">,</span> <span class="s">&#39;0e-1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;0.00&#39;</span><span class="p">,</span> <span class="s">&#39;0e-2&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.6e&#39;</span><span class="p">,</span> <span class="s">&#39;0E-15&#39;</span><span class="p">,</span> <span class="s">&#39;0.000000e-9&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.6e&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">,</span> <span class="s">&#39;0.000000e+6&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.6e&#39;</span><span class="p">,</span> <span class="s">&#39;9.999999&#39;</span><span class="p">,</span> <span class="s">&#39;9.999999e+0&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.6e&#39;</span><span class="p">,</span> <span class="s">&#39;9.9999999&#39;</span><span class="p">,</span> <span class="s">&#39;1.000000e+1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.6e&#39;</span><span class="p">,</span> <span class="s">&#39;-1.23e5&#39;</span><span class="p">,</span> <span class="s">&#39;-1.230000e+5&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.6e&#39;</span><span class="p">,</span> <span class="s">&#39;1.23456789e-3&#39;</span><span class="p">,</span> <span class="s">&#39;1.234568e-3&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;0.0&#39;</span><span class="p">,</span> <span class="s">&#39;0.0&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;0E-2&#39;</span><span class="p">,</span> <span class="s">&#39;0.00&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;0.00E-8&#39;</span><span class="p">,</span> <span class="s">&#39;0.0000000000&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;0E1&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">),</span> <span class="c"># loses exponent information</span>
            <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;3.2E1&#39;</span><span class="p">,</span> <span class="s">&#39;32&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;3.2E2&#39;</span><span class="p">,</span> <span class="s">&#39;320&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;3.20E2&#39;</span><span class="p">,</span> <span class="s">&#39;320&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;3.200E2&#39;</span><span class="p">,</span> <span class="s">&#39;320.0&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;3.2E-6&#39;</span><span class="p">,</span> <span class="s">&#39;0.0000032&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.6f&#39;</span><span class="p">,</span> <span class="s">&#39;0E-15&#39;</span><span class="p">,</span> <span class="s">&#39;0.000000&#39;</span><span class="p">),</span> <span class="c"># all zeros treated equally</span>
            <span class="p">(</span><span class="s">&#39;.6f&#39;</span><span class="p">,</span> <span class="s">&#39;0E1&#39;</span><span class="p">,</span> <span class="s">&#39;0.000000&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.6f&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">,</span> <span class="s">&#39;0.000000&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.0f&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">),</span> <span class="c"># no decimal point</span>
            <span class="p">(</span><span class="s">&#39;.0f&#39;</span><span class="p">,</span> <span class="s">&#39;0e-2&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.0f&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.1f&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3.1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.4f&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3.1416&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.6f&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3.141593&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.7f&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3.1415926&#39;</span><span class="p">),</span> <span class="c"># round-half-even!</span>
            <span class="p">(</span><span class="s">&#39;.8f&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.9f&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3.141592650&#39;</span><span class="p">),</span>

            <span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="s">&#39;0.0&#39;</span><span class="p">,</span> <span class="s">&#39;0.0&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="s">&#39;0E1&#39;</span><span class="p">,</span> <span class="s">&#39;0e+1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;G&#39;</span><span class="p">,</span> <span class="s">&#39;0E1&#39;</span><span class="p">,</span> <span class="s">&#39;0E+1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="s">&#39;0E-5&#39;</span><span class="p">,</span> <span class="s">&#39;0.00000&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="s">&#39;0E-6&#39;</span><span class="p">,</span> <span class="s">&#39;0.000000&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="s">&#39;0E-7&#39;</span><span class="p">,</span> <span class="s">&#39;0e-7&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="s">&#39;-0E2&#39;</span><span class="p">,</span> <span class="s">&#39;-0e+2&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.0g&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">),</span>  <span class="c"># 0 sig fig -&gt; 1 sig fig</span>
            <span class="p">(</span><span class="s">&#39;.0n&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">),</span>  <span class="c"># same for &#39;n&#39;</span>
            <span class="p">(</span><span class="s">&#39;.1g&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.2g&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3.1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.5g&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3.1416&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.7g&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3.141593&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.8g&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3.1415926&#39;</span><span class="p">),</span> <span class="c"># round-half-even!</span>
            <span class="p">(</span><span class="s">&#39;.9g&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.10g&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">,</span> <span class="s">&#39;3.14159265&#39;</span><span class="p">),</span> <span class="c"># don&#39;t pad</span>

            <span class="p">(</span><span class="s">&#39;%&#39;</span><span class="p">,</span> <span class="s">&#39;0E1&#39;</span><span class="p">,</span> <span class="s">&#39;0%&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;%&#39;</span><span class="p">,</span> <span class="s">&#39;0E0&#39;</span><span class="p">,</span> <span class="s">&#39;0%&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;%&#39;</span><span class="p">,</span> <span class="s">&#39;0E-1&#39;</span><span class="p">,</span> <span class="s">&#39;0%&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;%&#39;</span><span class="p">,</span> <span class="s">&#39;0E-2&#39;</span><span class="p">,</span> <span class="s">&#39;0%&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;%&#39;</span><span class="p">,</span> <span class="s">&#39;0E-3&#39;</span><span class="p">,</span> <span class="s">&#39;0.0%&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;%&#39;</span><span class="p">,</span> <span class="s">&#39;0E-4&#39;</span><span class="p">,</span> <span class="s">&#39;0.00%&#39;</span><span class="p">),</span>

            <span class="p">(</span><span class="s">&#39;.3%&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">,</span> <span class="s">&#39;0.000%&#39;</span><span class="p">),</span> <span class="c"># all zeros treated equally</span>
            <span class="p">(</span><span class="s">&#39;.3%&#39;</span><span class="p">,</span> <span class="s">&#39;0E10&#39;</span><span class="p">,</span> <span class="s">&#39;0.000%&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.3%&#39;</span><span class="p">,</span> <span class="s">&#39;0E-10&#39;</span><span class="p">,</span> <span class="s">&#39;0.000%&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.3%&#39;</span><span class="p">,</span> <span class="s">&#39;2.34&#39;</span><span class="p">,</span> <span class="s">&#39;234.000%&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.3%&#39;</span><span class="p">,</span> <span class="s">&#39;1.234567&#39;</span><span class="p">,</span> <span class="s">&#39;123.457%&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.0%&#39;</span><span class="p">,</span> <span class="s">&#39;1.23&#39;</span><span class="p">,</span> <span class="s">&#39;123%&#39;</span><span class="p">),</span>

            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;NaN&#39;</span><span class="p">,</span> <span class="s">&#39;NaN&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;-NaN123&#39;</span><span class="p">,</span> <span class="s">&#39;-NaN123&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;+g&#39;</span><span class="p">,</span> <span class="s">&#39;NaN456&#39;</span><span class="p">,</span> <span class="s">&#39;+NaN456&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.3e&#39;</span><span class="p">,</span> <span class="s">&#39;Inf&#39;</span><span class="p">,</span> <span class="s">&#39;Infinity&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.16f&#39;</span><span class="p">,</span> <span class="s">&#39;-Inf&#39;</span><span class="p">,</span> <span class="s">&#39;-Infinity&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.0g&#39;</span><span class="p">,</span> <span class="s">&#39;-sNaN&#39;</span><span class="p">,</span> <span class="s">&#39;-sNaN&#39;</span><span class="p">),</span>

            <span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;1.00&#39;</span><span class="p">,</span> <span class="s">&#39;1.00&#39;</span><span class="p">),</span>

            <span class="c"># test alignment and padding</span>
            <span class="p">(</span><span class="s">&#39;6&#39;</span><span class="p">,</span> <span class="s">&#39;123&#39;</span><span class="p">,</span> <span class="s">&#39;   123&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;&lt;6&#39;</span><span class="p">,</span> <span class="s">&#39;123&#39;</span><span class="p">,</span> <span class="s">&#39;123   &#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;&gt;6&#39;</span><span class="p">,</span> <span class="s">&#39;123&#39;</span><span class="p">,</span> <span class="s">&#39;   123&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;^6&#39;</span><span class="p">,</span> <span class="s">&#39;123&#39;</span><span class="p">,</span> <span class="s">&#39; 123  &#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;=+6&#39;</span><span class="p">,</span> <span class="s">&#39;123&#39;</span><span class="p">,</span> <span class="s">&#39;+  123&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;#&lt;10&#39;</span><span class="p">,</span> <span class="s">&#39;NaN&#39;</span><span class="p">,</span> <span class="s">&#39;NaN#######&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;#&lt;10&#39;</span><span class="p">,</span> <span class="s">&#39;-4.3&#39;</span><span class="p">,</span> <span class="s">&#39;-4.3######&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;#&lt;+10&#39;</span><span class="p">,</span> <span class="s">&#39;0.0130&#39;</span><span class="p">,</span> <span class="s">&#39;+0.0130###&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;#&lt; 10&#39;</span><span class="p">,</span> <span class="s">&#39;0.0130&#39;</span><span class="p">,</span> <span class="s">&#39; 0.0130###&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;@&gt;10&#39;</span><span class="p">,</span> <span class="s">&#39;-Inf&#39;</span><span class="p">,</span> <span class="s">&#39;@-Infinity&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;#&gt;5&#39;</span><span class="p">,</span> <span class="s">&#39;-Inf&#39;</span><span class="p">,</span> <span class="s">&#39;-Infinity&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;?^5&#39;</span><span class="p">,</span> <span class="s">&#39;123&#39;</span><span class="p">,</span> <span class="s">&#39;?123?&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;%^6&#39;</span><span class="p">,</span> <span class="s">&#39;123&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="si">%123%</span><span class="s">%&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39; ^6&#39;</span><span class="p">,</span> <span class="s">&#39;-45.6&#39;</span><span class="p">,</span> <span class="s">&#39;-45.6 &#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;/=10&#39;</span><span class="p">,</span> <span class="s">&#39;-45.6&#39;</span><span class="p">,</span> <span class="s">&#39;-/////45.6&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;/=+10&#39;</span><span class="p">,</span> <span class="s">&#39;45.6&#39;</span><span class="p">,</span> <span class="s">&#39;+/////45.6&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;/= 10&#39;</span><span class="p">,</span> <span class="s">&#39;45.6&#39;</span><span class="p">,</span> <span class="s">&#39; /////45.6&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;</span><span class="se">\x00</span><span class="s">=10&#39;</span><span class="p">,</span> <span class="s">&#39;-inf&#39;</span><span class="p">,</span> <span class="s">&#39;-</span><span class="se">\x00</span><span class="s">Infinity&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;</span><span class="se">\x00</span><span class="s">^16&#39;</span><span class="p">,</span> <span class="s">&#39;-inf&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\x00\x00\x00</span><span class="s">-Infinity</span><span class="se">\x00\x00\x00\x00</span><span class="s">&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;</span><span class="se">\x00</span><span class="s">&gt;10&#39;</span><span class="p">,</span> <span class="s">&#39;1.2345&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\x00\x00\x00\x00</span><span class="s">1.2345&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;</span><span class="se">\x00</span><span class="s">&lt;10&#39;</span><span class="p">,</span> <span class="s">&#39;1.2345&#39;</span><span class="p">,</span> <span class="s">&#39;1.2345</span><span class="se">\x00\x00\x00\x00</span><span class="s">&#39;</span><span class="p">),</span>

            <span class="c"># thousands separator</span>
            <span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="s">&#39;1234567&#39;</span><span class="p">,</span> <span class="s">&#39;1,234,567&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="s">&#39;123456&#39;</span><span class="p">,</span> <span class="s">&#39;123,456&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="s">&#39;12345&#39;</span><span class="p">,</span> <span class="s">&#39;12,345&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="s">&#39;1234&#39;</span><span class="p">,</span> <span class="s">&#39;1,234&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="s">&#39;123&#39;</span><span class="p">,</span> <span class="s">&#39;123&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="s">&#39;12&#39;</span><span class="p">,</span> <span class="s">&#39;12&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="s">&#39;-1234567&#39;</span><span class="p">,</span> <span class="s">&#39;-1,234,567&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="s">&#39;-123456&#39;</span><span class="p">,</span> <span class="s">&#39;-123,456&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;7,&#39;</span><span class="p">,</span> <span class="s">&#39;123456&#39;</span><span class="p">,</span> <span class="s">&#39;123,456&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;8,&#39;</span><span class="p">,</span> <span class="s">&#39;123456&#39;</span><span class="p">,</span> <span class="s">&#39; 123,456&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;08,&#39;</span><span class="p">,</span> <span class="s">&#39;123456&#39;</span><span class="p">,</span> <span class="s">&#39;0,123,456&#39;</span><span class="p">),</span> <span class="c"># special case: extra 0 needed</span>
            <span class="p">(</span><span class="s">&#39;+08,&#39;</span><span class="p">,</span> <span class="s">&#39;123456&#39;</span><span class="p">,</span> <span class="s">&#39;+123,456&#39;</span><span class="p">),</span> <span class="c"># but not if there&#39;s a sign</span>
            <span class="p">(</span><span class="s">&#39; 08,&#39;</span><span class="p">,</span> <span class="s">&#39;123456&#39;</span><span class="p">,</span> <span class="s">&#39; 123,456&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;08,&#39;</span><span class="p">,</span> <span class="s">&#39;-123456&#39;</span><span class="p">,</span> <span class="s">&#39;-123,456&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;+09,&#39;</span><span class="p">,</span> <span class="s">&#39;123456&#39;</span><span class="p">,</span> <span class="s">&#39;+0,123,456&#39;</span><span class="p">),</span>
            <span class="c"># ... with fractional part...</span>
            <span class="p">(</span><span class="s">&#39;07,&#39;</span><span class="p">,</span> <span class="s">&#39;1234.56&#39;</span><span class="p">,</span> <span class="s">&#39;1,234.56&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;08,&#39;</span><span class="p">,</span> <span class="s">&#39;1234.56&#39;</span><span class="p">,</span> <span class="s">&#39;1,234.56&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;09,&#39;</span><span class="p">,</span> <span class="s">&#39;1234.56&#39;</span><span class="p">,</span> <span class="s">&#39;01,234.56&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;010,&#39;</span><span class="p">,</span> <span class="s">&#39;1234.56&#39;</span><span class="p">,</span> <span class="s">&#39;001,234.56&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;011,&#39;</span><span class="p">,</span> <span class="s">&#39;1234.56&#39;</span><span class="p">,</span> <span class="s">&#39;0,001,234.56&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;012,&#39;</span><span class="p">,</span> <span class="s">&#39;1234.56&#39;</span><span class="p">,</span> <span class="s">&#39;0,001,234.56&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;08,.1f&#39;</span><span class="p">,</span> <span class="s">&#39;1234.5&#39;</span><span class="p">,</span> <span class="s">&#39;01,234.5&#39;</span><span class="p">),</span>
            <span class="c"># no thousands separators in fraction part</span>
            <span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="s">&#39;1.23456789&#39;</span><span class="p">,</span> <span class="s">&#39;1.23456789&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;,%&#39;</span><span class="p">,</span> <span class="s">&#39;123.456789&#39;</span><span class="p">,</span> <span class="s">&#39;12,345.6789%&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;,e&#39;</span><span class="p">,</span> <span class="s">&#39;123456&#39;</span><span class="p">,</span> <span class="s">&#39;1.23456e+5&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;,E&#39;</span><span class="p">,</span> <span class="s">&#39;123456&#39;</span><span class="p">,</span> <span class="s">&#39;1.23456E+5&#39;</span><span class="p">),</span>

            <span class="c"># issue 6850</span>
            <span class="p">(</span><span class="s">&#39;a=-7.0&#39;</span><span class="p">,</span> <span class="s">&#39;0.12345&#39;</span><span class="p">,</span> <span class="s">&#39;aaaa0.1&#39;</span><span class="p">),</span>

            <span class="c"># issue 22090</span>
            <span class="p">(</span><span class="s">&#39;&lt;^+15.20%&#39;</span><span class="p">,</span> <span class="s">&#39;inf&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;&lt;+Infinity%&lt;&lt;&lt;&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;</span><span class="se">\x07</span><span class="s">&gt;,%&#39;</span><span class="p">,</span> <span class="s">&#39;sNaN1234567&#39;</span><span class="p">,</span> <span class="s">&#39;sNaN1234567%&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;=10.10%&#39;</span><span class="p">,</span> <span class="s">&#39;NaN123&#39;</span><span class="p">,</span> <span class="s">&#39;   NaN123%&#39;</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="k">for</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">test_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">format</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">fmt</span><span class="p">),</span> <span class="n">result</span><span class="p">)</span>

        <span class="c"># bytes format argument</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__format__</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;-020&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FormatTest.test_n_format"><a class="viewcode-back" href="../../test.html#test.test_decimal.FormatTest.test_n_format">[docs]</a>    <span class="k">def</span> <span class="nf">test_n_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">locale</span> <span class="kn">import</span> <span class="n">CHAR_MAX</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipTest</span><span class="p">(</span><span class="s">&#39;locale.CHAR_MAX not available&#39;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">make_grouping</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span> <span class="o">==</span> <span class="n">C</span> <span class="k">else</span> <span class="n">lst</span>

        <span class="k">def</span> <span class="nf">get_fmt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s">&#39;n&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span> <span class="o">==</span> <span class="n">C</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">__format__</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="n">override</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">__format__</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="n">_localeconv</span><span class="o">=</span><span class="n">override</span><span class="p">)</span>

        <span class="c"># Set up some localeconv-like dictionaries</span>
        <span class="n">en_US</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;decimal_point&#39;</span> <span class="p">:</span> <span class="s">&#39;.&#39;</span><span class="p">,</span>
            <span class="s">&#39;grouping&#39;</span> <span class="p">:</span> <span class="n">make_grouping</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
            <span class="s">&#39;thousands_sep&#39;</span> <span class="p">:</span> <span class="s">&#39;,&#39;</span>
            <span class="p">}</span>

        <span class="n">fr_FR</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;decimal_point&#39;</span> <span class="p">:</span> <span class="s">&#39;,&#39;</span><span class="p">,</span>
            <span class="s">&#39;grouping&#39;</span> <span class="p">:</span> <span class="n">make_grouping</span><span class="p">([</span><span class="n">CHAR_MAX</span><span class="p">]),</span>
            <span class="s">&#39;thousands_sep&#39;</span> <span class="p">:</span> <span class="s">&#39;&#39;</span>
            <span class="p">}</span>

        <span class="n">ru_RU</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;decimal_point&#39;</span> <span class="p">:</span> <span class="s">&#39;,&#39;</span><span class="p">,</span>
            <span class="s">&#39;grouping&#39;</span><span class="p">:</span> <span class="n">make_grouping</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
            <span class="s">&#39;thousands_sep&#39;</span> <span class="p">:</span> <span class="s">&#39; &#39;</span>
            <span class="p">}</span>

        <span class="n">crazy</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;decimal_point&#39;</span> <span class="p">:</span> <span class="s">&#39;&amp;&#39;</span><span class="p">,</span>
            <span class="s">&#39;grouping&#39;</span><span class="p">:</span> <span class="n">make_grouping</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">CHAR_MAX</span><span class="p">]),</span>
            <span class="s">&#39;thousands_sep&#39;</span> <span class="p">:</span> <span class="s">&#39;-&#39;</span>
            <span class="p">}</span>

        <span class="n">dotsep_wide</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;decimal_point&#39;</span> <span class="p">:</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xc2\xbf</span><span class="s">&#39;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">),</span>
            <span class="s">&#39;grouping&#39;</span><span class="p">:</span> <span class="n">make_grouping</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
            <span class="s">&#39;thousands_sep&#39;</span> <span class="p">:</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xc2\xb4</span><span class="s">&#39;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;12.7&#39;</span><span class="p">),</span> <span class="n">en_US</span><span class="p">),</span> <span class="s">&#39;12.7&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;12.7&#39;</span><span class="p">),</span> <span class="n">fr_FR</span><span class="p">),</span> <span class="s">&#39;12,7&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;12.7&#39;</span><span class="p">),</span> <span class="n">ru_RU</span><span class="p">),</span> <span class="s">&#39;12,7&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;12.7&#39;</span><span class="p">),</span> <span class="n">crazy</span><span class="p">),</span> <span class="s">&#39;1-2&amp;7&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">123456789</span><span class="p">,</span> <span class="n">en_US</span><span class="p">),</span> <span class="s">&#39;123,456,789&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">123456789</span><span class="p">,</span> <span class="n">fr_FR</span><span class="p">),</span> <span class="s">&#39;123456789&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">123456789</span><span class="p">,</span> <span class="n">ru_RU</span><span class="p">),</span> <span class="s">&#39;123 456 789&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">1234567890123</span><span class="p">,</span> <span class="n">crazy</span><span class="p">),</span> <span class="s">&#39;123456-78-9012-3&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">123456789</span><span class="p">,</span> <span class="n">en_US</span><span class="p">,</span> <span class="s">&#39;.6n&#39;</span><span class="p">),</span> <span class="s">&#39;1.23457e+8&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">123456789</span><span class="p">,</span> <span class="n">fr_FR</span><span class="p">,</span> <span class="s">&#39;.6n&#39;</span><span class="p">),</span> <span class="s">&#39;1,23457e+8&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">123456789</span><span class="p">,</span> <span class="n">ru_RU</span><span class="p">,</span> <span class="s">&#39;.6n&#39;</span><span class="p">),</span> <span class="s">&#39;1,23457e+8&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">123456789</span><span class="p">,</span> <span class="n">crazy</span><span class="p">,</span> <span class="s">&#39;.6n&#39;</span><span class="p">),</span> <span class="s">&#39;1&amp;23457e+8&#39;</span><span class="p">)</span>

        <span class="c"># zero padding</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">1234</span><span class="p">,</span> <span class="n">fr_FR</span><span class="p">,</span> <span class="s">&#39;03n&#39;</span><span class="p">),</span> <span class="s">&#39;1234&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">1234</span><span class="p">,</span> <span class="n">fr_FR</span><span class="p">,</span> <span class="s">&#39;04n&#39;</span><span class="p">),</span> <span class="s">&#39;1234&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">1234</span><span class="p">,</span> <span class="n">fr_FR</span><span class="p">,</span> <span class="s">&#39;05n&#39;</span><span class="p">),</span> <span class="s">&#39;01234&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">1234</span><span class="p">,</span> <span class="n">fr_FR</span><span class="p">,</span> <span class="s">&#39;06n&#39;</span><span class="p">),</span> <span class="s">&#39;001234&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">12345</span><span class="p">,</span> <span class="n">en_US</span><span class="p">,</span> <span class="s">&#39;05n&#39;</span><span class="p">),</span> <span class="s">&#39;12,345&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">12345</span><span class="p">,</span> <span class="n">en_US</span><span class="p">,</span> <span class="s">&#39;06n&#39;</span><span class="p">),</span> <span class="s">&#39;12,345&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">12345</span><span class="p">,</span> <span class="n">en_US</span><span class="p">,</span> <span class="s">&#39;07n&#39;</span><span class="p">),</span> <span class="s">&#39;012,345&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">12345</span><span class="p">,</span> <span class="n">en_US</span><span class="p">,</span> <span class="s">&#39;08n&#39;</span><span class="p">),</span> <span class="s">&#39;0,012,345&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">12345</span><span class="p">,</span> <span class="n">en_US</span><span class="p">,</span> <span class="s">&#39;09n&#39;</span><span class="p">),</span> <span class="s">&#39;0,012,345&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">12345</span><span class="p">,</span> <span class="n">en_US</span><span class="p">,</span> <span class="s">&#39;010n&#39;</span><span class="p">),</span> <span class="s">&#39;00,012,345&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">123456</span><span class="p">,</span> <span class="n">crazy</span><span class="p">,</span> <span class="s">&#39;06n&#39;</span><span class="p">),</span> <span class="s">&#39;1-2345-6&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">123456</span><span class="p">,</span> <span class="n">crazy</span><span class="p">,</span> <span class="s">&#39;07n&#39;</span><span class="p">),</span> <span class="s">&#39;1-2345-6&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">123456</span><span class="p">,</span> <span class="n">crazy</span><span class="p">,</span> <span class="s">&#39;08n&#39;</span><span class="p">),</span> <span class="s">&#39;1-2345-6&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">123456</span><span class="p">,</span> <span class="n">crazy</span><span class="p">,</span> <span class="s">&#39;09n&#39;</span><span class="p">),</span> <span class="s">&#39;01-2345-6&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">123456</span><span class="p">,</span> <span class="n">crazy</span><span class="p">,</span> <span class="s">&#39;010n&#39;</span><span class="p">),</span> <span class="s">&#39;0-01-2345-6&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">123456</span><span class="p">,</span> <span class="n">crazy</span><span class="p">,</span> <span class="s">&#39;011n&#39;</span><span class="p">),</span> <span class="s">&#39;0-01-2345-6&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">123456</span><span class="p">,</span> <span class="n">crazy</span><span class="p">,</span> <span class="s">&#39;012n&#39;</span><span class="p">),</span> <span class="s">&#39;00-01-2345-6&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="mi">123456</span><span class="p">,</span> <span class="n">crazy</span><span class="p">,</span> <span class="s">&#39;013n&#39;</span><span class="p">),</span> <span class="s">&#39;000-01-2345-6&#39;</span><span class="p">)</span>

        <span class="c"># wide char separator and decimal point</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_fmt</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-1.5&#39;</span><span class="p">),</span> <span class="n">dotsep_wide</span><span class="p">,</span> <span class="s">&#39;020n&#39;</span><span class="p">),</span>
                         <span class="s">&#39;-0</span><span class="se">\u00b4</span><span class="s">000</span><span class="se">\u00b4</span><span class="s">000</span><span class="se">\u00b4</span><span class="s">000</span><span class="se">\u00b4</span><span class="s">001</span><span class="se">\u00bf</span><span class="s">5&#39;</span><span class="p">)</span>
</div>
    <span class="nd">@run_with_locale</span><span class="p">(</span><span class="s">&#39;LC_ALL&#39;</span><span class="p">,</span> <span class="s">&#39;ps_AF&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_wide_char_separator_decimal_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># locale with wide char separator and decimal point</span>
        <span class="kn">import</span> <span class="nn">locale</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">decimal_point</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">localeconv</span><span class="p">()[</span><span class="s">&#39;decimal_point&#39;</span><span class="p">]</span>
        <span class="n">thousands_sep</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">localeconv</span><span class="p">()[</span><span class="s">&#39;thousands_sep&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">decimal_point</span> <span class="o">!=</span> <span class="s">&#39;</span><span class="se">\u066b</span><span class="s">&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipTest</span><span class="p">(</span><span class="s">&#39;inappropriate decimal point separator&#39;</span>
                          <span class="s">&#39;({!a} not {!a})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">decimal_point</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\u066b</span><span class="s">&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">thousands_sep</span> <span class="o">!=</span> <span class="s">&#39;</span><span class="se">\u066c</span><span class="s">&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipTest</span><span class="p">(</span><span class="s">&#39;inappropriate thousands separator&#39;</span>
                          <span class="s">&#39;({!a} not {!a})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">thousands_sep</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\u066c</span><span class="s">&#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">format</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;100000000.123&#39;</span><span class="p">),</span> <span class="s">&#39;n&#39;</span><span class="p">),</span>
                         <span class="s">&#39;100</span><span class="se">\u066c</span><span class="s">000</span><span class="se">\u066c</span><span class="s">000</span><span class="se">\u066b</span><span class="s">123&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CFormatTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.CFormatTest">[docs]</a><span class="k">class</span> <span class="nc">CFormatTest</span><span class="p">(</span><span class="n">FormatTest</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">C</span></div>
<div class="viewcode-block" id="PyFormatTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyFormatTest">[docs]</a><span class="k">class</span> <span class="nc">PyFormatTest</span><span class="p">(</span><span class="n">FormatTest</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">P</span>
</div>
<div class="viewcode-block" id="ArithmeticOperatorsTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.ArithmeticOperatorsTest">[docs]</a><span class="k">class</span> <span class="nc">ArithmeticOperatorsTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Unit tests for all arithmetic operators, binary and unary.&#39;&#39;&#39;</span>

<div class="viewcode-block" id="ArithmeticOperatorsTest.test_addition"><a class="viewcode-back" href="../../test.html#test.test_decimal.ArithmeticOperatorsTest.test_addition">[docs]</a>    <span class="k">def</span> <span class="nf">test_addition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">d1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-11.1&#39;</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;22.2&#39;</span><span class="p">)</span>

        <span class="c">#two Decimals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">+</span><span class="n">d2</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;11.1&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d2</span><span class="o">+</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;11.1&#39;</span><span class="p">))</span>

        <span class="c">#with other type, left</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">+</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-6.1&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#with other type, right</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">d1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-6.1&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#inline with decimal</span>
        <span class="n">d1</span> <span class="o">+=</span> <span class="n">d2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;11.1&#39;</span><span class="p">))</span>

        <span class="c">#inline with other type</span>
        <span class="n">d1</span> <span class="o">+=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;16.1&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ArithmeticOperatorsTest.test_subtraction"><a class="viewcode-back" href="../../test.html#test.test_decimal.ArithmeticOperatorsTest.test_subtraction">[docs]</a>    <span class="k">def</span> <span class="nf">test_subtraction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">d1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-11.1&#39;</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;22.2&#39;</span><span class="p">)</span>

        <span class="c">#two Decimals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">-</span><span class="n">d2</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-33.3&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d2</span><span class="o">-</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;33.3&#39;</span><span class="p">))</span>

        <span class="c">#with other type, left</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">-</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-16.1&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#with other type, right</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">d1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;16.1&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#inline with decimal</span>
        <span class="n">d1</span> <span class="o">-=</span> <span class="n">d2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-33.3&#39;</span><span class="p">))</span>

        <span class="c">#inline with other type</span>
        <span class="n">d1</span> <span class="o">-=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-38.3&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ArithmeticOperatorsTest.test_multiplication"><a class="viewcode-back" href="../../test.html#test.test_decimal.ArithmeticOperatorsTest.test_multiplication">[docs]</a>    <span class="k">def</span> <span class="nf">test_multiplication</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">d1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-5&#39;</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;3&#39;</span><span class="p">)</span>

        <span class="c">#two Decimals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">*</span><span class="n">d2</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-15&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d2</span><span class="o">*</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-15&#39;</span><span class="p">))</span>

        <span class="c">#with other type, left</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">*</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-25&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#with other type, right</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">d1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-25&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#inline with decimal</span>
        <span class="n">d1</span> <span class="o">*=</span> <span class="n">d2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-15&#39;</span><span class="p">))</span>

        <span class="c">#inline with other type</span>
        <span class="n">d1</span> <span class="o">*=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-75&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ArithmeticOperatorsTest.test_division"><a class="viewcode-back" href="../../test.html#test.test_decimal.ArithmeticOperatorsTest.test_division">[docs]</a>    <span class="k">def</span> <span class="nf">test_division</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">d1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-5&#39;</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">)</span>

        <span class="c">#two Decimals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">/</span><span class="n">d2</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-2.5&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d2</span><span class="o">/</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-0.4&#39;</span><span class="p">))</span>

        <span class="c">#with other type, left</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">/</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-1.25&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#with other type, right</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">/</span> <span class="n">d1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-0.8&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#inline with decimal</span>
        <span class="n">d1</span> <span class="o">/=</span> <span class="n">d2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-2.5&#39;</span><span class="p">))</span>

        <span class="c">#inline with other type</span>
        <span class="n">d1</span> <span class="o">/=</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-0.625&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ArithmeticOperatorsTest.test_floor_division"><a class="viewcode-back" href="../../test.html#test.test_decimal.ArithmeticOperatorsTest.test_floor_division">[docs]</a>    <span class="k">def</span> <span class="nf">test_floor_division</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">d1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;5&#39;</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">)</span>

        <span class="c">#two Decimals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">//</span><span class="n">d2</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d2</span><span class="o">//</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">))</span>

        <span class="c">#with other type, left</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">//</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#with other type, right</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">//</span> <span class="n">d1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#inline with decimal</span>
        <span class="n">d1</span> <span class="o">//=</span> <span class="n">d2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">))</span>

        <span class="c">#inline with other type</span>
        <span class="n">d1</span> <span class="o">//=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ArithmeticOperatorsTest.test_powering"><a class="viewcode-back" href="../../test.html#test.test_decimal.ArithmeticOperatorsTest.test_powering">[docs]</a>    <span class="k">def</span> <span class="nf">test_powering</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">d1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;5&#39;</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">)</span>

        <span class="c">#two Decimals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">**</span><span class="n">d2</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;25&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d2</span><span class="o">**</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;32&#39;</span><span class="p">))</span>

        <span class="c">#with other type, left</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">**</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;625&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#with other type, right</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">**</span> <span class="n">d1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;16807&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#inline with decimal</span>
        <span class="n">d1</span> <span class="o">**=</span> <span class="n">d2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;25&#39;</span><span class="p">))</span>

        <span class="c">#inline with other type</span>
        <span class="n">d1</span> <span class="o">**=</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;390625&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ArithmeticOperatorsTest.test_module"><a class="viewcode-back" href="../../test.html#test.test_decimal.ArithmeticOperatorsTest.test_module">[docs]</a>    <span class="k">def</span> <span class="nf">test_module</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">d1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;5&#39;</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">)</span>

        <span class="c">#two Decimals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">%</span><span class="n">d2</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d2</span><span class="o">%</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">))</span>

        <span class="c">#with other type, left</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">%</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#with other type, right</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">%</span> <span class="n">d1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#inline with decimal</span>
        <span class="n">d1</span> <span class="o">%=</span> <span class="n">d2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">))</span>

        <span class="c">#inline with other type</span>
        <span class="n">d1</span> <span class="o">%=</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ArithmeticOperatorsTest.test_floor_div_module"><a class="viewcode-back" href="../../test.html#test.test_decimal.ArithmeticOperatorsTest.test_floor_div_module">[docs]</a>    <span class="k">def</span> <span class="nf">test_floor_div_module</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">d1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;5&#39;</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">)</span>

        <span class="c">#two Decimals</span>
        <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#with other type, left</span>
        <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>

        <span class="c">#with other type, right</span>
        <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ArithmeticOperatorsTest.test_unary_operators"><a class="viewcode-back" href="../../test.html#test.test_decimal.ArithmeticOperatorsTest.test_unary_operators">[docs]</a>    <span class="k">def</span> <span class="nf">test_unary_operators</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="o">+</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="o">+</span><span class="mi">45</span><span class="p">))</span>           <span class="c">#  +</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="o">-</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">))</span>           <span class="c">#  -</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">45</span><span class="p">)),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">)))</span>  <span class="c"># abs</span>
</div>
<div class="viewcode-block" id="ArithmeticOperatorsTest.test_nan_comparisons"><a class="viewcode-back" href="../../test.html#test.test_decimal.ArithmeticOperatorsTest.test_nan_comparisons">[docs]</a>    <span class="k">def</span> <span class="nf">test_nan_comparisons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># comparisons involving signaling nans signal InvalidOperation</span>

        <span class="c"># order comparisons (&lt;, &lt;=, &gt;, &gt;=) involving only quiet nans</span>
        <span class="c"># also signal InvalidOperation</span>

        <span class="c"># equality comparisons (==, !=) involving only quiet nans</span>
        <span class="c"># don&#39;t signal, but return False or True respectively.</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="n">n</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;NaN&#39;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;Inf&#39;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">)</span>

        <span class="n">qnan_pairs</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">f</span><span class="p">),</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">snan_pairs</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">f</span><span class="p">),</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="n">order_ops</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">lt</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">le</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">gt</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">ge</span>
        <span class="n">equality_ops</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">eq</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">ne</span>

        <span class="c"># results when InvalidOperation is not trapped</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">qnan_pairs</span> <span class="o">+</span> <span class="n">snan_pairs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">order_ops</span> <span class="o">+</span> <span class="n">equality_ops</span><span class="p">:</span>
                <span class="n">got</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                <span class="n">expected</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">op</span> <span class="ow">is</span> <span class="n">operator</span><span class="o">.</span><span class="n">ne</span> <span class="k">else</span> <span class="bp">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">got</span><span class="p">,</span>
                              <span class="s">&quot;expected {0!r} for operator.{1}({2!r}, {3!r}); &quot;</span>
                              <span class="s">&quot;got {4!r}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">expected</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">got</span><span class="p">))</span>

        <span class="c"># repeat the above, but this time trap the InvalidOperation</span>
        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">ctx</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">qnan_pairs</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">equality_ops</span><span class="p">:</span>
                    <span class="n">got</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                    <span class="n">expected</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">op</span> <span class="ow">is</span> <span class="n">operator</span><span class="o">.</span><span class="n">ne</span> <span class="k">else</span> <span class="bp">False</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">got</span><span class="p">,</span>
                                  <span class="s">&quot;expected {0!r} for &quot;</span>
                                  <span class="s">&quot;operator.{1}({2!r}, {3!r}); &quot;</span>
                                  <span class="s">&quot;got {4!r}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">expected</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">got</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">snan_pairs</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">equality_ops</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">eq</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">ne</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">qnan_pairs</span> <span class="o">+</span> <span class="n">snan_pairs</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">order_ops</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ArithmeticOperatorsTest.test_copy_sign"><a class="viewcode-back" href="../../test.html#test.test_decimal.ArithmeticOperatorsTest.test_copy_sign">[docs]</a>    <span class="k">def</span> <span class="nf">test_copy_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">copy_sign</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">copy_sign</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">copy_sign</span><span class="p">,</span> <span class="s">&#39;-2&#39;</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="CArithmeticOperatorsTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.CArithmeticOperatorsTest">[docs]</a><span class="k">class</span> <span class="nc">CArithmeticOperatorsTest</span><span class="p">(</span><span class="n">ArithmeticOperatorsTest</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">C</span></div>
<div class="viewcode-block" id="PyArithmeticOperatorsTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyArithmeticOperatorsTest">[docs]</a><span class="k">class</span> <span class="nc">PyArithmeticOperatorsTest</span><span class="p">(</span><span class="n">ArithmeticOperatorsTest</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">P</span>

<span class="c"># The following are two functions used to test threading in the next class</span>
</div>
<div class="viewcode-block" id="thfunc1"><a class="viewcode-back" href="../../test.html#test.test_decimal.thfunc1">[docs]</a><span class="k">def</span> <span class="nf">thfunc1</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
    <span class="n">Decimal</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
    <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>
    <span class="n">DivisionByZero</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">DivisionByZero</span>
    <span class="n">Overflow</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Overflow</span>
    <span class="n">Underflow</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Underflow</span>
    <span class="n">Inexact</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Inexact</span>
    <span class="n">getcontext</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span>
    <span class="n">localcontext</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>

    <span class="n">d1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">d3</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">test1</span> <span class="o">=</span> <span class="n">d1</span><span class="o">/</span><span class="n">d3</span>

    <span class="n">cls</span><span class="o">.</span><span class="n">finish1</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
    <span class="n">cls</span><span class="o">.</span><span class="n">synchro</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

    <span class="n">test2</span> <span class="o">=</span> <span class="n">d1</span><span class="o">/</span><span class="n">d3</span>
    <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c2</span><span class="p">:</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Inexact</span><span class="p">])</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">DivisionByZero</span><span class="p">,</span> <span class="n">c2</span><span class="o">.</span><span class="n">divide</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">DivisionByZero</span><span class="p">])</span>
        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c3</span><span class="p">:</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c3</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Inexact</span><span class="p">])</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c3</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">DivisionByZero</span><span class="p">])</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">c3</span><span class="o">.</span><span class="n">compare</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">))</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c3</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>
            <span class="k">del</span> <span class="n">c3</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>
        <span class="k">del</span> <span class="n">c2</span>

    <span class="n">cls</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">test1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;0.333333333333333333333333&#39;</span><span class="p">))</span>
    <span class="n">cls</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">test2</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;0.333333333333333333333333&#39;</span><span class="p">))</span>

    <span class="n">c1</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
    <span class="n">cls</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Inexact</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">sig</span> <span class="ow">in</span> <span class="n">Overflow</span><span class="p">,</span> <span class="n">Underflow</span><span class="p">,</span> <span class="n">DivisionByZero</span><span class="p">,</span> <span class="n">InvalidOperation</span><span class="p">:</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">sig</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="thfunc2"><a class="viewcode-back" href="../../test.html#test.test_decimal.thfunc2">[docs]</a><span class="k">def</span> <span class="nf">thfunc2</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
    <span class="n">Decimal</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
    <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>
    <span class="n">DivisionByZero</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">DivisionByZero</span>
    <span class="n">Overflow</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Overflow</span>
    <span class="n">Underflow</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Underflow</span>
    <span class="n">Inexact</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Inexact</span>
    <span class="n">getcontext</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span>
    <span class="n">localcontext</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>

    <span class="n">d1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">d3</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">test1</span> <span class="o">=</span> <span class="n">d1</span><span class="o">/</span><span class="n">d3</span>

    <span class="n">thiscontext</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
    <span class="n">thiscontext</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">18</span>
    <span class="n">test2</span> <span class="o">=</span> <span class="n">d1</span><span class="o">/</span><span class="n">d3</span>

    <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c2</span><span class="p">:</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Inexact</span><span class="p">])</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span> <span class="n">c2</span><span class="o">.</span><span class="n">multiply</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1e425000000&#39;</span><span class="p">),</span> <span class="mi">999</span><span class="p">)</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">])</span>
        <span class="k">with</span> <span class="n">localcontext</span><span class="p">(</span><span class="n">thiscontext</span><span class="p">)</span> <span class="k">as</span> <span class="n">c3</span><span class="p">:</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c3</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Inexact</span><span class="p">])</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c3</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">])</span>
            <span class="n">c3</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">Underflow</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Underflow</span><span class="p">,</span> <span class="n">c3</span><span class="o">.</span><span class="n">divide</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1e-425000000&#39;</span><span class="p">),</span> <span class="mi">999</span><span class="p">)</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c3</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Underflow</span><span class="p">])</span>
            <span class="k">del</span> <span class="n">c3</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Underflow</span><span class="p">])</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">Underflow</span><span class="p">])</span>
        <span class="k">del</span> <span class="n">c2</span>

    <span class="n">cls</span><span class="o">.</span><span class="n">synchro</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
    <span class="n">cls</span><span class="o">.</span><span class="n">finish2</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="n">cls</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">test1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;0.333333333333333333333333&#39;</span><span class="p">))</span>
    <span class="n">cls</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">test2</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;0.333333333333333333&#39;</span><span class="p">))</span>

    <span class="n">cls</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">thiscontext</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">Underflow</span><span class="p">])</span>
    <span class="n">cls</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">thiscontext</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Inexact</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">sig</span> <span class="ow">in</span> <span class="n">Overflow</span><span class="p">,</span> <span class="n">Underflow</span><span class="p">,</span> <span class="n">DivisionByZero</span><span class="p">,</span> <span class="n">InvalidOperation</span><span class="p">:</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">thiscontext</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">sig</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="ThreadingTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.ThreadingTest">[docs]</a><span class="k">class</span> <span class="nc">ThreadingTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Unit tests for thread local contexts in Decimal.&#39;&#39;&#39;</span>

    <span class="c"># Take care executing this test from IDLE, there&#39;s an issue in threading</span>
    <span class="c"># that hangs IDLE and I couldn&#39;t find it</span>

<div class="viewcode-block" id="ThreadingTest.test_threading"><a class="viewcode-back" href="../../test.html#test.test_decimal.ThreadingTest.test_threading">[docs]</a>    <span class="k">def</span> <span class="nf">test_threading</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">DefaultContext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">DefaultContext</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span> <span class="o">==</span> <span class="n">C</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">HAVE_THREADS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipTest</span><span class="p">(</span><span class="s">&quot;compiled without threading&quot;</span><span class="p">)</span>
        <span class="c"># Test the &quot;threading isolation&quot; of a Context. Also test changing</span>
        <span class="c"># the DefaultContext, which acts as a template for the thread-local</span>
        <span class="c"># contexts.</span>
        <span class="n">save_prec</span> <span class="o">=</span> <span class="n">DefaultContext</span><span class="o">.</span><span class="n">prec</span>
        <span class="n">save_emax</span> <span class="o">=</span> <span class="n">DefaultContext</span><span class="o">.</span><span class="n">Emax</span>
        <span class="n">save_emin</span> <span class="o">=</span> <span class="n">DefaultContext</span><span class="o">.</span><span class="n">Emin</span>
        <span class="n">DefaultContext</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">24</span>
        <span class="n">DefaultContext</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="mi">425000000</span>
        <span class="n">DefaultContext</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">425000000</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">synchro</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish1</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish2</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>

        <span class="n">th1</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">thfunc1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="p">,))</span>
        <span class="n">th2</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">thfunc2</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="p">,))</span>

        <span class="n">th1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">th2</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">finish1</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish2</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">sig</span> <span class="ow">in</span> <span class="n">Signals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">DefaultContext</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">sig</span><span class="p">])</span>

        <span class="n">DefaultContext</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">save_prec</span>
        <span class="n">DefaultContext</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="n">save_emax</span>
        <span class="n">DefaultContext</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="n">save_emin</span>
</div></div>
<span class="nd">@unittest.skipUnless</span><span class="p">(</span><span class="n">threading</span><span class="p">,</span> <span class="s">&#39;threading required&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="CThreadingTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.CThreadingTest">[docs]</a><span class="k">class</span> <span class="nc">CThreadingTest</span><span class="p">(</span><span class="n">ThreadingTest</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">C</span></div>
<span class="nd">@unittest.skipUnless</span><span class="p">(</span><span class="n">threading</span><span class="p">,</span> <span class="s">&#39;threading required&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="PyThreadingTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyThreadingTest">[docs]</a><span class="k">class</span> <span class="nc">PyThreadingTest</span><span class="p">(</span><span class="n">ThreadingTest</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">P</span>
</div>
<div class="viewcode-block" id="UsabilityTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest">[docs]</a><span class="k">class</span> <span class="nc">UsabilityTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Unit tests for Usability cases of Decimal.&#39;&#39;&#39;</span>

<div class="viewcode-block" id="UsabilityTest.test_comparison_operators"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_comparison_operators">[docs]</a>    <span class="k">def</span> <span class="nf">test_comparison_operators</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">da</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;23.42&#39;</span><span class="p">)</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;23.42&#39;</span><span class="p">)</span>
        <span class="n">dc</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;45&#39;</span><span class="p">)</span>

        <span class="c">#two Decimals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">da</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreaterEqual</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">da</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">dc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertLessEqual</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">dc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">dc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertLessEqual</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreaterEqual</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>

        <span class="c">#a Decimal and an int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="mi">23</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="n">dc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>

        <span class="c">#a Decimal and uncomparable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="s">&#39;ugly&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="mf">32.7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="nb">object</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="nb">object</span><span class="p">)</span>

        <span class="c"># sortable</span>
        <span class="n">a</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">Decimal</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)))</span>
        <span class="n">b</span> <span class="o">=</span>  <span class="n">a</span><span class="p">[:]</span>
        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_decimal_float_comparison"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_decimal_float_comparison">[docs]</a>    <span class="k">def</span> <span class="nf">test_decimal_float_comparison</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">da</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;0.25&#39;</span><span class="p">)</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;3.0&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertLessEqual</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreaterEqual</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">da</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreaterEqual</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">da</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertLessEqual</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;0.1&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_decimal_complex_comparison"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_decimal_complex_comparison">[docs]</a>    <span class="k">def</span> <span class="nf">test_decimal_complex_comparison</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">da</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;0.25&#39;</span><span class="p">)</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;3.0&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.5</span><span class="o">+</span><span class="mi">0j</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">((</span><span class="mf">1.5</span><span class="o">+</span><span class="mi">0j</span><span class="p">),</span> <span class="n">da</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.25</span><span class="o">+</span><span class="mi">0j</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="mf">0.25</span><span class="o">+</span><span class="mi">0j</span><span class="p">),</span> <span class="n">da</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="mf">3.0</span><span class="o">+</span><span class="mi">0j</span><span class="p">),</span> <span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="p">(</span><span class="mf">3.0</span><span class="o">+</span><span class="mi">0j</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="p">(</span><span class="mf">3.0</span><span class="o">+</span><span class="mi">1j</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">((</span><span class="mf">3.0</span><span class="o">+</span><span class="mi">1j</span><span class="p">),</span> <span class="n">db</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">__lt__</span><span class="p">(</span><span class="mf">3.0</span><span class="o">+</span><span class="mi">0j</span><span class="p">),</span> <span class="bp">NotImplemented</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">__le__</span><span class="p">(</span><span class="mf">3.0</span><span class="o">+</span><span class="mi">0j</span><span class="p">),</span> <span class="bp">NotImplemented</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">__gt__</span><span class="p">(</span><span class="mf">3.0</span><span class="o">+</span><span class="mi">0j</span><span class="p">),</span> <span class="bp">NotImplemented</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">__le__</span><span class="p">(</span><span class="mf">3.0</span><span class="o">+</span><span class="mi">0j</span><span class="p">),</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_decimal_fraction_comparison"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_decimal_fraction_comparison">[docs]</a>    <span class="k">def</span> <span class="nf">test_decimal_fraction_comparison</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">D</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">fractions</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="p">]</span><span class="o">.</span><span class="n">Fraction</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>


        <span class="n">emax</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">MAX_EMAX</span> <span class="k">if</span> <span class="n">C</span> <span class="k">else</span> <span class="mi">999999999</span>
        <span class="n">emin</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">MIN_EMIN</span> <span class="k">if</span> <span class="n">C</span> <span class="k">else</span> <span class="o">-</span><span class="mi">999999999</span>
        <span class="n">etiny</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">MIN_ETINY</span> <span class="k">if</span> <span class="n">C</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1999999997</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">Emax</span><span class="o">=</span><span class="n">emax</span><span class="p">,</span> <span class="n">Emin</span><span class="o">=</span><span class="n">emin</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">emax</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">9999999999999999999999999999999999999</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">9999999999999999999999999999999999999</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="s">&quot;1e&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">etiny</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;-1e&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">etiny</span><span class="p">)),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9999999999999999999999999</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="s">&quot;1e&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">etiny</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;-1e&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">etiny</span><span class="p">)),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9999999999999999999999999</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;0.1&quot;</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="s">&quot;0.1&quot;</span><span class="p">))</span>

            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">300</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertLessEqual</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="mi">120984237</span><span class="p">,</span> <span class="mi">9999999999</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="s">&quot;9e&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">emax</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertGreaterEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;9e&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">emax</span><span class="p">)),</span> <span class="n">F</span><span class="p">(</span><span class="mi">120984237</span><span class="p">,</span> <span class="mi">9999999999</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;inf&#39;</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">99999999999</span><span class="p">,</span><span class="mi">123</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;inf&#39;</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">99999999999</span><span class="p">,</span><span class="mi">123</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">99999999999</span><span class="p">,</span><span class="mi">123</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">99999999999</span><span class="p">,</span><span class="mi">123</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">__gt__</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="mi">123</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="bp">NotImplemented</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="mi">123</span><span class="p">)</span><span class="o">.</span><span class="n">__lt__</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="mi">123</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="mi">123</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_copy_and_deepcopy_methods"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_copy_and_deepcopy_methods">[docs]</a>    <span class="k">def</span> <span class="nf">test_copy_and_deepcopy_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;43.24&#39;</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
        <span class="n">dc</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">dc</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_hash_method"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_hash_method">[docs]</a>    <span class="k">def</span> <span class="nf">test_hash_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="k">def</span> <span class="nf">hashit</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">__hash__</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">a</span>

        <span class="c">#just that it&#39;s hashable</span>
        <span class="n">hashit</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span>
        <span class="n">hashit</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;Infinity&#39;</span><span class="p">))</span>
        <span class="n">hashit</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-Infinity&#39;</span><span class="p">))</span>
        <span class="n">hashit</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;nan123&#39;</span><span class="p">))</span>
        <span class="n">hashit</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-NaN&#39;</span><span class="p">))</span>

        <span class="n">test_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">Decimal</span><span class="p">(</span><span class="n">sign</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">m</span> <span class="o">+</span> <span class="n">n</span><span class="p">))</span>
                       <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span>
                                 <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">]</span>
                       <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
                       <span class="k">for</span> <span class="n">sign</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
        <span class="n">test_values</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-1&quot;</span><span class="p">),</span> <span class="c"># ==&gt; -2</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-0&quot;</span><span class="p">),</span> <span class="c"># zeros</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;0.00&quot;</span><span class="p">),</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-0.000&quot;</span><span class="p">),</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;0E10&quot;</span><span class="p">),</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-0E12&quot;</span><span class="p">),</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;10.0&quot;</span><span class="p">),</span> <span class="c"># negative exponent</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-23.00000&quot;</span><span class="p">),</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1230E100&quot;</span><span class="p">),</span> <span class="c"># positive exponent</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-4.5678E50&quot;</span><span class="p">),</span>
                <span class="c"># a value for which hash(n) != hash(n % (2**64-1))</span>
                <span class="c"># in Python pre-2.6</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">64</span> <span class="o">+</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
                <span class="c"># selection of values which fail with the old (before</span>
                <span class="c"># version 2.6) long.__hash__</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.634E100&quot;</span><span class="p">),</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;90.697E100&quot;</span><span class="p">),</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;188.83E100&quot;</span><span class="p">),</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1652.9E100&quot;</span><span class="p">),</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;56531E100&quot;</span><span class="p">),</span>
                <span class="p">])</span>

        <span class="c"># check that hash(d) == hash(int(d)) for integral values</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">test_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">hashit</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">hashit</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)))</span>

        <span class="c">#the same hash that to an int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">hashit</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">23</span><span class="p">)),</span> <span class="n">hashit</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">hash</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">hashit</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;Inf&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">hashit</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-Inf&#39;</span><span class="p">)))</span>

        <span class="c"># check that the hashes of a Decimal float match when they</span>
        <span class="c"># represent exactly the same values</span>
        <span class="n">test_strings</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;inf&#39;</span><span class="p">,</span> <span class="s">&#39;-Inf&#39;</span><span class="p">,</span> <span class="s">&#39;0.0&#39;</span><span class="p">,</span> <span class="s">&#39;-.0e1&#39;</span><span class="p">,</span>
                        <span class="s">&#39;34.0&#39;</span><span class="p">,</span> <span class="s">&#39;2.5&#39;</span><span class="p">,</span> <span class="s">&#39;112390.625&#39;</span><span class="p">,</span> <span class="s">&#39;-0.515625&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">test_strings</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">hashit</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">hashit</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="c"># check that the value of the hash doesn&#39;t depend on the</span>
            <span class="c"># current context (issue #1757)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;123456789.1&quot;</span><span class="p">)</span>

            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">6</span>
            <span class="n">h1</span> <span class="o">=</span> <span class="n">hashit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">h2</span> <span class="o">=</span> <span class="n">hashit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">16</span>
            <span class="n">h3</span> <span class="o">=</span> <span class="n">hashit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h3</span><span class="p">)</span>

            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">10000</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mi">1100</span> <span class="o">**</span> <span class="mi">1248</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">hashit</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">hashit</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_min_and_max_methods"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_min_and_max_methods">[docs]</a>    <span class="k">def</span> <span class="nf">test_min_and_max_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">d1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;15.32&#39;</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;28.5&#39;</span><span class="p">)</span>
        <span class="n">l1</span> <span class="o">=</span> <span class="mi">15</span>
        <span class="n">l2</span> <span class="o">=</span> <span class="mi">28</span>

        <span class="c">#between Decimals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span><span class="n">d2</span><span class="p">),</span> <span class="n">d1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span><span class="n">d1</span><span class="p">),</span> <span class="n">d1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span><span class="n">d2</span><span class="p">),</span> <span class="n">d2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span><span class="n">d1</span><span class="p">),</span> <span class="n">d2</span><span class="p">)</span>

        <span class="c">#between Decimal and int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span><span class="n">l2</span><span class="p">),</span> <span class="n">d1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span><span class="n">d1</span><span class="p">),</span> <span class="n">d1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span><span class="n">d2</span><span class="p">),</span> <span class="n">d2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span><span class="n">l1</span><span class="p">),</span> <span class="n">d2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_as_nonzero"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_as_nonzero">[docs]</a>    <span class="k">def</span> <span class="nf">test_as_nonzero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="c">#as false</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="c">#as true</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;0.372&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_tostring_methods"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_tostring_methods">[docs]</a>    <span class="k">def</span> <span class="nf">test_tostring_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#Test str and repr methods.</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;15.32&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&#39;15.32&#39;</span><span class="p">)</span>               <span class="c"># str</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s">&quot;Decimal(&#39;15.32&#39;)&quot;</span><span class="p">)</span>   <span class="c"># repr</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_tonum_methods"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_tonum_methods">[docs]</a>    <span class="k">def</span> <span class="nf">test_tonum_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#Test float and int methods.</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">d1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;66&#39;</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;15.32&#39;</span><span class="p">)</span>

        <span class="c">#int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">d1</span><span class="p">),</span> <span class="mi">66</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">d2</span><span class="p">),</span> <span class="mi">15</span><span class="p">)</span>

        <span class="c">#float</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">d1</span><span class="p">),</span> <span class="mi">66</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">d2</span><span class="p">),</span> <span class="mf">15.32</span><span class="p">)</span>

        <span class="c">#floor</span>
        <span class="n">test_pairs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;123.00&#39;</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;3.2&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;3.54&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;3.899&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;-2.3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;-11.0&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;0.0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;-0E3&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;89891211712379812736.1&#39;</span><span class="p">,</span> <span class="mi">89891211712379812736</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">test_pairs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">d</span><span class="p">)),</span> <span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-NaN&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;NaN123&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;Inf&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-Inf&#39;</span><span class="p">))</span>

        <span class="c">#ceiling</span>
        <span class="n">test_pairs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;123.00&#39;</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;3.2&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;3.54&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;3.899&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;-2.3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;-11.0&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;0.0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;-0E3&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;89891211712379812736.1&#39;</span><span class="p">,</span> <span class="mi">89891211712379812737</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">test_pairs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">d</span><span class="p">)),</span> <span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-NaN&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;NaN123&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;Inf&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-Inf&#39;</span><span class="p">))</span>

        <span class="c">#round, single argument</span>
        <span class="n">test_pairs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;123.00&#39;</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;3.2&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;3.54&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;3.899&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;-2.3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;-11.0&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;0.0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;-0E3&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;-3.5&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;-2.5&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;-1.5&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;-0.5&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;0.5&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;1.5&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;2.5&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;3.5&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">test_pairs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">d</span><span class="p">)),</span> <span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">round</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-NaN&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">round</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">round</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;NaN123&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="nb">round</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;Inf&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="nb">round</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-Inf&#39;</span><span class="p">))</span>

        <span class="c">#round, two arguments;  this is essentially equivalent</span>
        <span class="c">#to quantize, which is already extensively tested</span>
        <span class="n">test_triples</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;123.456&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="s">&#39;0E+4&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;123.456&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="s">&#39;0E+3&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;123.456&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;1E+2&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;123.456&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;1.2E+2&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;123.456&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;123&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;123.456&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;123.5&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;123.456&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;123.46&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;123.456&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;123.456&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;123.456&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;123.4560&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;123.455&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;123.46&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;123.445&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;123.44&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;Inf&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;NaN&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;-Inf&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="s">&#39;NaN&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;sNaN314&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;NaN314&#39;</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">test_triples</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">n</span><span class="p">)),</span> <span class="n">r</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_nan_to_float"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_nan_to_float">[docs]</a>    <span class="k">def</span> <span class="nf">test_nan_to_float</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test conversions of decimal NANs to float.</span>
        <span class="c"># See http://bugs.python.org/issue15544</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">,</span> <span class="s">&#39;nan1234&#39;</span><span class="p">,</span> <span class="s">&#39;-nan&#39;</span><span class="p">,</span> <span class="s">&#39;-nan2468&#39;</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">copysign</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="mf">1.0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_snan_to_float"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_snan_to_float">[docs]</a>    <span class="k">def</span> <span class="nf">test_snan_to_float</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;snan&#39;</span><span class="p">,</span> <span class="s">&#39;-snan&#39;</span><span class="p">,</span> <span class="s">&#39;snan1357&#39;</span><span class="p">,</span> <span class="s">&#39;-snan1234&#39;</span><span class="p">):</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_eval_round_trip"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_eval_round_trip">[docs]</a>    <span class="k">def</span> <span class="nf">test_eval_round_trip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="c">#with zero</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span>

        <span class="c">#int</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span>

        <span class="c">#float</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span>

        <span class="c">#weird</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">25</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_as_tuple"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_as_tuple">[docs]</a>    <span class="k">def</span> <span class="nf">test_as_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="c">#with zero</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span>

        <span class="c">#int</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span>

        <span class="c">#complicated string</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-4.34913534E-17&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">25</span><span class="p">)</span> <span class="p">)</span>

        <span class="c"># The &#39;0&#39; coefficient is implementation specific to decimal.py.</span>
        <span class="c"># It has no meaning in the C-version and is ignored there.</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;Infinity&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="s">&#39;F&#39;</span><span class="p">)</span> <span class="p">)</span>

        <span class="c">#leading zeros in coefficient should be stripped</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">37</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="mi">37</span><span class="p">))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(),</span> <span class="mi">37</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="mi">37</span><span class="p">))</span>

        <span class="c">#leading zeros in NaN diagnostic info should be stripped</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s">&#39;n&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s">&#39;n&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s">&#39;N&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(),</span> <span class="s">&#39;N&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(),</span> <span class="s">&#39;n&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(),</span> <span class="s">&#39;n&#39;</span><span class="p">)</span> <span class="p">)</span>

        <span class="c"># For infinities, decimal.py has always silently accepted any</span>
        <span class="c"># coefficient tuple.</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="s">&#39;F&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="s">&#39;F&#39;</span><span class="p">))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s">&#39;F&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="s">&#39;F&#39;</span><span class="p">))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s">&#39;F&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="s">&#39;F&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_subclassing"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_subclassing">[docs]</a>    <span class="k">def</span> <span class="nf">test_subclassing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Different behaviours when subclassing Decimal</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="k">class</span> <span class="nc">MyDecimal</span><span class="p">(</span><span class="n">Decimal</span><span class="p">):</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="n">d1</span> <span class="o">=</span> <span class="n">MyDecimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">MyDecimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">+</span> <span class="n">d2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">d1</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">MyDecimal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">MyDecimal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>

        <span class="c"># Decimal(Decimal)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.0&#39;</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

        <span class="c"># MyDecimal(Decimal)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MyDecimal</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">MyDecimal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="c"># Decimal(MyDecimal)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

        <span class="c"># MyDecimal(MyDecimal)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">9</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">MyDecimal</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">MyDecimal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_implicit_context"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_implicit_context">[docs]</a>    <span class="k">def</span> <span class="nf">test_implicit_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">getcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span>

        <span class="c"># Check results when context given implicitly.  (Issue 2478)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()),</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">))))</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_none_args"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_none_args">[docs]</a>    <span class="k">def</span> <span class="nf">test_none_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">DivisionByZero</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">DivisionByZero</span>
        <span class="n">Overflow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Overflow</span>
        <span class="n">Underflow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Underflow</span>
        <span class="n">Subnormal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Subnormal</span>
        <span class="n">Inexact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Inexact</span>
        <span class="n">Rounded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Rounded</span>
        <span class="n">Clamped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Clamped</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">(</span><span class="n">Context</span><span class="p">())</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">7</span>
            <span class="n">c</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="mi">999</span>
            <span class="n">c</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;111&quot;</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1e9999&quot;</span><span class="p">)</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1e-9999&quot;</span><span class="p">)</span>

            <span class="c">##### Unary functions</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)),</span> <span class="s">&#39;1.609487E+48&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Inexact</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Rounded</span><span class="p">])</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">is_normal</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">),</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">is_subnormal</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">),</span> <span class="bp">True</span><span class="p">)</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)),</span> <span class="s">&#39;4.709530&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Inexact</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Rounded</span><span class="p">])</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ln</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)),</span> <span class="s">&#39;2.045323&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Inexact</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Rounded</span><span class="p">])</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">log10</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">logb</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)),</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">DivisionByZero</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">logb</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">DivisionByZero</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">logical_invert</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)),</span> <span class="s">&#39;1111000&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">logical_invert</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">next_minus</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)),</span> <span class="s">&#39;9.999999E+999&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">next_minus</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">next_plus</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)),</span> <span class="s">&#39;Infinity&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">next_plus</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)),</span> <span class="s">&#39;0&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">normalize</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">number_class</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)),</span> <span class="s">&#39;+Subnormal&#39;</span><span class="p">)</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)),</span> <span class="s">&#39;0E-1005&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Clamped</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Inexact</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Rounded</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Subnormal</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Underflow</span><span class="p">])</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">sqrt</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">capitals</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">to_eng_string</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)),</span> <span class="s">&#39;1e-9999&#39;</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">capitals</span> <span class="o">=</span> <span class="mi">1</span>


            <span class="c">##### Binary functions</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;Nan891287828&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;NaN1287828&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">compare</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">compare_signal</span><span class="p">(</span><span class="mi">8224</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;-1&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">compare_signal</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;NaN&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;101&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">logical_and</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;111&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">logical_or</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;111&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">max_mag</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;111&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">max_mag</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;101&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">min_mag</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;101&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">min_mag</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">remainder_near</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">remainder_near</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;11100&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">rotate</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">scaleb</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;1.11E+9&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">scaleb</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;11100&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>


            <span class="c">##### Ternary functions</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;225&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">fma</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1e9999&#39;</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">])</span>


            <span class="c">##### Special cases</span>
            <span class="n">c</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">ROUND_HALF_EVEN</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral</span><span class="p">(</span><span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">ROUND_DOWN</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral</span><span class="p">(</span><span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">)</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral</span><span class="p">(</span><span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_UP</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">ROUND_HALF_EVEN</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">(</span><span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">ROUND_DOWN</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">(</span><span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">)</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">(</span><span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_UP</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">ROUND_HALF_EVEN</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">(</span><span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">ROUND_DOWN</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">(</span><span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">)</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">(</span><span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_UP</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;sNaN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">ROUND_UP</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.50001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1e-3&#39;</span><span class="p">),</span> <span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;1.501&#39;</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">ROUND_DOWN</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.50001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1e-3&#39;</span><span class="p">),</span> <span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;1.500&#39;</span><span class="p">)</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.50001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1e-3&#39;</span><span class="p">),</span> <span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_UP</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="s">&#39;1.501&#39;</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">quantize</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1e-10&#39;</span><span class="p">),</span> <span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_UP</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">(</span><span class="n">Context</span><span class="p">())</span> <span class="k">as</span> <span class="n">context</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">7</span>
            <span class="n">context</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="mi">999</span>
            <span class="n">context</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
            <span class="k">with</span> <span class="n">localcontext</span><span class="p">(</span><span class="n">ctx</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emax</span><span class="p">,</span> <span class="mi">999</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emin</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="UsabilityTest.test_conversions_from_int"><a class="viewcode-back" href="../../test.html#test.test_decimal.UsabilityTest.test_conversions_from_int">[docs]</a>    <span class="k">def</span> <span class="nf">test_conversions_from_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Check that methods taking a second Decimal argument will</span>
        <span class="c"># always accept an integer in place of a Decimal.</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">compare_signal</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">compare_signal</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">compare_total</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">compare_total</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">compare_total_mag</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">compare_total_mag</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10101</span><span class="p">)</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="mi">1001</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">10101</span><span class="p">)</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1001</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10101</span><span class="p">)</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="mi">1001</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">10101</span><span class="p">)</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1001</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10101</span><span class="p">)</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">(</span><span class="mi">1001</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">10101</span><span class="p">)</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1001</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">567</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">123</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">567</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">123</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">567</span><span class="p">)</span><span class="o">.</span><span class="n">max_mag</span><span class="p">(</span><span class="mi">123</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">567</span><span class="p">)</span><span class="o">.</span><span class="n">max_mag</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">123</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">567</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">123</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">567</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">123</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">567</span><span class="p">)</span><span class="o">.</span><span class="n">min_mag</span><span class="p">(</span><span class="mi">123</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">567</span><span class="p">)</span><span class="o">.</span><span class="n">min_mag</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">123</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">567</span><span class="p">)</span><span class="o">.</span><span class="n">next_toward</span><span class="p">(</span><span class="mi">123</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">567</span><span class="p">)</span><span class="o">.</span><span class="n">next_toward</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">123</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">100</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">768</span><span class="p">)</span><span class="o">.</span><span class="n">remainder_near</span><span class="p">(</span><span class="mi">1234</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">768</span><span class="p">)</span><span class="o">.</span><span class="n">remainder_near</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1234</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span><span class="o">.</span><span class="n">same_quantum</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span><span class="o">.</span><span class="n">same_quantum</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1000</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;9.123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">scaleb</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;9.123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">scaleb</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">456</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="mi">456</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span> <span class="mi">67</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">67</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mi">67</span><span class="p">),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">67</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">67</span><span class="p">)),</span>
                         <span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">67</span><span class="p">)))</span>
</div></div>
<div class="viewcode-block" id="CUsabilityTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.CUsabilityTest">[docs]</a><span class="k">class</span> <span class="nc">CUsabilityTest</span><span class="p">(</span><span class="n">UsabilityTest</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">C</span></div>
<div class="viewcode-block" id="PyUsabilityTest"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyUsabilityTest">[docs]</a><span class="k">class</span> <span class="nc">PyUsabilityTest</span><span class="p">(</span><span class="n">UsabilityTest</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">P</span>
</div>
<div class="viewcode-block" id="PythonAPItests"><a class="viewcode-back" href="../../test.html#test.test_decimal.PythonAPItests">[docs]</a><span class="k">class</span> <span class="nc">PythonAPItests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="PythonAPItests.test_abc"><a class="viewcode-back" href="../../test.html#test.test_decimal.PythonAPItests.test_abc">[docs]</a>    <span class="k">def</span> <span class="nf">test_abc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">Decimal</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">Decimal</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Real</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PythonAPItests.test_pickle"><a class="viewcode-back" href="../../test.html#test.test_decimal.PythonAPItests.test_pickle">[docs]</a>    <span class="k">def</span> <span class="nf">test_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">savedecimal</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span>

        <span class="c"># Round trip</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-3.141590000&#39;</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">C</span><span class="p">:</span>
            <span class="c"># Test interchangeability</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-3.123e81723&#39;</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-3.123e81723&#39;</span><span class="p">)</span>

            <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span>
            <span class="n">sx</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">sx</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">Decimal</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

            <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span>
            <span class="n">sy</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">sy</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">Decimal</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

            <span class="n">x</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-3.123e81723&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-3.123e81723&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()</span>

            <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span>
            <span class="n">sx</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">sx</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">DecimalTuple</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

            <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span>
            <span class="n">sy</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">sy</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecimalTuple</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

        <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">savedecimal</span>
</div>
<div class="viewcode-block" id="PythonAPItests.test_int"><a class="viewcode-back" href="../../test.html#test.test_decimal.PythonAPItests.test_int">[docs]</a>    <span class="k">def</span> <span class="nf">test_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%0.2f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span>
            <span class="c"># should work the same as for floats</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
            <span class="c"># should work the same as to_integral in the ROUND_DOWN mode</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">to_integral</span><span class="p">(</span><span class="n">ROUND_DOWN</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">)),</span> <span class="n">r</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-nan&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;snan&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;inf&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="PythonAPItests.test_trunc"><a class="viewcode-back" href="../../test.html#test.test_decimal.PythonAPItests.test_trunc">[docs]</a>    <span class="k">def</span> <span class="nf">test_trunc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%0.2f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span>
            <span class="c"># should work the same as for floats</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
            <span class="c"># should work the same as to_integral in the ROUND_DOWN mode</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">to_integral</span><span class="p">(</span><span class="n">ROUND_DOWN</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">d</span><span class="p">)),</span> <span class="n">r</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PythonAPItests.test_from_float"><a class="viewcode-back" href="../../test.html#test.test_decimal.PythonAPItests.test_from_float">[docs]</a>    <span class="k">def</span> <span class="nf">test_from_float</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="k">class</span> <span class="nc">MyDecimal</span><span class="p">(</span><span class="n">Decimal</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">MyDecimal</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">))</span>

        <span class="n">r</span> <span class="o">=</span> <span class="n">MyDecimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="n">MyDecimal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">),</span>
                <span class="s">&#39;0.1000000000000000055511151231257827021181583404541015625&#39;</span><span class="p">)</span>
        <span class="n">bigint</span> <span class="o">=</span> <span class="mi">12345678901234567890123456789</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">MyDecimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="n">bigint</span><span class="p">),</span> <span class="n">MyDecimal</span><span class="p">(</span><span class="n">bigint</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">MyDecimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">is_qnan</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">MyDecimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;inf&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">MyDecimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">MyDecimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">))),</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;NaN&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">MyDecimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;inf&#39;</span><span class="p">))),</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;Infinity&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">MyDecimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">))),</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-Infinity&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">MyDecimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">,</span> <span class="s">&#39;abc&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">expovariate</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">MyDecimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span> <span class="c"># roundtrip</span>
</div>
<div class="viewcode-block" id="PythonAPItests.test_create_decimal_from_float"><a class="viewcode-back" href="../../test.html#test.test_decimal.PythonAPItests.test_create_decimal_from_float">[docs]</a>    <span class="k">def</span> <span class="nf">test_create_decimal_from_float</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">Inexact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Inexact</span>

        <span class="n">context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_DOWN</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">create_decimal_from_float</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
            <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;3.1415&#39;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_UP</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">create_decimal_from_float</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
            <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;3.1416&#39;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">traps</span><span class="o">=</span><span class="p">[</span><span class="n">Inexact</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span>
            <span class="n">Inexact</span><span class="p">,</span>
            <span class="n">context</span><span class="o">.</span><span class="n">create_decimal_from_float</span><span class="p">,</span>
            <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">create_decimal_from_float</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0</span><span class="p">)),</span>
                         <span class="s">&quot;Decimal(&#39;-0&#39;)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">create_decimal_from_float</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)),</span>
                         <span class="s">&quot;Decimal(&#39;1&#39;)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">create_decimal_from_float</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span>
                         <span class="s">&quot;Decimal(&#39;10&#39;)&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PythonAPItests.test_quantize"><a class="viewcode-back" href="../../test.html#test.test_decimal.PythonAPItests.test_quantize">[docs]</a>    <span class="k">def</span> <span class="nf">test_quantize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">Emax</span><span class="o">=</span><span class="mi">99999</span><span class="p">,</span> <span class="n">Emin</span><span class="o">=-</span><span class="mi">99999</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;7.335&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;.01&#39;</span><span class="p">)),</span>
            <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;7.34&#39;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;7.335&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;.01&#39;</span><span class="p">),</span> <span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_DOWN</span><span class="p">),</span>
            <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;7.33&#39;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span>
            <span class="n">InvalidOperation</span><span class="p">,</span>
            <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;10e99999&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1e100000&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="n">c</span>
        <span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;0.871831e800&quot;</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1e797&quot;</span><span class="p">),</span> <span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_DOWN</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;8.71E+799&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="PythonAPItests.test_complex"><a class="viewcode-back" href="../../test.html#test.test_decimal.PythonAPItests.test_complex">[docs]</a>    <span class="k">def</span> <span class="nf">test_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;9.8182731e181273&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(),</span> <span class="n">x</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">complex</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&#39;real&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&#39;imag&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&#39;conjugate&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&#39;__complex__&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PythonAPItests.test_named_parameters"><a class="viewcode-back" href="../../test.html#test.test_decimal.PythonAPItests.test_named_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">test_named_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">D</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">Overflow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Overflow</span>

        <span class="n">xc</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">xc</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">xc</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">xc</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">xc</span><span class="p">),</span> <span class="mi">9</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="mi">9</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">9</span><span class="p">),</span> <span class="mi">9</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">xc</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="s">&quot;xyz&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">xc</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">xc</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="mi">7</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">xc</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">])</span>

            <span class="n">xc</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="s">&#39;0.7&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ln</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">xc</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">next_minus</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">next_plus</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="s">&#39;-0.9&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;9.73&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="s">&#39;1E+1&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;9999&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="mi">9999</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;-2000&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="o">-</span><span class="mi">2000</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;123&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="mi">123</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;0.0625&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="s">&#39;0.2&#39;</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;0.0625&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">xc</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                              <span class="n">D</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">compare_signal</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">xc</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;0.0101&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="s">&#39;0.0&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;0.0101&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="s">&#39;0.0&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;0.2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max_mag</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;-0.3&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span>
                             <span class="n">D</span><span class="p">(</span><span class="s">&#39;-0.3&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;0.02&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;-0.03&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="s">&#39;-0.0&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;0.02&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">min_mag</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;-0.03&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span>
                             <span class="n">D</span><span class="p">(</span><span class="s">&#39;0.0&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;0.2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">next_toward</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;-1&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="s">&#39;0.1&#39;</span><span class="p">))</span>
            <span class="n">xc</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                              <span class="n">D</span><span class="p">(</span><span class="s">&quot;0.2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="s">&#39;1e10&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">xc</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;9.99&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">remainder_near</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;1.5&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span>
                             <span class="n">D</span><span class="p">(</span><span class="s">&#39;-0.5&#39;</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;9.9&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="n">third</span><span class="o">=</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;0.9&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="mi">7</span><span class="p">),</span>
                             <span class="n">D</span><span class="p">(</span><span class="s">&#39;7E+1&#39;</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_canonical</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_finite</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_nan</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_qnan</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_snan</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_signed</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_normal</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_subnormal</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">adjusted</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">radix</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="o">-</span><span class="mi">111</span><span class="p">)</span><span class="o">.</span><span class="n">logb</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">logical_invert</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;0.01&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">number_class</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="s">&#39;+Subnormal&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;0.21&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_eng_string</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="s">&#39;0.21&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;10&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;10&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;01&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;10&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;23&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;23&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">xc</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span>
                              <span class="n">D</span><span class="p">(</span><span class="s">&#39;23&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">scaleb</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">xc</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&#39;23&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="o">.</span><span class="n">from_float</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">canonical</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="s">&quot;-1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="s">&quot;-1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">copy_negate</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">xc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">canonical</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">canonical</span><span class="p">,</span> <span class="n">xyz</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PythonAPItests.test_exception_hierarchy"><a class="viewcode-back" href="../../test.html#test.test_decimal.PythonAPItests.test_exception_hierarchy">[docs]</a>    <span class="k">def</span> <span class="nf">test_exception_hierarchy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span>
        <span class="n">DecimalException</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">DecimalException</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">FloatOperation</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">FloatOperation</span>
        <span class="n">DivisionByZero</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">DivisionByZero</span>
        <span class="n">Overflow</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Overflow</span>
        <span class="n">Underflow</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Underflow</span>
        <span class="n">Subnormal</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Subnormal</span>
        <span class="n">Inexact</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Inexact</span>
        <span class="n">Rounded</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Rounded</span>
        <span class="n">Clamped</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Clamped</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">DecimalException</span><span class="p">,</span> <span class="ne">ArithmeticError</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">DecimalException</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">FloatOperation</span><span class="p">,</span> <span class="n">DecimalException</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">FloatOperation</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">DivisionByZero</span><span class="p">,</span> <span class="n">DecimalException</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">DivisionByZero</span><span class="p">,</span> <span class="ne">ZeroDivisionError</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span> <span class="n">Rounded</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span> <span class="n">Inexact</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span> <span class="n">DecimalException</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">Underflow</span><span class="p">,</span> <span class="n">Inexact</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">Underflow</span><span class="p">,</span> <span class="n">Rounded</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">Underflow</span><span class="p">,</span> <span class="n">Subnormal</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">Underflow</span><span class="p">,</span> <span class="n">DecimalException</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">Subnormal</span><span class="p">,</span> <span class="n">DecimalException</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">Inexact</span><span class="p">,</span> <span class="n">DecimalException</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">Rounded</span><span class="p">,</span> <span class="n">DecimalException</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">Clamped</span><span class="p">,</span> <span class="n">DecimalException</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">ConversionSyntax</span><span class="p">,</span> <span class="n">InvalidOperation</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">DivisionImpossible</span><span class="p">,</span> <span class="n">InvalidOperation</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">DivisionUndefined</span><span class="p">,</span> <span class="n">InvalidOperation</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">DivisionUndefined</span><span class="p">,</span> <span class="ne">ZeroDivisionError</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidContext</span><span class="p">,</span> <span class="n">InvalidOperation</span><span class="p">))</span>
</div></div>
<div class="viewcode-block" id="CPythonAPItests"><a class="viewcode-back" href="../../test.html#test.test_decimal.CPythonAPItests">[docs]</a><span class="k">class</span> <span class="nc">CPythonAPItests</span><span class="p">(</span><span class="n">PythonAPItests</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">C</span></div>
<div class="viewcode-block" id="PyPythonAPItests"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyPythonAPItests">[docs]</a><span class="k">class</span> <span class="nc">PyPythonAPItests</span><span class="p">(</span><span class="n">PythonAPItests</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">P</span>
</div>
<div class="viewcode-block" id="ContextAPItests"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests">[docs]</a><span class="k">class</span> <span class="nc">ContextAPItests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="ContextAPItests.test_none_args"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_none_args">[docs]</a>    <span class="k">def</span> <span class="nf">test_none_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">DivisionByZero</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">DivisionByZero</span>
        <span class="n">Overflow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Overflow</span>

        <span class="n">c1</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Emax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Emin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                     <span class="n">capitals</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">clamp</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">traps</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">rounding</span><span class="p">,</span> <span class="n">ROUND_HALF_EVEN</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emax</span><span class="p">,</span> <span class="mi">999999</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emin</span><span class="p">,</span> <span class="o">-</span><span class="mi">999999</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">capitals</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">clamp</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">assert_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;flags&#39;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">assert_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;traps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">DivisionByZero</span><span class="p">,</span>
                                              <span class="n">Overflow</span><span class="p">])</span>
</div>
    <span class="nd">@cpython_only</span>
<div class="viewcode-block" id="ContextAPItests.test_from_legacy_strings"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_from_legacy_strings">[docs]</a>    <span class="k">def</span> <span class="nf">test_from_legacy_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">_testcapi</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">rnd</span> <span class="ow">in</span> <span class="n">RoundingModes</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">_testcapi</span><span class="o">.</span><span class="n">unicode_legacy_string</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">rounding</span><span class="p">,</span> <span class="n">rnd</span><span class="p">)</span>

        <span class="n">s</span> <span class="o">=</span> <span class="n">_testcapi</span><span class="o">.</span><span class="n">unicode_legacy_string</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;rounding&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

        <span class="n">s</span> <span class="o">=</span> <span class="n">_testcapi</span><span class="o">.</span><span class="n">unicode_legacy_string</span><span class="p">(</span><span class="s">&#39;ROUND_</span><span class="se">\x00</span><span class="s">UP&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;rounding&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_pickle"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_pickle">[docs]</a>    <span class="k">def</span> <span class="nf">test_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">savedecimal</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span>

        <span class="c"># Round trip</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">prec</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emin</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">Emin</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emax</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">Emax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">rounding</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">rounding</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">capitals</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">capitals</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">clamp</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">clamp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">traps</span><span class="p">)</span>

        <span class="c"># Test interchangeability</span>
        <span class="n">combinations</span> <span class="o">=</span> <span class="p">[(</span><span class="n">C</span><span class="p">,</span> <span class="n">P</span><span class="p">),</span> <span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">C</span><span class="p">)]</span> <span class="k">if</span> <span class="n">C</span> <span class="k">else</span> <span class="p">[(</span><span class="n">P</span><span class="p">,</span> <span class="n">P</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">dumper</span><span class="p">,</span> <span class="n">loader</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ri</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">RoundingModes</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">fi</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">OrderedSignals</span><span class="p">[</span><span class="n">dumper</span><span class="p">]):</span>
                    <span class="k">for</span> <span class="n">ti</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">OrderedSignals</span><span class="p">[</span><span class="n">dumper</span><span class="p">]):</span>

                        <span class="n">prec</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
                        <span class="n">emin</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="n">emax</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
                        <span class="n">caps</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                        <span class="n">clamp</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

                        <span class="c"># One module dumps</span>
                        <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dumper</span>
                        <span class="n">c</span> <span class="o">=</span> <span class="n">dumper</span><span class="o">.</span><span class="n">Context</span><span class="p">(</span>
                              <span class="n">prec</span><span class="o">=</span><span class="n">prec</span><span class="p">,</span> <span class="n">Emin</span><span class="o">=</span><span class="n">emin</span><span class="p">,</span> <span class="n">Emax</span><span class="o">=</span><span class="n">emax</span><span class="p">,</span>
                              <span class="n">rounding</span><span class="o">=</span><span class="n">RoundingModes</span><span class="p">[</span><span class="n">ri</span><span class="p">],</span>
                              <span class="n">capitals</span><span class="o">=</span><span class="n">caps</span><span class="p">,</span> <span class="n">clamp</span><span class="o">=</span><span class="n">clamp</span><span class="p">,</span>
                              <span class="n">flags</span><span class="o">=</span><span class="n">OrderedSignals</span><span class="p">[</span><span class="n">dumper</span><span class="p">][:</span><span class="n">fi</span><span class="p">],</span>
                              <span class="n">traps</span><span class="o">=</span><span class="n">OrderedSignals</span><span class="p">[</span><span class="n">dumper</span><span class="p">][:</span><span class="n">ti</span><span class="p">]</span>
                        <span class="p">)</span>
                        <span class="n">s</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

                        <span class="c"># The other module loads</span>
                        <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">loader</span>
                        <span class="n">d</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">loader</span><span class="o">.</span><span class="n">Context</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">Emin</span><span class="p">,</span> <span class="n">emin</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">Emax</span><span class="p">,</span> <span class="n">emax</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">rounding</span><span class="p">,</span> <span class="n">RoundingModes</span><span class="p">[</span><span class="n">ri</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">capitals</span><span class="p">,</span> <span class="n">caps</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">clamp</span><span class="p">,</span> <span class="n">clamp</span><span class="p">)</span>
                        <span class="n">assert_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="s">&#39;flags&#39;</span><span class="p">,</span> <span class="n">OrderedSignals</span><span class="p">[</span><span class="n">loader</span><span class="p">][:</span><span class="n">fi</span><span class="p">])</span>
                        <span class="n">assert_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="s">&#39;traps&#39;</span><span class="p">,</span> <span class="n">OrderedSignals</span><span class="p">[</span><span class="n">loader</span><span class="p">][:</span><span class="n">ti</span><span class="p">])</span>

        <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">savedecimal</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_equality_with_other_types"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_equality_with_other_types">[docs]</a>    <span class="k">def</span> <span class="nf">test_equality_with_other_types</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">{}])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">{}])</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_copy"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_copy">[docs]</a>    <span class="k">def</span> <span class="nf">test_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># All copies should be deep</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">flags</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">traps</span><span class="p">))</span>
        <span class="n">k1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">k2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test__clamp"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test__clamp">[docs]</a>    <span class="k">def</span> <span class="nf">test__clamp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># In Python 3.2, the private attribute `_clamp` was made</span>
        <span class="c"># public (issue 8540), with the old `_clamp` becoming a</span>
        <span class="c"># property wrapping `clamp`.  For the duration of Python 3.2</span>
        <span class="c"># only, the attribute should be gettable/settable via both</span>
        <span class="c"># `clamp` and `_clamp`; in Python 3.3, `_clamp` should be</span>
        <span class="c"># removed.</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;_clamp&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_abs"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_abs">[docs]</a>    <span class="k">def</span> <span class="nf">test_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">abs</span><span class="p">,</span> <span class="s">&#39;-1&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_add"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_add">[docs]</a>    <span class="k">def</span> <span class="nf">test_add</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_compare"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_compare">[docs]</a>    <span class="k">def</span> <span class="nf">test_compare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">compare</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">compare</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_compare_signal"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_compare_signal">[docs]</a>    <span class="k">def</span> <span class="nf">test_compare_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compare_signal</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">compare_signal</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">compare_signal</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">compare_signal</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">compare_signal</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">compare_signal</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_compare_total"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_compare_total">[docs]</a>    <span class="k">def</span> <span class="nf">test_compare_total</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compare_total</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">compare_total</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">compare_total</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">compare_total</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">compare_total</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">compare_total</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_compare_total_mag"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_compare_total_mag">[docs]</a>    <span class="k">def</span> <span class="nf">test_compare_total_mag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compare_total_mag</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">compare_total_mag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">compare_total_mag</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">compare_total_mag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">compare_total_mag</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">compare_total_mag</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_copy_abs"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_copy_abs">[docs]</a>    <span class="k">def</span> <span class="nf">test_copy_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">,</span> <span class="s">&#39;-1&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_copy_decimal"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_copy_decimal">[docs]</a>    <span class="k">def</span> <span class="nf">test_copy_decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">copy_decimal</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">copy_decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">copy_decimal</span><span class="p">,</span> <span class="s">&#39;-1&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_copy_negate"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_copy_negate">[docs]</a>    <span class="k">def</span> <span class="nf">test_copy_negate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">copy_negate</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">copy_negate</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">copy_negate</span><span class="p">,</span> <span class="s">&#39;-1&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_copy_sign"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_copy_sign">[docs]</a>    <span class="k">def</span> <span class="nf">test_copy_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">copy_sign</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">copy_sign</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">copy_sign</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">copy_sign</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">copy_sign</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">copy_sign</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;-2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_divide"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_divide">[docs]</a>    <span class="k">def</span> <span class="nf">test_divide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">divide</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">divide</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_divide_int"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_divide_int">[docs]</a>    <span class="k">def</span> <span class="nf">test_divide_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">divide_int</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">divide_int</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">divide_int</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">divide_int</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">divide_int</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">divide_int</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_divmod"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_divmod">[docs]</a>    <span class="k">def</span> <span class="nf">test_divmod</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">divmod</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">divmod</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">divmod</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">divmod</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">divmod</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">divmod</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_exp"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_exp">[docs]</a>    <span class="k">def</span> <span class="nf">test_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_fma"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_fma">[docs]</a>    <span class="k">def</span> <span class="nf">test_fma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">fma</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">fma</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">fma</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;4&#39;</span><span class="p">)</span>

        <span class="c"># Issue 12079 for Context.fma ...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">fma</span><span class="p">,</span>
                          <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;Infinity&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s">&quot;not a decimal&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">fma</span><span class="p">,</span>
                          <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;snan&#39;</span><span class="p">),</span> <span class="mf">1.222</span><span class="p">)</span>
        <span class="c"># ... and for Decimal.fma.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;Infinity&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fma</span><span class="p">,</span>
                          <span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s">&quot;not a decimal&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fma</span><span class="p">,</span>
                          <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;snan&#39;</span><span class="p">),</span> <span class="mf">1.222</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_is_finite"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_is_finite">[docs]</a>    <span class="k">def</span> <span class="nf">test_is_finite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">is_finite</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">is_finite</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">is_finite</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_is_infinite"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_is_infinite">[docs]</a>    <span class="k">def</span> <span class="nf">test_is_infinite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_is_nan"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_is_nan">[docs]</a>    <span class="k">def</span> <span class="nf">test_is_nan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">is_nan</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">is_nan</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">is_nan</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_is_normal"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_is_normal">[docs]</a>    <span class="k">def</span> <span class="nf">test_is_normal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">is_normal</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">is_normal</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">is_normal</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_is_qnan"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_is_qnan">[docs]</a>    <span class="k">def</span> <span class="nf">test_is_qnan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">is_qnan</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">is_qnan</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">is_qnan</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_is_signed"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_is_signed">[docs]</a>    <span class="k">def</span> <span class="nf">test_is_signed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">is_signed</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">is_signed</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">is_signed</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_is_snan"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_is_snan">[docs]</a>    <span class="k">def</span> <span class="nf">test_is_snan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">is_snan</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">is_snan</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">is_snan</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_is_subnormal"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_is_subnormal">[docs]</a>    <span class="k">def</span> <span class="nf">test_is_subnormal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">is_subnormal</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">is_subnormal</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">is_subnormal</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_is_zero"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_is_zero">[docs]</a>    <span class="k">def</span> <span class="nf">test_is_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">is_zero</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">is_zero</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">is_zero</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_ln"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_ln">[docs]</a>    <span class="k">def</span> <span class="nf">test_ln</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">ln</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_log10"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_log10">[docs]</a>    <span class="k">def</span> <span class="nf">test_log10</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">log10</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_logb"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_logb">[docs]</a>    <span class="k">def</span> <span class="nf">test_logb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">logb</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">logb</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">logb</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_logical_and"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_logical_and">[docs]</a>    <span class="k">def</span> <span class="nf">test_logical_and</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">logical_and</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">logical_and</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_logical_invert"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_logical_invert">[docs]</a>    <span class="k">def</span> <span class="nf">test_logical_invert</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">logical_invert</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">logical_invert</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">logical_invert</span><span class="p">,</span> <span class="s">&#39;1000&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_logical_or"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_logical_or">[docs]</a>    <span class="k">def</span> <span class="nf">test_logical_or</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">logical_or</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">logical_or</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_logical_xor"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_logical_xor">[docs]</a>    <span class="k">def</span> <span class="nf">test_logical_xor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_max"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_max">[docs]</a>    <span class="k">def</span> <span class="nf">test_max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_max_mag"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_max_mag">[docs]</a>    <span class="k">def</span> <span class="nf">test_max_mag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">max_mag</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">max_mag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">max_mag</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">max_mag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">max_mag</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">max_mag</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_min"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_min">[docs]</a>    <span class="k">def</span> <span class="nf">test_min</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_min_mag"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_min_mag">[docs]</a>    <span class="k">def</span> <span class="nf">test_min_mag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">min_mag</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">min_mag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">min_mag</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">min_mag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">min_mag</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">min_mag</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_minus"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_minus">[docs]</a>    <span class="k">def</span> <span class="nf">test_minus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">minus</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">minus</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">minus</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_multiply"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_multiply">[docs]</a>    <span class="k">def</span> <span class="nf">test_multiply</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">multiply</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">multiply</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_next_minus"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_next_minus">[docs]</a>    <span class="k">def</span> <span class="nf">test_next_minus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">next_minus</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">next_minus</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">next_minus</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_next_plus"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_next_plus">[docs]</a>    <span class="k">def</span> <span class="nf">test_next_plus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">next_plus</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">next_plus</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">next_plus</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_next_toward"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_next_toward">[docs]</a>    <span class="k">def</span> <span class="nf">test_next_toward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">next_toward</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">next_toward</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">next_toward</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">next_toward</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">next_toward</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">next_toward</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_normalize"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_normalize">[docs]</a>    <span class="k">def</span> <span class="nf">test_normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">normalize</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_number_class"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_number_class">[docs]</a>    <span class="k">def</span> <span class="nf">test_number_class</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">number_class</span><span class="p">(</span><span class="mi">123</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">number_class</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">123</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">number_class</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">number_class</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">number_class</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">number_class</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_plus"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_plus">[docs]</a>    <span class="k">def</span> <span class="nf">test_plus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plus</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">plus</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">plus</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_power"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_power">[docs]</a>    <span class="k">def</span> <span class="nf">test_power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">power</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">power</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;4&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">modulo</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_quantize"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_quantize">[docs]</a>    <span class="k">def</span> <span class="nf">test_quantize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">quantize</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">quantize</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_remainder"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_remainder">[docs]</a>    <span class="k">def</span> <span class="nf">test_remainder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">remainder</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">remainder</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_remainder_near"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_remainder_near">[docs]</a>    <span class="k">def</span> <span class="nf">test_remainder_near</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">remainder_near</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">remainder_near</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">remainder_near</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">remainder_near</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">remainder_near</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">remainder_near</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_rotate"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_rotate">[docs]</a>    <span class="k">def</span> <span class="nf">test_rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">rotate</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">rotate</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_sqrt"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_sqrt">[docs]</a>    <span class="k">def</span> <span class="nf">test_sqrt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">sqrt</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_same_quantum"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_same_quantum">[docs]</a>    <span class="k">def</span> <span class="nf">test_same_quantum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">same_quantum</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">same_quantum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">same_quantum</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">same_quantum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">same_quantum</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">same_quantum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_scaleb"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_scaleb">[docs]</a>    <span class="k">def</span> <span class="nf">test_scaleb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">scaleb</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">scaleb</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">scaleb</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">scaleb</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">scaleb</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">scaleb</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_shift"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_shift">[docs]</a>    <span class="k">def</span> <span class="nf">test_shift</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_subtract"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_subtract">[docs]</a>    <span class="k">def</span> <span class="nf">test_subtract</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">subtract</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">subtract</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_to_eng_string"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_to_eng_string">[docs]</a>    <span class="k">def</span> <span class="nf">test_to_eng_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">to_eng_string</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">to_eng_string</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">to_eng_string</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_to_sci_string"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_to_sci_string">[docs]</a>    <span class="k">def</span> <span class="nf">test_to_sci_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">to_sci_string</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">to_sci_string</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">to_sci_string</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_to_integral_exact"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_to_integral_exact">[docs]</a>    <span class="k">def</span> <span class="nf">test_to_integral_exact</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextAPItests.test_to_integral_value"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextAPItests.test_to_integral_value">[docs]</a>    <span class="k">def</span> <span class="nf">test_to_integral_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="CContextAPItests"><a class="viewcode-back" href="../../test.html#test.test_decimal.CContextAPItests">[docs]</a><span class="k">class</span> <span class="nc">CContextAPItests</span><span class="p">(</span><span class="n">ContextAPItests</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">C</span></div>
<div class="viewcode-block" id="PyContextAPItests"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyContextAPItests">[docs]</a><span class="k">class</span> <span class="nc">PyContextAPItests</span><span class="p">(</span><span class="n">ContextAPItests</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">P</span>
</div>
<div class="viewcode-block" id="ContextWithStatement"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextWithStatement">[docs]</a><span class="k">class</span> <span class="nc">ContextWithStatement</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="c"># Can&#39;t do these as docstrings until Python 2.6</span>
    <span class="c"># as doctest can&#39;t handle __future__ statements</span>

<div class="viewcode-block" id="ContextWithStatement.test_localcontext"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextWithStatement.test_localcontext">[docs]</a>    <span class="k">def</span> <span class="nf">test_localcontext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Use a copy of the current context in the block</span>
        <span class="n">getcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="n">orig_ctx</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">enter_ctx</span><span class="p">:</span>
            <span class="n">set_ctx</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="n">final_ctx</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">orig_ctx</span><span class="p">,</span> <span class="n">final_ctx</span><span class="p">,</span> <span class="s">&#39;did not restore context correctly&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">orig_ctx</span><span class="p">,</span> <span class="n">set_ctx</span><span class="p">,</span> <span class="s">&#39;did not copy the context&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">set_ctx</span><span class="p">,</span> <span class="n">enter_ctx</span><span class="p">,</span> <span class="s">&#39;__enter__ returned wrong context&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextWithStatement.test_localcontextarg"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextWithStatement.test_localcontextarg">[docs]</a>    <span class="k">def</span> <span class="nf">test_localcontextarg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Use a copy of the supplied context in the block</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">getcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>
        <span class="n">orig_ctx</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="n">new_ctx</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">localcontext</span><span class="p">(</span><span class="n">new_ctx</span><span class="p">)</span> <span class="k">as</span> <span class="n">enter_ctx</span><span class="p">:</span>
            <span class="n">set_ctx</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="n">final_ctx</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">orig_ctx</span><span class="p">,</span> <span class="n">final_ctx</span><span class="p">,</span> <span class="s">&#39;did not restore context correctly&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">set_ctx</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="n">new_ctx</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="s">&#39;did not set correct context&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">new_ctx</span><span class="p">,</span> <span class="n">set_ctx</span><span class="p">,</span> <span class="s">&#39;did not copy the context&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">set_ctx</span><span class="p">,</span> <span class="n">enter_ctx</span><span class="p">,</span> <span class="s">&#39;__enter__ returned wrong context&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextWithStatement.test_nested_with_statements"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextWithStatement.test_nested_with_statements">[docs]</a>    <span class="k">def</span> <span class="nf">test_nested_with_statements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Use a copy of the supplied context in the block</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">getcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>
        <span class="n">Clamped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Clamped</span>
        <span class="n">Overflow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Overflow</span>

        <span class="n">orig_ctx</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="n">orig_ctx</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
        <span class="n">new_ctx</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">Emax</span><span class="o">=</span><span class="mi">384</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="n">orig_ctx</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">traps</span><span class="p">,</span> <span class="n">orig_ctx</span><span class="o">.</span><span class="n">traps</span><span class="p">)</span>
            <span class="n">c1</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">Clamped</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">c1</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">383</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">orig_ctx</span><span class="o">.</span><span class="n">Emin</span><span class="p">,</span> <span class="o">-</span><span class="mi">383</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Clamped</span><span class="p">,</span> <span class="n">c1</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">,</span> <span class="s">&#39;0e-999&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Clamped</span><span class="p">])</span>
            <span class="k">with</span> <span class="n">localcontext</span><span class="p">(</span><span class="n">new_ctx</span><span class="p">)</span> <span class="k">as</span> <span class="n">c2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="n">new_ctx</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">traps</span><span class="p">,</span> <span class="n">new_ctx</span><span class="o">.</span><span class="n">traps</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span> <span class="n">c2</span><span class="o">.</span><span class="n">power</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;3.4e200&#39;</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Clamped</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">])</span>
                <span class="k">del</span> <span class="n">c2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">])</span>
            <span class="k">del</span> <span class="n">c1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">orig_ctx</span><span class="o">.</span><span class="n">Emin</span><span class="p">,</span> <span class="o">-</span><span class="mi">383</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">orig_ctx</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Clamped</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">orig_ctx</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">new_ctx</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Clamped</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">new_ctx</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="ContextWithStatement.test_with_statements_gc1"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextWithStatement.test_with_statements_gc1">[docs]</a>    <span class="k">def</span> <span class="nf">test_with_statements_gc1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c1</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">c1</span>
            <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c2</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">c2</span>
                <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c3</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">c3</span>
                    <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c4</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">c4</span>
</div>
<div class="viewcode-block" id="ContextWithStatement.test_with_statements_gc2"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextWithStatement.test_with_statements_gc2">[docs]</a>    <span class="k">def</span> <span class="nf">test_with_statements_gc2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c1</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">localcontext</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span> <span class="k">as</span> <span class="n">c2</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">c1</span>
                <span class="k">with</span> <span class="n">localcontext</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span> <span class="k">as</span> <span class="n">c3</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">c2</span>
                    <span class="k">with</span> <span class="n">localcontext</span><span class="p">(</span><span class="n">c3</span><span class="p">)</span> <span class="k">as</span> <span class="n">c4</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">c3</span>
                        <span class="k">del</span> <span class="n">c4</span>
</div>
<div class="viewcode-block" id="ContextWithStatement.test_with_statements_gc3"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextWithStatement.test_with_statements_gc3">[docs]</a>    <span class="k">def</span> <span class="nf">test_with_statements_gc3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>
        <span class="n">getcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span>
        <span class="n">setcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">setcontext</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c1</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">c1</span>
            <span class="n">n1</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">setcontext</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">localcontext</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="k">as</span> <span class="n">c2</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">n1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">c2</span>
                <span class="n">n2</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">setcontext</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">n2</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">n3</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">setcontext</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">localcontext</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span> <span class="k">as</span> <span class="n">c3</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">n3</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c3</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
                    <span class="k">del</span> <span class="n">c3</span>
                    <span class="n">n4</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
                    <span class="n">setcontext</span><span class="p">(</span><span class="n">n4</span><span class="p">)</span>
                    <span class="k">del</span> <span class="n">n4</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
                    <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c4</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c4</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
                        <span class="k">del</span> <span class="n">c4</span>
</div></div>
<div class="viewcode-block" id="CContextWithStatement"><a class="viewcode-back" href="../../test.html#test.test_decimal.CContextWithStatement">[docs]</a><span class="k">class</span> <span class="nc">CContextWithStatement</span><span class="p">(</span><span class="n">ContextWithStatement</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">C</span></div>
<div class="viewcode-block" id="PyContextWithStatement"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyContextWithStatement">[docs]</a><span class="k">class</span> <span class="nc">PyContextWithStatement</span><span class="p">(</span><span class="n">ContextWithStatement</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">P</span>
</div>
<div class="viewcode-block" id="ContextFlags"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextFlags">[docs]</a><span class="k">class</span> <span class="nc">ContextFlags</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="ContextFlags.test_flags_irrelevant"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextFlags.test_flags_irrelevant">[docs]</a>    <span class="k">def</span> <span class="nf">test_flags_irrelevant</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># check that the result (numeric result + flags raised) of an</span>
        <span class="c"># arithmetic operation doesn&#39;t depend on the current flags</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">Inexact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Inexact</span>
        <span class="n">Rounded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Rounded</span>
        <span class="n">Underflow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Underflow</span>
        <span class="n">Clamped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Clamped</span>
        <span class="n">Subnormal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Subnormal</span>

        <span class="k">def</span> <span class="nf">raise_error</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span> <span class="o">==</span> <span class="n">C</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">flag</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">flag</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="n">flag</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

        <span class="n">context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">Emin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">425000000</span><span class="p">,</span> <span class="n">Emax</span> <span class="o">=</span> <span class="mi">425000000</span><span class="p">,</span>
                          <span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_HALF_EVEN</span><span class="p">,</span> <span class="n">traps</span><span class="o">=</span><span class="p">[],</span> <span class="n">flags</span><span class="o">=</span><span class="p">[])</span>

        <span class="c"># operations that raise various flags, in the form (function, arglist)</span>
        <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">_apply</span><span class="p">,</span> <span class="p">[</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;100E-425000010&quot;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">sqrt</span><span class="p">,</span> <span class="p">[</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)]),</span>
            <span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="p">[</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.23456789&quot;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;9.87654321&quot;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">multiply</span><span class="p">,</span> <span class="p">[</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.23456789&quot;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;9.87654321&quot;</span><span class="p">)]),</span>
            <span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">subtract</span><span class="p">,</span> <span class="p">[</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.23456789&quot;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;9.87654321&quot;</span><span class="p">)]),</span>
            <span class="p">]</span>

        <span class="c"># try various flags individually, then a whole lot at once</span>
        <span class="n">flagsets</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Inexact</span><span class="p">],</span> <span class="p">[</span><span class="n">Rounded</span><span class="p">],</span> <span class="p">[</span><span class="n">Underflow</span><span class="p">],</span> <span class="p">[</span><span class="n">Clamped</span><span class="p">],</span> <span class="p">[</span><span class="n">Subnormal</span><span class="p">],</span>
                    <span class="p">[</span><span class="n">Inexact</span><span class="p">,</span> <span class="n">Rounded</span><span class="p">,</span> <span class="n">Underflow</span><span class="p">,</span> <span class="n">Clamped</span><span class="p">,</span> <span class="n">Subnormal</span><span class="p">]]</span>

        <span class="k">for</span> <span class="n">fn</span><span class="p">,</span> <span class="n">args</span> <span class="ow">in</span> <span class="n">operations</span><span class="p">:</span>
            <span class="c"># find answer and flags raised using a clean context</span>
            <span class="n">context</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">extra_flags</span> <span class="ow">in</span> <span class="n">flagsets</span><span class="p">:</span>
                <span class="c"># set flags, before calling operation</span>
                <span class="n">context</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">extra_flags</span><span class="p">:</span>
                    <span class="n">raise_error</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
                <span class="n">new_ans</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

                <span class="c"># flags that we expect to be set after the operation</span>
                <span class="n">expected_flags</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">extra_flags</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">flag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">expected_flags</span><span class="p">:</span>
                        <span class="n">expected_flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
                <span class="n">expected_flags</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>

                <span class="c"># flags we actually got</span>
                <span class="n">new_flags</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">]</span>
                <span class="n">new_flags</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">new_ans</span><span class="p">,</span>
                                 <span class="s">&quot;operation produces different answers depending on flags set: &quot;</span> <span class="o">+</span>
                                 <span class="s">&quot;expected </span><span class="si">%s</span><span class="s">, got </span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">new_ans</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">new_flags</span><span class="p">,</span> <span class="n">expected_flags</span><span class="p">,</span>
                                  <span class="s">&quot;operation raises different flags depending on flags set: &quot;</span> <span class="o">+</span>
                                  <span class="s">&quot;expected </span><span class="si">%s</span><span class="s">, got </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expected_flags</span><span class="p">,</span> <span class="n">new_flags</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ContextFlags.test_flag_comparisons"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextFlags.test_flag_comparisons">[docs]</a>    <span class="k">def</span> <span class="nf">test_flag_comparisons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">Inexact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Inexact</span>
        <span class="n">Rounded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Rounded</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>

        <span class="c"># Valid SignalDict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span>

        <span class="n">c</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">traps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span>

        <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Rounded</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">c</span><span class="o">.</span><span class="n">traps</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

        <span class="n">d</span><span class="p">[</span><span class="n">Inexact</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

        <span class="c"># Invalid SignalDict</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="n">Inexact</span><span class="p">:</span><span class="bp">False</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;xyz&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</div>
    <span class="nd">@requires_IEEE_754</span>
<div class="viewcode-block" id="ContextFlags.test_float_operation"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextFlags.test_float_operation">[docs]</a>    <span class="k">def</span> <span class="nf">test_float_operation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">FloatOperation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">FloatOperation</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="c">##### trap is off by default</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>

            <span class="c"># implicit conversion sets the flag</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mf">7.5</span><span class="p">),</span> <span class="mf">7.5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="mf">7.5</span><span class="p">),</span> <span class="mf">7.5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>

            <span class="c"># explicit conversion does not set the flag</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="mf">7.5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>
            <span class="c"># comparison sets the flag</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">create_decimal_from_float</span><span class="p">(</span><span class="mf">7.5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>

            <span class="c">##### set the trap</span>
            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

            <span class="c"># implicit conversion raises</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">FloatOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">FloatOperation</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>

            <span class="c"># explicit conversion is silent</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="mf">7.5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">create_decimal_from_float</span><span class="p">(</span><span class="mf">7.5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="ContextFlags.test_float_comparison"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextFlags.test_float_comparison">[docs]</a>    <span class="k">def</span> <span class="nf">test_float_comparison</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">FloatOperation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">FloatOperation</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="k">def</span> <span class="nf">assert_attr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="n">context</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">signal</span> <span class="o">==</span> <span class="n">FloatOperation</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>

        <span class="n">small_d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;0.25&#39;</span><span class="p">)</span>
        <span class="n">big_d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;3.0&#39;</span><span class="p">)</span>
        <span class="n">small_f</span> <span class="o">=</span> <span class="mf">0.25</span>
        <span class="n">big_f</span> <span class="o">=</span> <span class="mf">3.0</span>

        <span class="n">zero_d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="n">neg_zero_d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-0.0&#39;</span><span class="p">)</span>
        <span class="n">zero_f</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">neg_zero_f</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0</span>

        <span class="n">inf_d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;Infinity&#39;</span><span class="p">)</span>
        <span class="n">neg_inf_d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-Infinity&#39;</span><span class="p">)</span>
        <span class="n">inf_f</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">&#39;inf&#39;</span><span class="p">)</span>
        <span class="n">neg_inf_f</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">doit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="c"># Order</span>
            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="s">&#39;__lt__&#39;</span><span class="p">,</span> <span class="s">&#39;__le__&#39;</span><span class="p">:</span>
                <span class="n">assert_attr</span><span class="p">(</span><span class="n">small_d</span><span class="p">,</span> <span class="n">big_f</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">signal</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="s">&#39;__gt__&#39;</span><span class="p">,</span> <span class="s">&#39;__ge__&#39;</span><span class="p">:</span>
                <span class="n">assert_attr</span><span class="p">(</span><span class="n">big_d</span><span class="p">,</span> <span class="n">small_f</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">signal</span><span class="p">)</span>

            <span class="c"># Equality</span>
            <span class="n">assert_attr</span><span class="p">(</span><span class="n">small_d</span><span class="p">,</span> <span class="n">small_f</span><span class="p">,</span> <span class="s">&#39;__eq__&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

            <span class="n">assert_attr</span><span class="p">(</span><span class="n">neg_zero_d</span><span class="p">,</span> <span class="n">neg_zero_f</span><span class="p">,</span> <span class="s">&#39;__eq__&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">assert_attr</span><span class="p">(</span><span class="n">neg_zero_d</span><span class="p">,</span> <span class="n">zero_f</span><span class="p">,</span> <span class="s">&#39;__eq__&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

            <span class="n">assert_attr</span><span class="p">(</span><span class="n">zero_d</span><span class="p">,</span> <span class="n">neg_zero_f</span><span class="p">,</span> <span class="s">&#39;__eq__&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">assert_attr</span><span class="p">(</span><span class="n">zero_d</span><span class="p">,</span> <span class="n">zero_f</span><span class="p">,</span> <span class="s">&#39;__eq__&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

            <span class="n">assert_attr</span><span class="p">(</span><span class="n">neg_inf_d</span><span class="p">,</span> <span class="n">neg_inf_f</span><span class="p">,</span> <span class="s">&#39;__eq__&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">assert_attr</span><span class="p">(</span><span class="n">inf_d</span><span class="p">,</span> <span class="n">inf_f</span><span class="p">,</span> <span class="s">&#39;__eq__&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

            <span class="c"># Inequality</span>
            <span class="n">assert_attr</span><span class="p">(</span><span class="n">small_d</span><span class="p">,</span> <span class="n">big_f</span><span class="p">,</span> <span class="s">&#39;__ne__&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

            <span class="n">assert_attr</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;0.1&#39;</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s">&#39;__ne__&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

            <span class="n">assert_attr</span><span class="p">(</span><span class="n">neg_inf_d</span><span class="p">,</span> <span class="n">inf_f</span><span class="p">,</span> <span class="s">&#39;__ne__&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">assert_attr</span><span class="p">(</span><span class="n">inf_d</span><span class="p">,</span> <span class="n">neg_inf_f</span><span class="p">,</span> <span class="s">&#39;__ne__&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

            <span class="n">assert_attr</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;NaN&#39;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">),</span> <span class="s">&#39;__ne__&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">test_containers</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">s</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;100.0&#39;</span><span class="p">)])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">signal</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;10.0&#39;</span><span class="p">)])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;10.0&#39;</span><span class="p">)])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">b</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;10.0&#39;</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">b</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="ow">in</span> <span class="p">{</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;10.0&#39;</span><span class="p">):</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">:</span><span class="s">&#39;b&#39;</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>

        <span class="n">nc</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">localcontext</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>
            <span class="n">doit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
            <span class="n">test_containers</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">doit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="n">FloatOperation</span><span class="p">)</span>
            <span class="n">test_containers</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="n">FloatOperation</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContextFlags.test_float_operation_default"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextFlags.test_float_operation_default">[docs]</a>    <span class="k">def</span> <span class="nf">test_float_operation_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">Inexact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Inexact</span>
        <span class="n">FloatOperation</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">FloatOperation</span>

        <span class="n">context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>

        <span class="n">context</span><span class="o">.</span><span class="n">clear_traps</span><span class="p">()</span>
        <span class="n">context</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">Inexact</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">context</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">Inexact</span><span class="p">])</span>
</div></div>
<div class="viewcode-block" id="CContextFlags"><a class="viewcode-back" href="../../test.html#test.test_decimal.CContextFlags">[docs]</a><span class="k">class</span> <span class="nc">CContextFlags</span><span class="p">(</span><span class="n">ContextFlags</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">C</span></div>
<div class="viewcode-block" id="PyContextFlags"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyContextFlags">[docs]</a><span class="k">class</span> <span class="nc">PyContextFlags</span><span class="p">(</span><span class="n">ContextFlags</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">P</span>
</div>
<div class="viewcode-block" id="SpecialContexts"><a class="viewcode-back" href="../../test.html#test.test_decimal.SpecialContexts">[docs]</a><span class="k">class</span> <span class="nc">SpecialContexts</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test the context templates.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="SpecialContexts.test_context_templates"><a class="viewcode-back" href="../../test.html#test.test_decimal.SpecialContexts.test_context_templates">[docs]</a>    <span class="k">def</span> <span class="nf">test_context_templates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BasicContext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">BasicContext</span>
        <span class="n">ExtendedContext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">ExtendedContext</span>
        <span class="n">getcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span>
        <span class="n">setcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">setcontext</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">DivisionByZero</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">DivisionByZero</span>
        <span class="n">Overflow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Overflow</span>
        <span class="n">Underflow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Underflow</span>
        <span class="n">Clamped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Clamped</span>

        <span class="n">assert_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">BasicContext</span><span class="p">,</span> <span class="s">&#39;traps&#39;</span><span class="p">,</span>
            <span class="p">[</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">DivisionByZero</span><span class="p">,</span> <span class="n">Overflow</span><span class="p">,</span> <span class="n">Underflow</span><span class="p">,</span> <span class="n">Clamped</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="n">savecontext</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">basic_context_prec</span> <span class="o">=</span> <span class="n">BasicContext</span><span class="o">.</span><span class="n">prec</span>
        <span class="n">extended_context_prec</span> <span class="o">=</span> <span class="n">ExtendedContext</span><span class="o">.</span><span class="n">prec</span>

        <span class="n">ex</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">BasicContext</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">ExtendedContext</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">441</span>
            <span class="k">for</span> <span class="n">template</span> <span class="ow">in</span> <span class="n">BasicContext</span><span class="p">,</span> <span class="n">ExtendedContext</span><span class="p">:</span>
                <span class="n">setcontext</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">template</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">441</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">ex</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">__class__</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">BasicContext</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">basic_context_prec</span>
            <span class="n">ExtendedContext</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">extended_context_prec</span>
            <span class="n">setcontext</span><span class="p">(</span><span class="n">savecontext</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ex</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ex</span>
</div>
<div class="viewcode-block" id="SpecialContexts.test_default_context"><a class="viewcode-back" href="../../test.html#test.test_decimal.SpecialContexts.test_default_context">[docs]</a>    <span class="k">def</span> <span class="nf">test_default_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">DefaultContext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">DefaultContext</span>
        <span class="n">BasicContext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">BasicContext</span>
        <span class="n">ExtendedContext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">ExtendedContext</span>
        <span class="n">getcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span>
        <span class="n">setcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">setcontext</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">DivisionByZero</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">DivisionByZero</span>
        <span class="n">Overflow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Overflow</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">BasicContext</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ExtendedContext</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

        <span class="n">assert_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DefaultContext</span><span class="p">,</span> <span class="s">&#39;traps&#39;</span><span class="p">,</span>
            <span class="p">[</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">DivisionByZero</span><span class="p">,</span> <span class="n">Overflow</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="n">savecontext</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">default_context_prec</span> <span class="o">=</span> <span class="n">DefaultContext</span><span class="o">.</span><span class="n">prec</span>

        <span class="n">ex</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
            <span class="n">saveprec</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">prec</span>

            <span class="n">DefaultContext</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">961</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="n">saveprec</span><span class="p">)</span>

            <span class="n">setcontext</span><span class="p">(</span><span class="n">DefaultContext</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">DefaultContext</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">961</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">ex</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">__class__</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">DefaultContext</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">default_context_prec</span>
            <span class="n">setcontext</span><span class="p">(</span><span class="n">savecontext</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ex</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ex</span>
</div></div>
<div class="viewcode-block" id="CSpecialContexts"><a class="viewcode-back" href="../../test.html#test.test_decimal.CSpecialContexts">[docs]</a><span class="k">class</span> <span class="nc">CSpecialContexts</span><span class="p">(</span><span class="n">SpecialContexts</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">C</span></div>
<div class="viewcode-block" id="PySpecialContexts"><a class="viewcode-back" href="../../test.html#test.test_decimal.PySpecialContexts">[docs]</a><span class="k">class</span> <span class="nc">PySpecialContexts</span><span class="p">(</span><span class="n">SpecialContexts</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">P</span>
</div>
<div class="viewcode-block" id="ContextInputValidation"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextInputValidation">[docs]</a><span class="k">class</span> <span class="nc">ContextInputValidation</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="ContextInputValidation.test_invalid_context"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextInputValidation.test_invalid_context">[docs]</a>    <span class="k">def</span> <span class="nf">test_invalid_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">DefaultContext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">DefaultContext</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">DefaultContext</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c"># prec, Emax</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;prec&#39;</span><span class="p">,</span> <span class="s">&#39;Emax&#39;</span><span class="p">]:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="mi">999999</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">),</span> <span class="mi">999999</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="s">&#39;xyz&#39;</span><span class="p">)</span>

        <span class="c"># Emin</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&#39;Emin&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">999999</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&#39;Emin&#39;</span><span class="p">),</span> <span class="o">-</span><span class="mi">999999</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;Emin&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;Emin&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;rounding&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;rounding&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;rounding&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;rounding&#39;</span><span class="p">,</span> <span class="s">&#39;xyz&#39;</span><span class="p">)</span>

        <span class="c"># capitals, clamp</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;capitals&#39;</span><span class="p">,</span> <span class="s">&#39;clamp&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

        <span class="c"># Invalid attribute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;emax&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

        <span class="c"># Invalid signal dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;flags&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;flags&#39;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;traps&#39;</span><span class="p">,</span>
                          <span class="p">{</span><span class="s">&#39;InvalidOperation&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>

        <span class="c"># Attributes cannot be deleted</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;prec&#39;</span><span class="p">,</span> <span class="s">&#39;Emax&#39;</span><span class="p">,</span> <span class="s">&#39;Emin&#39;</span><span class="p">,</span> <span class="s">&#39;rounding&#39;</span><span class="p">,</span> <span class="s">&#39;capitals&#39;</span><span class="p">,</span> <span class="s">&#39;clamp&#39;</span><span class="p">,</span>
                     <span class="s">&#39;flags&#39;</span><span class="p">,</span> <span class="s">&#39;traps&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">__delattr__</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>

        <span class="c"># Invalid attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

        <span class="c"># Invalid values in constructor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="mi">999999</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="s">&#39;xyz&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">clamp</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">capitals</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;P&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">traps</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;Q&quot;</span><span class="p">])</span>

        <span class="c"># Type error in conversion</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">traps</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
</div></div>
<div class="viewcode-block" id="CContextInputValidation"><a class="viewcode-back" href="../../test.html#test.test_decimal.CContextInputValidation">[docs]</a><span class="k">class</span> <span class="nc">CContextInputValidation</span><span class="p">(</span><span class="n">ContextInputValidation</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">C</span></div>
<div class="viewcode-block" id="PyContextInputValidation"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyContextInputValidation">[docs]</a><span class="k">class</span> <span class="nc">PyContextInputValidation</span><span class="p">(</span><span class="n">ContextInputValidation</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">P</span>
</div>
<div class="viewcode-block" id="ContextSubclassing"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextSubclassing">[docs]</a><span class="k">class</span> <span class="nc">ContextSubclassing</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="ContextSubclassing.test_context_subclassing"><a class="viewcode-back" href="../../test.html#test.test_decimal.ContextSubclassing.test_context_subclassing">[docs]</a>    <span class="k">def</span> <span class="nf">test_context_subclassing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">Clamped</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Clamped</span>
        <span class="n">DivisionByZero</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">DivisionByZero</span>
        <span class="n">Inexact</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Inexact</span>
        <span class="n">Overflow</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Overflow</span>
        <span class="n">Rounded</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Rounded</span>
        <span class="n">Subnormal</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Subnormal</span>
        <span class="n">Underflow</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Underflow</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>

        <span class="k">class</span> <span class="nc">MyContext</span><span class="p">(</span><span class="n">Context</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Emin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Emax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                               <span class="n">capitals</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">clamp</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                               <span class="n">traps</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
                <span class="n">Context</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">prec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">prec</span>
                <span class="k">if</span> <span class="n">rounding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">rounding</span>
                <span class="k">if</span> <span class="n">Emin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="n">Emin</span>
                <span class="k">if</span> <span class="n">Emax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="n">Emax</span>
                <span class="k">if</span> <span class="n">capitals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">capitals</span> <span class="o">=</span> <span class="n">capitals</span>
                <span class="k">if</span> <span class="n">clamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">clamp</span> <span class="o">=</span> <span class="n">clamp</span>
                <span class="k">if</span> <span class="n">flags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flags</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="n">flags</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:(</span><span class="n">v</span> <span class="ow">in</span> <span class="n">flags</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">OrderedSignals</span><span class="p">[</span><span class="n">decimal</span><span class="p">]</span> <span class="o">+</span> <span class="n">flags</span><span class="p">}</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">flags</span>
                <span class="k">if</span> <span class="n">traps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">traps</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="n">traps</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:(</span><span class="n">v</span> <span class="ow">in</span> <span class="n">traps</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">OrderedSignals</span><span class="p">[</span><span class="n">decimal</span><span class="p">]</span> <span class="o">+</span> <span class="n">traps</span><span class="p">}</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">traps</span> <span class="o">=</span> <span class="n">traps</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">MyContext</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;prec&#39;</span><span class="p">,</span> <span class="s">&#39;rounding&#39;</span><span class="p">,</span> <span class="s">&#39;Emin&#39;</span><span class="p">,</span> <span class="s">&#39;Emax&#39;</span><span class="p">,</span> <span class="s">&#39;capitals&#39;</span><span class="p">,</span> <span class="s">&#39;clamp&#39;</span><span class="p">,</span>
                     <span class="s">&#39;flags&#39;</span><span class="p">,</span> <span class="s">&#39;traps&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">),</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>

        <span class="c"># prec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">MyContext</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s">&#39;prec&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">})</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">MyContext</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">quantize</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;9e2&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c"># rounding</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">MyContext</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s">&#39;rounding&#39;</span><span class="p">:</span><span class="s">&#39;XYZ&#39;</span><span class="p">})</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">MyContext</span><span class="p">(</span><span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_DOWN</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">rounding</span><span class="p">,</span> <span class="n">ROUND_DOWN</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">plus</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;9.9&#39;</span><span class="p">)),</span> <span class="mi">9</span><span class="p">)</span>

        <span class="c"># Emin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">MyContext</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s">&#39;Emin&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">MyContext</span><span class="p">(</span><span class="n">Emin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emin</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1e-99&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;2.234e-2000&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;0.0&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">signal</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Inexact</span><span class="p">,</span> <span class="n">Underflow</span><span class="p">,</span> <span class="n">Subnormal</span><span class="p">,</span> <span class="n">Rounded</span><span class="p">,</span> <span class="n">Clamped</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">signal</span><span class="p">])</span>

        <span class="c"># Emax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">MyContext</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s">&#39;Emax&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">})</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">MyContext</span><span class="p">(</span><span class="n">Emax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emax</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1e99&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;2.234e2000&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span> <span class="o">==</span> <span class="n">C</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">signal</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Inexact</span><span class="p">,</span> <span class="n">Overflow</span><span class="p">,</span> <span class="n">Rounded</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">signal</span><span class="p">])</span>

        <span class="c"># capitals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">MyContext</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s">&#39;capitals&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">})</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">MyContext</span><span class="p">(</span><span class="n">capitals</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">capitals</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="s">&#39;1E222&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">to_sci_string</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">&#39;1e+222&#39;</span><span class="p">)</span>

        <span class="c"># clamp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">MyContext</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s">&#39;clamp&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">MyContext</span><span class="p">(</span><span class="n">clamp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Emax</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">clamp</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plus</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1e99&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">&#39;1.000000000000000000000000000E+99&#39;</span><span class="p">)</span>

        <span class="c"># flags</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">MyContext</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s">&#39;flags&#39;</span><span class="p">:</span><span class="s">&#39;XYZ&#39;</span><span class="p">})</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">MyContext</span><span class="p">(</span><span class="n">flags</span><span class="o">=</span><span class="p">[</span><span class="n">Rounded</span><span class="p">,</span> <span class="n">DivisionByZero</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">signal</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Rounded</span><span class="p">,</span> <span class="n">DivisionByZero</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">signal</span><span class="p">])</span>
        <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">signal</span> <span class="ow">in</span> <span class="n">OrderedSignals</span><span class="p">[</span><span class="n">decimal</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">signal</span><span class="p">])</span>

        <span class="c"># traps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">MyContext</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s">&#39;traps&#39;</span><span class="p">:</span><span class="s">&#39;XYZ&#39;</span><span class="p">})</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">MyContext</span><span class="p">(</span><span class="n">traps</span><span class="o">=</span><span class="p">[</span><span class="n">Rounded</span><span class="p">,</span> <span class="n">DivisionByZero</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">signal</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Rounded</span><span class="p">,</span> <span class="n">DivisionByZero</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">signal</span><span class="p">])</span>
        <span class="n">c</span><span class="o">.</span><span class="n">clear_traps</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">signal</span> <span class="ow">in</span> <span class="n">OrderedSignals</span><span class="p">[</span><span class="n">decimal</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">signal</span><span class="p">])</span>
</div></div>
<div class="viewcode-block" id="CContextSubclassing"><a class="viewcode-back" href="../../test.html#test.test_decimal.CContextSubclassing">[docs]</a><span class="k">class</span> <span class="nc">CContextSubclassing</span><span class="p">(</span><span class="n">ContextSubclassing</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">C</span></div>
<div class="viewcode-block" id="PyContextSubclassing"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyContextSubclassing">[docs]</a><span class="k">class</span> <span class="nc">PyContextSubclassing</span><span class="p">(</span><span class="n">ContextSubclassing</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">P</span>
</div>
<span class="nd">@skip_if_extra_functionality</span>
<div class="viewcode-block" id="CheckAttributes"><a class="viewcode-back" href="../../test.html#test.test_decimal.CheckAttributes">[docs]</a><span class="k">class</span> <span class="nc">CheckAttributes</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="CheckAttributes.test_module_attributes"><a class="viewcode-back" href="../../test.html#test.test_decimal.CheckAttributes.test_module_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">test_module_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c"># Architecture dependent context limits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">MAX_PREC</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">MAX_PREC</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">MAX_EMAX</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">MAX_EMAX</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">MIN_EMIN</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">MIN_EMIN</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">MIN_ETINY</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">MIN_ETINY</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">HAVE_THREADS</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">C</span><span class="o">.</span><span class="n">HAVE_THREADS</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">HAVE_THREADS</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">P</span><span class="o">.</span><span class="n">HAVE_THREADS</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">__libmpdec_version__</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">__libmpdec_version__</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="nb">dir</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">if</span> <span class="s">&#39;__&#39;</span> <span class="ow">in</span> <span class="n">s</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">set</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="CheckAttributes.test_context_attributes"><a class="viewcode-back" href="../../test.html#test.test_decimal.CheckAttributes.test_context_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">test_context_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">Context</span><span class="p">())</span> <span class="k">if</span> <span class="s">&#39;__&#39;</span> <span class="ow">in</span> <span class="n">s</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">Context</span><span class="p">())</span> <span class="k">if</span> <span class="s">&#39;__&#39;</span> <span class="ow">in</span> <span class="n">s</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">set</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="CheckAttributes.test_decimal_attributes"><a class="viewcode-back" href="../../test.html#test.test_decimal.CheckAttributes.test_decimal_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">test_decimal_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="k">if</span> <span class="s">&#39;__&#39;</span> <span class="ow">in</span> <span class="n">s</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="k">if</span> <span class="s">&#39;__&#39;</span> <span class="ow">in</span> <span class="n">s</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">set</span><span class="p">())</span>
</div></div>
<div class="viewcode-block" id="Coverage"><a class="viewcode-back" href="../../test.html#test.test_decimal.Coverage">[docs]</a><span class="k">class</span> <span class="nc">Coverage</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="Coverage.test_adjusted"><a class="viewcode-back" href="../../test.html#test.test_decimal.Coverage.test_adjusted">[docs]</a>    <span class="k">def</span> <span class="nf">test_adjusted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1234e9999&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">adjusted</span><span class="p">(),</span> <span class="mi">10002</span><span class="p">)</span>
        <span class="c"># XXX raise?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">adjusted</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;inf&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">adjusted</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Coverage.test_canonical"><a class="viewcode-back" href="../../test.html#test.test_decimal.Coverage.test_canonical">[docs]</a>    <span class="k">def</span> <span class="nf">test_canonical</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">getcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">canonical</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">canonical</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Coverage.test_context_repr"><a class="viewcode-back" href="../../test.html#test.test_decimal.Coverage.test_context_repr">[docs]</a>    <span class="k">def</span> <span class="nf">test_context_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">DefaultContext</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">425000000</span>
        <span class="n">c</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="mi">425000000</span>
        <span class="n">c</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">425000000</span>
        <span class="n">c</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">ROUND_HALF_DOWN</span>
        <span class="n">c</span><span class="o">.</span><span class="n">capitals</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">c</span><span class="o">.</span><span class="n">clamp</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">sig</span> <span class="ow">in</span> <span class="n">OrderedSignals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="p">]:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">sig</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">sig</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="n">s</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">__repr__</span><span class="p">()</span>
        <span class="n">t</span> <span class="o">=</span> <span class="s">&quot;Context(prec=425000000, rounding=ROUND_HALF_DOWN, &quot;</span> \
            <span class="s">&quot;Emin=-425000000, Emax=425000000, capitals=0, clamp=1, &quot;</span> \
            <span class="s">&quot;flags=[], traps=[])&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Coverage.test_implicit_context"><a class="viewcode-back" href="../../test.html#test.test_decimal.Coverage.test_implicit_context">[docs]</a>    <span class="k">def</span> <span class="nf">test_implicit_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">c</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">c</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

            <span class="c"># abs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-10&quot;</span><span class="p">)),</span> <span class="mi">10</span><span class="p">)</span>
            <span class="c"># add</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;7&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
            <span class="c"># divide</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="c"># divide_int</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c"># fma</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;NaN&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_nan</span><span class="p">(),</span> <span class="bp">True</span><span class="p">)</span>
            <span class="c"># three arg power</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
            <span class="c"># exp</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.01&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
            <span class="c"># is_normal</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_normal</span><span class="p">(),</span> <span class="bp">False</span><span class="p">)</span>
            <span class="c"># is_subnormal</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_subnormal</span><span class="p">(),</span> <span class="bp">True</span><span class="p">)</span>
            <span class="c"># ln</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;20&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ln</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
            <span class="c"># log10</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;20&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">log10</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c"># logb</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;580&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">logb</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
            <span class="c"># logical_invert</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">logical_invert</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c"># minus</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="o">-</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-10&quot;</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
            <span class="c"># multiply</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;2&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
            <span class="c"># next_minus</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">next_minus</span><span class="p">(),</span> <span class="mi">9</span><span class="p">)</span>
            <span class="c"># next_plus</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">next_plus</span><span class="p">(),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;2E+1&#39;</span><span class="p">))</span>
            <span class="c"># normalize</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-10&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">(),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-1E+1&#39;</span><span class="p">))</span>
            <span class="c"># number_class</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">number_class</span><span class="p">(),</span> <span class="s">&#39;+Normal&#39;</span><span class="p">)</span>
            <span class="c"># plus</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="o">+</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-1&quot;</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="c"># remainder</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="c"># subtract</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="c"># to_integral_exact</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.12345&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>

            <span class="c"># Boolean functions</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_canonical</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_finite</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_finite</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;snan&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_snan</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_signed</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">())</span>

        <span class="c"># Copy</span>
        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">10000</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mi">1228</span> <span class="o">**</span> <span class="mi">1523</span>
            <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">Decimal</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

            <span class="n">z</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

            <span class="n">z</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy_negate</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

            <span class="n">z</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy_sign</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Coverage.test_divmod"><a class="viewcode-back" href="../../test.html#test.test_decimal.Coverage.test_divmod">[docs]</a>    <span class="k">def</span> <span class="nf">test_divmod</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">DivisionByZero</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">DivisionByZero</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;10912837129&quot;</span><span class="p">),</span> <span class="mi">1001</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;10901935&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;194&#39;</span><span class="p">))</span>

            <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;NaN&quot;</span><span class="p">),</span> <span class="mi">7</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">is_nan</span><span class="p">()</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">is_nan</span><span class="p">())</span>

            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;NaN&quot;</span><span class="p">),</span> <span class="mi">7</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">is_nan</span><span class="p">()</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">is_nan</span><span class="p">())</span>

            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;inf&quot;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;inf&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">is_nan</span><span class="p">()</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">is_nan</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;inf&quot;</span><span class="p">),</span> <span class="mi">101</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">()</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">is_nan</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">is_nan</span><span class="p">()</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">is_nan</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">DivisionByZero</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">()</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">is_nan</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">]</span> <span class="ow">and</span>
                            <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">DivisionByZero</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="Coverage.test_power"><a class="viewcode-back" href="../../test.html#test.test_decimal.Coverage.test_power">[docs]</a>    <span class="k">def</span> <span class="nf">test_power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>
        <span class="n">Overflow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Overflow</span>
        <span class="n">Rounded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Rounded</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.0&quot;</span><span class="p">)</span> <span class="o">**</span> <span class="mi">100</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.00&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Rounded</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">c</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">c</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">Overflow</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span> <span class="o">**</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;0.5&quot;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;inf&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="Coverage.test_quantize"><a class="viewcode-back" href="../../test.html#test.test_decimal.Coverage.test_quantize">[docs]</a>    <span class="k">def</span> <span class="nf">test_quantize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">InvalidOperation</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">c</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">c</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1e1&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">is_nan</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="Coverage.test_radix"><a class="viewcode-back" href="../../test.html#test.test_decimal.Coverage.test_radix">[docs]</a>    <span class="k">def</span> <span class="nf">test_radix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">getcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">radix</span><span class="p">(),</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">radix</span><span class="p">(),</span> <span class="mi">10</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Coverage.test_rop"><a class="viewcode-back" href="../../test.html#test.test_decimal.Coverage.test_rop">[docs]</a>    <span class="k">def</span> <span class="nf">test_rop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;__radd__&#39;</span><span class="p">,</span> <span class="s">&#39;__rsub__&#39;</span><span class="p">,</span> <span class="s">&#39;__rmul__&#39;</span><span class="p">,</span> <span class="s">&#39;__rtruediv__&#39;</span><span class="p">,</span>
                     <span class="s">&#39;__rdivmod__&#39;</span><span class="p">,</span> <span class="s">&#39;__rmod__&#39;</span><span class="p">,</span> <span class="s">&#39;__rfloordiv__&#39;</span><span class="p">,</span> <span class="s">&#39;__rpow__&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">),</span> <span class="n">attr</span><span class="p">)(</span><span class="s">&quot;xyz&quot;</span><span class="p">),</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Coverage.test_round"><a class="viewcode-back" href="../../test.html#test.test_decimal.Coverage.test_round">[docs]</a>    <span class="k">def</span> <span class="nf">test_round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Python3 behavior: round() returns Decimal</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">getcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">28</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;9.99&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__round__</span><span class="p">()),</span> <span class="s">&quot;10&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;9.99e-5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__round__</span><span class="p">()),</span> <span class="s">&quot;0&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.23456789&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__round__</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="s">&quot;1.23457&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.2345&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__round__</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span> <span class="s">&quot;1.2345000000&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.2345&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__round__</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)),</span> <span class="s">&quot;0E+10&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.23&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__round__</span><span class="p">,</span> <span class="s">&quot;5&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.23&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__round__</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Coverage.test_create_decimal"><a class="viewcode-back" href="../../test.html#test.test_decimal.Coverage.test_create_decimal">[docs]</a>    <span class="k">def</span> <span class="nf">test_create_decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;%&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="Coverage.test_int"><a class="viewcode-back" href="../../test.html#test.test_decimal.Coverage.test_int">[docs]</a>    <span class="k">def</span> <span class="nf">test_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">9999</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1221</span><span class="o">**</span><span class="mi">1271</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="mi">3923</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">to_integral</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Coverage.test_copy"><a class="viewcode-back" href="../../test.html#test.test_decimal.Coverage.test_copy">[docs]</a>    <span class="k">def</span> <span class="nf">test_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">10000</span>
        <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1172</span> <span class="o">**</span> <span class="mi">1712</span><span class="p">)</span>

        <span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span>

        <span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">copy_negate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span>

        <span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">copy_sign</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="CCoverage"><a class="viewcode-back" href="../../test.html#test.test_decimal.CCoverage">[docs]</a><span class="k">class</span> <span class="nc">CCoverage</span><span class="p">(</span><span class="n">Coverage</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">C</span></div>
<div class="viewcode-block" id="PyCoverage"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyCoverage">[docs]</a><span class="k">class</span> <span class="nc">PyCoverage</span><span class="p">(</span><span class="n">Coverage</span><span class="p">):</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">P</span>
</div>
<div class="viewcode-block" id="PyFunctionality"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyFunctionality">[docs]</a><span class="k">class</span> <span class="nc">PyFunctionality</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extra functionality in decimal.py&quot;&quot;&quot;</span>

<div class="viewcode-block" id="PyFunctionality.test_py_quantize_watchexp"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyFunctionality.test_py_quantize_watchexp">[docs]</a>    <span class="k">def</span> <span class="nf">test_py_quantize_watchexp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># watchexp functionality</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">c</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">c</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">99999</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1e3&quot;</span><span class="p">),</span> <span class="n">watchexp</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.00E+5&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="PyFunctionality.test_py_alternate_formatting"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyFunctionality.test_py_alternate_formatting">[docs]</a>    <span class="k">def</span> <span class="nf">test_py_alternate_formatting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># triples giving a format, a Decimal, and the expected result</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="n">test_values</span> <span class="o">=</span> <span class="p">[</span>
            <span class="c"># Issue 7094: Alternate formatting (specified by #)</span>
            <span class="p">(</span><span class="s">&#39;.0e&#39;</span><span class="p">,</span> <span class="s">&#39;1.0&#39;</span><span class="p">,</span> <span class="s">&#39;1e+0&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;#.0e&#39;</span><span class="p">,</span> <span class="s">&#39;1.0&#39;</span><span class="p">,</span> <span class="s">&#39;1.e+0&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.0f&#39;</span><span class="p">,</span> <span class="s">&#39;1.0&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;#.0f&#39;</span><span class="p">,</span> <span class="s">&#39;1.0&#39;</span><span class="p">,</span> <span class="s">&#39;1.&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="s">&#39;1.1&#39;</span><span class="p">,</span> <span class="s">&#39;1.1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;#g&#39;</span><span class="p">,</span> <span class="s">&#39;1.1&#39;</span><span class="p">,</span> <span class="s">&#39;1.1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.0g&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;#.0g&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;1.&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;.0%&#39;</span><span class="p">,</span> <span class="s">&#39;1.0&#39;</span><span class="p">,</span> <span class="s">&#39;100%&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;#.0%&#39;</span><span class="p">,</span> <span class="s">&#39;1.0&#39;</span><span class="p">,</span> <span class="s">&#39;100.%&#39;</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="k">for</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">test_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">format</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">fmt</span><span class="p">),</span> <span class="n">result</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="PyWhitebox"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyWhitebox">[docs]</a><span class="k">class</span> <span class="nc">PyWhitebox</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;White box testing for decimal.py&quot;&quot;&quot;</span>

<div class="viewcode-block" id="PyWhitebox.test_py_exact_power"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyWhitebox.test_py_exact_power">[docs]</a>    <span class="k">def</span> <span class="nf">test_py_exact_power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Rarely exercised lines in _power_exact.</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">8</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">)</span> <span class="o">**</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-0.5&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;0.00390625&#39;</span><span class="p">))</span>

            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">)</span> <span class="o">**</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-0.6&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;0.0012885819&#39;</span><span class="p">))</span>

            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;256e7&quot;</span><span class="p">)</span> <span class="o">**</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-0.5&quot;</span><span class="p">)</span>

            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">152587890625</span><span class="p">)</span> <span class="o">**</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-0.0625&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;0.2&quot;</span><span class="p">))</span>

            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;152587890625e7&quot;</span><span class="p">)</span> <span class="o">**</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-0.0625&#39;</span><span class="p">)</span>

            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">5</span><span class="o">**</span><span class="mi">2659</span><span class="p">)</span> <span class="o">**</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-0.0625&#39;</span><span class="p">)</span>

            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;152587890625&quot;</span><span class="p">)</span> <span class="o">**</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-0.5&#39;</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">201</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">578</span><span class="p">)</span> <span class="o">**</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;-0.5&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PyWhitebox.test_py_immutability_operations"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyWhitebox.test_py_immutability_operations">[docs]</a>    <span class="k">def</span> <span class="nf">test_py_immutability_operations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Do operations and check that it didn&#39;t change internal objects.</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">DefaultContext</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">DefaultContext</span>
        <span class="n">setcontext</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">setcontext</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">DefaultContext</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">c</span><span class="o">.</span><span class="n">traps</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">OrderedSignals</span><span class="p">[</span><span class="n">P</span><span class="p">])</span>
        <span class="n">setcontext</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="n">d1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-25e55&#39;</span><span class="p">)</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;-25e55&#39;</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;33e+33&#39;</span><span class="p">)</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;33e+33&#39;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">checkSameDec</span><span class="p">(</span><span class="n">operation</span><span class="p">,</span> <span class="n">useOther</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">useOther</span><span class="p">:</span>
                <span class="nb">eval</span><span class="p">(</span><span class="s">&quot;d1.&quot;</span> <span class="o">+</span> <span class="n">operation</span> <span class="o">+</span> <span class="s">&quot;(d2)&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="n">b1</span><span class="o">.</span><span class="n">_sign</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="n">b1</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">_exp</span><span class="p">,</span> <span class="n">b1</span><span class="o">.</span><span class="n">_exp</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d2</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="n">b2</span><span class="o">.</span><span class="n">_sign</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d2</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="n">b2</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d2</span><span class="o">.</span><span class="n">_exp</span><span class="p">,</span> <span class="n">b2</span><span class="o">.</span><span class="n">_exp</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">eval</span><span class="p">(</span><span class="s">&quot;d1.&quot;</span> <span class="o">+</span> <span class="n">operation</span> <span class="o">+</span> <span class="s">&quot;()&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="n">b1</span><span class="o">.</span><span class="n">_sign</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="n">b1</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">_exp</span><span class="p">,</span> <span class="n">b1</span><span class="o">.</span><span class="n">_exp</span><span class="p">)</span>

        <span class="n">Decimal</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="n">b1</span><span class="o">.</span><span class="n">_sign</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="n">b1</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">_exp</span><span class="p">,</span> <span class="n">b1</span><span class="o">.</span><span class="n">_exp</span><span class="p">)</span>

        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__abs__&quot;</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__add__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__divmod__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__eq__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__ne__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__le__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__lt__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__ge__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__gt__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__float__&quot;</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__floordiv__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__hash__&quot;</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__int__&quot;</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__trunc__&quot;</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__mod__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__mul__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__neg__&quot;</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__bool__&quot;</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__pos__&quot;</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__pow__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__radd__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__rdivmod__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__repr__&quot;</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__rfloordiv__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__rmod__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__rmul__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__rpow__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__rsub__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__str__&quot;</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__sub__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;__truediv__&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;adjusted&quot;</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;as_tuple&quot;</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;compare&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;max&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;min&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;normalize&quot;</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;quantize&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;remainder_near&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;same_quantum&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;sqrt&quot;</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;to_eng_string&quot;</span><span class="p">)</span>
        <span class="n">checkSameDec</span><span class="p">(</span><span class="s">&quot;to_integral&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PyWhitebox.test_py_decimal_id"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyWhitebox.test_py_decimal_id">[docs]</a>    <span class="k">def</span> <span class="nf">test_py_decimal_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s">&#39;45&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="PyWhitebox.test_py_rescale"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyWhitebox.test_py_rescale">[docs]</a>    <span class="k">def</span> <span class="nf">test_py_rescale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Coverage</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;NaN&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">_rescale</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">ROUND_UP</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">is_nan</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="PyWhitebox.test_py__round"><a class="viewcode-back" href="../../test.html#test.test_decimal.PyWhitebox.test_py__round">[docs]</a>    <span class="k">def</span> <span class="nf">test_py__round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Coverage</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;3.1234&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">_round</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ROUND_UP</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="CFunctionality"><a class="viewcode-back" href="../../test.html#test.test_decimal.CFunctionality">[docs]</a><span class="k">class</span> <span class="nc">CFunctionality</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extra functionality in _decimal&quot;&quot;&quot;</span>

    <span class="nd">@requires_extra_functionality</span>
<div class="viewcode-block" id="CFunctionality.test_c_ieee_context"><a class="viewcode-back" href="../../test.html#test.test_decimal.CFunctionality.test_c_ieee_context">[docs]</a>    <span class="k">def</span> <span class="nf">test_c_ieee_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># issue 8786: Add support for IEEE 754 contexts to decimal module.</span>
        <span class="n">IEEEContext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">IEEEContext</span>
        <span class="n">DECIMAL32</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">DECIMAL32</span>
        <span class="n">DECIMAL64</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">DECIMAL64</span>
        <span class="n">DECIMAL128</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">DECIMAL128</span>

        <span class="k">def</span> <span class="nf">assert_rest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">clamp</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">assert_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="s">&#39;traps&#39;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">assert_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="s">&#39;flags&#39;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">IEEEContext</span><span class="p">(</span><span class="n">DECIMAL32</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emax</span><span class="p">,</span> <span class="mi">96</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emin</span><span class="p">,</span> <span class="o">-</span><span class="mi">95</span><span class="p">)</span>
        <span class="n">assert_rest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">IEEEContext</span><span class="p">(</span><span class="n">DECIMAL64</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emax</span><span class="p">,</span> <span class="mi">384</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emin</span><span class="p">,</span> <span class="o">-</span><span class="mi">383</span><span class="p">)</span>
        <span class="n">assert_rest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">IEEEContext</span><span class="p">(</span><span class="n">DECIMAL128</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">34</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emax</span><span class="p">,</span> <span class="mi">6144</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emin</span><span class="p">,</span> <span class="o">-</span><span class="mi">6143</span><span class="p">)</span>
        <span class="n">assert_rest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

        <span class="c"># Invalid values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">IEEEContext</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">63</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">IEEEContext</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">IEEEContext</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
</div>
    <span class="nd">@requires_extra_functionality</span>
<div class="viewcode-block" id="CFunctionality.test_c_context"><a class="viewcode-back" href="../../test.html#test.test_decimal.CFunctionality.test_c_context">[docs]</a>    <span class="k">def</span> <span class="nf">test_c_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">flags</span><span class="o">=</span><span class="n">C</span><span class="o">.</span><span class="n">DecClamped</span><span class="p">,</span> <span class="n">traps</span><span class="o">=</span><span class="n">C</span><span class="o">.</span><span class="n">DecRounded</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">_flags</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecClamped</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">_traps</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecRounded</span><span class="p">)</span>
</div>
    <span class="nd">@requires_extra_functionality</span>
<div class="viewcode-block" id="CFunctionality.test_constants"><a class="viewcode-back" href="../../test.html#test.test_decimal.CFunctionality.test_constants">[docs]</a>    <span class="k">def</span> <span class="nf">test_constants</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Condition flags</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">C</span><span class="o">.</span><span class="n">DecClamped</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecConversionSyntax</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecDivisionByZero</span><span class="p">,</span>
            <span class="n">C</span><span class="o">.</span><span class="n">DecDivisionImpossible</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecDivisionUndefined</span><span class="p">,</span>
            <span class="n">C</span><span class="o">.</span><span class="n">DecFpuError</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecInexact</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecInvalidContext</span><span class="p">,</span>
            <span class="n">C</span><span class="o">.</span><span class="n">DecInvalidOperation</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecMallocError</span><span class="p">,</span>
            <span class="n">C</span><span class="o">.</span><span class="n">DecFloatOperation</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecOverflow</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecRounded</span><span class="p">,</span>
            <span class="n">C</span><span class="o">.</span><span class="n">DecSubnormal</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecUnderflow</span>
        <span class="p">)</span>

        <span class="c"># IEEEContext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">DECIMAL32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">DECIMAL64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">DECIMAL128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">IEEE_CONTEXT_MAX_BITS</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>

        <span class="c"># Conditions</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cond</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">i</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">DecIEEEInvalidOperation</span><span class="p">,</span>
                         <span class="n">C</span><span class="o">.</span><span class="n">DecConversionSyntax</span><span class="o">|</span>
                         <span class="n">C</span><span class="o">.</span><span class="n">DecDivisionImpossible</span><span class="o">|</span>
                         <span class="n">C</span><span class="o">.</span><span class="n">DecDivisionUndefined</span><span class="o">|</span>
                         <span class="n">C</span><span class="o">.</span><span class="n">DecFpuError</span><span class="o">|</span>
                         <span class="n">C</span><span class="o">.</span><span class="n">DecInvalidContext</span><span class="o">|</span>
                         <span class="n">C</span><span class="o">.</span><span class="n">DecInvalidOperation</span><span class="o">|</span>
                         <span class="n">C</span><span class="o">.</span><span class="n">DecMallocError</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">DecErrors</span><span class="p">,</span>
                         <span class="n">C</span><span class="o">.</span><span class="n">DecIEEEInvalidOperation</span><span class="o">|</span>
                         <span class="n">C</span><span class="o">.</span><span class="n">DecDivisionByZero</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">DecTraps</span><span class="p">,</span>
                         <span class="n">C</span><span class="o">.</span><span class="n">DecErrors</span><span class="o">|</span><span class="n">C</span><span class="o">.</span><span class="n">DecOverflow</span><span class="o">|</span><span class="n">C</span><span class="o">.</span><span class="n">DecUnderflow</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="CWhitebox"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox">[docs]</a><span class="k">class</span> <span class="nc">CWhitebox</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Whitebox testing for _decimal&quot;&quot;&quot;</span>

<div class="viewcode-block" id="CWhitebox.test_bignum"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_bignum">[docs]</a>    <span class="k">def</span> <span class="nf">test_bignum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Not exactly whitebox, but too slow with pydecimal.</span>

        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="n">b1</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">35</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">36</span>
        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">1000000</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">a</span> <span class="o">**</span> <span class="n">b</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CWhitebox.test_invalid_construction"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_invalid_construction">[docs]</a>    <span class="k">def</span> <span class="nf">test_invalid_construction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">Decimal</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s">&quot;xyz&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CWhitebox.test_c_input_restriction"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_c_input_restriction">[docs]</a>    <span class="k">def</span> <span class="nf">test_c_input_restriction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Too large for _decimal to be converted exactly</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">(</span><span class="n">Context</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span>
                              <span class="s">&quot;1e9999999999999999999&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CWhitebox.test_c_context_repr"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_c_context_repr">[docs]</a>    <span class="k">def</span> <span class="nf">test_c_context_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># This test is _decimal-only because flags are not printed</span>
        <span class="c"># in the same order.</span>
        <span class="n">DefaultContext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">DefaultContext</span>
        <span class="n">FloatOperation</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">FloatOperation</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">DefaultContext</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">425000000</span>
        <span class="n">c</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="mi">425000000</span>
        <span class="n">c</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">425000000</span>
        <span class="n">c</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">ROUND_HALF_DOWN</span>
        <span class="n">c</span><span class="o">.</span><span class="n">capitals</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">c</span><span class="o">.</span><span class="n">clamp</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">sig</span> <span class="ow">in</span> <span class="n">OrderedSignals</span><span class="p">[</span><span class="n">C</span><span class="p">]:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">sig</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">sig</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">s</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">__repr__</span><span class="p">()</span>
        <span class="n">t</span> <span class="o">=</span> <span class="s">&quot;Context(prec=425000000, rounding=ROUND_HALF_DOWN, &quot;</span> \
            <span class="s">&quot;Emin=-425000000, Emax=425000000, capitals=0, clamp=1, &quot;</span> \
            <span class="s">&quot;flags=[Clamped, InvalidOperation, DivisionByZero, Inexact, &quot;</span> \
                   <span class="s">&quot;FloatOperation, Overflow, Rounded, Subnormal, Underflow], &quot;</span> \
            <span class="s">&quot;traps=[Clamped, InvalidOperation, DivisionByZero, Inexact, &quot;</span> \
                   <span class="s">&quot;FloatOperation, Overflow, Rounded, Subnormal, Underflow])&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CWhitebox.test_c_context_errors"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_c_context_errors">[docs]</a>    <span class="k">def</span> <span class="nf">test_c_context_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">Overflow</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Overflow</span>
        <span class="n">FloatOperation</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">FloatOperation</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">localcontext</span>
        <span class="n">getcontext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">getcontext</span>
        <span class="n">setcontext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">setcontext</span>
        <span class="n">HAVE_CONFIG_64</span> <span class="o">=</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">MAX_PREC</span> <span class="o">&gt;</span> <span class="mi">425000000</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>

        <span class="c"># SignalDict: input validation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">,</span> <span class="mi">801</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">,</span> <span class="mi">801</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">__delitem__</span><span class="p">,</span> <span class="n">Overflow</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="o">.</span><span class="n">__delitem__</span><span class="p">,</span> <span class="n">InvalidOperation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;flags&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span><span class="s">&#39;traps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;flags&#39;</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;traps&#39;</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>

        <span class="c"># Test assignment from a signal dict with the correct length but</span>
        <span class="c"># one invalid key.</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="n">FloatOperation</span><span class="p">]</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&quot;XYZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">91283719</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;flags&#39;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;traps&#39;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

        <span class="c"># Input corner cases</span>
        <span class="n">int_max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">63</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">HAVE_CONFIG_64</span> <span class="k">else</span> <span class="mi">2</span><span class="o">**</span><span class="mi">31</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">gt_max_emax</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">18</span> <span class="k">if</span> <span class="n">HAVE_CONFIG_64</span> <span class="k">else</span> <span class="mi">10</span><span class="o">**</span><span class="mi">9</span>

        <span class="c"># prec, Emax, Emin</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;prec&#39;</span><span class="p">,</span> <span class="s">&#39;Emax&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">gt_max_emax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;Emin&#39;</span><span class="p">,</span> <span class="o">-</span><span class="n">gt_max_emax</span><span class="p">)</span>

        <span class="c"># prec, Emax, Emin in context constructor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="n">gt_max_emax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">Emax</span><span class="o">=</span><span class="n">gt_max_emax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">Emin</span><span class="o">=-</span><span class="n">gt_max_emax</span><span class="p">)</span>

        <span class="c"># Overflow in conversion</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="n">int_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">Emax</span><span class="o">=</span><span class="n">int_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">Emin</span><span class="o">=-</span><span class="n">int_max</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">clamp</span><span class="o">=</span><span class="n">int_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">capitals</span><span class="o">=</span><span class="n">int_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

        <span class="c"># OverflowError, general ValueError</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;prec&#39;</span><span class="p">,</span> <span class="s">&#39;Emin&#39;</span><span class="p">,</span> <span class="s">&#39;Emax&#39;</span><span class="p">,</span> <span class="s">&#39;capitals&#39;</span><span class="p">,</span> <span class="s">&#39;clamp&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">int_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="o">-</span><span class="n">int_max</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">!=</span> <span class="s">&#39;win32&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">int_max</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="o">-</span><span class="n">int_max</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c"># OverflowError: _unsafe_setprec, _unsafe_setemin, _unsafe_setemax</span>
        <span class="k">if</span> <span class="n">C</span><span class="o">.</span><span class="n">MAX_PREC</span> <span class="o">==</span> <span class="mi">425000000</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&#39;_unsafe_setprec&#39;</span><span class="p">),</span>
                              <span class="n">int_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&#39;_unsafe_setemax&#39;</span><span class="p">),</span>
                              <span class="n">int_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&#39;_unsafe_setemin&#39;</span><span class="p">),</span>
                              <span class="o">-</span><span class="n">int_max</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>

        <span class="c"># ValueError: _unsafe_setprec, _unsafe_setemin, _unsafe_setemax</span>
        <span class="k">if</span> <span class="n">C</span><span class="o">.</span><span class="n">MAX_PREC</span> <span class="o">==</span> <span class="mi">425000000</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&#39;_unsafe_setprec&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&#39;_unsafe_setprec&#39;</span><span class="p">),</span>
                              <span class="mi">1070000001</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&#39;_unsafe_setemax&#39;</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&#39;_unsafe_setemax&#39;</span><span class="p">),</span>
                              <span class="mi">1070000001</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&#39;_unsafe_setemin&#39;</span><span class="p">),</span>
                              <span class="o">-</span><span class="mi">1070000001</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&#39;_unsafe_setemin&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c"># capitals, clamp</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;capitals&#39;</span><span class="p">,</span> <span class="s">&#39;clamp&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">HAVE_CONFIG_64</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

        <span class="c"># Invalid local context</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="k">exec</span><span class="p">,</span> <span class="s">&#39;with localcontext(&quot;xyz&quot;): pass&#39;</span><span class="p">,</span>
                          <span class="nb">locals</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="k">exec</span><span class="p">,</span>
                          <span class="s">&#39;with localcontext(context=getcontext()): pass&#39;</span><span class="p">,</span>
                          <span class="nb">locals</span><span class="p">())</span>

        <span class="c"># setcontext</span>
        <span class="n">saved_context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">setcontext</span><span class="p">,</span> <span class="s">&quot;xyz&quot;</span><span class="p">)</span>
        <span class="n">setcontext</span><span class="p">(</span><span class="n">saved_context</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CWhitebox.test_rounding_strings_interned"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_rounding_strings_interned">[docs]</a>    <span class="k">def</span> <span class="nf">test_rounding_strings_interned</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ROUND_UP</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_UP</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ROUND_DOWN</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_DOWN</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ROUND_CEILING</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_CEILING</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ROUND_FLOOR</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_FLOOR</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ROUND_HALF_UP</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_HALF_UP</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ROUND_HALF_DOWN</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_HALF_DOWN</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ROUND_HALF_EVEN</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_HALF_EVEN</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ROUND_05UP</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">ROUND_05UP</span><span class="p">)</span>
</div>
    <span class="nd">@requires_extra_functionality</span>
<div class="viewcode-block" id="CWhitebox.test_c_context_errors_extra"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_c_context_errors_extra">[docs]</a>    <span class="k">def</span> <span class="nf">test_c_context_errors_extra</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">Overflow</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Overflow</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">localcontext</span>
        <span class="n">getcontext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">getcontext</span>
        <span class="n">setcontext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">setcontext</span>
        <span class="n">HAVE_CONFIG_64</span> <span class="o">=</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">MAX_PREC</span> <span class="o">&gt;</span> <span class="mi">425000000</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>

        <span class="c"># Input corner cases</span>
        <span class="n">int_max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">63</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">HAVE_CONFIG_64</span> <span class="k">else</span> <span class="mi">2</span><span class="o">**</span><span class="mi">31</span><span class="o">-</span><span class="mi">1</span>

        <span class="c"># OverflowError, general ValueError</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;_allcr&#39;</span><span class="p">,</span> <span class="n">int_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;_allcr&#39;</span><span class="p">,</span> <span class="o">-</span><span class="n">int_max</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">!=</span> <span class="s">&#39;win32&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;_allcr&#39;</span><span class="p">,</span> <span class="n">int_max</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;_allcr&#39;</span><span class="p">,</span> <span class="o">-</span><span class="n">int_max</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c"># OverflowError, general TypeError</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;_flags&#39;</span><span class="p">,</span> <span class="s">&#39;_traps&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">int_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="o">-</span><span class="n">int_max</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">!=</span> <span class="s">&#39;win32&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">int_max</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="o">-</span><span class="n">int_max</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c"># _allcr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;_allcr&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;_allcr&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;_allcr&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">HAVE_CONFIG_64</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;_allcr&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;_allcr&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

        <span class="c"># _flags, _traps</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;_flags&#39;</span><span class="p">,</span> <span class="s">&#39;_traps&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="mi">999999</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">setattr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CWhitebox.test_c_valid_context"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_c_valid_context">[docs]</a>    <span class="k">def</span> <span class="nf">test_c_valid_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># These tests are for code coverage in _decimal.</span>
        <span class="n">DefaultContext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">DefaultContext</span>
        <span class="n">Clamped</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Clamped</span>
        <span class="n">Underflow</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Underflow</span>
        <span class="n">Inexact</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Inexact</span>
        <span class="n">Rounded</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Rounded</span>
        <span class="n">Subnormal</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Subnormal</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">DefaultContext</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c"># Exercise all getters and setters</span>
        <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">34</span>
        <span class="n">c</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">ROUND_HALF_UP</span>
        <span class="n">c</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="mi">3000</span>
        <span class="n">c</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3000</span>
        <span class="n">c</span><span class="o">.</span><span class="n">capitals</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">c</span><span class="o">.</span><span class="n">clamp</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">34</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">rounding</span><span class="p">,</span> <span class="n">ROUND_HALF_UP</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emin</span><span class="p">,</span> <span class="o">-</span><span class="mi">3000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emax</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">capitals</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">clamp</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Etiny</span><span class="p">(),</span> <span class="o">-</span><span class="mi">3033</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Etop</span><span class="p">(),</span> <span class="mi">2967</span><span class="p">)</span>

        <span class="c"># Exercise all unsafe setters</span>
        <span class="k">if</span> <span class="n">C</span><span class="o">.</span><span class="n">MAX_PREC</span> <span class="o">==</span> <span class="mi">425000000</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">_unsafe_setprec</span><span class="p">(</span><span class="mi">999999999</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">_unsafe_setemax</span><span class="p">(</span><span class="mi">999999999</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">_unsafe_setemin</span><span class="p">(</span><span class="o">-</span><span class="mi">999999999</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">999999999</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emax</span><span class="p">,</span> <span class="mi">999999999</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emin</span><span class="p">,</span> <span class="o">-</span><span class="mi">999999999</span><span class="p">)</span>
</div>
    <span class="nd">@requires_extra_functionality</span>
<div class="viewcode-block" id="CWhitebox.test_c_valid_context_extra"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_c_valid_context_extra">[docs]</a>    <span class="k">def</span> <span class="nf">test_c_valid_context_extra</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">DefaultContext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">DefaultContext</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">DefaultContext</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">_allcr</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">_allcr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">_allcr</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CWhitebox.test_c_round"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_c_round">[docs]</a>    <span class="k">def</span> <span class="nf">test_c_round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Restricted input.</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">localcontext</span>
        <span class="n">MAX_EMAX</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">MAX_EMAX</span>
        <span class="n">MIN_ETINY</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">MIN_ETINY</span>
        <span class="n">int_max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">63</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">C</span><span class="o">.</span><span class="n">MAX_PREC</span> <span class="o">&gt;</span> <span class="mi">425000000</span> <span class="k">else</span> <span class="mi">2</span><span class="o">**</span><span class="mi">31</span><span class="o">-</span><span class="mi">1</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.23&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__round__</span><span class="p">,</span>
                              <span class="o">-</span><span class="n">int_max</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.23&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__round__</span><span class="p">,</span>
                              <span class="n">int_max</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__round__</span><span class="p">,</span>
                              <span class="nb">int</span><span class="p">(</span><span class="n">MAX_EMAX</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__round__</span><span class="p">,</span>
                              <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">MIN_ETINY</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.23&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__round__</span><span class="p">,</span>
                              <span class="o">-</span><span class="n">int_max</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.23&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__round__</span><span class="p">,</span>
                              <span class="n">int_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CWhitebox.test_c_format"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_c_format">[docs]</a>    <span class="k">def</span> <span class="nf">test_c_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Restricted input</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">HAVE_CONFIG_64</span> <span class="o">=</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">MAX_PREC</span> <span class="o">&gt;</span> <span class="mi">425000000</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__format__</span><span class="p">,</span> <span class="s">&quot;=10.10&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="mi">9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__format__</span><span class="p">,</span> <span class="s">&quot;=10.10&quot;</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__format__</span><span class="p">,</span> <span class="p">[])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__format__</span><span class="p">,</span> <span class="s">&quot;&lt;&gt;=10.10&quot;</span><span class="p">)</span>
        <span class="n">maxsize</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">63</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">HAVE_CONFIG_64</span> <span class="k">else</span> <span class="mi">2</span><span class="o">**</span><span class="mi">31</span><span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.23456789&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__format__</span><span class="p">,</span>
                          <span class="s">&quot;=</span><span class="si">%d</span><span class="s">.1&quot;</span> <span class="o">%</span> <span class="n">maxsize</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CWhitebox.test_c_integral"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_c_integral">[docs]</a>    <span class="k">def</span> <span class="nf">test_c_integral</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Inexact</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Inexact</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">to_integral</span><span class="p">(),</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">(),</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">(),</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;99999999999999999999999999.9&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">(</span><span class="n">ROUND_UP</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;100000000000000000000000000&#39;</span><span class="p">))</span>

            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;99999999999999999999999999.9&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">(</span><span class="n">ROUND_UP</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;100000000000000000000000000&#39;</span><span class="p">))</span>

            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">Inexact</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Inexact</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;999.9&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">,</span> <span class="n">ROUND_UP</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CWhitebox.test_c_funcs"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_c_funcs">[docs]</a>    <span class="k">def</span> <span class="nf">test_c_funcs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Invalid arguments</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">DivisionByZero</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">DivisionByZero</span>
        <span class="n">getcontext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">getcontext</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">localcontext</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;9.99e10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_eng_string</span><span class="p">(),</span> <span class="s">&#39;99.9E+9&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">pow</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">number_class</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">same_quantum</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span>
            <span class="ne">TypeError</span><span class="p">,</span>
            <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.23456789&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1e-100000&#39;</span><span class="p">),</span> <span class="p">[]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span>
            <span class="ne">TypeError</span><span class="p">,</span>
            <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.23456789&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1e-100000&#39;</span><span class="p">),</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span>
            <span class="ne">TypeError</span><span class="p">,</span>
            <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.23456789&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1e-100000&#39;</span><span class="p">),</span> <span class="mi">10</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span>
            <span class="ne">TypeError</span><span class="p">,</span>
            <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.23456789&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1e-100000&#39;</span><span class="p">),</span> <span class="n">ROUND_UP</span><span class="p">,</span> <span class="mi">1000</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">clear_traps</span><span class="p">()</span>

            <span class="c"># Invalid arguments</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">copy_sign</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">canonical</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">is_canonical</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">divmod</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">same_quantum</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">canonical</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">200</span><span class="p">))),</span> <span class="s">&#39;200&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">radix</span><span class="p">(),</span> <span class="mi">10</span><span class="p">)</span>

            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">DivisionByZero</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">DivisionByZero</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">__divmod__</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">DivisionByZero</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">divmod</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">__divmod__</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">divmod</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">DivisionByZero</span><span class="p">])</span>

            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="nb">pow</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">501</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CWhitebox.test_va_args_exceptions"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_va_args_exceptions">[docs]</a>    <span class="k">def</span> <span class="nf">test_va_args_exceptions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Context</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;10001111111&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;exp&#39;</span><span class="p">,</span> <span class="s">&#39;is_normal&#39;</span><span class="p">,</span> <span class="s">&#39;is_subnormal&#39;</span><span class="p">,</span> <span class="s">&#39;ln&#39;</span><span class="p">,</span> <span class="s">&#39;log10&#39;</span><span class="p">,</span>
                     <span class="s">&#39;logb&#39;</span><span class="p">,</span> <span class="s">&#39;logical_invert&#39;</span><span class="p">,</span> <span class="s">&#39;next_minus&#39;</span><span class="p">,</span> <span class="s">&#39;next_plus&#39;</span><span class="p">,</span>
                     <span class="s">&#39;normalize&#39;</span><span class="p">,</span> <span class="s">&#39;number_class&#39;</span><span class="p">,</span> <span class="s">&#39;sqrt&#39;</span><span class="p">,</span> <span class="s">&#39;to_eng_string&#39;</span><span class="p">]:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;compare&#39;</span><span class="p">,</span> <span class="s">&#39;compare_signal&#39;</span><span class="p">,</span> <span class="s">&#39;logical_and&#39;</span><span class="p">,</span>
                     <span class="s">&#39;logical_or&#39;</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">,</span> <span class="s">&#39;max_mag&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span><span class="p">,</span> <span class="s">&#39;min_mag&#39;</span><span class="p">,</span>
                     <span class="s">&#39;remainder_near&#39;</span><span class="p">,</span> <span class="s">&#39;rotate&#39;</span><span class="p">,</span> <span class="s">&#39;scaleb&#39;</span><span class="p">,</span> <span class="s">&#39;shift&#39;</span><span class="p">]:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="p">{},</span> <span class="n">context</span><span class="o">=</span><span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="p">{},</span> <span class="n">context</span><span class="o">=</span><span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="p">{},</span> <span class="n">context</span><span class="o">=</span><span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">fma</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">fma</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">quantize</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[],</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">quantize</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[],</span> <span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">quantize</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">power</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mod</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">power</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="n">mod</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">power</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mod</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</div>
    <span class="nd">@requires_extra_functionality</span>
<div class="viewcode-block" id="CWhitebox.test_c_context_templates"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_c_context_templates">[docs]</a>    <span class="k">def</span> <span class="nf">test_c_context_templates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">C</span><span class="o">.</span><span class="n">BasicContext</span><span class="o">.</span><span class="n">_traps</span><span class="p">,</span>
            <span class="n">C</span><span class="o">.</span><span class="n">DecIEEEInvalidOperation</span><span class="o">|</span><span class="n">C</span><span class="o">.</span><span class="n">DecDivisionByZero</span><span class="o">|</span><span class="n">C</span><span class="o">.</span><span class="n">DecOverflow</span><span class="o">|</span>
            <span class="n">C</span><span class="o">.</span><span class="n">DecUnderflow</span><span class="o">|</span><span class="n">C</span><span class="o">.</span><span class="n">DecClamped</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">C</span><span class="o">.</span><span class="n">DefaultContext</span><span class="o">.</span><span class="n">_traps</span><span class="p">,</span>
            <span class="n">C</span><span class="o">.</span><span class="n">DecIEEEInvalidOperation</span><span class="o">|</span><span class="n">C</span><span class="o">.</span><span class="n">DecDivisionByZero</span><span class="o">|</span><span class="n">C</span><span class="o">.</span><span class="n">DecOverflow</span>
        <span class="p">)</span>
</div>
    <span class="nd">@requires_extra_functionality</span>
<div class="viewcode-block" id="CWhitebox.test_c_signal_dict"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_c_signal_dict">[docs]</a>    <span class="k">def</span> <span class="nf">test_c_signal_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c"># SignalDict coverage</span>
        <span class="n">Context</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Context</span>
        <span class="n">DefaultContext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">DefaultContext</span>

        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">DivisionByZero</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">DivisionByZero</span>
        <span class="n">Overflow</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Overflow</span>
        <span class="n">Subnormal</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Subnormal</span>
        <span class="n">Underflow</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Underflow</span>
        <span class="n">Rounded</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Rounded</span>
        <span class="n">Inexact</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Inexact</span>
        <span class="n">Clamped</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Clamped</span>

        <span class="n">DecClamped</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">DecClamped</span>
        <span class="n">DecInvalidOperation</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">DecInvalidOperation</span>
        <span class="n">DecIEEEInvalidOperation</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">DecIEEEInvalidOperation</span>

        <span class="k">def</span> <span class="nf">assertIsExclusivelySet</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">signal_dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">sig</span> <span class="ow">in</span> <span class="n">signal_dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sig</span> <span class="o">==</span> <span class="n">signal</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">signal_dict</span><span class="p">[</span><span class="n">sig</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">signal_dict</span><span class="p">[</span><span class="n">sig</span><span class="p">])</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">DefaultContext</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c"># Signal dict methods</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Overflow</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">clear_traps</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">clear_traps</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Overflow</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">),</span> <span class="s">&quot;y&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">,</span> <span class="s">&quot;z&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">))</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">__repr__</span><span class="p">()</span>

        <span class="c"># Set flags/traps.</span>
        <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
        <span class="n">c</span><span class="o">.</span><span class="n">_flags</span> <span class="o">=</span> <span class="n">DecClamped</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Clamped</span><span class="p">])</span>

        <span class="n">c</span><span class="o">.</span><span class="n">clear_traps</span><span class="p">()</span>
        <span class="n">c</span><span class="o">.</span><span class="n">_traps</span> <span class="o">=</span> <span class="n">DecInvalidOperation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">])</span>

        <span class="c"># Set flags/traps from dictionary.</span>
        <span class="n">c</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">d</span><span class="p">[</span><span class="n">DivisionByZero</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">c</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">d</span>
        <span class="n">assertIsExclusivelySet</span><span class="p">(</span><span class="n">DivisionByZero</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span>

        <span class="n">c</span><span class="o">.</span><span class="n">clear_traps</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">d</span><span class="p">[</span><span class="n">Underflow</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">c</span><span class="o">.</span><span class="n">traps</span> <span class="o">=</span> <span class="n">d</span>
        <span class="n">assertIsExclusivelySet</span><span class="p">(</span><span class="n">Underflow</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">)</span>

        <span class="c"># Random constructors</span>
        <span class="n">IntSignals</span> <span class="o">=</span> <span class="p">{</span>
          <span class="n">Clamped</span><span class="p">:</span> <span class="n">C</span><span class="o">.</span><span class="n">DecClamped</span><span class="p">,</span>
          <span class="n">Rounded</span><span class="p">:</span> <span class="n">C</span><span class="o">.</span><span class="n">DecRounded</span><span class="p">,</span>
          <span class="n">Inexact</span><span class="p">:</span> <span class="n">C</span><span class="o">.</span><span class="n">DecInexact</span><span class="p">,</span>
          <span class="n">Subnormal</span><span class="p">:</span> <span class="n">C</span><span class="o">.</span><span class="n">DecSubnormal</span><span class="p">,</span>
          <span class="n">Underflow</span><span class="p">:</span> <span class="n">C</span><span class="o">.</span><span class="n">DecUnderflow</span><span class="p">,</span>
          <span class="n">Overflow</span><span class="p">:</span> <span class="n">C</span><span class="o">.</span><span class="n">DecOverflow</span><span class="p">,</span>
          <span class="n">DivisionByZero</span><span class="p">:</span> <span class="n">C</span><span class="o">.</span><span class="n">DecDivisionByZero</span><span class="p">,</span>
          <span class="n">InvalidOperation</span><span class="p">:</span> <span class="n">C</span><span class="o">.</span><span class="n">DecIEEEInvalidOperation</span>
        <span class="p">}</span>
        <span class="n">IntCond</span> <span class="o">=</span> <span class="p">[</span>
          <span class="n">C</span><span class="o">.</span><span class="n">DecDivisionImpossible</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecDivisionUndefined</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecFpuError</span><span class="p">,</span>
          <span class="n">C</span><span class="o">.</span><span class="n">DecInvalidContext</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecInvalidOperation</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">DecMallocError</span><span class="p">,</span>
          <span class="n">C</span><span class="o">.</span><span class="n">DecConversionSyntax</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="n">lim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">OrderedSignals</span><span class="p">[</span><span class="n">C</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lim</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lim</span><span class="p">):</span>
                <span class="k">for</span> <span class="nb">round</span> <span class="ow">in</span> <span class="n">RoundingModes</span><span class="p">:</span>
                    <span class="n">flags</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">OrderedSignals</span><span class="p">[</span><span class="n">C</span><span class="p">],</span> <span class="n">r</span><span class="p">)</span>
                    <span class="n">traps</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">OrderedSignals</span><span class="p">[</span><span class="n">C</span><span class="p">],</span> <span class="n">t</span><span class="p">)</span>
                    <span class="n">prec</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
                    <span class="n">emin</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="n">emax</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
                    <span class="n">clamp</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">caps</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">cr</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="n">prec</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="nb">round</span><span class="p">,</span> <span class="n">Emin</span><span class="o">=</span><span class="n">emin</span><span class="p">,</span> <span class="n">Emax</span><span class="o">=</span><span class="n">emax</span><span class="p">,</span>
                                <span class="n">capitals</span><span class="o">=</span><span class="n">caps</span><span class="p">,</span> <span class="n">clamp</span><span class="o">=</span><span class="n">clamp</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">flags</span><span class="p">),</span>
                                <span class="n">traps</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">traps</span><span class="p">))</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">rounding</span><span class="p">,</span> <span class="nb">round</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emin</span><span class="p">,</span> <span class="n">emin</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Emax</span><span class="p">,</span> <span class="n">emax</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">capitals</span><span class="p">,</span> <span class="n">caps</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">clamp</span><span class="p">,</span> <span class="n">clamp</span><span class="p">)</span>

                    <span class="n">f</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">flags</span><span class="p">:</span>
                        <span class="n">f</span> <span class="o">|=</span> <span class="n">IntSignals</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">_flags</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

                    <span class="n">f</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">traps</span><span class="p">:</span>
                        <span class="n">f</span> <span class="o">|=</span> <span class="n">IntSignals</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">_traps</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">IntCond</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">_flags</span> <span class="o">=</span> <span class="n">cond</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">_flags</span><span class="o">&amp;</span><span class="n">DecIEEEInvalidOperation</span><span class="p">)</span>
            <span class="n">assertIsExclusivelySet</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">IntCond</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">_traps</span> <span class="o">=</span> <span class="n">cond</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">_traps</span><span class="o">&amp;</span><span class="n">DecIEEEInvalidOperation</span><span class="p">)</span>
            <span class="n">assertIsExclusivelySet</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CWhitebox.test_invalid_override"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_invalid_override">[docs]</a>    <span class="k">def</span> <span class="nf">test_invalid_override</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Decimal</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">locale</span> <span class="kn">import</span> <span class="n">CHAR_MAX</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipTest</span><span class="p">(</span><span class="s">&#39;locale.CHAR_MAX not available&#39;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">make_grouping</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">])</span>

        <span class="k">def</span> <span class="nf">get_fmt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s">&#39;n&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">__format__</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="n">override</span><span class="p">)</span>

        <span class="n">invalid_grouping</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;decimal_point&#39;</span> <span class="p">:</span> <span class="s">&#39;,&#39;</span><span class="p">,</span>
            <span class="s">&#39;grouping&#39;</span> <span class="p">:</span> <span class="n">make_grouping</span><span class="p">([</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
            <span class="s">&#39;thousands_sep&#39;</span> <span class="p">:</span> <span class="s">&#39;,&#39;</span>
        <span class="p">}</span>
        <span class="n">invalid_dot</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;decimal_point&#39;</span> <span class="p">:</span> <span class="s">&#39;xxxxx&#39;</span><span class="p">,</span>
            <span class="s">&#39;grouping&#39;</span> <span class="p">:</span> <span class="n">make_grouping</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
            <span class="s">&#39;thousands_sep&#39;</span> <span class="p">:</span> <span class="s">&#39;,&#39;</span>
        <span class="p">}</span>
        <span class="n">invalid_sep</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;decimal_point&#39;</span> <span class="p">:</span> <span class="s">&#39;.&#39;</span><span class="p">,</span>
            <span class="s">&#39;grouping&#39;</span> <span class="p">:</span> <span class="n">make_grouping</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
            <span class="s">&#39;thousands_sep&#39;</span> <span class="p">:</span> <span class="s">&#39;yyyyy&#39;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">CHAR_MAX</span> <span class="o">==</span> <span class="mi">127</span><span class="p">:</span> <span class="c"># negative grouping in override</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">get_fmt</span><span class="p">,</span> <span class="mi">12345</span><span class="p">,</span>
                              <span class="n">invalid_grouping</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">get_fmt</span><span class="p">,</span> <span class="mi">12345</span><span class="p">,</span> <span class="n">invalid_dot</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">get_fmt</span><span class="p">,</span> <span class="mi">12345</span><span class="p">,</span> <span class="n">invalid_sep</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CWhitebox.test_exact_conversion"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_exact_conversion">[docs]</a>    <span class="k">def</span> <span class="nf">test_exact_conversion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">localcontext</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">InvalidOperation</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>

            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

            <span class="c"># Clamped</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s">&quot;0e</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

            <span class="n">x</span> <span class="o">=</span> <span class="s">&quot;0e</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

            <span class="c"># Overflow</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s">&quot;1e</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

            <span class="c"># Underflow</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s">&quot;1e</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CWhitebox.test_from_tuple"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_from_tuple">[docs]</a>    <span class="k">def</span> <span class="nf">test_from_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">localcontext</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">localcontext</span>
        <span class="n">InvalidOperation</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">InvalidOperation</span>
        <span class="n">Overflow</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Overflow</span>
        <span class="n">Underflow</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Underflow</span>

        <span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>

            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">InvalidOperation</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">Overflow</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">c</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">Underflow</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

            <span class="c"># SSIZE_MAX</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(),</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="s">&#39;-0E+999999&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

            <span class="c"># SSIZE_MIN</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(),</span> <span class="o">-</span><span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="s">&#39;-0E-1000026&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Underflow</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

            <span class="c"># OverflowError</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(),</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(),</span> <span class="o">-</span><span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

            <span class="c"># Specials</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(),</span> <span class="s">&quot;N&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="s">&#39;-sNaN&#39;</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="s">&quot;N&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="s">&#39;-sNaN&#39;</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s">&quot;N&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="s">&#39;-sNaN1&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CWhitebox.test_sizeof"><a class="viewcode-back" href="../../test.html#test.test_decimal.CWhitebox.test_sizeof">[docs]</a>    <span class="k">def</span> <span class="nf">test_sizeof</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Decimal</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Decimal</span>
        <span class="n">HAVE_CONFIG_64</span> <span class="o">=</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">MAX_PREC</span> <span class="o">&gt;</span> <span class="mi">425000000</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__sizeof__</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">HAVE_CONFIG_64</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mi">19</span><span class="o">*</span><span class="mi">24</span><span class="p">))</span><span class="o">.</span><span class="n">__sizeof__</span><span class="p">()</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mi">19</span><span class="o">*</span><span class="mi">25</span><span class="p">))</span><span class="o">.</span><span class="n">__sizeof__</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mi">9</span><span class="o">*</span><span class="mi">24</span><span class="p">))</span><span class="o">.</span><span class="n">__sizeof__</span><span class="p">()</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mi">9</span><span class="o">*</span><span class="mi">25</span><span class="p">))</span><span class="o">.</span><span class="n">__sizeof__</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
</div></div>
<span class="n">all_tests</span> <span class="o">=</span> <span class="p">[</span>
  <span class="n">CExplicitConstructionTest</span><span class="p">,</span> <span class="n">PyExplicitConstructionTest</span><span class="p">,</span>
  <span class="n">CImplicitConstructionTest</span><span class="p">,</span> <span class="n">PyImplicitConstructionTest</span><span class="p">,</span>
  <span class="n">CFormatTest</span><span class="p">,</span>               <span class="n">PyFormatTest</span><span class="p">,</span>
  <span class="n">CArithmeticOperatorsTest</span><span class="p">,</span>  <span class="n">PyArithmeticOperatorsTest</span><span class="p">,</span>
  <span class="n">CThreadingTest</span><span class="p">,</span>            <span class="n">PyThreadingTest</span><span class="p">,</span>
  <span class="n">CUsabilityTest</span><span class="p">,</span>            <span class="n">PyUsabilityTest</span><span class="p">,</span>
  <span class="n">CPythonAPItests</span><span class="p">,</span>           <span class="n">PyPythonAPItests</span><span class="p">,</span>
  <span class="n">CContextAPItests</span><span class="p">,</span>          <span class="n">PyContextAPItests</span><span class="p">,</span>
  <span class="n">CContextWithStatement</span><span class="p">,</span>     <span class="n">PyContextWithStatement</span><span class="p">,</span>
  <span class="n">CContextFlags</span><span class="p">,</span>             <span class="n">PyContextFlags</span><span class="p">,</span>
  <span class="n">CSpecialContexts</span><span class="p">,</span>          <span class="n">PySpecialContexts</span><span class="p">,</span>
  <span class="n">CContextInputValidation</span><span class="p">,</span>   <span class="n">PyContextInputValidation</span><span class="p">,</span>
  <span class="n">CContextSubclassing</span><span class="p">,</span>       <span class="n">PyContextSubclassing</span><span class="p">,</span>
  <span class="n">CCoverage</span><span class="p">,</span>                 <span class="n">PyCoverage</span><span class="p">,</span>
  <span class="n">CFunctionality</span><span class="p">,</span>            <span class="n">PyFunctionality</span><span class="p">,</span>
  <span class="n">CWhitebox</span><span class="p">,</span>                 <span class="n">PyWhitebox</span><span class="p">,</span>
  <span class="n">CIBMTestCases</span><span class="p">,</span>             <span class="n">PyIBMTestCases</span><span class="p">,</span>
<span class="p">]</span>

<span class="c"># Delete C tests if _decimal.so is not present.</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">C</span><span class="p">:</span>
    <span class="n">all_tests</span> <span class="o">=</span> <span class="n">all_tests</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">all_tests</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">CheckAttributes</span><span class="p">)</span>


<div class="viewcode-block" id="test_main"><a class="viewcode-back" href="../../test.html#test.test_decimal.test_main">[docs]</a><span class="k">def</span> <span class="nf">test_main</span><span class="p">(</span><span class="n">arith</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">todo_tests</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Execute the tests.</span>

<span class="sd">    Runs all arithmetic tests if arith is True or if the &quot;decimal&quot; resource</span>
<span class="sd">    is enabled in regrtest.py</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">init</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
    <span class="n">init</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
    <span class="k">global</span> <span class="n">TEST_ALL</span><span class="p">,</span> <span class="n">DEBUG</span>
    <span class="n">TEST_ALL</span> <span class="o">=</span> <span class="n">arith</span> <span class="k">if</span> <span class="n">arith</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">is_resource_enabled</span><span class="p">(</span><span class="s">&#39;decimal&#39;</span><span class="p">)</span>
    <span class="n">DEBUG</span> <span class="o">=</span> <span class="n">debug</span>

    <span class="k">if</span> <span class="n">todo_tests</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">test_classes</span> <span class="o">=</span> <span class="n">all_tests</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">test_classes</span> <span class="o">=</span> <span class="p">[</span><span class="n">CIBMTestCases</span><span class="p">,</span> <span class="n">PyIBMTestCases</span><span class="p">]</span>

    <span class="c"># Dynamically build custom test definition for each file in the test</span>
    <span class="c"># directory and add the definitions to the DecimalTest class.  This</span>
    <span class="c"># procedure insures that new files do not get skipped.</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="k">if</span> <span class="s">&#39;.decTest&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">filename</span> <span class="ow">or</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">head</span><span class="p">,</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">todo_tests</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">head</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">todo_tests</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">tester</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">filename</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval_file</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">CIBMTestCases</span><span class="p">,</span> <span class="s">&#39;test_&#39;</span> <span class="o">+</span> <span class="n">head</span><span class="p">,</span> <span class="n">tester</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">PyIBMTestCases</span><span class="p">,</span> <span class="s">&#39;test_&#39;</span> <span class="o">+</span> <span class="n">head</span><span class="p">,</span> <span class="n">tester</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">filename</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">tester</span>


    <span class="k">try</span><span class="p">:</span>
        <span class="n">run_unittest</span><span class="p">(</span><span class="o">*</span><span class="n">test_classes</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">todo_tests</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">doctest</span> <span class="kn">import</span> <span class="n">IGNORE_EXCEPTION_DETAIL</span>
            <span class="n">savedecimal</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">C</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span>
                <span class="n">run_doctest</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">optionflags</span><span class="o">=</span><span class="n">IGNORE_EXCEPTION_DETAIL</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span>
            <span class="n">run_doctest</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">savedecimal</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">C</span><span class="p">:</span> <span class="n">C</span><span class="o">.</span><span class="n">setcontext</span><span class="p">(</span><span class="n">ORIGINAL_CONTEXT</span><span class="p">[</span><span class="n">C</span><span class="p">])</span>
        <span class="n">P</span><span class="o">.</span><span class="n">setcontext</span><span class="p">(</span><span class="n">ORIGINAL_CONTEXT</span><span class="p">[</span><span class="n">P</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">C</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;C tests skipped: no module named _decimal.&#39;</span><span class="p">,</span>
                          <span class="ne">UserWarning</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">orig_sys_decimal</span> <span class="ow">is</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;decimal&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">TestFailed</span><span class="p">(</span><span class="s">&quot;Internal error: unbalanced number of changes to &quot;</span>
                             <span class="s">&quot;sys.modules[&#39;decimal&#39;].&quot;</span><span class="p">)</span>

</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">optparse</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">optparse</span><span class="o">.</span><span class="n">OptionParser</span><span class="p">(</span><span class="s">&quot;test_decimal.py [--debug] [{--skip | test1 [test2 [...]]}]&quot;</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&#39;--debug&#39;</span><span class="p">,</span> <span class="s">&#39;-d&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&#39;shows the test number and context before each test&#39;</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&#39;--skip&#39;</span><span class="p">,</span>  <span class="s">&#39;-s&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&#39;skip over 90</span><span class="si">% o</span><span class="s">f the arithmetic tests&#39;</span><span class="p">)</span>
    <span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">skip</span><span class="p">:</span>
        <span class="n">test_main</span><span class="p">(</span><span class="n">arith</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">test_main</span><span class="p">(</span><span class="n">arith</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">todo_tests</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">debug</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">test_main</span><span class="p">(</span><span class="n">arith</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>