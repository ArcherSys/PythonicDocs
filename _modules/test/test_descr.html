

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_descr &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_descr</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_descr</h1><div class="highlight"><pre>
<span class="kn">import</span> <span class="nn">builtins</span>
<span class="kn">import</span> <span class="nn">copyreg</span>
<span class="kn">import</span> <span class="nn">gc</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">types</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">weakref</span>

<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">support</span>


<div class="viewcode-block" id="OperatorsTest"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest">[docs]</a><span class="k">class</span> <span class="nc">OperatorsTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binops</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;add&#39;</span><span class="p">:</span> <span class="s">&#39;+&#39;</span><span class="p">,</span>
            <span class="s">&#39;sub&#39;</span><span class="p">:</span> <span class="s">&#39;-&#39;</span><span class="p">,</span>
            <span class="s">&#39;mul&#39;</span><span class="p">:</span> <span class="s">&#39;*&#39;</span><span class="p">,</span>
            <span class="s">&#39;div&#39;</span><span class="p">:</span> <span class="s">&#39;/&#39;</span><span class="p">,</span>
            <span class="s">&#39;divmod&#39;</span><span class="p">:</span> <span class="s">&#39;divmod&#39;</span><span class="p">,</span>
            <span class="s">&#39;pow&#39;</span><span class="p">:</span> <span class="s">&#39;**&#39;</span><span class="p">,</span>
            <span class="s">&#39;lshift&#39;</span><span class="p">:</span> <span class="s">&#39;&lt;&lt;&#39;</span><span class="p">,</span>
            <span class="s">&#39;rshift&#39;</span><span class="p">:</span> <span class="s">&#39;&gt;&gt;&#39;</span><span class="p">,</span>
            <span class="s">&#39;and&#39;</span><span class="p">:</span> <span class="s">&#39;&amp;&#39;</span><span class="p">,</span>
            <span class="s">&#39;xor&#39;</span><span class="p">:</span> <span class="s">&#39;^&#39;</span><span class="p">,</span>
            <span class="s">&#39;or&#39;</span><span class="p">:</span> <span class="s">&#39;|&#39;</span><span class="p">,</span>
            <span class="s">&#39;cmp&#39;</span><span class="p">:</span> <span class="s">&#39;cmp&#39;</span><span class="p">,</span>
            <span class="s">&#39;lt&#39;</span><span class="p">:</span> <span class="s">&#39;&lt;&#39;</span><span class="p">,</span>
            <span class="s">&#39;le&#39;</span><span class="p">:</span> <span class="s">&#39;&lt;=&#39;</span><span class="p">,</span>
            <span class="s">&#39;eq&#39;</span><span class="p">:</span> <span class="s">&#39;==&#39;</span><span class="p">,</span>
            <span class="s">&#39;ne&#39;</span><span class="p">:</span> <span class="s">&#39;!=&#39;</span><span class="p">,</span>
            <span class="s">&#39;gt&#39;</span><span class="p">:</span> <span class="s">&#39;&gt;&#39;</span><span class="p">,</span>
            <span class="s">&#39;ge&#39;</span><span class="p">:</span> <span class="s">&#39;&gt;=&#39;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">expr</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binops</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">islower</span><span class="p">():</span>
                <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span> <span class="o">+</span> <span class="s">&quot;(a, b)&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">expr</span> <span class="o">=</span> <span class="s">&#39;a </span><span class="si">%s</span><span class="s"> b&#39;</span> <span class="o">%</span> <span class="n">expr</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">binops</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">expr</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">unops</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;pos&#39;</span><span class="p">:</span> <span class="s">&#39;+&#39;</span><span class="p">,</span>
            <span class="s">&#39;neg&#39;</span><span class="p">:</span> <span class="s">&#39;-&#39;</span><span class="p">,</span>
            <span class="s">&#39;abs&#39;</span><span class="p">:</span> <span class="s">&#39;abs&#39;</span><span class="p">,</span>
            <span class="s">&#39;invert&#39;</span><span class="p">:</span> <span class="s">&#39;~&#39;</span><span class="p">,</span>
            <span class="s">&#39;int&#39;</span><span class="p">:</span> <span class="s">&#39;int&#39;</span><span class="p">,</span>
            <span class="s">&#39;float&#39;</span><span class="p">:</span> <span class="s">&#39;float&#39;</span><span class="p">,</span>
            <span class="s">&#39;oct&#39;</span><span class="p">:</span> <span class="s">&#39;oct&#39;</span><span class="p">,</span>
            <span class="s">&#39;hex&#39;</span><span class="p">:</span> <span class="s">&#39;hex&#39;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">expr</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unops</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">islower</span><span class="p">():</span>
                <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span> <span class="o">+</span> <span class="s">&quot;(a)&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">expr</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s"> a&#39;</span> <span class="o">%</span> <span class="n">expr</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unops</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">expr</span>

<div class="viewcode-block" id="OperatorsTest.unop_test"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest.unop_test">[docs]</a>    <span class="k">def</span> <span class="nf">unop_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">expr</span><span class="o">=</span><span class="s">&quot;len(a)&quot;</span><span class="p">,</span> <span class="n">meth</span><span class="o">=</span><span class="s">&quot;__len__&quot;</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="n">res</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">meth</span><span class="p">)</span>

        <span class="c"># Find method in parent class</span>
        <span class="k">while</span> <span class="n">meth</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c"># in some implementations (e.g. PyPy), &#39;m&#39; can be a regular unbound</span>
        <span class="c"># method object; the getattr() below obtains its underlying function.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&#39;im_func&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">t</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">meth</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">res</span><span class="p">)</span>
        <span class="n">bm</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">meth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bm</span><span class="p">(),</span> <span class="n">res</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OperatorsTest.binop_test"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest.binop_test">[docs]</a>    <span class="k">def</span> <span class="nf">binop_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">expr</span><span class="o">=</span><span class="s">&quot;a+b&quot;</span><span class="p">,</span> <span class="n">meth</span><span class="o">=</span><span class="s">&quot;__add__&quot;</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="n">b</span><span class="p">}</span>

        <span class="c"># XXX Hack so this passes before 2.3 when -Qnew is specified.</span>
        <span class="k">if</span> <span class="n">meth</span> <span class="o">==</span> <span class="s">&quot;__div__&quot;</span> <span class="ow">and</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">meth</span> <span class="o">=</span> <span class="s">&quot;__truediv__&quot;</span>

        <span class="k">if</span> <span class="n">meth</span> <span class="o">==</span> <span class="s">&#39;__divmod__&#39;</span><span class="p">:</span> <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="n">res</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">meth</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">meth</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c"># in some implementations (e.g. PyPy), &#39;m&#39; can be a regular unbound</span>
        <span class="c"># method object; the getattr() below obtains its underlying function.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&#39;im_func&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">t</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">meth</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">res</span><span class="p">)</span>
        <span class="n">bm</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">meth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bm</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">res</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OperatorsTest.sliceop_test"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest.sliceop_test">[docs]</a>    <span class="k">def</span> <span class="nf">sliceop_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">expr</span><span class="o">=</span><span class="s">&quot;a[b:c]&quot;</span><span class="p">,</span> <span class="n">meth</span><span class="o">=</span><span class="s">&quot;__getitem__&quot;</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="n">res</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">meth</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">meth</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c"># in some implementations (e.g. PyPy), &#39;m&#39; can be a regular unbound</span>
        <span class="c"># method object; the getattr() below obtains its underlying function.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&#39;im_func&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">t</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">meth</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)),</span> <span class="n">res</span><span class="p">)</span>
        <span class="n">bm</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">meth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bm</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)),</span> <span class="n">res</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OperatorsTest.setop_test"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest.setop_test">[docs]</a>    <span class="k">def</span> <span class="nf">setop_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">stmt</span><span class="o">=</span><span class="s">&quot;a+=b&quot;</span><span class="p">,</span> <span class="n">meth</span><span class="o">=</span><span class="s">&quot;__iadd__&quot;</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="n">b</span><span class="p">}</span>
        <span class="k">exec</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">meth</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">meth</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c"># in some implementations (e.g. PyPy), &#39;m&#39; can be a regular unbound</span>
        <span class="c"># method object; the getattr() below obtains its underlying function.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&#39;im_func&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">t</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">meth</span><span class="p">])</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">m</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">bm</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">meth</span><span class="p">)</span>
        <span class="n">bm</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OperatorsTest.set2op_test"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest.set2op_test">[docs]</a>    <span class="k">def</span> <span class="nf">set2op_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">stmt</span><span class="o">=</span><span class="s">&quot;a[b]=c&quot;</span><span class="p">,</span> <span class="n">meth</span><span class="o">=</span><span class="s">&quot;__setitem__&quot;</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">}</span>
        <span class="k">exec</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">meth</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">meth</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c"># in some implementations (e.g. PyPy), &#39;m&#39; can be a regular unbound</span>
        <span class="c"># method object; the getattr() below obtains its underlying function.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&#39;im_func&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">t</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">meth</span><span class="p">])</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">m</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">bm</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">meth</span><span class="p">)</span>
        <span class="n">bm</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OperatorsTest.setsliceop_test"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest.setsliceop_test">[docs]</a>    <span class="k">def</span> <span class="nf">setsliceop_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">stmt</span><span class="o">=</span><span class="s">&quot;a[b:c]=d&quot;</span><span class="p">,</span> <span class="n">meth</span><span class="o">=</span><span class="s">&quot;__setitem__&quot;</span><span class="p">):</span>
        <span class="n">dictionary</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">:</span> <span class="n">d</span><span class="p">}</span>
        <span class="k">exec</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">meth</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">meth</span><span class="p">)</span>
        <span class="c"># in some implementations (e.g. PyPy), &#39;m&#39; can be a regular unbound</span>
        <span class="c"># method object; the getattr() below obtains its underlying function.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&#39;im_func&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">t</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">meth</span><span class="p">])</span>
        <span class="n">dictionary</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">m</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="nb">slice</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">)</span>
        <span class="n">dictionary</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">bm</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">meth</span><span class="p">)</span>
        <span class="n">bm</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OperatorsTest.test_lists"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest.test_lists">[docs]</a>    <span class="k">def</span> <span class="nf">test_lists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing list operations...</span>
        <span class="c"># Asserts are within individual test methods</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="s">&quot;a+b&quot;</span><span class="p">,</span> <span class="s">&quot;__add__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;b in a&quot;</span><span class="p">,</span> <span class="s">&quot;__contains__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;b in a&quot;</span><span class="p">,</span> <span class="s">&quot;__contains__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;a[b]&quot;</span><span class="p">,</span> <span class="s">&quot;__getitem__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliceop_test</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="s">&quot;a[b:c]&quot;</span><span class="p">,</span> <span class="s">&quot;__getitem__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setop_test</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="s">&quot;a+=b&quot;</span><span class="p">,</span> <span class="s">&quot;__iadd__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setop_test</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="s">&quot;a*=b&quot;</span><span class="p">,</span> <span class="s">&quot;__imul__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unop_test</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&quot;len(a)&quot;</span><span class="p">,</span> <span class="s">&quot;__len__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="s">&quot;a*b&quot;</span><span class="p">,</span> <span class="s">&quot;__mul__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="s">&quot;b*a&quot;</span><span class="p">,</span> <span class="s">&quot;__rmul__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set2op_test</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s">&quot;a[b]=c&quot;</span><span class="p">,</span> <span class="s">&quot;__setitem__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setsliceop_test</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="s">&quot;a[b:c]=d&quot;</span><span class="p">,</span>
                        <span class="s">&quot;__setitem__&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OperatorsTest.test_dicts"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest.test_dicts">[docs]</a>    <span class="k">def</span> <span class="nf">test_dicts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing dict operations...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">},</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;b in a&quot;</span><span class="p">,</span> <span class="s">&quot;__contains__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">},</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;b in a&quot;</span><span class="p">,</span> <span class="s">&quot;__contains__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">},</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;a[b]&quot;</span><span class="p">,</span> <span class="s">&quot;__getitem__&quot;</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">}</span>
        <span class="n">l1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">l1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">__iter__</span><span class="p">():</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__iter__</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unop_test</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;len(a)&quot;</span><span class="p">,</span> <span class="s">&quot;__len__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="p">{}),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">__repr__</span><span class="p">(),</span> <span class="p">{}),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set2op_test</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">},</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">},</span> <span class="s">&quot;a[b]=c&quot;</span><span class="p">,</span>
                        <span class="s">&quot;__setitem__&quot;</span><span class="p">)</span>

    <span class="c"># Tests for unary and binary operators</span></div>
<div class="viewcode-block" id="OperatorsTest.number_operators"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest.number_operators">[docs]</a>    <span class="k">def</span> <span class="nf">number_operators</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="p">[]):</span>
        <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="n">b</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">expr</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binops</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">skip</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;__</span><span class="si">%s</span><span class="s">__&quot;</span> <span class="o">%</span> <span class="n">name</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">expr</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unops</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">skip</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;__</span><span class="si">%s</span><span class="s">__&quot;</span> <span class="o">%</span> <span class="n">name</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">unop_test</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OperatorsTest.test_ints"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest.test_ints">[docs]</a>    <span class="k">def</span> <span class="nf">test_ints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing int operations...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_operators</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="c"># The following crashes in Python 2.2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__bool__</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__bool__</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c"># This returns &#39;NotImplemented&#39; in Python 2.2</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">NotImplemented</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">C</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;&quot;</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;NotImplemented should have caused TypeError&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OperatorsTest.test_floats"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest.test_floats">[docs]</a>    <span class="k">def</span> <span class="nf">test_floats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing float operations...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_operators</span><span class="p">(</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OperatorsTest.test_complexes"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest.test_complexes">[docs]</a>    <span class="k">def</span> <span class="nf">test_complexes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing complex operations...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_operators</span><span class="p">(</span><span class="mf">100.0j</span><span class="p">,</span> <span class="mf">3.0j</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;lt&#39;</span><span class="p">,</span> <span class="s">&#39;le&#39;</span><span class="p">,</span> <span class="s">&#39;gt&#39;</span><span class="p">,</span> <span class="s">&#39;ge&#39;</span><span class="p">,</span>
                                                  <span class="s">&#39;int&#39;</span><span class="p">,</span> <span class="s">&#39;float&#39;</span><span class="p">,</span>
                                                  <span class="s">&#39;divmod&#39;</span><span class="p">,</span> <span class="s">&#39;mod&#39;</span><span class="p">])</span>

        <span class="k">class</span> <span class="nc">Number</span><span class="p">(</span><span class="nb">complex</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;prec&#39;</span><span class="p">]</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="nb">complex</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;prec&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">result</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="n">prec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prec</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">imag</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s">&quot;</span><span class="si">%.*g</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">real</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s">&quot;</span><span class="si">%.*g</span><span class="s">j&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
                <span class="k">return</span> <span class="s">&quot;(</span><span class="si">%.*g</span><span class="s">+</span><span class="si">%.*g</span><span class="s">j)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">prec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
            <span class="n">__str__</span> <span class="o">=</span> <span class="n">__repr__</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">Number</span><span class="p">(</span><span class="mf">3.14</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">&quot;3.14&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">Number</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">&quot;3.1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">Number</span><span class="p">(</span><span class="mf">234.5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">&quot;234.5&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OperatorsTest.test_explicit_reverse_methods"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest.test_explicit_reverse_methods">[docs]</a>    <span class="k">def</span> <span class="nf">test_explicit_reverse_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># see issue 9930</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">complex</span><span class="o">.</span><span class="n">__radd__</span><span class="p">(</span><span class="mi">3j</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">),</span> <span class="nb">complex</span><span class="p">(</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">float</span><span class="o">.</span><span class="n">__rsub__</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
</div>
    <span class="nd">@support.impl_detail</span><span class="p">(</span><span class="s">&quot;the module &#39;xxsubtype&#39; is internal&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="OperatorsTest.test_spam_lists"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest.test_spam_lists">[docs]</a>    <span class="k">def</span> <span class="nf">test_spam_lists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing spamlist operations...</span>
        <span class="kn">import</span> <span class="nn">copy</span><span class="o">,</span> <span class="nn">xxsubtype</span> <span class="kn">as</span> <span class="nn">spam</span>

        <span class="k">def</span> <span class="nf">spamlist</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="kn">import</span> <span class="nn">xxsubtype</span> <span class="kn">as</span> <span class="nn">spam</span>
            <span class="k">return</span> <span class="n">spam</span><span class="o">.</span><span class="n">spamlist</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

        <span class="c"># This is an ugly hack:</span>
        <span class="n">copy</span><span class="o">.</span><span class="n">_deepcopy_dispatch</span><span class="p">[</span><span class="n">spam</span><span class="o">.</span><span class="n">spamlist</span><span class="p">]</span> <span class="o">=</span> <span class="n">spamlist</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">(</span><span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="n">spamlist</span><span class="p">([</span><span class="mi">2</span><span class="p">]),</span> <span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="s">&quot;a+b&quot;</span><span class="p">,</span>
                       <span class="s">&quot;__add__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">(</span><span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;b in a&quot;</span><span class="p">,</span> <span class="s">&quot;__contains__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">(</span><span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;b in a&quot;</span><span class="p">,</span> <span class="s">&quot;__contains__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">(</span><span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;a[b]&quot;</span><span class="p">,</span> <span class="s">&quot;__getitem__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliceop_test</span><span class="p">(</span><span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="s">&quot;a[b:c]&quot;</span><span class="p">,</span>
                          <span class="s">&quot;__getitem__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setop_test</span><span class="p">(</span><span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="n">spamlist</span><span class="p">([</span><span class="mi">2</span><span class="p">]),</span> <span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="s">&quot;a+=b&quot;</span><span class="p">,</span>
                        <span class="s">&quot;__iadd__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setop_test</span><span class="p">(</span><span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="s">&quot;a*=b&quot;</span><span class="p">,</span>
                        <span class="s">&quot;__imul__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unop_test</span><span class="p">(</span><span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&quot;len(a)&quot;</span><span class="p">,</span> <span class="s">&quot;__len__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">(</span><span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="s">&quot;a*b&quot;</span><span class="p">,</span>
                        <span class="s">&quot;__mul__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">(</span><span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="s">&quot;b*a&quot;</span><span class="p">,</span>
                        <span class="s">&quot;__rmul__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set2op_test</span><span class="p">(</span><span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="s">&quot;a[b]=c&quot;</span><span class="p">,</span>
                         <span class="s">&quot;__setitem__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setsliceop_test</span><span class="p">(</span><span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">spamlist</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]),</span>
                             <span class="n">spamlist</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="s">&quot;a[b:c]=d&quot;</span><span class="p">,</span> <span class="s">&quot;__setitem__&quot;</span><span class="p">)</span>
        <span class="c"># Test subclassing</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">spam</span><span class="o">.</span><span class="n">spamlist</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="mi">1</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">foo</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">getstate</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">setstate</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">getstate</span><span class="p">(),</span> <span class="mi">42</span><span class="p">)</span>
</div>
    <span class="nd">@support.impl_detail</span><span class="p">(</span><span class="s">&quot;the module &#39;xxsubtype&#39; is internal&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="OperatorsTest.test_spam_dicts"><a class="viewcode-back" href="../../test.html#test.test_descr.OperatorsTest.test_spam_dicts">[docs]</a>    <span class="k">def</span> <span class="nf">test_spam_dicts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing spamdict operations...</span>
        <span class="kn">import</span> <span class="nn">copy</span><span class="o">,</span> <span class="nn">xxsubtype</span> <span class="kn">as</span> <span class="nn">spam</span>
        <span class="k">def</span> <span class="nf">spamdict</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="kn">import</span> <span class="nn">xxsubtype</span> <span class="kn">as</span> <span class="nn">spam</span>
            <span class="n">sd</span> <span class="o">=</span> <span class="n">spam</span><span class="o">.</span><span class="n">spamdict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">sd</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">return</span> <span class="n">sd</span>
        <span class="c"># This is an ugly hack:</span>
        <span class="n">copy</span><span class="o">.</span><span class="n">_deepcopy_dispatch</span><span class="p">[</span><span class="n">spam</span><span class="o">.</span><span class="n">spamdict</span><span class="p">]</span> <span class="o">=</span> <span class="n">spamdict</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">(</span><span class="n">spamdict</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">}),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;b in a&quot;</span><span class="p">,</span> <span class="s">&quot;__contains__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">(</span><span class="n">spamdict</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">}),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;b in a&quot;</span><span class="p">,</span> <span class="s">&quot;__contains__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binop_test</span><span class="p">(</span><span class="n">spamdict</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">}),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;a[b]&quot;</span><span class="p">,</span> <span class="s">&quot;__getitem__&quot;</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">spamdict</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">l1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">l1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">__iter__</span><span class="p">():</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">type</span><span class="p">(</span><span class="n">spamdict</span><span class="p">({}))</span><span class="o">.</span><span class="n">__iter__</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
        <span class="n">straightd</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">}</span>
        <span class="n">spamd</span> <span class="o">=</span> <span class="n">spamdict</span><span class="p">(</span><span class="n">straightd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unop_test</span><span class="p">(</span><span class="n">spamd</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;len(a)&quot;</span><span class="p">,</span> <span class="s">&quot;__len__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unop_test</span><span class="p">(</span><span class="n">spamd</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">straightd</span><span class="p">),</span> <span class="s">&quot;repr(a)&quot;</span><span class="p">,</span> <span class="s">&quot;__repr__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set2op_test</span><span class="p">(</span><span class="n">spamdict</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">}),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">spamdict</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">}),</span>
                   <span class="s">&quot;a[b]=c&quot;</span><span class="p">,</span> <span class="s">&quot;__setitem__&quot;</span><span class="p">)</span>
        <span class="c"># Test subclassing</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">spam</span><span class="o">.</span><span class="n">spamdict</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="mi">1</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">foo</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">a</span><span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;bar&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="p">[(</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">getstate</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">setstate</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">getstate</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="ClassPropertiesAndMethods"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods">[docs]</a><span class="k">class</span> <span class="nc">ClassPropertiesAndMethods</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="ClassPropertiesAndMethods.assertHasAttr"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.assertHasAttr">[docs]</a>    <span class="k">def</span> <span class="nf">assertHasAttr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span>
                        <span class="s">&#39;</span><span class="si">%r</span><span class="s"> has no attribute </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.assertNotHasAttr"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.assertNotHasAttr">[docs]</a>    <span class="k">def</span> <span class="nf">assertNotHasAttr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span>
                         <span class="s">&#39;</span><span class="si">%r</span><span class="s"> has unexpected attribute </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_python_dicts"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_python_dicts">[docs]</a>    <span class="k">def</span> <span class="nf">test_python_dicts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing Python subclass of dict...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">({},</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
            <span class="n">state</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self_local</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">a</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">self_local</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">kw</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                        <span class="n">self_local</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
            <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="n">self_local</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                <span class="nb">dict</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="n">self_local</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">setstate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">state</span>
            <span class="k">def</span> <span class="nf">getstate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="nb">dict</span><span class="p">))</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bar</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;foo&#39;</span> <span class="ow">and</span> <span class="n">a2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s">&#39;bar&#39;</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">getstate</span><span class="p">(),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">setstate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">getstate</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">setstate</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">getstate</span><span class="p">(),</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">42</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">42</span><span class="p">],</span> <span class="mi">24</span><span class="p">)</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">j</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_python_lists"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_python_lists">[docs]</a>    <span class="k">def</span> <span class="nf">test_python_lists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing Python subclass of list...</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">i</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">stop</span>
                <span class="k">return</span> <span class="nb">list</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">a</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">101</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">102</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">200</span><span class="p">],</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_metaclass"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_metaclass">[docs]</a>    <span class="k">def</span> <span class="nf">test_metaclass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing metaclasses...</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__state</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">def</span> <span class="nf">getstate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__state</span>
            <span class="k">def</span> <span class="nf">setstate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__state</span> <span class="o">=</span> <span class="n">state</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">getstate</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">setstate</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">getstate</span><span class="p">(),</span> <span class="mi">10</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">_metaclass</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">myself</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span> <span class="k">return</span> <span class="n">cls</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">_metaclass</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">myself</span><span class="p">(),</span> <span class="n">D</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">M1</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="nb">dict</span><span class="p">[</span><span class="s">&#39;__spam__&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="nb">type</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">M1</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">__spam__</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">__spam__</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">_instance</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">M2</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="nd">@staticmethod</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="bp">self</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bases</span> <span class="o">=</span> <span class="n">bases</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dict</span> <span class="o">=</span> <span class="nb">dict</span>
                <span class="k">return</span> <span class="bp">self</span>
            <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="n">it</span> <span class="o">=</span> <span class="n">_instance</span><span class="p">()</span>
                <span class="c"># Early binding of methods</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;__&quot;</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">__get__</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">it</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">M2</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">spam</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">bases</span><span class="p">,</span> <span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&#39;spam&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">dict</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">spam</span><span class="p">(),</span> <span class="mi">42</span><span class="p">)</span>

        <span class="c"># More metaclass examples</span>

        <span class="k">class</span> <span class="nc">autosuper</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="c"># Automatically add __super to the class</span>
            <span class="c"># This trick only works for dynamic classes</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">metaclass</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">cls</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">autosuper</span><span class="p">,</span> <span class="n">metaclass</span><span class="p">)</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">metaclass</span><span class="p">,</span>
                                                          <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
                <span class="c"># Name mangling for __super removes leading underscores</span>
                <span class="k">while</span> <span class="n">name</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;_&quot;</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;_</span><span class="si">%s</span><span class="s">__super&quot;</span> <span class="o">%</span> <span class="n">name</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;__super&quot;</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">super</span><span class="p">(</span><span class="n">cls</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">cls</span>
        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">autosuper</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;A&quot;</span>
        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;B&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__super</span><span class="o">.</span><span class="n">meth</span><span class="p">()</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;C&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__super</span><span class="o">.</span><span class="n">meth</span><span class="p">()</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;D&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__super</span><span class="o">.</span><span class="n">meth</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">()</span><span class="o">.</span><span class="n">meth</span><span class="p">(),</span> <span class="s">&quot;DCBA&quot;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;E&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__super</span><span class="o">.</span><span class="n">meth</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">E</span><span class="p">()</span><span class="o">.</span><span class="n">meth</span><span class="p">(),</span> <span class="s">&quot;EBCA&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">autoproperty</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="c"># Automatically create property attributes when methods</span>
            <span class="c"># named _get_x and/or _set_x are found</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">metaclass</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">hits</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;_get_&quot;</span><span class="p">):</span>
                        <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>
                        <span class="n">get</span><span class="p">,</span> <span class="nb">set</span> <span class="o">=</span> <span class="n">hits</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
                        <span class="n">get</span> <span class="o">=</span> <span class="n">val</span>
                        <span class="n">hits</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">get</span><span class="p">,</span> <span class="nb">set</span>
                    <span class="k">elif</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;_set_&quot;</span><span class="p">):</span>
                        <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>
                        <span class="n">get</span><span class="p">,</span> <span class="nb">set</span> <span class="o">=</span> <span class="n">hits</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
                        <span class="nb">set</span> <span class="o">=</span> <span class="n">val</span>
                        <span class="n">hits</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">get</span><span class="p">,</span> <span class="nb">set</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">get</span><span class="p">,</span> <span class="nb">set</span><span class="p">)</span> <span class="ow">in</span> <span class="n">hits</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="nb">dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get</span><span class="p">,</span> <span class="nb">set</span><span class="p">)</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">autoproperty</span><span class="p">,</span> <span class="n">metaclass</span><span class="p">)</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">metaclass</span><span class="p">,</span>
                                                            <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">autoproperty</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">_get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">__x</span>
            <span class="k">def</span> <span class="nf">_set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__x</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">_A__x</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">multimetaclass</span><span class="p">(</span><span class="n">autoproperty</span><span class="p">,</span> <span class="n">autosuper</span><span class="p">):</span>
            <span class="c"># Merge of multiple cooperating metaclasses</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">multimetaclass</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">_get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;A&quot;</span>
        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">_get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;B&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__super</span><span class="o">.</span><span class="n">_get_x</span><span class="p">()</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">_get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;C&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__super</span><span class="o">.</span><span class="n">_get_x</span><span class="p">()</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">_get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;D&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__super</span><span class="o">.</span><span class="n">_get_x</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s">&quot;DCBA&quot;</span><span class="p">)</span>

        <span class="c"># Make sure type(x) doesn&#39;t call x.__class__.__init__</span>
        <span class="k">class</span> <span class="nc">T</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
                <span class="n">T</span><span class="o">.</span><span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">T</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">counter</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">C</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">counter</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span> <span class="n">c</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;calling object w/o call method should raise &quot;</span>
                        <span class="s">&quot;TypeError&quot;</span><span class="p">)</span>

        <span class="c"># Testing code to find most derived baseclass</span>
        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">type</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">A</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="c"># The most derived metaclass of D is A rather than type.</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">D</span><span class="p">))</span>

        <span class="c"># issue1294232: correct metaclass calculation</span>
        <span class="n">new_calls</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># to check the order of __new__ calls</span>
        <span class="k">class</span> <span class="nc">AMeta</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="nd">@staticmethod</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">ns</span><span class="p">):</span>
                <span class="n">new_calls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;AMeta&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">ns</span><span class="p">)</span>
            <span class="nd">@classmethod</span>
            <span class="k">def</span> <span class="nf">__prepare__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{}</span>

        <span class="k">class</span> <span class="nc">BMeta</span><span class="p">(</span><span class="n">AMeta</span><span class="p">):</span>
            <span class="nd">@staticmethod</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">ns</span><span class="p">):</span>
                <span class="n">new_calls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;BMeta&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">ns</span><span class="p">)</span>
            <span class="nd">@classmethod</span>
            <span class="k">def</span> <span class="nf">__prepare__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">):</span>
                <span class="n">ns</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__prepare__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">)</span>
                <span class="n">ns</span><span class="p">[</span><span class="s">&#39;BMeta_was_here&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">return</span> <span class="n">ns</span>

        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">AMeta</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;AMeta&#39;</span><span class="p">],</span> <span class="n">new_calls</span><span class="p">)</span>
        <span class="n">new_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">BMeta</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="c"># BMeta.__new__ calls AMeta.__new__ with super:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BMeta&#39;</span><span class="p">,</span> <span class="s">&#39;AMeta&#39;</span><span class="p">],</span> <span class="n">new_calls</span><span class="p">)</span>
        <span class="n">new_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="c"># The most derived metaclass is BMeta:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BMeta&#39;</span><span class="p">,</span> <span class="s">&#39;AMeta&#39;</span><span class="p">],</span> <span class="n">new_calls</span><span class="p">)</span>
        <span class="n">new_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="c"># BMeta.__prepare__ should&#39;ve been called:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&#39;BMeta_was_here&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">__dict__</span><span class="p">)</span>

        <span class="c"># The order of the bases shouldn&#39;t matter:</span>
        <span class="k">class</span> <span class="nc">C2</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BMeta&#39;</span><span class="p">,</span> <span class="s">&#39;AMeta&#39;</span><span class="p">],</span> <span class="n">new_calls</span><span class="p">)</span>
        <span class="n">new_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&#39;BMeta_was_here&#39;</span><span class="p">,</span> <span class="n">C2</span><span class="o">.</span><span class="n">__dict__</span><span class="p">)</span>

        <span class="c"># Check correct metaclass calculation when a metaclass is declared:</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BMeta&#39;</span><span class="p">,</span> <span class="s">&#39;AMeta&#39;</span><span class="p">],</span> <span class="n">new_calls</span><span class="p">)</span>
        <span class="n">new_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&#39;BMeta_was_here&#39;</span><span class="p">,</span> <span class="n">D</span><span class="o">.</span><span class="n">__dict__</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">AMeta</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BMeta&#39;</span><span class="p">,</span> <span class="s">&#39;AMeta&#39;</span><span class="p">],</span> <span class="n">new_calls</span><span class="p">)</span>
        <span class="n">new_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&#39;BMeta_was_here&#39;</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">__dict__</span><span class="p">)</span>

        <span class="c"># Special case: the given metaclass isn&#39;t a class,</span>
        <span class="c"># so there is no metaclass calculation.</span>
        <span class="n">marker</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
        <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">marker</span>
        <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">func</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">Y</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">func</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">Z</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">func</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>

        <span class="c"># The given metaclass is a class,</span>
        <span class="c"># but not a descendant of type.</span>
        <span class="n">prepare_calls</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># to track __prepare__ calls</span>
        <span class="k">class</span> <span class="nc">ANotMeta</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="n">new_calls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;ANotMeta&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">)</span>
            <span class="nd">@classmethod</span>
            <span class="k">def</span> <span class="nf">__prepare__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">):</span>
                <span class="n">prepare_calls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;ANotMeta&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">{}</span>
        <span class="k">class</span> <span class="nc">BNotMeta</span><span class="p">(</span><span class="n">ANotMeta</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="n">new_calls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;BNotMeta&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">)</span>
            <span class="nd">@classmethod</span>
            <span class="k">def</span> <span class="nf">__prepare__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">):</span>
                <span class="n">prepare_calls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;BNotMeta&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__prepare__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">ANotMeta</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">ANotMeta</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;ANotMeta&#39;</span><span class="p">],</span> <span class="n">prepare_calls</span><span class="p">)</span>
        <span class="n">prepare_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;ANotMeta&#39;</span><span class="p">],</span> <span class="n">new_calls</span><span class="p">)</span>
        <span class="n">new_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">BNotMeta</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">BNotMeta</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BNotMeta&#39;</span><span class="p">,</span> <span class="s">&#39;ANotMeta&#39;</span><span class="p">],</span> <span class="n">prepare_calls</span><span class="p">)</span>
        <span class="n">prepare_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BNotMeta&#39;</span><span class="p">,</span> <span class="s">&#39;ANotMeta&#39;</span><span class="p">],</span> <span class="n">new_calls</span><span class="p">)</span>
        <span class="n">new_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">BNotMeta</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BNotMeta&#39;</span><span class="p">,</span> <span class="s">&#39;ANotMeta&#39;</span><span class="p">],</span> <span class="n">new_calls</span><span class="p">)</span>
        <span class="n">new_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BNotMeta&#39;</span><span class="p">,</span> <span class="s">&#39;ANotMeta&#39;</span><span class="p">],</span> <span class="n">prepare_calls</span><span class="p">)</span>
        <span class="n">prepare_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">class</span> <span class="nc">C2</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">BNotMeta</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">C2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BNotMeta&#39;</span><span class="p">,</span> <span class="s">&#39;ANotMeta&#39;</span><span class="p">],</span> <span class="n">new_calls</span><span class="p">)</span>
        <span class="n">new_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BNotMeta&#39;</span><span class="p">,</span> <span class="s">&#39;ANotMeta&#39;</span><span class="p">],</span> <span class="n">prepare_calls</span><span class="p">)</span>
        <span class="n">prepare_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c"># This is a TypeError, because of a metaclass conflict:</span>
        <span class="c"># BNotMeta is neither a subclass, nor a superclass of type</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="nb">type</span><span class="p">):</span>
                <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ANotMeta</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">BNotMeta</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BNotMeta&#39;</span><span class="p">,</span> <span class="s">&#39;ANotMeta&#39;</span><span class="p">],</span> <span class="n">new_calls</span><span class="p">)</span>
        <span class="n">new_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BNotMeta&#39;</span><span class="p">,</span> <span class="s">&#39;ANotMeta&#39;</span><span class="p">],</span> <span class="n">prepare_calls</span><span class="p">)</span>
        <span class="n">prepare_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">class</span> <span class="nc">F</span><span class="p">(</span><span class="nb">object</span><span class="p">(),</span> <span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">BNotMeta</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">F</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BNotMeta&#39;</span><span class="p">,</span> <span class="s">&#39;ANotMeta&#39;</span><span class="p">],</span> <span class="n">new_calls</span><span class="p">)</span>
        <span class="n">new_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BNotMeta&#39;</span><span class="p">,</span> <span class="s">&#39;ANotMeta&#39;</span><span class="p">],</span> <span class="n">prepare_calls</span><span class="p">)</span>
        <span class="n">prepare_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">class</span> <span class="nc">F2</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="nb">object</span><span class="p">()):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">BNotMeta</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">F2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BNotMeta&#39;</span><span class="p">,</span> <span class="s">&#39;ANotMeta&#39;</span><span class="p">],</span> <span class="n">new_calls</span><span class="p">)</span>
        <span class="n">new_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="s">&#39;BNotMeta&#39;</span><span class="p">,</span> <span class="s">&#39;ANotMeta&#39;</span><span class="p">],</span> <span class="n">prepare_calls</span><span class="p">)</span>
        <span class="n">prepare_calls</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c"># TypeError: BNotMeta is neither a</span>
        <span class="c"># subclass, nor a superclass of int</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="nb">int</span><span class="p">()):</span>
                <span class="k">pass</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="nb">int</span><span class="p">(),</span> <span class="n">C</span><span class="p">):</span>
                <span class="k">pass</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_module_subclasses"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_module_subclasses">[docs]</a>    <span class="k">def</span> <span class="nf">test_module_subclasses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing Python subclass of module...</span>
        <span class="n">log</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">MT</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">MM</span><span class="p">(</span><span class="n">MT</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="n">MT</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;getattr&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">MT</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;setattr&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
                <span class="n">MT</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__delattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;delattr&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
                <span class="n">MT</span><span class="o">.</span><span class="n">__delattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">MM</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">foo</span>
        <span class="k">del</span> <span class="n">a</span><span class="o">.</span><span class="n">foo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;setattr&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
                               <span class="p">(</span><span class="s">&quot;getattr&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s">&quot;delattr&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">)])</span>

        <span class="c"># http://python.org/sf/1174712</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">Module</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;inheriting from ModuleType and str at the same time &quot;</span>
                      <span class="s">&quot;should fail&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_multiple_inheritance"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_multiple_inheritance">[docs]</a>    <span class="k">def</span> <span class="nf">test_multiple_inheritance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing multiple inheritance...</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__state</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">def</span> <span class="nf">getstate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__state</span>
            <span class="k">def</span> <span class="nf">setstate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__state</span> <span class="o">=</span> <span class="n">state</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">getstate</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">setstate</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">getstate</span><span class="p">(),</span> <span class="mi">10</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="nb">type</span><span class="p">({})</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">C</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="p">[])</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&quot;hello&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;world&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="p">[(</span><span class="s">&quot;hello&quot;</span><span class="p">,</span> <span class="s">&quot;world&quot;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&quot;hello&quot;</span><span class="p">],</span> <span class="s">&quot;world&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">getstate</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">setstate</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">getstate</span><span class="p">(),</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">__mro__</span><span class="p">,</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="nb">object</span><span class="p">))</span>

        <span class="c"># SF bug #442833</span>
        <span class="k">class</span> <span class="nc">Node</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">foo</span><span class="p">())</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;23&quot;</span>
        <span class="k">class</span> <span class="nc">Frag</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;42&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Node</span><span class="p">()</span><span class="o">.</span><span class="n">__int__</span><span class="p">(),</span> <span class="mi">23</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Node</span><span class="p">()),</span> <span class="mi">23</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Frag</span><span class="p">()</span><span class="o">.</span><span class="n">__int__</span><span class="p">(),</span> <span class="mi">42</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Frag</span><span class="p">()),</span> <span class="mi">42</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_diamond_inheritence"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_diamond_inheritence">[docs]</a>    <span class="k">def</span> <span class="nf">test_diamond_inheritence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing multiple inheritance special cases...</span>
        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">spam</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="s">&quot;A&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">A</span><span class="p">()</span><span class="o">.</span><span class="n">spam</span><span class="p">(),</span> <span class="s">&quot;A&quot;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">boo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="s">&quot;B&quot;</span>
            <span class="k">def</span> <span class="nf">spam</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="s">&quot;B&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">B</span><span class="p">()</span><span class="o">.</span><span class="n">spam</span><span class="p">(),</span> <span class="s">&quot;B&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">B</span><span class="p">()</span><span class="o">.</span><span class="n">boo</span><span class="p">(),</span> <span class="s">&quot;B&quot;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">boo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="s">&quot;C&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="p">()</span><span class="o">.</span><span class="n">spam</span><span class="p">(),</span> <span class="s">&quot;A&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="p">()</span><span class="o">.</span><span class="n">boo</span><span class="p">(),</span> <span class="s">&quot;C&quot;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span> <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">()</span><span class="o">.</span><span class="n">spam</span><span class="p">(),</span> <span class="s">&quot;B&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">()</span><span class="o">.</span><span class="n">boo</span><span class="p">(),</span> <span class="s">&quot;B&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">__mro__</span><span class="p">,</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="nb">object</span><span class="p">))</span>
        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span> <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">E</span><span class="p">()</span><span class="o">.</span><span class="n">spam</span><span class="p">(),</span> <span class="s">&quot;B&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">E</span><span class="p">()</span><span class="o">.</span><span class="n">boo</span><span class="p">(),</span> <span class="s">&quot;C&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">__mro__</span><span class="p">,</span> <span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="nb">object</span><span class="p">))</span>
        <span class="c"># MRO order disagreement</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">F</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;expected MRO order disagreement (F)&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">G</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">D</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;expected MRO order disagreement (G)&quot;</span><span class="p">)</span>

    <span class="c"># see thread python-dev/2002-October/029035.html</span></div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_ex5_from_c3_switch"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_ex5_from_c3_switch">[docs]</a>    <span class="k">def</span> <span class="nf">test_ex5_from_c3_switch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing ex5 from C3 switch discussion...</span>
        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="n">A</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">Y</span><span class="p">(</span><span class="n">A</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">Z</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Z</span><span class="o">.</span><span class="n">__mro__</span><span class="p">,</span> <span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="nb">object</span><span class="p">))</span>

    <span class="c"># see &quot;A Monotonic Superclass Linearization for Dylan&quot;,</span>
    <span class="c"># by Kim Barrett et al. (OOPSLA 1996)</span></div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_monotonicity"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_monotonicity">[docs]</a>    <span class="k">def</span> <span class="nf">test_monotonicity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing MRO monotonicity...</span>
        <span class="k">class</span> <span class="nc">Boat</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">DayBoat</span><span class="p">(</span><span class="n">Boat</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">WheelBoat</span><span class="p">(</span><span class="n">Boat</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">EngineLess</span><span class="p">(</span><span class="n">DayBoat</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">SmallMultihull</span><span class="p">(</span><span class="n">DayBoat</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">PedalWheelBoat</span><span class="p">(</span><span class="n">EngineLess</span><span class="p">,</span><span class="n">WheelBoat</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">SmallCatamaran</span><span class="p">(</span><span class="n">SmallMultihull</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">Pedalo</span><span class="p">(</span><span class="n">PedalWheelBoat</span><span class="p">,</span><span class="n">SmallCatamaran</span><span class="p">):</span> <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">PedalWheelBoat</span><span class="o">.</span><span class="n">__mro__</span><span class="p">,</span>
              <span class="p">(</span><span class="n">PedalWheelBoat</span><span class="p">,</span> <span class="n">EngineLess</span><span class="p">,</span> <span class="n">DayBoat</span><span class="p">,</span> <span class="n">WheelBoat</span><span class="p">,</span> <span class="n">Boat</span><span class="p">,</span> <span class="nb">object</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">SmallCatamaran</span><span class="o">.</span><span class="n">__mro__</span><span class="p">,</span>
              <span class="p">(</span><span class="n">SmallCatamaran</span><span class="p">,</span> <span class="n">SmallMultihull</span><span class="p">,</span> <span class="n">DayBoat</span><span class="p">,</span> <span class="n">Boat</span><span class="p">,</span> <span class="nb">object</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Pedalo</span><span class="o">.</span><span class="n">__mro__</span><span class="p">,</span>
              <span class="p">(</span><span class="n">Pedalo</span><span class="p">,</span> <span class="n">PedalWheelBoat</span><span class="p">,</span> <span class="n">EngineLess</span><span class="p">,</span> <span class="n">SmallCatamaran</span><span class="p">,</span>
               <span class="n">SmallMultihull</span><span class="p">,</span> <span class="n">DayBoat</span><span class="p">,</span> <span class="n">WheelBoat</span><span class="p">,</span> <span class="n">Boat</span><span class="p">,</span> <span class="nb">object</span><span class="p">))</span>

    <span class="c"># see &quot;A Monotonic Superclass Linearization for Dylan&quot;,</span>
    <span class="c"># by Kim Barrett et al. (OOPSLA 1996)</span></div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_consistency_with_epg"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_consistency_with_epg">[docs]</a>    <span class="k">def</span> <span class="nf">test_consistency_with_epg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing consistency with EPG...</span>
        <span class="k">class</span> <span class="nc">Pane</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">ScrollingMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">EditingMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">ScrollablePane</span><span class="p">(</span><span class="n">Pane</span><span class="p">,</span><span class="n">ScrollingMixin</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">EditablePane</span><span class="p">(</span><span class="n">Pane</span><span class="p">,</span><span class="n">EditingMixin</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">EditableScrollablePane</span><span class="p">(</span><span class="n">ScrollablePane</span><span class="p">,</span><span class="n">EditablePane</span><span class="p">):</span> <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">EditableScrollablePane</span><span class="o">.</span><span class="n">__mro__</span><span class="p">,</span>
              <span class="p">(</span><span class="n">EditableScrollablePane</span><span class="p">,</span> <span class="n">ScrollablePane</span><span class="p">,</span> <span class="n">EditablePane</span><span class="p">,</span> <span class="n">Pane</span><span class="p">,</span>
                <span class="n">ScrollingMixin</span><span class="p">,</span> <span class="n">EditingMixin</span><span class="p">,</span> <span class="nb">object</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_mro_disagreement"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_mro_disagreement">[docs]</a>    <span class="k">def</span> <span class="nf">test_mro_disagreement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing error messages for MRO disagreement...</span>
        <span class="n">mro_err_msg</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;Cannot create a consistent method resolution</span>
<span class="s">order (MRO) for bases &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">raises</span><span class="p">(</span><span class="n">exc</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span> <span class="nb">callable</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">callable</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">exc</span> <span class="k">as</span> <span class="n">msg</span><span class="p">:</span>
                <span class="c"># the exact msg is generally considered an impl detail</span>
                <span class="k">if</span> <span class="n">support</span><span class="o">.</span><span class="n">check_impl_detail</span><span class="p">():</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">expected</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Message </span><span class="si">%r</span><span class="s">, expected </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span>
                                  <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span> <span class="n">expected</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Expected </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">exc</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>

        <span class="c"># Test some very simple errors</span>
        <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="s">&quot;duplicate base class A&quot;</span><span class="p">,</span>
               <span class="nb">type</span><span class="p">,</span> <span class="s">&quot;X&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="p">),</span> <span class="p">{})</span>
        <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">mro_err_msg</span><span class="p">,</span>
               <span class="nb">type</span><span class="p">,</span> <span class="s">&quot;X&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">),</span> <span class="p">{})</span>
        <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">mro_err_msg</span><span class="p">,</span>
               <span class="nb">type</span><span class="p">,</span> <span class="s">&quot;X&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">B</span><span class="p">),</span> <span class="p">{})</span>
        <span class="c"># Test a slightly more complex error</span>
        <span class="k">class</span> <span class="nc">GridLayout</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">HorizontalGrid</span><span class="p">(</span><span class="n">GridLayout</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">VerticalGrid</span><span class="p">(</span><span class="n">GridLayout</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">HVGrid</span><span class="p">(</span><span class="n">HorizontalGrid</span><span class="p">,</span> <span class="n">VerticalGrid</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">VHGrid</span><span class="p">(</span><span class="n">VerticalGrid</span><span class="p">,</span> <span class="n">HorizontalGrid</span><span class="p">):</span> <span class="k">pass</span>
        <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">mro_err_msg</span><span class="p">,</span>
               <span class="nb">type</span><span class="p">,</span> <span class="s">&quot;ConfusedGrid&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">HVGrid</span><span class="p">,</span> <span class="n">VHGrid</span><span class="p">),</span> <span class="p">{})</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_object_class"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_object_class">[docs]</a>    <span class="k">def</span> <span class="nf">test_object_class</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing object class...</span>
        <span class="n">a</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">object</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">object</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;object() should not allow setting a foo attribute&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="nb">object</span><span class="p">(),</span> <span class="s">&quot;__dict__&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">Cdict</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">Cdict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">x</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_slots"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_slots">[docs]</a>    <span class="k">def</span> <span class="nf">test_slots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing __slots__...</span>
        <span class="k">class</span> <span class="nc">C0</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">C0</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&quot;__dict__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C1</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">C1</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&quot;__dict__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">x</span><span class="o">.</span><span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C3</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">C3</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&quot;__dict__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">x</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">x</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C4</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Validate name mangling&quot;&quot;&quot;</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;__a&#39;</span><span class="p">]</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__a</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__a</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">C4</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;__dict__&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;__a&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="mi">5</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">x</span><span class="o">.</span><span class="n">__a</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Double underscored names not mangled&quot;</span><span class="p">)</span>

        <span class="c"># Make sure slot names are proper identifiers</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
                <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;[None] slots not caught&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
                <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;foo bar&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;[&#39;foo bar&#39;] slots not caught&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
                <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;foo</span><span class="se">\0</span><span class="s">bar&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;[&#39;foo</span><span class="se">\\</span><span class="s">0bar&#39;] slots not caught&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
                <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;1&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;[&#39;1&#39;] slots not caught&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
                <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;[&#39;&#39;] slots not caught&quot;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;a_b&quot;</span><span class="p">,</span> <span class="s">&quot;_a&quot;</span><span class="p">,</span> <span class="s">&quot;A0123456789Z&quot;</span><span class="p">]</span>
        <span class="c"># XXX(nnorwitz): was there supposed to be something tested</span>
        <span class="c"># from the class above?</span>

        <span class="c"># Test a single string is not expanded as a sequence.</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="s">&quot;abc&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">c</span><span class="o">.</span><span class="n">abc</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">abc</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="c"># Test unicode slot names</span>
        <span class="c"># Test a single unicode string is not expanded as a sequence.</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="s">&quot;abc&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">c</span><span class="o">.</span><span class="n">abc</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">abc</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="c"># _unicode_to_string used to modify slots in certain circumstances</span>
        <span class="n">slots</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="n">slots</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">x</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">slots</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">str</span><span class="p">)</span>
        <span class="c"># this used to leak references</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
                <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="nb">chr</span><span class="p">(</span><span class="mi">128</span><span class="p">)]</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">UnicodeEncodeError</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;[chr(128)] slots not caught&quot;</span><span class="p">)</span>

        <span class="c"># Test leaks</span>
        <span class="k">class</span> <span class="nc">Counted</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c"># counts the number of instances alive</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="n">Counted</span><span class="o">.</span><span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="n">Counted</span><span class="o">.</span><span class="n">counter</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">x</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">Counted</span><span class="p">()</span>
        <span class="n">x</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">Counted</span><span class="p">()</span>
        <span class="n">x</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">Counted</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Counted</span><span class="o">.</span><span class="n">counter</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">x</span>
        <span class="n">support</span><span class="o">.</span><span class="n">gc_collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Counted</span><span class="o">.</span><span class="n">counter</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="n">x</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">Counted</span><span class="p">()</span>
        <span class="n">x</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">Counted</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Counted</span><span class="o">.</span><span class="n">counter</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">x</span>
        <span class="n">support</span><span class="o">.</span><span class="n">gc_collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Counted</span><span class="o">.</span><span class="n">counter</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;e&#39;</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">E</span><span class="p">()</span>
        <span class="n">x</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">Counted</span><span class="p">()</span>
        <span class="n">x</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">Counted</span><span class="p">()</span>
        <span class="n">x</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="n">Counted</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Counted</span><span class="o">.</span><span class="n">counter</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">x</span>
        <span class="n">support</span><span class="o">.</span><span class="n">gc_collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Counted</span><span class="o">.</span><span class="n">counter</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c"># Test cyclical leaks [SF bug 519621]</span>
        <span class="k">class</span> <span class="nc">F</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">]</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">F</span><span class="p">()</span>
        <span class="n">s</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">Counted</span><span class="p">(),</span> <span class="n">s</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Counted</span><span class="o">.</span><span class="n">counter</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">support</span><span class="o">.</span><span class="n">gc_collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Counted</span><span class="o">.</span><span class="n">counter</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c"># Test lookup leaks [SF bug 572567]</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="s">&#39;get_objects&#39;</span><span class="p">):</span>
            <span class="k">class</span> <span class="nc">G</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
                <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">False</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">G</span><span class="p">()</span>
            <span class="n">orig_objects</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gc</span><span class="o">.</span><span class="n">get_objects</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
                <span class="n">g</span><span class="o">==</span><span class="n">g</span>
            <span class="n">new_objects</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gc</span><span class="o">.</span><span class="n">get_objects</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">orig_objects</span><span class="p">,</span> <span class="n">new_objects</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">H</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">]</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="n">self_</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">self_</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">self_</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">support</span><span class="o">.</span><span class="n">captured_output</span><span class="p">(</span><span class="s">&#39;stderr&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">H</span><span class="p">()</span>
            <span class="k">del</span> <span class="n">h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span> <span class="s">&#39;&#39;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="s">&quot;a&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">X</span><span class="p">()</span><span class="o">.</span><span class="n">a</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_slots_special"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_slots_special">[docs]</a>    <span class="k">def</span> <span class="nf">test_slots_special</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing __dict__ and __weakref__ in __slots__...</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;__dict__&quot;</span><span class="p">]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;__dict__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;__weakref__&quot;</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;foo&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">})</span>

        <span class="k">class</span> <span class="nc">W</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;__weakref__&quot;</span><span class="p">]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">W</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;__weakref__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;__dict__&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t be allowed to set a.foo&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C1</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">D</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C1</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;__dict__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;__weakref__&quot;</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;foo&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">})</span>

        <span class="k">class</span> <span class="nc">C2</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">W</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C2</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;__dict__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;__weakref__&quot;</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;foo&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_slots_descriptor"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_slots_descriptor">[docs]</a>    <span class="k">def</span> <span class="nf">test_slots_descriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Issue2115: slot descriptors did not correctly check</span>
        <span class="c"># the type of the given object</span>
        <span class="kn">import</span> <span class="nn">abc</span>
        <span class="k">class</span> <span class="nc">MyABC</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="s">&quot;a&quot;</span>

        <span class="k">class</span> <span class="nc">Unrelated</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">MyABC</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Unrelated</span><span class="p">)</span>

        <span class="n">u</span> <span class="o">=</span> <span class="n">Unrelated</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">MyABC</span><span class="p">)</span>

        <span class="c"># This used to crash</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">MyABC</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">__set__</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_dynamics"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_dynamics">[docs]</a>    <span class="k">def</span> <span class="nf">test_dynamics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing class attribute propagation...</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">F</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">D</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c"># Test that dynamic attributes are inherited</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c"># Test dynamic instances</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;foobar&quot;</span><span class="p">)</span>
        <span class="n">C</span><span class="o">.</span><span class="n">foobar</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">foobar</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">C</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">method</span><span class="p">(),</span> <span class="mi">42</span><span class="p">)</span>
        <span class="n">C</span><span class="o">.</span><span class="n">__repr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="s">&quot;C()&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">&quot;C()&quot;</span><span class="p">)</span>
        <span class="n">C</span><span class="o">.</span><span class="n">__int__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="mi">100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">foobar</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">mygetattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&quot;spam&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s">&quot;spam&quot;</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span>
        <span class="n">C</span><span class="o">.</span><span class="n">__getattr__</span> <span class="o">=</span> <span class="n">mygetattr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">spam</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">new</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">new</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">mysetattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&quot;spam&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span>
            <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">C</span><span class="o">.</span><span class="n">__setattr__</span> <span class="o">=</span> <span class="n">mysetattr</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">spam</span> <span class="o">=</span> <span class="s">&quot;not spam&quot;</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;expected AttributeError&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">spam</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="n">d</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c"># Test handling of int*seq and seq*int</span>
        <span class="k">class</span> <span class="nc">I</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="o">*</span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s">&quot;aa&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;aa&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>

        <span class="c"># Test comparison of classes with dynamic metaclasses</span>
        <span class="k">class</span> <span class="nc">dynamicmetaclass</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">someclass</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">dynamicmetaclass</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">someclass</span><span class="p">,</span> <span class="nb">object</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_errors"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_errors">[docs]</a>    <span class="k">def</span> <span class="nf">test_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing errors...</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;inheritance from both list and dict should be illegal&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
                <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;inheritance from non-type should be illegal&quot;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">Classic</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="nb">len</span><span class="p">)):</span>
                <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;inheritance from CFunction should be illegal&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
                <span class="n">__slots__</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;__slots__ = 1 should be illegal&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
                <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;__slots__ = [1] should be illegal&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">M1</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">M2</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">A1</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">M1</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">A2</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">M2</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">):</span>
                <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;finding the most derived metaclass should have failed&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_classmethods"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_classmethods">[docs]</a>    <span class="k">def</span> <span class="nf">test_classmethods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing class methods...</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">):</span> <span class="k">return</span> <span class="n">a</span>
            <span class="n">goo</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">goo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">goo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">goo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">goo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">foo</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="c"># Test for a specific crash (SF bug 528132)</span>
        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
        <span class="n">ff</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ff</span><span class="o">.</span><span class="n">__get__</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">)(</span><span class="mi">42</span><span class="p">),</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="mi">42</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ff</span><span class="o">.</span><span class="n">__get__</span><span class="p">(</span><span class="mi">0</span><span class="p">)(</span><span class="mi">42</span><span class="p">),</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="mi">42</span><span class="p">))</span>

        <span class="c"># Test super() with classmethods (SF bug 535444)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">goo</span><span class="o">.</span><span class="n">__self__</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">goo</span><span class="o">.</span><span class="n">__self__</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">goo</span><span class="o">.</span><span class="n">__self__</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">goo</span><span class="o">.</span><span class="n">__self__</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">goo</span><span class="p">(),</span> <span class="p">(</span><span class="n">D</span><span class="p">,))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">goo</span><span class="p">(),</span> <span class="p">(</span><span class="n">D</span><span class="p">,))</span>

        <span class="c"># Verify that a non-callable will raise</span>
        <span class="n">meth</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__get__</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">meth</span><span class="p">)</span>

        <span class="c"># Verify that classmethod() doesn&#39;t allow keyword args</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">classmethod</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">kw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;classmethod shouldn&#39;t accept keyword args&quot;</span><span class="p">)</span>

        <span class="n">cm</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">cm</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">42</span><span class="p">})</span>
        <span class="k">del</span> <span class="n">cm</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">)</span>
</div>
    <span class="nd">@support.impl_detail</span><span class="p">(</span><span class="s">&quot;the module &#39;xxsubtype&#39; is internal&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_classmethods_in_c"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_classmethods_in_c">[docs]</a>    <span class="k">def</span> <span class="nf">test_classmethods_in_c</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing C-based class methods...</span>
        <span class="kn">import</span> <span class="nn">xxsubtype</span> <span class="kn">as</span> <span class="nn">spam</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;abc&#39;</span><span class="p">:</span> <span class="mi">123</span><span class="p">}</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">d1</span> <span class="o">=</span> <span class="n">spam</span><span class="o">.</span><span class="n">spamlist</span><span class="o">.</span><span class="n">classmeth</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">spam</span><span class="o">.</span><span class="n">spamlist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">d1</span> <span class="o">=</span> <span class="n">spam</span><span class="o">.</span><span class="n">spamlist</span><span class="p">()</span><span class="o">.</span><span class="n">classmeth</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">spam</span><span class="o">.</span><span class="n">spamlist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>
        <span class="n">spam_cm</span> <span class="o">=</span> <span class="n">spam</span><span class="o">.</span><span class="n">spamlist</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;classmeth&#39;</span><span class="p">]</span>
        <span class="n">x2</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">spam_cm</span><span class="p">(</span><span class="n">spam</span><span class="o">.</span><span class="n">spamlist</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">spam</span><span class="o">.</span><span class="n">spamlist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">SubSpam</span><span class="p">(</span><span class="n">spam</span><span class="o">.</span><span class="n">spamlist</span><span class="p">):</span> <span class="k">pass</span>
        <span class="n">x2</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">spam_cm</span><span class="p">(</span><span class="n">SubSpam</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">SubSpam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">spam_cm</span><span class="p">()</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">spam_cm</span><span class="p">(</span><span class="n">spam</span><span class="o">.</span><span class="n">spamlist</span><span class="p">())</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">spam_cm</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_staticmethods"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_staticmethods">[docs]</a>    <span class="k">def</span> <span class="nf">test_staticmethods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing static methods...</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">):</span> <span class="k">return</span> <span class="n">a</span>
            <span class="n">goo</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">goo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">goo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">,))</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">goo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">goo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">foo</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">sm</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">sm</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">42</span><span class="p">})</span>
        <span class="k">del</span> <span class="n">sm</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">)</span>
</div>
    <span class="nd">@support.impl_detail</span><span class="p">(</span><span class="s">&quot;the module &#39;xxsubtype&#39; is internal&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_staticmethods_in_c"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_staticmethods_in_c">[docs]</a>    <span class="k">def</span> <span class="nf">test_staticmethods_in_c</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing C-based static methods...</span>
        <span class="kn">import</span> <span class="nn">xxsubtype</span> <span class="kn">as</span> <span class="nn">spam</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;abc&quot;</span><span class="p">:</span> <span class="mi">123</span><span class="p">}</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">d1</span> <span class="o">=</span> <span class="n">spam</span><span class="o">.</span><span class="n">spamlist</span><span class="o">.</span><span class="n">staticmeth</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">spam</span><span class="o">.</span><span class="n">spamlist</span><span class="p">()</span><span class="o">.</span><span class="n">staticmeth</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_classic"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_classic">[docs]</a>    <span class="k">def</span> <span class="nf">test_classic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing classic classes...</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">):</span> <span class="k">return</span> <span class="n">a</span>
            <span class="n">goo</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">goo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">goo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">goo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">goo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">foo</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">class</span> <span class="nc">E</span><span class="p">:</span> <span class="c"># *not* subclassing from C</span>
            <span class="n">foo</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">foo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">E</span><span class="p">()</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">__func__</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span> <span class="c"># i.e., unbound</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">__get__</span><span class="p">(</span><span class="n">C</span><span class="p">()))</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;&lt;bound method &quot;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_compattr"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_compattr">[docs]</a>    <span class="k">def</span> <span class="nf">test_compattr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing computed attributes...</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">class</span> <span class="nc">computed_attribute</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
                <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__get</span> <span class="o">=</span> <span class="n">get</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__set</span> <span class="o">=</span> <span class="nb">set</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__delete</span> <span class="o">=</span> <span class="n">delete</span>
                <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__set</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">def</span> <span class="nf">__delete__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__delete</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__x</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">def</span> <span class="nf">__get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__x</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span>
                <span class="k">return</span> <span class="n">x</span>
            <span class="k">def</span> <span class="nf">__set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__x</span> <span class="o">=</span> <span class="n">x</span>
            <span class="k">def</span> <span class="nf">__delete_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__x</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">computed_attribute</span><span class="p">(</span><span class="n">__get_x</span><span class="p">,</span> <span class="n">__set_x</span><span class="p">,</span> <span class="n">__delete_x</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_newslots"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_newslots">[docs]</a>    <span class="k">def</span> <span class="nf">test_newslots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing __new__ slot override...</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
                <span class="bp">self</span> <span class="o">=</span> <span class="nb">list</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="bp">self</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">foo</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_altmro"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_altmro">[docs]</a>    <span class="k">def</span> <span class="nf">test_altmro</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing mro() and overriding it...</span>
        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="s">&quot;A&quot;</span>
        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="s">&quot;C&quot;</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">mro</span><span class="p">(),</span> <span class="p">[</span><span class="n">D</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="nb">object</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">__mro__</span><span class="p">,</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="nb">object</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">()</span><span class="o">.</span><span class="n">f</span><span class="p">(),</span> <span class="s">&quot;C&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">PerverseMetaType</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">mro</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
                <span class="n">L</span> <span class="o">=</span> <span class="nb">type</span><span class="o">.</span><span class="n">mro</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span>
                <span class="n">L</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">L</span>
        <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">PerverseMetaType</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">__mro__</span><span class="p">,</span> <span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">X</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">X</span><span class="p">()</span><span class="o">.</span><span class="n">f</span><span class="p">(),</span> <span class="s">&quot;A&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">_metaclass</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
                <span class="k">def</span> <span class="nf">mro</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">object</span><span class="p">]</span>
            <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">_metaclass</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="c"># In CPython, the class creation above already raises</span>
            <span class="c"># TypeError, as a protection against the fact that</span>
            <span class="c"># instances of X would segfault it.  In other Python</span>
            <span class="c"># implementations it would be ok to let the class X</span>
            <span class="c"># be created, but instead get a clean TypeError on the</span>
            <span class="c"># __setitem__ below.</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;devious mro() return not caught&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">_metaclass</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
                <span class="k">def</span> <span class="nf">mro</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">_metaclass</span><span class="p">):</span>
                <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;non-class mro() return not caught&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">_metaclass</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
                <span class="k">def</span> <span class="nf">mro</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                    <span class="k">return</span> <span class="mi">1</span>
            <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">_metaclass</span><span class="p">):</span>
                <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;non-sequence mro() return not caught&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_overloading"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_overloading">[docs]</a>    <span class="k">def</span> <span class="nf">test_overloading</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing operator overloading...</span>

        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="s">&quot;Intermediate class because object doesn&#39;t have a __setattr__&quot;</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&quot;foo&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">(</span><span class="s">&quot;getattr&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">AttributeError</span>
            <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&quot;foo&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span> <span class="o">=</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">B</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__delattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&quot;foo&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">delattr</span> <span class="o">=</span> <span class="n">name</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">B</span><span class="o">.</span><span class="n">__delattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="s">&quot;getitem&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setitem</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delitem</span> <span class="o">=</span> <span class="n">key</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;getattr&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">))</span>
        <span class="n">a</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">setattr</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="k">del</span> <span class="n">a</span><span class="o">.</span><span class="n">foo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">delattr</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="p">(</span><span class="s">&quot;getitem&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="mi">21</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">setitem</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">21</span><span class="p">))</span>
        <span class="k">del</span> <span class="n">a</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">delitem</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="p">(</span><span class="s">&quot;getitem&quot;</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;foo&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">setitem</span><span class="p">,</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="s">&quot;foo&quot;</span><span class="p">))</span>
        <span class="k">del</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">delitem</span><span class="p">,</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_methods"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_methods">[docs]</a>    <span class="k">def</span> <span class="nf">test_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing methods...</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">foo</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="n">boo</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">foo</span>
            <span class="n">goo</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">foo</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d2</span><span class="o">.</span><span class="n">foo</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d2</span><span class="o">.</span><span class="n">boo</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d2</span><span class="o">.</span><span class="n">goo</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">foo</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">foo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">E</span><span class="p">()</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">__func__</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span> <span class="c"># i.e., unbound</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">__get__</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;&lt;bound method &quot;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_special_method_lookup"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_special_method_lookup">[docs]</a>    <span class="k">def</span> <span class="nf">test_special_method_lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># The lookup of special methods bypasses __getattr__ and</span>
        <span class="c"># __getattribute__, but they still can be descriptors.</span>

        <span class="k">def</span> <span class="nf">run_context</span><span class="p">(</span><span class="n">manager</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">manager</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">def</span> <span class="nf">iden</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">b</span><span class="s">&quot;hello&quot;</span>
        <span class="k">def</span> <span class="nf">empty_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">def</span> <span class="nf">zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">def</span> <span class="nf">complex_num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">1j</span>
        <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="k">def</span> <span class="nf">return_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thing</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">def</span> <span class="nf">do_isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">do_issubclass</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">do_dict_missing</span><span class="p">(</span><span class="n">checker</span><span class="p">):</span>
            <span class="k">class</span> <span class="nc">DictSub</span><span class="p">(</span><span class="n">checker</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">DictSub</span><span class="p">()[</span><span class="s">&quot;hi&quot;</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">some_number</span><span class="p">(</span><span class="n">self_</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;hi&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">4</span>
        <span class="k">def</span> <span class="nf">swallow</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">def</span> <span class="nf">format_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spec</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&quot;hello&quot;</span>

        <span class="c"># It would be nice to have every special method tested here, but I&#39;m</span>
        <span class="c"># only listing the ones I can remember outside of typeobject.c, since it</span>
        <span class="c"># does it right.</span>
        <span class="n">specials</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&quot;__bytes__&quot;</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">hello</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">{}),</span>
            <span class="p">(</span><span class="s">&quot;__reversed__&quot;</span><span class="p">,</span> <span class="nb">reversed</span><span class="p">,</span> <span class="n">empty_seq</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">{}),</span>
            <span class="p">(</span><span class="s">&quot;__length_hint__&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">zero</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span>
             <span class="p">{</span><span class="s">&quot;__iter__&quot;</span> <span class="p">:</span> <span class="n">iden</span><span class="p">,</span> <span class="s">&quot;__next__&quot;</span> <span class="p">:</span> <span class="n">stop</span><span class="p">}),</span>
            <span class="p">(</span><span class="s">&quot;__sizeof__&quot;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">,</span> <span class="n">zero</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">{}),</span>
            <span class="p">(</span><span class="s">&quot;__instancecheck__&quot;</span><span class="p">,</span> <span class="n">do_isinstance</span><span class="p">,</span> <span class="n">return_true</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">{}),</span>
            <span class="p">(</span><span class="s">&quot;__missing__&quot;</span><span class="p">,</span> <span class="n">do_dict_missing</span><span class="p">,</span> <span class="n">some_number</span><span class="p">,</span>
             <span class="nb">set</span><span class="p">((</span><span class="s">&quot;__class__&quot;</span><span class="p">,)),</span> <span class="p">{}),</span>
            <span class="p">(</span><span class="s">&quot;__subclasscheck__&quot;</span><span class="p">,</span> <span class="n">do_issubclass</span><span class="p">,</span> <span class="n">return_true</span><span class="p">,</span>
             <span class="nb">set</span><span class="p">((</span><span class="s">&quot;__bases__&quot;</span><span class="p">,)),</span> <span class="p">{}),</span>
            <span class="p">(</span><span class="s">&quot;__enter__&quot;</span><span class="p">,</span> <span class="n">run_context</span><span class="p">,</span> <span class="n">iden</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">{</span><span class="s">&quot;__exit__&quot;</span> <span class="p">:</span> <span class="n">swallow</span><span class="p">}),</span>
            <span class="p">(</span><span class="s">&quot;__exit__&quot;</span><span class="p">,</span> <span class="n">run_context</span><span class="p">,</span> <span class="n">swallow</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">{</span><span class="s">&quot;__enter__&quot;</span> <span class="p">:</span> <span class="n">iden</span><span class="p">}),</span>
            <span class="p">(</span><span class="s">&quot;__complex__&quot;</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">complex_num</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">{}),</span>
            <span class="p">(</span><span class="s">&quot;__format__&quot;</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">format_impl</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">{}),</span>
            <span class="p">(</span><span class="s">&quot;__floor__&quot;</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">,</span> <span class="n">zero</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">{}),</span>
            <span class="p">(</span><span class="s">&quot;__trunc__&quot;</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">trunc</span><span class="p">,</span> <span class="n">zero</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">{}),</span>
            <span class="p">(</span><span class="s">&quot;__trunc__&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">zero</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">{}),</span>
            <span class="p">(</span><span class="s">&quot;__ceil__&quot;</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">,</span> <span class="n">zero</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">{}),</span>
            <span class="p">(</span><span class="s">&quot;__dir__&quot;</span><span class="p">,</span> <span class="nb">dir</span><span class="p">,</span> <span class="n">empty_seq</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">{}),</span>
            <span class="p">(</span><span class="s">&quot;__round__&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">,</span> <span class="n">zero</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">{}),</span>
            <span class="p">]</span>

        <span class="k">class</span> <span class="nc">Checker</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="bp">self</span><span class="p">):</span>
                <span class="n">test</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;__getattr__ called with {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attr</span><span class="p">))</span>
            <span class="k">def</span> <span class="nf">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ok</span><span class="p">:</span>
                    <span class="n">test</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;__getattribute__ called with {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attr</span><span class="p">))</span>
                <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">SpecialDescr</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">impl</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">impl</span> <span class="o">=</span> <span class="n">impl</span>
            <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">owner</span><span class="p">):</span>
                <span class="n">record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">__get__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">owner</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">MyException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">ErrDescr</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">owner</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">MyException</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">runner</span><span class="p">,</span> <span class="n">meth_impl</span><span class="p">,</span> <span class="n">ok</span><span class="p">,</span> <span class="n">env</span> <span class="ow">in</span> <span class="n">specials</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="n">Checker</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">env</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">meth_impl</span><span class="p">)</span>
            <span class="n">runner</span><span class="p">(</span><span class="n">X</span><span class="p">())</span>

            <span class="n">record</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="n">Checker</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">env</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">SpecialDescr</span><span class="p">(</span><span class="n">meth_impl</span><span class="p">))</span>
            <span class="n">runner</span><span class="p">(</span><span class="n">X</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">record</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">name</span><span class="p">)</span>

            <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="n">Checker</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">env</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ErrDescr</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">MyException</span><span class="p">,</span> <span class="n">runner</span><span class="p">,</span> <span class="n">X</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_specials"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_specials">[docs]</a>    <span class="k">def</span> <span class="nf">test_specials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing special operators...</span>
        <span class="c"># Test operators like __hash__ for which a built-in default exists</span>

        <span class="c"># Test the default behavior for static classes</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span> <span class="k">return</span> <span class="n">i</span>
                <span class="k">raise</span> <span class="ne">IndexError</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="ow">not</span> <span class="n">c1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">c1</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">c2</span><span class="p">))</span>
        <span class="nb">hash</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
        <span class="nb">hash</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">c1</span> <span class="o">!=</span> <span class="n">c2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c1</span> <span class="o">!=</span> <span class="n">c1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">c1</span> <span class="o">==</span> <span class="n">c2</span><span class="p">)</span>
        <span class="c"># Note that the module name appears in str/repr, and that varies</span>
        <span class="c"># depending on whether this test is run standalone or from a framework.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreaterEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;C object at &#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c1</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">c1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
        <span class="c"># Test the default behavior for dynamic classes</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span> <span class="k">return</span> <span class="n">i</span>
                <span class="k">raise</span> <span class="ne">IndexError</span>
        <span class="n">d1</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="ow">not</span> <span class="n">d1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">d1</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">d2</span><span class="p">))</span>
        <span class="nb">hash</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span>
        <span class="nb">hash</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">d1</span> <span class="o">!=</span> <span class="n">d1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">d1</span> <span class="o">==</span> <span class="n">d2</span><span class="p">)</span>
        <span class="c"># Note that the module name appears in str/repr, and that varies</span>
        <span class="c"># depending on whether this test is run standalone or from a framework.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreaterEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;D object at &#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d1</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>
        <span class="c"># Test overridden behavior</span>
        <span class="k">class</span> <span class="nc">Proxy</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
            <span class="k">def</span> <span class="nf">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="ow">not</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
            <span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">other</span>
            <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">!=</span> <span class="n">other</span>
            <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">other</span>
            <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">other</span>
            <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">other</span>
            <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">other</span>
            <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;Proxy:</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;Proxy(</span><span class="si">%r</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
            <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
        <span class="n">p0</span> <span class="o">=</span> <span class="n">Proxy</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="n">Proxy</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">p_1</span> <span class="o">=</span> <span class="n">Proxy</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="ow">not</span> <span class="n">p1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">p0</span><span class="p">),</span> <span class="nb">hash</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">p0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">p0</span> <span class="o">!=</span> <span class="n">p0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="ow">not</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">p0</span> <span class="o">&lt;</span> <span class="n">p1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">p0</span> <span class="o">&lt;=</span> <span class="n">p1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">p1</span> <span class="o">&gt;</span> <span class="n">p0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">p1</span> <span class="o">&gt;=</span> <span class="n">p0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p0</span><span class="p">),</span> <span class="s">&quot;Proxy:0&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">p0</span><span class="p">),</span> <span class="s">&quot;Proxy(0)&quot;</span><span class="p">)</span>
        <span class="n">p10</span> <span class="o">=</span> <span class="n">Proxy</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">p10</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">p10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">p10</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_weakrefs"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_weakrefs">[docs]</a>    <span class="k">def</span> <span class="nf">test_weakrefs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing weak references...</span>
        <span class="kn">import</span> <span class="nn">weakref</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="p">(),</span> <span class="n">c</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">c</span>
        <span class="n">support</span><span class="o">.</span><span class="n">gc_collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="p">(),</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">r</span>
        <span class="k">class</span> <span class="nc">NoWeak</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">]</span>
        <span class="n">no</span> <span class="o">=</span> <span class="n">NoWeak</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">no</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">msg</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;weak reference&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;weakref.ref(no) should be illegal&quot;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">Weak</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;__weakref__&#39;</span><span class="p">]</span>
        <span class="n">yes</span> <span class="o">=</span> <span class="n">Weak</span><span class="p">()</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">yes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="p">(),</span> <span class="n">yes</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">yes</span>
        <span class="n">support</span><span class="o">.</span><span class="n">gc_collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="p">(),</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">r</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_properties"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_properties">[docs]</a>    <span class="k">def</span> <span class="nf">test_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing property...</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">getx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__x</span>
            <span class="k">def</span> <span class="nf">setx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__x</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">def</span> <span class="nf">delx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__x</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">getx</span><span class="p">,</span> <span class="n">setx</span><span class="p">,</span> <span class="n">delx</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;I&#39;m the x property.&quot;</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">_C__x</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;_C__x&quot;</span><span class="p">)</span>
        <span class="n">C</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">__set__</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">__get__</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">C</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">__delete__</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">)</span>

        <span class="n">raw</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="nb">property</span><span class="p">)</span>

        <span class="n">attrs</span> <span class="o">=</span> <span class="nb">dir</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;__doc__&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;fget&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;fset&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;fdel&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">__doc__</span><span class="p">,</span> <span class="s">&quot;I&#39;m the x property.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">fget</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;getx&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">fset</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;setx&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">fdel</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;delx&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="s">&quot;__doc__&quot;</span><span class="p">,</span> <span class="s">&quot;fget&quot;</span><span class="p">,</span> <span class="s">&quot;fset&quot;</span><span class="p">,</span> <span class="s">&quot;fdel&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">msg</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;readonly&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;when setting readonly attr </span><span class="si">%r</span><span class="s"> on a property, &quot;</span>
                              <span class="s">&quot;got unexpected AttributeError msg </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;expected AttributeError from trying to set readonly </span><span class="si">%r</span><span class="s"> &quot;</span>
                          <span class="s">&quot;attr on a property&quot;</span> <span class="o">%</span> <span class="n">attr</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__getitem__</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;expected ZeroDivisionError from bad property&quot;</span><span class="p">)</span>
</div>
    <span class="nd">@unittest.skipIf</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">optimize</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">,</span>
                     <span class="s">&quot;Docstrings are omitted with -O2 and above&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_properties_doc_attrib"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_properties_doc_attrib">[docs]</a>    <span class="k">def</span> <span class="nf">test_properties_doc_attrib</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">getter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="s">&quot;getter method&quot;</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">def</span> <span class="nf">setter</span><span class="p">(</span><span class="n">self_</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="s">&quot;setter method&quot;</span>
                <span class="k">pass</span>
            <span class="n">prop</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">getter</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">__doc__</span><span class="p">,</span> <span class="s">&quot;getter method&quot;</span><span class="p">)</span>
            <span class="n">prop2</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fset</span><span class="o">=</span><span class="n">setter</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">prop2</span><span class="o">.</span><span class="n">__doc__</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</div>
    <span class="nd">@support.cpython_only</span>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_testcapi_no_segfault"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_testcapi_no_segfault">[docs]</a>    <span class="k">def</span> <span class="nf">test_testcapi_no_segfault</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># this segfaulted in 2.5b2</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">_testcapi</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
                <span class="n">p</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_testcapi</span><span class="o">.</span><span class="n">test_with_docstring</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_properties_plus"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_properties_plus">[docs]</a>    <span class="k">def</span> <span class="nf">test_properties_plus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">foo</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="s">&quot;hello&quot;</span><span class="p">)</span>
            <span class="nd">@foo.getter</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_foo</span>
            <span class="nd">@foo.setter</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_foo</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="nd">@foo.deleter</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_foo</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">__doc__</span><span class="p">,</span> <span class="s">&quot;hello&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="o">-</span><span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHasAttr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&#39;_foo&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">_foo</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">c</span><span class="o">.</span><span class="n">foo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&#39;_foo&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="nd">@C.foo.deleter</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_foo</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="n">d</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">24</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">d</span><span class="o">.</span><span class="n">foo</span>
        <span class="k">del</span> <span class="n">d</span><span class="o">.</span><span class="n">foo</span>

        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="nd">@property</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_foo</span>
            <span class="nd">@foo.setter</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span>
            <span class="nd">@foo.setter</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_foo</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="nd">@foo.deleter</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_foo</span>

        <span class="n">e</span> <span class="o">=</span> <span class="n">E</span><span class="p">()</span>
        <span class="n">e</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="o">-</span><span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">e</span><span class="o">.</span><span class="n">foo</span>

        <span class="k">class</span> <span class="nc">F</span><span class="p">(</span><span class="n">E</span><span class="p">):</span>
            <span class="nd">@E.foo.deleter</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_foo</span>
            <span class="nd">@foo.setter</span>
            <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_foo</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">F</span><span class="p">()</span>
        <span class="n">f</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">f</span><span class="o">.</span><span class="n">foo</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_dict_constructors"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_dict_constructors">[docs]</a>    <span class="k">def</span> <span class="nf">test_dict_constructors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing dict constructor ...</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">({})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&#39;b&#39;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&#39;b&#39;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">({</span><span class="s">&#39;one&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;two&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">one</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">two</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="o">**</span><span class="n">d</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">({</span><span class="s">&quot;one&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">two</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">([(</span><span class="s">&quot;two&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="n">one</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">([(</span><span class="s">&quot;one&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;two&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)],</span> <span class="o">**</span><span class="n">d</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="o">**</span><span class="n">d</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">badarg</span> <span class="ow">in</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0j</span><span class="p">,</span> <span class="s">&quot;0&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">dict</span><span class="p">(</span><span class="n">badarg</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">badarg</span> <span class="o">==</span> <span class="s">&quot;0&quot;</span><span class="p">:</span>
                    <span class="c"># It&#39;s a sequence, and its elements are also sequences (gotta</span>
                    <span class="c"># love strings &lt;wink&gt;), but they aren&#39;t of length 2, so this</span>
                    <span class="c"># one seemed better as a ValueError than a TypeError.</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;no TypeError from dict(</span><span class="si">%r</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">badarg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;no TypeError from dict(</span><span class="si">%r</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">badarg</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="nb">dict</span><span class="p">({},</span> <span class="p">{})</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;no TypeError from dict({}, {})&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">Mapping</span><span class="p">:</span>
            <span class="c"># Lacks a .keys() method; will be added later.</span>
            <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">:</span><span class="mi">1j</span><span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="nb">dict</span><span class="p">(</span><span class="n">Mapping</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;no TypeError from dict(incomplete mapping)&quot;</span><span class="p">)</span>

        <span class="n">Mapping</span><span class="o">.</span><span class="n">keys</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">Mapping</span><span class="o">.</span><span class="n">__getitem__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Mapping</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">Mapping</span><span class="o">.</span><span class="n">dict</span><span class="p">)</span>

        <span class="c"># Init from sequence of iterable objects, each producing a 2-sequence.</span>
        <span class="k">class</span> <span class="nc">AddressBookEntry</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">first</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">last</span> <span class="o">=</span> <span class="n">last</span>
            <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">iter</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last</span><span class="p">])</span>

        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span><span class="n">AddressBookEntry</span><span class="p">(</span><span class="s">&#39;Tim&#39;</span><span class="p">,</span> <span class="s">&#39;Warsaw&#39;</span><span class="p">),</span>
                  <span class="n">AddressBookEntry</span><span class="p">(</span><span class="s">&#39;Barry&#39;</span><span class="p">,</span> <span class="s">&#39;Peters&#39;</span><span class="p">),</span>
                  <span class="n">AddressBookEntry</span><span class="p">(</span><span class="s">&#39;Tim&#39;</span><span class="p">,</span> <span class="s">&#39;Peters&#39;</span><span class="p">),</span>
                  <span class="n">AddressBookEntry</span><span class="p">(</span><span class="s">&#39;Barry&#39;</span><span class="p">,</span> <span class="s">&#39;Warsaw&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Barry&#39;</span><span class="p">:</span> <span class="s">&#39;Warsaw&#39;</span><span class="p">,</span> <span class="s">&#39;Tim&#39;</span><span class="p">:</span> <span class="s">&#39;Peters&#39;</span><span class="p">})</span>

        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]))</span>

        <span class="c"># Bad sequence lengths.</span>
        <span class="k">for</span> <span class="n">bad</span> <span class="ow">in</span> <span class="p">[(</span><span class="s">&#39;tooshort&#39;</span><span class="p">,)],</span> <span class="p">[(</span><span class="s">&#39;too&#39;</span><span class="p">,</span> <span class="s">&#39;long&#39;</span><span class="p">,</span> <span class="s">&#39;by 1&#39;</span><span class="p">)]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">dict</span><span class="p">(</span><span class="n">bad</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;no ValueError from dict(</span><span class="si">%r</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">bad</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_dir"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_dir">[docs]</a>    <span class="k">def</span> <span class="nf">test_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing dir() ...</span>
        <span class="n">junk</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">dir</span><span class="p">(),</span> <span class="p">[</span><span class="s">&#39;junk&#39;</span><span class="p">,</span> <span class="s">&#39;self&#39;</span><span class="p">])</span>
        <span class="k">del</span> <span class="n">junk</span>

        <span class="c"># Just make sure these don&#39;t blow up!</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2j</span><span class="p">,</span> <span class="mf">2e0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s">&quot;2&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;2&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span> <span class="nb">type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_dir</span><span class="p">:</span>
            <span class="nb">dir</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

        <span class="c"># Test dir on new-style classes.  Since these have object as a</span>
        <span class="c"># base class, a lot more gets sucked in.</span>
        <span class="k">def</span> <span class="nf">interesting</span><span class="p">(</span><span class="n">strings</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">strings</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)]</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">Cdata</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">def</span> <span class="nf">Cmethod</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>

        <span class="n">cstuff</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Cdata&#39;</span><span class="p">,</span> <span class="s">&#39;Cmethod&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">interesting</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">C</span><span class="p">)),</span> <span class="n">cstuff</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">interesting</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">c</span><span class="p">)),</span> <span class="n">cstuff</span><span class="p">)</span>
        <span class="c">## self.assertIn(&#39;__self__&#39;, dir(C.Cmethod))</span>

        <span class="n">c</span><span class="o">.</span><span class="n">cdata</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">c</span><span class="o">.</span><span class="n">cmethod</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">interesting</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">c</span><span class="p">)),</span> <span class="n">cstuff</span> <span class="o">+</span> <span class="p">[</span><span class="s">&#39;cdata&#39;</span><span class="p">,</span> <span class="s">&#39;cmethod&#39;</span><span class="p">])</span>
        <span class="c">## self.assertIn(&#39;__self__&#39;, dir(c.Cmethod))</span>

        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="n">Adata</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">def</span> <span class="nf">Amethod</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>

        <span class="n">astuff</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Adata&#39;</span><span class="p">,</span> <span class="s">&#39;Amethod&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">cstuff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">interesting</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">A</span><span class="p">)),</span> <span class="n">astuff</span><span class="p">)</span>
        <span class="c">## self.assertIn(&#39;__self__&#39;, dir(A.Amethod))</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">interesting</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">astuff</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">adata</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="n">a</span><span class="o">.</span><span class="n">amethod</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">interesting</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">astuff</span> <span class="o">+</span> <span class="p">[</span><span class="s">&#39;adata&#39;</span><span class="p">,</span> <span class="s">&#39;amethod&#39;</span><span class="p">])</span>
        <span class="c">## self.assertIn(&#39;__self__&#39;, dir(a.Amethod))</span>

        <span class="c"># Try a module subclass.</span>
        <span class="k">class</span> <span class="nc">M</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">sys</span><span class="p">)):</span>
            <span class="k">pass</span>
        <span class="n">minstance</span> <span class="o">=</span> <span class="n">M</span><span class="p">(</span><span class="s">&quot;m&quot;</span><span class="p">)</span>
        <span class="n">minstance</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">minstance</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">default_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;__name__&#39;</span><span class="p">,</span> <span class="s">&#39;__doc__&#39;</span><span class="p">,</span> <span class="s">&#39;__package__&#39;</span><span class="p">,</span>
                              <span class="s">&#39;__loader__&#39;</span><span class="p">,</span> <span class="s">&#39;__spec__&#39;</span><span class="p">]</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">minstance</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">default_attributes</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">])</span>

        <span class="k">class</span> <span class="nc">M2</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">getdict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;Not a dict!&quot;</span>
            <span class="n">__dict__</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">getdict</span><span class="p">)</span>

        <span class="n">m2instance</span> <span class="o">=</span> <span class="n">M2</span><span class="p">(</span><span class="s">&quot;m2&quot;</span><span class="p">)</span>
        <span class="n">m2instance</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">m2instance</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m2instance</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="s">&quot;Not a dict!&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">dir</span><span class="p">(</span><span class="n">m2instance</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c"># Two essentially featureless objects, just inheriting stuff from</span>
        <span class="c"># object.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="bp">NotImplemented</span><span class="p">),</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">Ellipsis</span><span class="p">))</span>

        <span class="c"># Nasty test case for proxied objects</span>
        <span class="k">class</span> <span class="nc">Wrapper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;Wrapper(</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__obj</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Wrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__obj</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__obj</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Wrapper</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__obj</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__getclass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Wrapper</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
            <span class="n">__class__</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__getclass</span><span class="p">)</span>

        <span class="nb">dir</span><span class="p">(</span><span class="n">C</span><span class="p">())</span> <span class="c"># This used to segfault</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_supers"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_supers">[docs]</a>    <span class="k">def</span> <span class="nf">test_supers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing super...</span>

        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;A(</span><span class="si">%r</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">a</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">A</span><span class="p">()</span><span class="o">.</span><span class="n">meth</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s">&quot;A(1)&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__super</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;B(</span><span class="si">%r</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">a</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__super</span><span class="o">.</span><span class="n">meth</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">B</span><span class="p">()</span><span class="o">.</span><span class="n">meth</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s">&quot;B(2)A(2)&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;C(</span><span class="si">%r</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">a</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__super</span><span class="o">.</span><span class="n">meth</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">C</span><span class="o">.</span><span class="n">_C__super</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="p">()</span><span class="o">.</span><span class="n">meth</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s">&quot;C(3)A(3)&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;D(</span><span class="si">%r</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">a</span> <span class="o">+</span> <span class="nb">super</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">meth</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">()</span><span class="o">.</span><span class="n">meth</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="s">&quot;D(4)C(4)B(4)A(4)&quot;</span><span class="p">)</span>

        <span class="c"># Test for subclassing super</span>

        <span class="k">class</span> <span class="nc">mysuper</span><span class="p">(</span><span class="nb">super</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">mysuper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;E(</span><span class="si">%r</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">a</span> <span class="o">+</span> <span class="n">mysuper</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">meth</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">E</span><span class="p">()</span><span class="o">.</span><span class="n">meth</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="s">&quot;E(5)D(5)C(5)B(5)A(5)&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">F</span><span class="p">(</span><span class="n">E</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
                <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__super</span> <span class="c"># == mysuper(F, self)</span>
                <span class="k">return</span> <span class="s">&quot;F(</span><span class="si">%r</span><span class="s">)[</span><span class="si">%s</span><span class="s">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="n">meth</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">F</span><span class="o">.</span><span class="n">_F__super</span> <span class="o">=</span> <span class="n">mysuper</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">F</span><span class="p">()</span><span class="o">.</span><span class="n">meth</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="s">&quot;F(6)[mysuper]E(6)D(6)C(6)B(6)A(6)&quot;</span><span class="p">)</span>

        <span class="c"># Make sure certain errors are raised</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t allow super(D, 42)&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">C</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t allow super(D, C())&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">__get__</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t allow super(D).__get__(12)&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">__get__</span><span class="p">(</span><span class="n">C</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t allow super(D).__get__(C())&quot;</span><span class="p">)</span>

        <span class="c"># Make sure data descriptors can be overridden and accessed via super</span>
        <span class="c"># (new feature in Python 2.3)</span>

        <span class="k">class</span> <span class="nc">DDbase</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">getx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="mi">42</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">getx</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">DDsub</span><span class="p">(</span><span class="n">DDbase</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">getx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="s">&quot;hello&quot;</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">getx</span><span class="p">)</span>

        <span class="n">dd</span> <span class="o">=</span> <span class="n">DDsub</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dd</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s">&quot;hello&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">DDsub</span><span class="p">,</span> <span class="n">dd</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>

        <span class="c"># Ensure that super() lookup of descriptor from classmethod</span>
        <span class="c"># works (SF ID# 743627)</span>

        <span class="k">class</span> <span class="nc">Base</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">aProp</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="s">&quot;foo&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">Sub</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
            <span class="nd">@classmethod</span>
            <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">klass</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Sub</span><span class="p">,</span><span class="n">klass</span><span class="p">)</span><span class="o">.</span><span class="n">aProp</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Sub</span><span class="o">.</span><span class="n">test</span><span class="p">(),</span> <span class="n">Base</span><span class="o">.</span><span class="n">aProp</span><span class="p">)</span>

        <span class="c"># Verify that super() doesn&#39;t allow keyword args</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">Base</span><span class="p">,</span> <span class="n">kw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&quot;super shouldn&#39;t accept keyword args&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_basic_inheritance"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_basic_inheritance">[docs]</a>    <span class="k">def</span> <span class="nf">test_basic_inheritance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing inheritance from basic types...</span>

        <span class="k">class</span> <span class="nc">hexint</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">hex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">hexint</span><span class="p">(</span><span class="nb">int</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>
            <span class="c"># (Note that overriding __radd__ doesn&#39;t work,</span>
            <span class="c"># because the int type gets first dibs.)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">hexint</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="mi">9</span><span class="p">),</span> <span class="s">&quot;0x10&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">hexint</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">7</span><span class="p">),</span> <span class="s">&quot;0x3ef&quot;</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">hexint</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">12345</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mi">12345</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">hash</span><span class="p">(</span><span class="mi">12345</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">hexint</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">hexint</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">octlong</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">oct</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">octlong</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
            <span class="n">__radd__</span> <span class="o">=</span> <span class="n">__add__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">octlong</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">),</span> <span class="s">&quot;0o10&quot;</span><span class="p">)</span>
        <span class="c"># (Note that overriding __radd__ here only seems to work</span>
        <span class="c"># because the example uses a short int left argument.)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="n">octlong</span><span class="p">(</span><span class="mi">3000</span><span class="p">)),</span> <span class="s">&quot;0o5675&quot;</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">octlong</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">12345</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mi">12345</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">hash</span><span class="p">(</span><span class="mi">12345</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="o">-</span><span class="n">octlong</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">**</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">//</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="mi">1</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">^</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">octlong</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">octlong</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">octlong</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>

        <span class="c"># Because octlong overrides __add__, we can&#39;t check the absence of +0</span>
        <span class="c"># optimizations using octlong.</span>
        <span class="k">class</span> <span class="nc">longclone</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">longclone</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="mi">0</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>

        <span class="c"># Check that negative clones don&#39;t segfault</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">longclone</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c"># self.assertTrue PyNumber_Long() copies the sign bit</span>

        <span class="k">class</span> <span class="nc">precfloat</span><span class="p">(</span><span class="nb">float</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;prec&#39;</span><span class="p">]</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">12</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;</span><span class="si">%.*g</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">precfloat</span><span class="p">(</span><span class="mf">1.1</span><span class="p">)),</span> <span class="s">&quot;1.1&quot;</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">precfloat</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mf">12345.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mf">12345.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">hash</span><span class="p">(</span><span class="mf">12345.0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">madcomplex</span><span class="p">(</span><span class="nb">complex</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;</span><span class="si">%.17g</span><span class="s">j</span><span class="si">%+.17g</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">madcomplex</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">&quot;4j-3&quot;</span><span class="p">)</span>
        <span class="n">base</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">madcomplex</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c"># just trying another form of the constructor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">&quot;4j-3&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">hash</span><span class="p">(</span><span class="n">base</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">0</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="n">a</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="n">a</span> <span class="o">/</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="mi">1</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">madtuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="n">_rev</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">def</span> <span class="nf">rev</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rev</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rev</span>
                <span class="n">L</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">L</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rev</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">madtuple</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">rev</span><span class="p">(),</span> <span class="n">madtuple</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">rev</span><span class="p">()</span><span class="o">.</span><span class="n">rev</span><span class="p">(),</span> <span class="n">madtuple</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">512</span><span class="p">):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">madtuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">rev</span><span class="p">()</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">rev</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">madtuple</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">hash</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">a</span><span class="p">[:]</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="p">())</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">madtuple</span><span class="p">(())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">a</span><span class="p">[:]</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">madstring</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">_rev</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">def</span> <span class="nf">rev</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rev</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rev</span>
                <span class="n">L</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">L</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rev</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">madstring</span><span class="p">(</span><span class="s">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rev</span><span class="p">(),</span> <span class="n">madstring</span><span class="p">(</span><span class="s">&quot;zyxwvutsrqponmlkjihgfedcba&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rev</span><span class="p">()</span><span class="o">.</span><span class="n">rev</span><span class="p">(),</span> <span class="n">madstring</span><span class="p">(</span><span class="s">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">madstring</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">))))</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">rev</span><span class="p">()</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">rev</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">madstring</span><span class="p">(</span><span class="s">&quot;12345&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="s">&quot;12345&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>

        <span class="n">base</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\x00</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">5</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">madstring</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="nb">hash</span><span class="p">(</span><span class="n">base</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">({</span><span class="n">s</span><span class="p">:</span> <span class="mi">1</span><span class="p">}[</span><span class="n">base</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">({</span><span class="n">base</span><span class="p">:</span> <span class="mi">1</span><span class="p">}[</span><span class="n">s</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">s</span> <span class="o">+</span> <span class="s">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="s">&quot;&quot;</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&quot;&quot;</span> <span class="o">+</span> <span class="n">s</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">s</span> <span class="o">*</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">s</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">s</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">base</span> <span class="o">+</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">s</span><span class="p">[:]</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="p">[:],</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">],</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">base</span><span class="p">)</span>
        <span class="n">identitytab</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">identitytab</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">identitytab</span><span class="p">),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">base</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">madunicode</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">_rev</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">def</span> <span class="nf">rev</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rev</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rev</span>
                <span class="n">L</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">L</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rev</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">madunicode</span><span class="p">(</span><span class="s">&quot;ABCDEF&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="s">&quot;ABCDEF&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">rev</span><span class="p">(),</span> <span class="n">madunicode</span><span class="p">(</span><span class="s">&quot;FEDCBA&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">rev</span><span class="p">()</span><span class="o">.</span><span class="n">rev</span><span class="p">(),</span> <span class="n">madunicode</span><span class="p">(</span><span class="s">&quot;ABCDEF&quot;</span><span class="p">))</span>
        <span class="n">base</span> <span class="o">=</span> <span class="s">&quot;12345&quot;</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">madunicode</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="nb">hash</span><span class="p">(</span><span class="n">base</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">({</span><span class="n">u</span><span class="p">:</span> <span class="mi">1</span><span class="p">}[</span><span class="n">base</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">({</span><span class="n">base</span><span class="p">:</span> <span class="mi">1</span><span class="p">}[</span><span class="n">u</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;xy&quot;</span><span class="p">,</span> <span class="s">&quot;xy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;xy&quot;</span><span class="p">,</span> <span class="s">&quot;xy&quot;</span><span class="p">),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">capitalize</span><span class="p">(),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">u</span> <span class="o">+</span> <span class="s">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span> <span class="o">+</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="s">&quot;&quot;</span> <span class="o">+</span> <span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&quot;&quot;</span> <span class="o">+</span> <span class="n">u</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">u</span> <span class="o">*</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span> <span class="o">*</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">u</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">((</span><span class="n">u</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">base</span> <span class="o">+</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">u</span><span class="p">[:]</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="p">[:],</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">],</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">sublist</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">sublist</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="s">&quot;hello&quot;</span><span class="p">])</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
        <span class="n">a</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>
        <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>
        <span class="k">del</span> <span class="n">a</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="mi">9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>

        <span class="c">## class CountedInput(file):</span>
        <span class="c">##    &quot;&quot;&quot;Counts lines read by self.readline().</span>
        <span class="c">##</span>
        <span class="c">##     self.lineno is the 0-based ordinal of the last line read, up to</span>
        <span class="c">##     a maximum of one greater than the number of lines in the file.</span>
        <span class="c">##</span>
        <span class="c">##     self.ateof is true if and only if the final &quot;&quot; line has been read,</span>
        <span class="c">##     at which point self.lineno stops incrementing, and further calls</span>
        <span class="c">##     to readline() continue to return &quot;&quot;.</span>
        <span class="c">##     &quot;&quot;&quot;</span>
        <span class="c">##</span>
        <span class="c">##     lineno = 0</span>
        <span class="c">##     ateof = 0</span>
        <span class="c">##     def readline(self):</span>
        <span class="c">##         if self.ateof:</span>
        <span class="c">##             return &quot;&quot;</span>
        <span class="c">##         s = file.readline(self)</span>
        <span class="c">##         # Next line works too.</span>
        <span class="c">##         # s = super(CountedInput, self).readline()</span>
        <span class="c">##         self.lineno += 1</span>
        <span class="c">##         if s == &quot;&quot;:</span>
        <span class="c">##             self.ateof = 1</span>
        <span class="c">##        return s</span>
        <span class="c">##</span>
        <span class="c">## f = file(name=support.TESTFN, mode=&#39;w&#39;)</span>
        <span class="c">## lines = [&#39;a\n&#39;, &#39;b\n&#39;, &#39;c\n&#39;]</span>
        <span class="c">## try:</span>
        <span class="c">##     f.writelines(lines)</span>
        <span class="c">##     f.close()</span>
        <span class="c">##     f = CountedInput(support.TESTFN)</span>
        <span class="c">##     for (i, expected) in zip(range(1, 5) + [4], lines + 2 * [&quot;&quot;]):</span>
        <span class="c">##         got = f.readline()</span>
        <span class="c">##         self.assertEqual(expected, got)</span>
        <span class="c">##         self.assertEqual(f.lineno, i)</span>
        <span class="c">##         self.assertEqual(f.ateof, (i &gt; len(lines)))</span>
        <span class="c">##     f.close()</span>
        <span class="c">## finally:</span>
        <span class="c">##     try:</span>
        <span class="c">##         f.close()</span>
        <span class="c">##     except:</span>
        <span class="c">##         pass</span>
        <span class="c">##     support.unlink(support.TESTFN)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_keywords"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_keywords">[docs]</a>    <span class="k">def</span> <span class="nf">test_keywords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing keyword args to basic type constructors ...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">imag</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="mi">666</span><span class="p">),</span> <span class="nb">complex</span><span class="p">(</span><span class="mi">666</span><span class="p">,</span> <span class="mi">42</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">object</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span> <span class="s">&#39;500&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">object</span><span class="o">=</span><span class="n">b</span><span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s">&#39;strict&#39;</span><span class="p">),</span> <span class="s">&#39;abc&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
        <span class="c"># note: as of Python 2.3, dict() no longer has an &quot;items&quot; keyword arg</span>

        <span class="k">for</span> <span class="n">constructor</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span>
                            <span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">constructor</span><span class="p">(</span><span class="n">bogus_keyword_arg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;expected TypeError from bogus keyword argument to </span><span class="si">%r</span><span class="s">&quot;</span>
                            <span class="o">%</span> <span class="n">constructor</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_str_subclass_as_dict_key"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_str_subclass_as_dict_key">[docs]</a>    <span class="k">def</span> <span class="nf">test_str_subclass_as_dict_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing a str subclass used as dict key ..</span>

        <span class="k">class</span> <span class="nc">cistr</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Sublcass of str that computes __eq__ case-insensitively.</span>

<span class="sd">            Also computes a hash code of the string in canonical form.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canonical</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hashcode</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canonical</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">cistr</span><span class="p">):</span>
                    <span class="n">other</span> <span class="o">=</span> <span class="n">cistr</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canonical</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">canonical</span>

            <span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hashcode</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">cistr</span><span class="p">(</span><span class="s">&#39;ABC&#39;</span><span class="p">),</span> <span class="s">&#39;abc&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&#39;aBc&#39;</span><span class="p">,</span> <span class="n">cistr</span><span class="p">(</span><span class="s">&#39;ABC&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cistr</span><span class="p">(</span><span class="s">&#39;ABC&#39;</span><span class="p">)),</span> <span class="s">&#39;ABC&#39;</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="n">cistr</span><span class="p">(</span><span class="s">&#39;one&#39;</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cistr</span><span class="p">(</span><span class="s">&#39;two&#39;</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span> <span class="n">cistr</span><span class="p">(</span><span class="s">&#39;tHree&#39;</span><span class="p">):</span> <span class="mi">3</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">cistr</span><span class="p">(</span><span class="s">&#39;one&#39;</span><span class="p">)],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">cistr</span><span class="p">(</span><span class="s">&#39;tWo&#39;</span><span class="p">)],</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">cistr</span><span class="p">(</span><span class="s">&#39;THrEE&#39;</span><span class="p">)],</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">cistr</span><span class="p">(</span><span class="s">&#39;ONe&#39;</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cistr</span><span class="p">(</span><span class="s">&#39;thrEE&#39;</span><span class="p">)),</span> <span class="mi">3</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_classic_comparisons"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_classic_comparisons">[docs]</a>    <span class="k">def</span> <span class="nf">test_classic_comparisons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing classic comparisons...</span>
        <span class="k">class</span> <span class="nc">classic</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="p">(</span><span class="n">classic</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">object</span><span class="p">):</span>
            <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">base</span><span class="p">):</span>
                <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">other</span>
                    <span class="k">return</span> <span class="bp">NotImplemented</span>
                <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="n">other</span>
                    <span class="k">return</span> <span class="bp">NotImplemented</span>
                <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="n">other</span>
                    <span class="k">return</span> <span class="bp">NotImplemented</span>
                <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="n">other</span>
                    <span class="k">return</span> <span class="bp">NotImplemented</span>
                <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="n">other</span>
                    <span class="k">return</span> <span class="bp">NotImplemented</span>
                <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;=</span> <span class="n">other</span>
                    <span class="k">return</span> <span class="bp">NotImplemented</span>

            <span class="n">c1</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">c2</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">c3</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="n">c1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="n">c2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="n">c3</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="s">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;=&quot;</span><span class="p">,</span> <span class="s">&quot;==&quot;</span><span class="p">,</span> <span class="s">&quot;!=&quot;</span><span class="p">,</span> <span class="s">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;&gt;=&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s">&quot;c[x] </span><span class="si">%s</span><span class="s"> c[y]&quot;</span> <span class="o">%</span> <span class="n">op</span><span class="p">),</span>
                                     <span class="nb">eval</span><span class="p">(</span><span class="s">&quot;x </span><span class="si">%s</span><span class="s"> y&quot;</span> <span class="o">%</span> <span class="n">op</span><span class="p">),</span>
                                     <span class="s">&quot;x=</span><span class="si">%d</span><span class="s">, y=</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s">&quot;c[x] </span><span class="si">%s</span><span class="s"> y&quot;</span> <span class="o">%</span> <span class="n">op</span><span class="p">),</span>
                                     <span class="nb">eval</span><span class="p">(</span><span class="s">&quot;x </span><span class="si">%s</span><span class="s"> y&quot;</span> <span class="o">%</span> <span class="n">op</span><span class="p">),</span>
                                     <span class="s">&quot;x=</span><span class="si">%d</span><span class="s">, y=</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s">&quot;x </span><span class="si">%s</span><span class="s"> c[y]&quot;</span> <span class="o">%</span> <span class="n">op</span><span class="p">),</span>
                                     <span class="nb">eval</span><span class="p">(</span><span class="s">&quot;x </span><span class="si">%s</span><span class="s"> y&quot;</span> <span class="o">%</span> <span class="n">op</span><span class="p">),</span>
                                     <span class="s">&quot;x=</span><span class="si">%d</span><span class="s">, y=</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_rich_comparisons"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_rich_comparisons">[docs]</a>    <span class="k">def</span> <span class="nf">test_rich_comparisons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing rich comparisons...</span>
        <span class="k">class</span> <span class="nc">Z</span><span class="p">(</span><span class="nb">complex</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">0j</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">ZZ</span><span class="p">(</span><span class="nb">complex</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span> <span class="o">-</span> <span class="n">other</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1e-6</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">NotImplemented</span>
        <span class="n">zz</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">(</span><span class="mf">1.0000003</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">zz</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">0j</span><span class="p">,</span> <span class="n">zz</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">classic</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="p">(</span><span class="n">classic</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">base</span><span class="p">):</span>
                <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="n">self_</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t call __cmp__&quot;</span><span class="p">)</span>
                <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">other</span>
                    <span class="k">return</span> <span class="bp">NotImplemented</span>
                <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="n">other</span>
                    <span class="k">return</span> <span class="bp">NotImplemented</span>
                <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="n">other</span>
                    <span class="k">return</span> <span class="bp">NotImplemented</span>
                <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="n">other</span>
                    <span class="k">return</span> <span class="bp">NotImplemented</span>
                <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="n">other</span>
                    <span class="k">return</span> <span class="bp">NotImplemented</span>
                <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;=</span> <span class="n">other</span>
                    <span class="k">return</span> <span class="bp">NotImplemented</span>
            <span class="n">c1</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">c2</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">c3</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="n">c1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="n">c2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="n">c3</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="s">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;=&quot;</span><span class="p">,</span> <span class="s">&quot;==&quot;</span><span class="p">,</span> <span class="s">&quot;!=&quot;</span><span class="p">,</span> <span class="s">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;&gt;=&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s">&quot;c[x] </span><span class="si">%s</span><span class="s"> c[y]&quot;</span> <span class="o">%</span> <span class="n">op</span><span class="p">),</span>
                                         <span class="nb">eval</span><span class="p">(</span><span class="s">&quot;x </span><span class="si">%s</span><span class="s"> y&quot;</span> <span class="o">%</span> <span class="n">op</span><span class="p">),</span>
                                         <span class="s">&quot;x=</span><span class="si">%d</span><span class="s">, y=</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s">&quot;c[x] </span><span class="si">%s</span><span class="s"> y&quot;</span> <span class="o">%</span> <span class="n">op</span><span class="p">),</span>
                                         <span class="nb">eval</span><span class="p">(</span><span class="s">&quot;x </span><span class="si">%s</span><span class="s"> y&quot;</span> <span class="o">%</span> <span class="n">op</span><span class="p">),</span>
                                         <span class="s">&quot;x=</span><span class="si">%d</span><span class="s">, y=</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s">&quot;x </span><span class="si">%s</span><span class="s"> c[y]&quot;</span> <span class="o">%</span> <span class="n">op</span><span class="p">),</span>
                                         <span class="nb">eval</span><span class="p">(</span><span class="s">&quot;x </span><span class="si">%s</span><span class="s"> y&quot;</span> <span class="o">%</span> <span class="n">op</span><span class="p">),</span>
                                         <span class="s">&quot;x=</span><span class="si">%d</span><span class="s">, y=</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_descrdoc"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_descrdoc">[docs]</a>    <span class="k">def</span> <span class="nf">test_descrdoc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing descriptor doc strings...</span>
        <span class="kn">from</span> <span class="nn">_io</span> <span class="kn">import</span> <span class="n">FileIO</span>
        <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">descr</span><span class="p">,</span> <span class="n">what</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">descr</span><span class="o">.</span><span class="n">__doc__</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span>
        <span class="n">check</span><span class="p">(</span><span class="n">FileIO</span><span class="o">.</span><span class="n">closed</span><span class="p">,</span> <span class="s">&quot;True if the file is closed&quot;</span><span class="p">)</span> <span class="c"># getset descriptor</span>
        <span class="n">check</span><span class="p">(</span><span class="nb">complex</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="s">&quot;the real part of a complex number&quot;</span><span class="p">)</span> <span class="c"># member descriptor</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_doc_descriptor"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_doc_descriptor">[docs]</a>    <span class="k">def</span> <span class="nf">test_doc_descriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing __doc__ descriptor...</span>
        <span class="c"># SF bug 542984</span>
        <span class="k">class</span> <span class="nc">DocDescr</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="n">otype</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">object</span><span class="p">:</span>
                    <span class="nb">object</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span> <span class="o">+</span> <span class="s">&#39; instance&#39;</span>
                <span class="k">if</span> <span class="n">otype</span><span class="p">:</span>
                    <span class="n">otype</span> <span class="o">=</span> <span class="n">otype</span><span class="o">.</span><span class="n">__name__</span>
                <span class="k">return</span> <span class="s">&#39;object=</span><span class="si">%s</span><span class="s">; type=</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">otype</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">OldClass</span><span class="p">:</span>
            <span class="n">__doc__</span> <span class="o">=</span> <span class="n">DocDescr</span><span class="p">()</span>
        <span class="k">class</span> <span class="nc">NewClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__doc__</span> <span class="o">=</span> <span class="n">DocDescr</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">OldClass</span><span class="o">.</span><span class="n">__doc__</span><span class="p">,</span> <span class="s">&#39;object=None; type=OldClass&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">OldClass</span><span class="p">()</span><span class="o">.</span><span class="n">__doc__</span><span class="p">,</span> <span class="s">&#39;object=OldClass instance; type=OldClass&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">NewClass</span><span class="o">.</span><span class="n">__doc__</span><span class="p">,</span> <span class="s">&#39;object=None; type=NewClass&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">NewClass</span><span class="p">()</span><span class="o">.</span><span class="n">__doc__</span><span class="p">,</span> <span class="s">&#39;object=NewClass instance; type=NewClass&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_set_class"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_set_class">[docs]</a>    <span class="k">def</span> <span class="nf">test_set_class</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing __class__ assignment...</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">F</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="k">pass</span>
        <span class="k">for</span> <span class="n">cls</span> <span class="ow">in</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">F</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cls2</span> <span class="ow">in</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">F</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">cls</span><span class="p">()</span>
                <span class="n">x</span><span class="o">.</span><span class="n">__class__</span> <span class="o">=</span> <span class="n">cls2</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">cls2</span><span class="p">)</span>
                <span class="n">x</span><span class="o">.</span><span class="n">__class__</span> <span class="o">=</span> <span class="n">cls</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">cls</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">cant</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">x</span><span class="o">.</span><span class="n">__class__</span> <span class="o">=</span> <span class="n">C</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t allow </span><span class="si">%r</span><span class="s">.__class__ = </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">C</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">delattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&quot;__class__&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t allow del </span><span class="si">%r</span><span class="s">.__class__&quot;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">cant</span><span class="p">(</span><span class="n">C</span><span class="p">(),</span> <span class="nb">list</span><span class="p">)</span>
        <span class="n">cant</span><span class="p">(</span><span class="nb">list</span><span class="p">(),</span> <span class="n">C</span><span class="p">)</span>
        <span class="n">cant</span><span class="p">(</span><span class="n">C</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">cant</span><span class="p">(</span><span class="n">C</span><span class="p">(),</span> <span class="nb">object</span><span class="p">)</span>
        <span class="n">cant</span><span class="p">(</span><span class="nb">object</span><span class="p">(),</span> <span class="nb">list</span><span class="p">)</span>
        <span class="n">cant</span><span class="p">(</span><span class="nb">list</span><span class="p">(),</span> <span class="nb">object</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">Int</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cant</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Int</span><span class="p">)</span>
        <span class="n">cant</span><span class="p">(</span><span class="n">Int</span><span class="p">(),</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cant</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cant</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">o</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
        <span class="n">cant</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">cant</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">))</span>
        <span class="k">del</span> <span class="n">o</span>
        <span class="k">class</span> <span class="nc">G</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">]</span>
        <span class="k">class</span> <span class="nc">H</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">]</span>
        <span class="k">class</span> <span class="nc">I</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">]</span>
        <span class="k">class</span> <span class="nc">J</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">]</span>
        <span class="k">class</span> <span class="nc">K</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;d&quot;</span><span class="p">]</span>
        <span class="k">class</span> <span class="nc">L</span><span class="p">(</span><span class="n">H</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;e&quot;</span><span class="p">]</span>
        <span class="k">class</span> <span class="nc">M</span><span class="p">(</span><span class="n">I</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;e&quot;</span><span class="p">]</span>
        <span class="k">class</span> <span class="nc">N</span><span class="p">(</span><span class="n">J</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;__weakref__&quot;</span><span class="p">]</span>
        <span class="k">class</span> <span class="nc">P</span><span class="p">(</span><span class="n">J</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;__dict__&quot;</span><span class="p">]</span>
        <span class="k">class</span> <span class="nc">Q</span><span class="p">(</span><span class="n">J</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">R</span><span class="p">(</span><span class="n">J</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;__dict__&quot;</span><span class="p">,</span> <span class="s">&quot;__weakref__&quot;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">cls</span><span class="p">,</span> <span class="n">cls2</span> <span class="ow">in</span> <span class="p">((</span><span class="n">G</span><span class="p">,</span> <span class="n">H</span><span class="p">),</span> <span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">I</span><span class="p">),</span> <span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">H</span><span class="p">),</span> <span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span><span class="p">),</span> <span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">Q</span><span class="p">)):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">cls</span><span class="p">()</span>
            <span class="n">x</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">x</span><span class="o">.</span><span class="n">__class__</span> <span class="o">=</span> <span class="n">cls2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">cls2</span><span class="p">,</span>
                   <span class="s">&quot;assigning </span><span class="si">%r</span><span class="s"> as __class__ for </span><span class="si">%r</span><span class="s"> silently failed&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls2</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">x</span><span class="o">.</span><span class="n">__class__</span> <span class="o">=</span> <span class="n">cls</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">cls</span><span class="p">,</span>
                   <span class="s">&quot;assigning </span><span class="si">%r</span><span class="s"> as __class__ for </span><span class="si">%r</span><span class="s"> silently failed&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">cls</span> <span class="ow">in</span> <span class="n">G</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">Int</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cls2</span> <span class="ow">in</span> <span class="n">G</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">Int</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cls</span> <span class="ow">is</span> <span class="n">cls2</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">cant</span><span class="p">(</span><span class="n">cls</span><span class="p">(),</span> <span class="n">cls2</span><span class="p">)</span>

        <span class="c"># Issue5283: when __class__ changes in __del__, the wrong</span>
        <span class="c"># type gets DECREF&#39;d.</span>
        <span class="k">class</span> <span class="nc">O</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span> <span class="o">=</span> <span class="n">O</span>
        <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
        <span class="k">del</span> <span class="n">l</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_set_dict"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_set_dict">[docs]</a>    <span class="k">def</span> <span class="nf">test_set_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing __dict__ assignment...</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">a</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">cant</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">x</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="nb">dict</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t allow </span><span class="si">%r</span><span class="s">.__dict__ = </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">))</span>
        <span class="n">cant</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">cant</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">cant</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">a</span><span class="o">.</span><span class="n">__dict__</span> <span class="c"># Deleting __dict__ is allowed</span>

        <span class="k">class</span> <span class="nc">Base</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">def</span> <span class="nf">verify_dict_readonly</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            x has to be an instance of a class inheriting from Base.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">cant</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">x</span><span class="o">.</span><span class="n">__dict__</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t allow del </span><span class="si">%r</span><span class="s">.__dict__&quot;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">dict_descr</span> <span class="o">=</span> <span class="n">Base</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&quot;__dict__&quot;</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dict_descr</span><span class="o">.</span><span class="n">__set__</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;dict_descr allowed access to </span><span class="si">%r</span><span class="s">&#39;s dict&quot;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>

        <span class="c"># Classes don&#39;t allow __dict__ assignment and have readonly dicts</span>
        <span class="k">class</span> <span class="nc">Meta1</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">Base</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">Meta2</span><span class="p">(</span><span class="n">Base</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">Meta1</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">Meta2</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">cls</span> <span class="ow">in</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">E</span><span class="p">:</span>
            <span class="n">verify_dict_readonly</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span>
            <span class="n">class_dict</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">__dict__</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">class_dict</span><span class="p">[</span><span class="s">&quot;spam&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;eggs&quot;</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%r</span><span class="s">&#39;s __dict__ can be modified&quot;</span> <span class="o">%</span> <span class="n">cls</span><span class="p">)</span>

        <span class="c"># Modules also disallow __dict__ assignment</span>
        <span class="k">class</span> <span class="nc">Module1</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">Base</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">Module2</span><span class="p">(</span><span class="n">Base</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">ModuleType</span> <span class="ow">in</span> <span class="n">Module1</span><span class="p">,</span> <span class="n">Module2</span><span class="p">:</span>
            <span class="n">mod</span> <span class="o">=</span> <span class="n">ModuleType</span><span class="p">(</span><span class="s">&quot;spam&quot;</span><span class="p">)</span>
            <span class="n">verify_dict_readonly</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
            <span class="n">mod</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&quot;spam&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;eggs&quot;</span>

        <span class="c"># Exception&#39;s __dict__ can be replaced, but not deleted</span>
        <span class="c"># (at least not any more than regular exception&#39;s __dict__ can</span>
        <span class="c"># be deleted; on CPython it is not the case, whereas on PyPy they</span>
        <span class="c"># can, just like any other new-style instance&#39;s __dict__.)</span>
        <span class="k">def</span> <span class="nf">can_delete_dict</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">e</span><span class="o">.</span><span class="n">__dict__</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">class</span> <span class="nc">Exception1</span><span class="p">(</span><span class="ne">Exception</span><span class="p">,</span> <span class="n">Base</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">Exception2</span><span class="p">(</span><span class="n">Base</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">ExceptionType</span> <span class="ow">in</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">Exception1</span><span class="p">,</span> <span class="n">Exception2</span><span class="p">:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">ExceptionType</span><span class="p">()</span>
            <span class="n">e</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;a&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">can_delete_dict</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">can_delete_dict</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">()))</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_binary_operator_override"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_binary_operator_override">[docs]</a>    <span class="k">def</span> <span class="nf">test_binary_operator_override</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing overrides of binary operations...</span>
        <span class="k">class</span> <span class="nc">I</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;I(</span><span class="si">%r</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">I</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
            <span class="n">__radd__</span> <span class="o">=</span> <span class="n">__add__</span>
            <span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">mod</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">mod</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">I</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">I</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">mod</span><span class="p">)))</span>
            <span class="k">def</span> <span class="nf">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">mod</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">mod</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">I</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">mod</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">I</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">mod</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="s">&quot;I(3)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="s">&quot;I(3)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="s">&quot;I(3)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="n">I</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="s">&quot;I(8)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">I</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="s">&quot;I(8)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span><span class="p">),</span> <span class="s">&quot;I(8)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">I</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">I</span><span class="p">(</span><span class="mi">5</span><span class="p">))),</span> <span class="s">&quot;I(3)&quot;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">S</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_subclass_propagation"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_subclass_propagation">[docs]</a>    <span class="k">def</span> <span class="nf">test_subclass_propagation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing propagation of slot functions to subclasses...</span>
        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="n">orig_hash</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="c"># related to id(d) in platform-dependent ways</span>
        <span class="n">A</span><span class="o">.</span><span class="n">__hash__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="mi">42</span><span class="p">)</span>
        <span class="n">C</span><span class="o">.</span><span class="n">__hash__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="mi">314</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="mi">314</span><span class="p">)</span>
        <span class="n">B</span><span class="o">.</span><span class="n">__hash__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="mi">144</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="mi">144</span><span class="p">)</span>
        <span class="n">D</span><span class="o">.</span><span class="n">__hash__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="mi">100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">D</span><span class="o">.</span><span class="n">__hash__</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">hash</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">D</span><span class="o">.</span><span class="n">__hash__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="mi">144</span><span class="p">)</span>
        <span class="n">B</span><span class="o">.</span><span class="n">__hash__</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">hash</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">B</span><span class="o">.</span><span class="n">__hash__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="mi">314</span><span class="p">)</span>
        <span class="n">C</span><span class="o">.</span><span class="n">__hash__</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">hash</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">C</span><span class="o">.</span><span class="n">__hash__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="mi">42</span><span class="p">)</span>
        <span class="n">A</span><span class="o">.</span><span class="n">__hash__</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">hash</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">A</span><span class="o">.</span><span class="n">__hash__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">orig_hash</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="n">d</span><span class="o">.</span><span class="n">bar</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">bar</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&quot;foo&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">24</span>
            <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">A</span><span class="o">.</span><span class="n">__getattribute__</span> <span class="o">=</span> <span class="n">__getattribute__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">bar</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;spam&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;hello&quot;</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">B</span><span class="o">.</span><span class="n">__getattr__</span> <span class="o">=</span> <span class="n">__getattr__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">spam</span><span class="p">,</span> <span class="s">&quot;hello&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">bar</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">A</span><span class="o">.</span><span class="n">__getattribute__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">d</span><span class="o">.</span><span class="n">foo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="s">&quot;hello&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">bar</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">B</span><span class="o">.</span><span class="n">__getattr__</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">d</span><span class="o">.</span><span class="n">foo</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;d.foo should be undefined now&quot;</span><span class="p">)</span>

        <span class="c"># Test a nasty bug in recurse_down_subclasses()</span>
        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">del</span> <span class="n">B</span>
        <span class="n">support</span><span class="o">.</span><span class="n">gc_collect</span><span class="p">()</span>
        <span class="n">A</span><span class="o">.</span><span class="n">__setitem__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">a</span><span class="p">:</span> <span class="bp">None</span> <span class="c"># crash</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_buffer_inheritance"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_buffer_inheritance">[docs]</a>    <span class="k">def</span> <span class="nf">test_buffer_inheritance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing that buffer interface is inherited ...</span>

        <span class="kn">import</span> <span class="nn">binascii</span>
        <span class="c"># SF bug [#470040] ParseTuple t# vs subclasses.</span>

        <span class="k">class</span> <span class="nc">MyBytes</span><span class="p">(</span><span class="nb">bytes</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;abc&#39;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MyBytes</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
        <span class="c"># b2a_hex uses the buffer interface to get its argument&#39;s value, via</span>
        <span class="c"># PyArg_ParseTuple &#39;t#&#39; code.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">binascii</span><span class="o">.</span><span class="n">b2a_hex</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">binascii</span><span class="o">.</span><span class="n">b2a_hex</span><span class="p">(</span><span class="n">base</span><span class="p">))</span>

        <span class="k">class</span> <span class="nc">MyInt</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MyInt</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">binascii</span><span class="o">.</span><span class="n">b2a_hex</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&#39;subclass of int should not have a buffer interface&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_str_of_str_subclass"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_str_of_str_subclass">[docs]</a>    <span class="k">def</span> <span class="nf">test_str_of_str_subclass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing __str__ defined in subclass of str ...</span>
        <span class="kn">import</span> <span class="nn">binascii</span>
        <span class="kn">import</span> <span class="nn">io</span>

        <span class="k">class</span> <span class="nc">octetstring</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">binascii</span><span class="o">.</span><span class="n">b2a_hex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;ascii&quot;</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="s">&quot; repr&quot;</span>

        <span class="n">o</span> <span class="o">=</span> <span class="n">octetstring</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">o</span><span class="p">),</span> <span class="n">octetstring</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="p">)),</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">o</span><span class="p">)),</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">o</span><span class="p">),</span> <span class="mh">0x41</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="p">),</span> <span class="s">&#39;41&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">o</span><span class="p">),</span> <span class="s">&#39;A repr&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">__str__</span><span class="p">(),</span> <span class="s">&#39;41&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">__repr__</span><span class="p">(),</span> <span class="s">&#39;A repr&#39;</span><span class="p">)</span>

        <span class="n">capture</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="c"># Calling str() or not exercises different internal paths.</span>
        <span class="k">print</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">capture</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="p">),</span> <span class="nb">file</span><span class="o">=</span><span class="n">capture</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">capture</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span> <span class="s">&#39;41</span><span class="se">\n</span><span class="s">41</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">capture</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_keyword_arguments"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_keyword_arguments">[docs]</a>    <span class="k">def</span> <span class="nf">test_keyword_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing keyword arguments to __init__, __call__...</span>
        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">a</span><span class="p">):</span> <span class="k">return</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">__call__</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span> <span class="mi">42</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="nb">list</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_recursive_call"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_recursive_call">[docs]</a>    <span class="k">def</span> <span class="nf">test_recursive_call</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing recursive __call__() by setting to instance of class...</span>
        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="n">A</span><span class="o">.</span><span class="n">__call__</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">A</span><span class="p">()()</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Recursion limit should have been reached for __call__()&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_delete_hook"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_delete_hook">[docs]</a>    <span class="k">def</span> <span class="nf">test_delete_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing __del__ hook...</span>
        <span class="n">log</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">del</span> <span class="n">c</span>
        <span class="n">support</span><span class="o">.</span><span class="n">gc_collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span> <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;invalid del() didn&#39;t raise TypeError&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_hash_inheritance"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_hash_inheritance">[docs]</a>    <span class="k">def</span> <span class="nf">test_hash_inheritance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing hash of mutable subclasses...</span>

        <span class="k">class</span> <span class="nc">mydict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">mydict</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">hash</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;hash() of dict subclass should fail&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">mylist</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">mylist</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">hash</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;hash() of list subclass should fail&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_str_operations"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_str_operations">[docs]</a>    <span class="k">def</span> <span class="nf">test_str_operations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span> <span class="s">&#39;a&#39;</span> <span class="o">+</span> <span class="mi">5</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;&#39;&#39; + 5 doesn&#39;t raise TypeError&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;&#39;&#39;.split(&#39;&#39;) doesn&#39;t raise ValueError&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;&#39;&#39;.join([0]) doesn&#39;t raise TypeError&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">rindex</span><span class="p">(</span><span class="s">&#39;5&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;&#39;&#39;.rindex(&#39;5&#39;) doesn&#39;t raise ValueError&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span> <span class="s">&#39;</span><span class="si">%(n)s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">None</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;&#39;</span><span class="si">%(n)s</span><span class="s">&#39; % None doesn&#39;t raise TypeError&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span> <span class="s">&#39;%(n&#39;</span> <span class="o">%</span> <span class="p">{}</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;&#39;%(n&#39; % {} &#39;&#39; doesn&#39;t raise ValueError&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span> <span class="s">&#39;</span><span class="si">%*s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;&#39;</span><span class="si">%*s</span><span class="s">&#39; % (&#39;abc&#39;) doesn&#39;t raise TypeError&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span> <span class="s">&#39;</span><span class="si">%*.*s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;&#39;</span><span class="si">%*.*s</span><span class="s">&#39; % (&#39;abc&#39;, 5) doesn&#39;t raise TypeError&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;&#39;</span><span class="si">%s</span><span class="s">&#39; % (1, 2) doesn&#39;t raise TypeError&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span> <span class="s">&#39;%&#39;</span> <span class="o">%</span> <span class="bp">None</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;&#39;%&#39; % None doesn&#39;t raise ValueError&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&#39;534253&#39;</span><span class="o">.</span><span class="n">isdigit</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&#39;534253x&#39;</span><span class="o">.</span><span class="n">isdigit</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%c</span><span class="s">&#39;</span> <span class="o">%</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\x05</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%c</span><span class="s">&#39;</span> <span class="o">%</span> <span class="s">&#39;5&#39;</span><span class="p">,</span> <span class="s">&#39;5&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_deepcopy_recursive"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_deepcopy_recursive">[docs]</a>    <span class="k">def</span> <span class="nf">test_deepcopy_recursive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing deepcopy of recursive objects...</span>
        <span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">Node</span><span class="p">()</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">Node</span><span class="p">()</span>
        <span class="n">a</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
        <span class="n">b</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="c"># This blew up before</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_unintialized_modules"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_unintialized_modules">[docs]</a>    <span class="k">def</span> <span class="nf">test_unintialized_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing uninitialized module objects...</span>
        <span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="n">ModuleType</span> <span class="k">as</span> <span class="n">M</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;__name__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;__file__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">__dict__</span><span class="p">)</span>   <span class="c"># None or {} are both reasonable answers</span>
        <span class="n">m</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;foo&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_funny_new"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_funny_new">[docs]</a>    <span class="k">def</span> <span class="nf">test_funny_new</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing __new__ returning something unexpected...</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span> <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span> <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="n">arg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_imul_bug"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_imul_bug">[docs]</a>    <span class="k">def</span> <span class="nf">test_imul_bug</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing for __imul__ problems...</span>
        <span class="c"># SF bug 544647</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__imul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">y</span> <span class="o">*=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">y</span> <span class="o">*=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">y</span> <span class="o">*=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">y</span> <span class="o">*=</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">100</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">y</span> <span class="o">*=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">y</span> <span class="o">*=</span> <span class="s">&quot;foo&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_copy_setstate"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_copy_setstate">[docs]</a>    <span class="k">def</span> <span class="nf">test_copy_setstate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing that copy.*copy() correctly uses __setstate__...</span>
        <span class="kn">import</span> <span class="nn">copy</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foo</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="n">foo</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__foo</span> <span class="o">=</span> <span class="n">foo</span>
            <span class="k">def</span> <span class="nf">setfoo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foo</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="n">foo</span>
            <span class="k">def</span> <span class="nf">getfoo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__foo</span>
            <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">foo</span><span class="p">]</span>
            <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="n">self_</span><span class="p">,</span> <span class="n">lst</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">self_</span><span class="o">.</span><span class="n">__foo</span> <span class="o">=</span> <span class="n">self_</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">setfoo</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">getfoo</span><span class="p">(),</span> <span class="mi">42</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">getfoo</span><span class="p">(),</span> <span class="mi">24</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">getfoo</span><span class="p">(),</span> <span class="mi">24</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_slices"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_slices">[docs]</a>    <span class="k">def</span> <span class="nf">test_slices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing cases with slices and overridden __getitem__ ...</span>

        <span class="c"># Strings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="s">&quot;hell&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span> <span class="s">&quot;hell&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="s">&quot;hell&quot;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">S</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">str</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">)[:</span><span class="mi">4</span><span class="p">],</span> <span class="s">&quot;hell&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">)[</span><span class="nb">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span> <span class="s">&quot;hell&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="s">&quot;hell&quot;</span><span class="p">)</span>
        <span class="c"># Tuples</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)[:</span><span class="mi">2</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)[</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">tuple</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">class</span> <span class="nc">T</span><span class="p">(</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">tuple</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">T</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))[:</span><span class="mi">2</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">T</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))[</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">T</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="c"># Lists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">][:</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">][</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">class</span> <span class="nc">L</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">list</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">L</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])[:</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">L</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])[</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">L</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="c"># Now do lists and __setitem__</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">L</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">a</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">a</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">a</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">a</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_subtype_resurrection"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_subtype_resurrection">[docs]</a>    <span class="k">def</span> <span class="nf">test_subtype_resurrection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing resurrection of new-style instance...</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">container</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="c"># resurrect the instance</span>
                <span class="n">C</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">c</span><span class="o">.</span><span class="n">attr</span> <span class="o">=</span> <span class="mi">42</span>

        <span class="c"># The most interesting thing here is whether this blows up, due to</span>
        <span class="c"># flawed GC tracking logic in typeobject.c&#39;s call_finalizer() (a 2.2.1</span>
        <span class="c"># bug).</span>
        <span class="k">del</span> <span class="n">c</span>

        <span class="n">support</span><span class="o">.</span><span class="n">gc_collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">container</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c"># Make c mortal again, so that the test framework with -l doesn&#39;t report</span>
        <span class="c"># it as a leak.</span>
        <span class="k">del</span> <span class="n">C</span><span class="o">.</span><span class="n">__del__</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_slots_trash"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_slots_trash">[docs]</a>    <span class="k">def</span> <span class="nf">test_slots_trash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing slot trash...</span>
        <span class="c"># Deallocating deeply nested slotted trash caused stack overflows</span>
        <span class="k">class</span> <span class="nc">trash</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">o</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50000</span><span class="p">):</span>
            <span class="n">o</span> <span class="o">=</span> <span class="n">trash</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">o</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_slots_multiple_inheritance"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_slots_multiple_inheritance">[docs]</a>    <span class="k">def</span> <span class="nf">test_slots_multiple_inheritance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># SF bug 575229, multiple inheritance w/ slots dumps core</span>
        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__slots__</span><span class="o">=</span><span class="p">()</span>
        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="p">:</span>
            <span class="n">__slots__</span><span class="o">=</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">support</span><span class="o">.</span><span class="n">check_impl_detail</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">__basicsize__</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">__basicsize__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHasAttr</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="s">&#39;__dict__&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHasAttr</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="s">&#39;__weakref__&#39;</span><span class="p">)</span>
        <span class="n">C</span><span class="p">()</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_rmul"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_rmul">[docs]</a>    <span class="k">def</span> <span class="nf">test_rmul</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing correct invocation of __rmul__...</span>
        <span class="c"># SF patch 592646</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;mul&quot;</span>
            <span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;rmul&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="s">&quot;mul&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="mf">2.2</span><span class="p">,</span> <span class="s">&quot;mul&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;rmul&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mf">2.2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;rmul&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_ipow"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_ipow">[docs]</a>    <span class="k">def</span> <span class="nf">test_ipow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing correct invocation of __ipow__...</span>
        <span class="c"># [SF bug 620179]</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__ipow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">pass</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">a</span> <span class="o">**=</span> <span class="mi">2</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_mutable_bases"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_mutable_bases">[docs]</a>    <span class="k">def</span> <span class="nf">test_mutable_bases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing mutable bases...</span>

        <span class="c"># stuff that should work:</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">C2</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s">&#39;a&#39;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">1</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">E</span><span class="p">()</span>
        <span class="n">D</span><span class="o">.</span><span class="n">__bases__</span> <span class="o">=</span> <span class="p">(</span><span class="n">C</span><span class="p">,)</span>
        <span class="n">D</span><span class="o">.</span><span class="n">__bases__</span> <span class="o">=</span> <span class="p">(</span><span class="n">C2</span><span class="p">,)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">meth</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">meth</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C2</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">(),</span> <span class="p">[</span><span class="n">D</span><span class="p">])</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">D</span><span class="o">.</span><span class="n">__bases__</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t be able to delete .__bases__&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">D</span><span class="o">.</span><span class="n">__bases__</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">msg</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="o">==</span> <span class="s">&quot;a new-style class can&#39;t have only classic bases&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;wrong error message for .__bases__ = ()&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t be able to set .__bases__ to ()&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">D</span><span class="o">.</span><span class="n">__bases__</span> <span class="o">=</span> <span class="p">(</span><span class="n">D</span><span class="p">,)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># actually, we&#39;ll have crashed by here...</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t be able to create inheritance cycles&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">D</span><span class="o">.</span><span class="n">__bases__</span> <span class="o">=</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;didn&#39;t detect repeated base classes&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">D</span><span class="o">.</span><span class="n">__bases__</span> <span class="o">=</span> <span class="p">(</span><span class="n">E</span><span class="p">,)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t be able to create inheritance cycles&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_builtin_bases"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_builtin_bases">[docs]</a>    <span class="k">def</span> <span class="nf">test_builtin_bases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure all the builtin types can have their base queried without</span>
        <span class="c"># segfaulting. See issue #5787.</span>
        <span class="n">builtin_types</span> <span class="o">=</span> <span class="p">[</span><span class="n">tp</span> <span class="k">for</span> <span class="n">tp</span> <span class="ow">in</span> <span class="n">builtins</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                         <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tp</span><span class="p">,</span> <span class="nb">type</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">tp</span> <span class="ow">in</span> <span class="n">builtin_types</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="n">tp</span><span class="p">,</span> <span class="s">&quot;__bases__&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">object</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tp</span><span class="o">.</span><span class="n">__bases__</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">L</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">L</span><span class="o">.</span><span class="n">__bases__</span> <span class="o">=</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t turn list subclass into dict subclass&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">__bases__</span> <span class="o">=</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t be able to assign to list.__bases__&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">D</span><span class="o">.</span><span class="n">__bases__</span> <span class="o">=</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;best_base calculation found wanting&quot;</span>

</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_mutable_bases_with_failing_mro"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_mutable_bases_with_failing_mro">[docs]</a>    <span class="k">def</span> <span class="nf">test_mutable_bases_with_failing_mro</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing mutable bases with failing mro...</span>
        <span class="k">class</span> <span class="nc">WorkOnce</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">ns</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">WorkOnce</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">WorkOnce</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">ns</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">mro</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;bozo&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">flag</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">return</span> <span class="nb">type</span><span class="o">.</span><span class="n">mro</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">WorkAlways</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">mro</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="c"># this is here to make sure that .mro()s aren&#39;t called</span>
                <span class="c"># with an exception set (which was possible at one point).</span>
                <span class="c"># An error message will be printed in a debug build.</span>
                <span class="c"># What&#39;s a good way to test for this?</span>
                <span class="k">return</span> <span class="nb">type</span><span class="o">.</span><span class="n">mro</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">C2</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">F</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">WorkOnce</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">G</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">WorkAlways</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="c"># Immediate subclasses have their mro&#39;s adjusted in alphabetical</span>
        <span class="c"># order, so E&#39;s will get adjusted before adjusting F&#39;s fails.  We</span>
        <span class="c"># check here that E&#39;s gets restored.</span>

        <span class="n">E_mro_before</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">__mro__</span>
        <span class="n">D_mro_before</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">__mro__</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">D</span><span class="o">.</span><span class="n">__bases__</span> <span class="o">=</span> <span class="p">(</span><span class="n">C2</span><span class="p">,)</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">__mro__</span><span class="p">,</span> <span class="n">E_mro_before</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">__mro__</span><span class="p">,</span> <span class="n">D_mro_before</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;exception not propagated&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_mutable_bases_catch_mro_conflict"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_mutable_bases_catch_mro_conflict">[docs]</a>    <span class="k">def</span> <span class="nf">test_mutable_bases_catch_mro_conflict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing mutable bases catch mro conflict...</span>
        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">C</span><span class="o">.</span><span class="n">__bases__</span> <span class="o">=</span> <span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;didn&#39;t catch MRO conflict&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_mutable_names"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_mutable_names">[docs]</a>    <span class="k">def</span> <span class="nf">test_mutable_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing mutable names...</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="c"># C.__module__ could be &#39;test_descr&#39; or &#39;__main__&#39;</span>
        <span class="n">mod</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">__module__</span>

        <span class="n">C</span><span class="o">.</span><span class="n">__name__</span> <span class="o">=</span> <span class="s">&#39;D&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="n">C</span><span class="o">.</span><span class="n">__module__</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">__name__</span><span class="p">),</span> <span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="s">&#39;D&#39;</span><span class="p">))</span>

        <span class="n">C</span><span class="o">.</span><span class="n">__name__</span> <span class="o">=</span> <span class="s">&#39;D.E&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="n">C</span><span class="o">.</span><span class="n">__module__</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">__name__</span><span class="p">),</span> <span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="s">&#39;D.E&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_evil_type_name"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_evil_type_name">[docs]</a>    <span class="k">def</span> <span class="nf">test_evil_type_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># A badly placed Py_DECREF in type_set_name led to arbitrary code</span>
        <span class="c"># execution while the type structure was not in a sane state, and a</span>
        <span class="c"># possible segmentation fault as a result.  See bug #16447.</span>
        <span class="k">class</span> <span class="nc">Nasty</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="n">C</span><span class="o">.</span><span class="n">__name__</span> <span class="o">=</span> <span class="s">&quot;other&quot;</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">C</span><span class="o">.</span><span class="n">__name__</span> <span class="o">=</span> <span class="n">Nasty</span><span class="p">(</span><span class="s">&quot;abc&quot;</span><span class="p">)</span>
        <span class="n">C</span><span class="o">.</span><span class="n">__name__</span> <span class="o">=</span> <span class="s">&quot;normal&quot;</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_subclass_right_op"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_subclass_right_op">[docs]</a>    <span class="k">def</span> <span class="nf">test_subclass_right_op</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing correct dispatch of subclass overloading __r&lt;op&gt;__...</span>

        <span class="c"># This code tests various cases where right-dispatch of a subclass</span>
        <span class="c"># should be preferred over left-dispatch of a base class.</span>

        <span class="c"># Case 1: subclass of int; this tests code in abstract.c::binary_op1()</span>

        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;B.__floordiv__&quot;</span>
            <span class="k">def</span> <span class="nf">__rfloordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;B.__rfloordiv__&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;B.__floordiv__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">1</span> <span class="o">//</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s">&quot;B.__rfloordiv__&quot;</span><span class="p">)</span>

        <span class="c"># Case 2: subclass of object; this is just the baseline for case 3</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;C.__floordiv__&quot;</span>
            <span class="k">def</span> <span class="nf">__rfloordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;C.__rfloordiv__&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="p">()</span> <span class="o">//</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;C.__floordiv__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">1</span> <span class="o">//</span> <span class="n">C</span><span class="p">(),</span> <span class="s">&quot;C.__rfloordiv__&quot;</span><span class="p">)</span>

        <span class="c"># Case 3: subclass of new-style class; here it gets interesting</span>

        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;D.__floordiv__&quot;</span>
            <span class="k">def</span> <span class="nf">__rfloordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;D.__rfloordiv__&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">D</span><span class="p">()</span> <span class="o">//</span> <span class="n">C</span><span class="p">(),</span> <span class="s">&quot;D.__floordiv__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="p">()</span> <span class="o">//</span> <span class="n">D</span><span class="p">(),</span> <span class="s">&quot;D.__rfloordiv__&quot;</span><span class="p">)</span>

        <span class="c"># Case 4: this didn&#39;t work right in 2.2.2 and 2.3a1</span>

        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">__rfloordiv__</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">__rfloordiv__</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">E</span><span class="p">()</span> <span class="o">//</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;C.__floordiv__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">1</span> <span class="o">//</span> <span class="n">E</span><span class="p">(),</span> <span class="s">&quot;C.__rfloordiv__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">E</span><span class="p">()</span> <span class="o">//</span> <span class="n">C</span><span class="p">(),</span> <span class="s">&quot;C.__floordiv__&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="p">()</span> <span class="o">//</span> <span class="n">E</span><span class="p">(),</span> <span class="s">&quot;C.__floordiv__&quot;</span><span class="p">)</span> <span class="c"># This one would fail</span>
</div>
    <span class="nd">@support.impl_detail</span><span class="p">(</span><span class="s">&quot;testing an internal kind of method object&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_meth_class_get"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_meth_class_get">[docs]</a>    <span class="k">def</span> <span class="nf">test_meth_class_get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing __get__ method of METH_CLASS C methods...</span>
        <span class="c"># Full coverage of descrobject.c::classmethod_get()</span>

        <span class="c"># Baseline</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="bp">None</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">arg</span><span class="p">),</span> <span class="n">res</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">({}</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">arg</span><span class="p">),</span> <span class="n">res</span><span class="p">)</span>

        <span class="c"># Now get the descriptor</span>
        <span class="n">descr</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&quot;fromkeys&quot;</span><span class="p">]</span>

        <span class="c"># More baseline using the descriptor directly</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">descr</span><span class="o">.</span><span class="n">__get__</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)(</span><span class="n">arg</span><span class="p">),</span> <span class="n">res</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">descr</span><span class="o">.</span><span class="n">__get__</span><span class="p">({})(</span><span class="n">arg</span><span class="p">),</span> <span class="n">res</span><span class="p">)</span>

        <span class="c"># Now check various error cases</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">descr</span><span class="o">.</span><span class="n">__get__</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t have allowed descr.__get__(None, None)&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">descr</span><span class="o">.</span><span class="n">__get__</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t have allowed descr.__get__(42)&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">descr</span><span class="o">.</span><span class="n">__get__</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t have allowed descr.__get__(None, 42)&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">descr</span><span class="o">.</span><span class="n">__get__</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;shouldn&#39;t have allowed descr.__get__(None, int)&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_isinst_isclass"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_isinst_isclass">[docs]</a>    <span class="k">def</span> <span class="nf">test_isinst_isclass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing proxy isinstance() and isclass()...</span>
        <span class="k">class</span> <span class="nc">Proxy</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="k">def</span> <span class="nf">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;_Proxy__&quot;</span><span class="p">):</span>
                    <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__obj</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="c"># Test with a classic class</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">pa</span> <span class="o">=</span> <span class="n">Proxy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>  <span class="c"># Baseline</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">pa</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="c"># Test</span>
        <span class="c"># Test with a classic subclass</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="n">pa</span> <span class="o">=</span> <span class="n">Proxy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>  <span class="c"># Baseline</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">pa</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="c"># Test</span>
        <span class="c"># Test with a new-style class</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">pa</span> <span class="o">=</span> <span class="n">Proxy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>  <span class="c"># Baseline</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">pa</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="c"># Test</span>
        <span class="c"># Test with a new-style subclass</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
        <span class="n">pa</span> <span class="o">=</span> <span class="n">Proxy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>  <span class="c"># Baseline</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">pa</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="c"># Test</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_proxy_super"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_proxy_super">[docs]</a>    <span class="k">def</span> <span class="nf">test_proxy_super</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing super() for a proxy object...</span>
        <span class="k">class</span> <span class="nc">Proxy</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="k">def</span> <span class="nf">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;_Proxy__&quot;</span><span class="p">):</span>
                    <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__obj</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;B.f&quot;</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;-&gt;C.f&quot;</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">Proxy</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&quot;f&quot;</span><span class="p">](</span><span class="n">p</span><span class="p">),</span> <span class="s">&quot;B.f-&gt;C.f&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_carloverre"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_carloverre">[docs]</a>    <span class="k">def</span> <span class="nf">test_carloverre</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing prohibition of Carlo Verre&#39;s hack...</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Carlo Verre __setattr__ succeeded!&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="n">__delattr__</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="s">&quot;lower&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Carlo Verre __delattr__ succeeded!&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_weakref_segfault"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_weakref_segfault">[docs]</a>    <span class="k">def</span> <span class="nf">test_weakref_segfault</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing weakref segfault...</span>
        <span class="c"># SF 742911</span>
        <span class="kn">import</span> <span class="nn">weakref</span>

        <span class="k">class</span> <span class="nc">Provoker</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">referrent</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">referrent</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span>

        <span class="k">class</span> <span class="nc">Oops</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="n">o</span> <span class="o">=</span> <span class="n">Oops</span><span class="p">()</span>
        <span class="n">o</span><span class="o">.</span><span class="n">whatever</span> <span class="o">=</span> <span class="n">Provoker</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">o</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_wrapper_segfault"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_wrapper_segfault">[docs]</a>    <span class="k">def</span> <span class="nf">test_wrapper_segfault</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># SF 927248: deeply nested wrappers could cause stack overflow</span>
        <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span><span class="bp">None</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__call__</span>
        <span class="n">f</span> <span class="o">=</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_file_fault"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_file_fault">[docs]</a>    <span class="k">def</span> <span class="nf">test_file_fault</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing sys.stdout is changed in getattr...</span>
        <span class="n">test_stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>
        <span class="k">class</span> <span class="nc">StdoutGuard</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">__stdout__</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;Premature access to sys.stdout.</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">attr</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">StdoutGuard</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Oops!&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">test_stdout</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_vicious_descriptor_nonsense"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_vicious_descriptor_nonsense">[docs]</a>    <span class="k">def</span> <span class="nf">test_vicious_descriptor_nonsense</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing vicious_descriptor_nonsense...</span>

        <span class="c"># A potential segfault spotted by Thomas Wouters in mail to</span>
        <span class="c"># python-dev 2003-04-17, turned into an example &amp; fixed by Michael</span>
        <span class="c"># Hudson just less than four months later...</span>

        <span class="k">class</span> <span class="nc">Evil</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="s">&#39;attr&#39;</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">del</span> <span class="n">C</span><span class="o">.</span><span class="n">attr</span>
                <span class="k">return</span> <span class="mi">0</span>

        <span class="k">class</span> <span class="nc">Descr</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ob</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">1</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="n">Descr</span><span class="p">()</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">c</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">Evil</span><span class="p">()]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">attr</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c"># this makes a crash more likely:</span>
        <span class="n">support</span><span class="o">.</span><span class="n">gc_collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotHasAttr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">&#39;attr&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_init"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_init">[docs]</a>    <span class="k">def</span> <span class="nf">test_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># SF 1155938</span>
        <span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">10</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Foo</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;did not test __init__() for None return&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_method_wrapper"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_method_wrapper">[docs]</a>    <span class="k">def</span> <span class="nf">test_method_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing method-wrapper objects...</span>
        <span class="c"># &lt;type &#39;method-wrapper&#39;&gt; did not support any reflection before 2.5</span>

        <span class="c"># XXX should methods really support __eq__?</span>

        <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">__add__</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">__add__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">__add__</span><span class="p">,</span> <span class="p">[]</span><span class="o">.</span><span class="n">__add__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">__add__</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">__add__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">__add__</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">__mul__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">__add__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="s">&#39;__add__&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">__add__</span><span class="p">,</span> <span class="s">&#39;__self__&#39;</span><span class="p">):</span>
            <span class="c"># CPython</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">__add__</span><span class="o">.</span><span class="n">__self__</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">__add__</span><span class="o">.</span><span class="n">__objclass__</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Python implementations where [].__add__ is a normal bound method</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">__add__</span><span class="o">.</span><span class="n">im_self</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">__add__</span><span class="o">.</span><span class="n">im_class</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">__add__</span><span class="o">.</span><span class="n">__doc__</span><span class="p">,</span> <span class="nb">list</span><span class="o">.</span><span class="n">__add__</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">hash</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">__add__</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;no TypeError from hash([].__add__)&quot;</span><span class="p">)</span>

        <span class="n">t</span> <span class="o">=</span> <span class="p">()</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">__add__</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,)</span><span class="o">.</span><span class="n">__add__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">__add__</span><span class="p">),</span> <span class="nb">hash</span><span class="p">((</span><span class="mi">7</span><span class="p">,)</span><span class="o">.</span><span class="n">__add__</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_not_implemented"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_not_implemented">[docs]</a>    <span class="k">def</span> <span class="nf">test_not_implemented</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing NotImplemented...</span>
        <span class="c"># all binary methods should be able to return a NotImplemented</span>
        <span class="kn">import</span> <span class="nn">operator</span>

        <span class="k">def</span> <span class="nf">specialmethod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

        <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">exec</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;operator&#39;</span><span class="p">:</span> <span class="n">operator</span><span class="p">})</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;no TypeError from </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expr</span><span class="p">,))</span>

        <span class="n">N1</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span> <span class="o">+</span> <span class="mi">1</span>    <span class="c"># might trigger OverflowErrors instead of</span>
                                <span class="c"># TypeErrors</span>
        <span class="n">N2</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>         <span class="c"># if sizeof(int) &lt; sizeof(long), might trigger</span>
                                <span class="c">#   ValueErrors instead of TypeErrors</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">iexpr</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="p">(</span><span class="s">&#39;__add__&#39;</span><span class="p">,</span>      <span class="s">&#39;x + y&#39;</span><span class="p">,</span>                   <span class="s">&#39;x += y&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;__sub__&#39;</span><span class="p">,</span>      <span class="s">&#39;x - y&#39;</span><span class="p">,</span>                   <span class="s">&#39;x -= y&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;__mul__&#39;</span><span class="p">,</span>      <span class="s">&#39;x * y&#39;</span><span class="p">,</span>                   <span class="s">&#39;x *= y&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;__truediv__&#39;</span><span class="p">,</span>  <span class="s">&#39;operator.truediv(x, y)&#39;</span><span class="p">,</span>  <span class="bp">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;__floordiv__&#39;</span><span class="p">,</span> <span class="s">&#39;operator.floordiv(x, y)&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;__div__&#39;</span><span class="p">,</span>      <span class="s">&#39;x / y&#39;</span><span class="p">,</span>                   <span class="s">&#39;x /= y&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;__mod__&#39;</span><span class="p">,</span>      <span class="s">&#39;x % y&#39;</span><span class="p">,</span>                   <span class="s">&#39;x %= y&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;__divmod__&#39;</span><span class="p">,</span>   <span class="s">&#39;divmod(x, y)&#39;</span><span class="p">,</span>            <span class="bp">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;__pow__&#39;</span><span class="p">,</span>      <span class="s">&#39;x ** y&#39;</span><span class="p">,</span>                  <span class="s">&#39;x **= y&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;__lshift__&#39;</span><span class="p">,</span>   <span class="s">&#39;x &lt;&lt; y&#39;</span><span class="p">,</span>                  <span class="s">&#39;x &lt;&lt;= y&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;__rshift__&#39;</span><span class="p">,</span>   <span class="s">&#39;x &gt;&gt; y&#39;</span><span class="p">,</span>                  <span class="s">&#39;x &gt;&gt;= y&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;__and__&#39;</span><span class="p">,</span>      <span class="s">&#39;x &amp; y&#39;</span><span class="p">,</span>                   <span class="s">&#39;x &amp;= y&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;__or__&#39;</span><span class="p">,</span>       <span class="s">&#39;x | y&#39;</span><span class="p">,</span>                   <span class="s">&#39;x |= y&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;__xor__&#39;</span><span class="p">,</span>      <span class="s">&#39;x ^ y&#39;</span><span class="p">,</span>                   <span class="s">&#39;x ^= y&#39;</span><span class="p">)]:</span>
            <span class="n">rname</span> <span class="o">=</span> <span class="s">&#39;__r&#39;</span> <span class="o">+</span> <span class="n">name</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
            <span class="n">A</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="p">(),</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">specialmethod</span><span class="p">})</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
            <span class="n">check</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">check</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">N1</span><span class="p">)</span>
            <span class="n">check</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">N2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">iexpr</span><span class="p">:</span>
                <span class="n">check</span><span class="p">(</span><span class="n">iexpr</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
                <span class="n">check</span><span class="p">(</span><span class="n">iexpr</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">N1</span><span class="p">)</span>
                <span class="n">check</span><span class="p">(</span><span class="n">iexpr</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">N2</span><span class="p">)</span>
                <span class="n">iname</span> <span class="o">=</span> <span class="s">&#39;__i&#39;</span> <span class="o">+</span> <span class="n">name</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
                <span class="n">C</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="p">(),</span> <span class="p">{</span><span class="n">iname</span><span class="p">:</span> <span class="n">specialmethod</span><span class="p">})</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
                <span class="n">check</span><span class="p">(</span><span class="n">iexpr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
                <span class="n">check</span><span class="p">(</span><span class="n">iexpr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">N1</span><span class="p">)</span>
                <span class="n">check</span><span class="p">(</span><span class="n">iexpr</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">N2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_assign_slice"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_assign_slice">[docs]</a>    <span class="k">def</span> <span class="nf">test_assign_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># ceval.c&#39;s assign_slice used to check for</span>
        <span class="c"># tp-&gt;tp_as_sequence-&gt;sq_slice instead of</span>
        <span class="c"># tp-&gt;tp_as_sequence-&gt;sq_ass_slice</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
        <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_set_and_no_get"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_set_and_no_get">[docs]</a>    <span class="k">def</span> <span class="nf">test_set_and_no_get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># See</span>
        <span class="c"># http://mail.python.org/pipermail/python-dev/2010-January/095637.html</span>
        <span class="k">class</span> <span class="nc">Descr</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

            <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">descr</span> <span class="o">=</span> <span class="n">Descr</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">descr</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">descr</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>

        <span class="c"># Also check type_getattro for correctness.</span>
        <span class="k">class</span> <span class="nc">Meta</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">Meta</span>
        <span class="n">X</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="n">Meta</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">Descr</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_getattr_hooks"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_getattr_hooks">[docs]</a>    <span class="k">def</span> <span class="nf">test_getattr_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># issue 4230</span>

        <span class="k">class</span> <span class="nc">Descriptor</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">objtype</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
                <span class="k">def</span> <span class="nf">getter</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">getter</span>

        <span class="n">descr</span> <span class="o">=</span> <span class="n">Descriptor</span><span class="p">()</span>
        <span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__getattribute__</span> <span class="o">=</span> <span class="n">descr</span>
        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__getattr__</span> <span class="o">=</span> <span class="n">descr</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">__getattribute__</span> <span class="o">=</span> <span class="n">descr</span>
            <span class="n">__getattr__</span> <span class="o">=</span> <span class="n">descr</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">,</span> <span class="n">A</span><span class="p">(),</span> <span class="s">&quot;attr&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">descr</span><span class="o">.</span><span class="n">counter</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">,</span> <span class="n">B</span><span class="p">(),</span> <span class="s">&quot;attr&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">descr</span><span class="o">.</span><span class="n">counter</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">,</span> <span class="n">C</span><span class="p">(),</span> <span class="s">&quot;attr&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">descr</span><span class="o">.</span><span class="n">counter</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">EvilGetattribute</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="c"># This used to segfault</span>
            <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="k">del</span> <span class="n">EvilGetattribute</span><span class="o">.</span><span class="n">__getattr__</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
                    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">,</span> <span class="n">EvilGetattribute</span><span class="p">(),</span> <span class="s">&quot;attr&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_type___getattribute__"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_type___getattribute__">[docs]</a>    <span class="k">def</span> <span class="nf">test_type___getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">type</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_abstractmethods"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_abstractmethods">[docs]</a>    <span class="k">def</span> <span class="nf">test_abstractmethods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># type pretends not to have __abstractmethods__.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="s">&quot;__abstractmethods__&quot;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">meta</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="s">&quot;__abstractmethods__&quot;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">X</span><span class="o">.</span><span class="n">__abstractmethods__</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_proxy_call"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_proxy_call">[docs]</a>    <span class="k">def</span> <span class="nf">test_proxy_call</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">FakeStr</span><span class="p">:</span>
            <span class="n">__class__</span> <span class="o">=</span> <span class="nb">str</span>

        <span class="n">fake_str</span> <span class="o">=</span> <span class="n">FakeStr</span><span class="p">()</span>
        <span class="c"># isinstance() reads __class__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">fake_str</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>

        <span class="c"># call a method descriptor</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="nb">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">fake_str</span><span class="p">)</span>

        <span class="c"># call a slot wrapper descriptor</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="nb">str</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="n">fake_str</span><span class="p">,</span> <span class="s">&quot;abc&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_repr_as_str"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_repr_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">test_repr_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Issue #11603: crash or infinite loop when rebinding __str__ as</span>
        <span class="c"># __repr__.</span>
        <span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">Foo</span><span class="o">.</span><span class="n">__repr__</span> <span class="o">=</span> <span class="n">Foo</span><span class="o">.</span><span class="n">__str__</span>
        <span class="n">foo</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">RuntimeError</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">foo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">RuntimeError</span><span class="p">,</span> <span class="nb">repr</span><span class="p">,</span> <span class="n">foo</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_mixing_slot_wrappers"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_mixing_slot_wrappers">[docs]</a>    <span class="k">def</span> <span class="nf">test_mixing_slot_wrappers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
            <span class="n">__setattr__</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__setitem__</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="p">()</span>
        <span class="n">x</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&quot;y&quot;</span><span class="p">],</span> <span class="mi">42</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_slot_shadows_class_variable"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_slot_shadows_class_variable">[docs]</a>    <span class="k">def</span> <span class="nf">test_slot_shadows_class_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">X</span><span class="p">:</span>
                <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;foo&quot;</span><span class="p">]</span>
                <span class="n">foo</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&quot;&#39;foo&#39; in __slots__ conflicts with class variable&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_set_doc"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_set_doc">[docs]</a>    <span class="k">def</span> <span class="nf">test_set_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">X</span><span class="p">:</span>
            <span class="s">&quot;elephant&quot;</span>
        <span class="n">X</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">=</span> <span class="s">&quot;banana&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">__doc__</span><span class="p">,</span> <span class="s">&quot;banana&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="nb">type</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&quot;__doc__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">__set__</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="s">&quot;blah&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;can&#39;t set list.__doc__&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">))</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&quot;__doc__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">__delete__</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;can&#39;t delete X.__doc__&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">__doc__</span><span class="p">,</span> <span class="s">&quot;banana&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_qualname"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_qualname">[docs]</a>    <span class="k">def</span> <span class="nf">test_qualname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">descriptors</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="nb">complex</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="nb">float</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="nb">int</span><span class="o">.</span><span class="n">__add__</span><span class="p">]</span>
        <span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;method&#39;</span><span class="p">,</span> <span class="s">&#39;member&#39;</span><span class="p">,</span> <span class="s">&#39;getset&#39;</span><span class="p">,</span> <span class="s">&#39;wrapper&#39;</span><span class="p">]</span>

        <span class="c"># make sure we have an example of each type of descriptor</span>
        <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">descriptors</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="s">&#39;_descriptor&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">descriptors</span><span class="p">:</span>
            <span class="n">qualname</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">__objclass__</span><span class="o">.</span><span class="n">__qualname__</span> <span class="o">+</span> <span class="s">&#39;.&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="o">.</span><span class="n">__name__</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">__qualname__</span><span class="p">,</span> <span class="n">qualname</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="o">.</span><span class="n">__qualname__</span><span class="p">,</span> <span class="s">&#39;str.lower&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">complex</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">__qualname__</span><span class="p">,</span> <span class="s">&#39;complex.real&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">float</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">__qualname__</span><span class="p">,</span> <span class="s">&#39;float.real&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="o">.</span><span class="n">__add__</span><span class="o">.</span><span class="n">__qualname__</span><span class="p">,</span> <span class="s">&#39;int.__add__&#39;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">X</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">X</span><span class="o">.</span><span class="n">__qualname__</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">type</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__qualname__&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">__set__</span><span class="p">,</span>
                          <span class="nb">str</span><span class="p">,</span> <span class="s">&#39;Oink&#39;</span><span class="p">)</span>

        <span class="k">global</span> <span class="n">Y</span>
        <span class="k">class</span> <span class="nc">Y</span><span class="p">:</span>
            <span class="k">class</span> <span class="nc">Inside</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">__qualname__</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">Inside</span><span class="o">.</span><span class="n">__qualname__</span><span class="p">,</span> <span class="s">&#39;Y.Inside&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_qualname_dict"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_qualname_dict">[docs]</a>    <span class="k">def</span> <span class="nf">test_qualname_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;__qualname__&#39;</span><span class="p">:</span> <span class="s">&#39;some.name&#39;</span><span class="p">}</span>
        <span class="n">tp</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s">&#39;Foo&#39;</span><span class="p">,</span> <span class="p">(),</span> <span class="n">ns</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tp</span><span class="o">.</span><span class="n">__qualname__</span><span class="p">,</span> <span class="s">&#39;some.name&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="s">&#39;__qualname__&#39;</span><span class="p">,</span> <span class="n">tp</span><span class="o">.</span><span class="n">__dict__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;__qualname__&#39;</span><span class="p">:</span> <span class="s">&#39;some.name&#39;</span><span class="p">})</span>

        <span class="n">ns</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;__qualname__&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="s">&#39;Foo&#39;</span><span class="p">,</span> <span class="p">(),</span> <span class="n">ns</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_cycle_through_dict"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_cycle_through_dict">[docs]</a>    <span class="k">def</span> <span class="nf">test_cycle_through_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># See bug #1469629</span>
        <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="nb">dict</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="p">()</span>
        <span class="n">x</span><span class="o">.</span><span class="n">attr</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="n">wr</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">x</span>
        <span class="n">support</span><span class="o">.</span><span class="n">gc_collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">wr</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">gc</span><span class="o">.</span><span class="n">get_objects</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">o</span><span class="p">),</span> <span class="n">X</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_object_new_and_init_with_parameters"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_object_new_and_init_with_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">test_object_new_and_init_with_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># See issue #1683368</span>
        <span class="k">class</span> <span class="nc">OverrideNeither</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">OverrideNeither</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">OverrideNeither</span><span class="p">,</span> <span class="n">kw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">OverrideNew</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">foo</span><span class="p">,</span> <span class="n">kw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">OverrideInit</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foo</span><span class="p">,</span> <span class="n">kw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">OverrideBoth</span><span class="p">(</span><span class="n">OverrideNew</span><span class="p">,</span> <span class="n">OverrideInit</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">case</span> <span class="ow">in</span> <span class="n">OverrideNew</span><span class="p">,</span> <span class="n">OverrideInit</span><span class="p">,</span> <span class="n">OverrideBoth</span><span class="p">:</span>
            <span class="n">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">case</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">kw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">foo</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ClassPropertiesAndMethods.test_subclassing_does_not_duplicate_dict_descriptors"><a class="viewcode-back" href="../../test.html#test.test_descr.ClassPropertiesAndMethods.test_subclassing_does_not_duplicate_dict_descriptors">[docs]</a>    <span class="k">def</span> <span class="nf">test_subclassing_does_not_duplicate_dict_descriptors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">Base</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">Sub</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;__dict__&quot;</span><span class="p">,</span> <span class="n">Base</span><span class="o">.</span><span class="n">__dict__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="s">&quot;__dict__&quot;</span><span class="p">,</span> <span class="n">Sub</span><span class="o">.</span><span class="n">__dict__</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="DictProxyTests"><a class="viewcode-back" href="../../test.html#test.test_descr.DictProxyTests">[docs]</a><span class="k">class</span> <span class="nc">DictProxyTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="DictProxyTests.setUp"><a class="viewcode-back" href="../../test.html#test.test_descr.DictProxyTests.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">C</span>
</div>
    <span class="nd">@unittest.skipIf</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">&#39;gettrace&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettrace</span><span class="p">(),</span>
                        <span class="s">&#39;trace function introduces __local__&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="DictProxyTests.test_iter_keys"><a class="viewcode-back" href="../../test.html#test.test_descr.DictProxyTests.test_iter_keys">[docs]</a>    <span class="k">def</span> <span class="nf">test_iter_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing dict-proxy keys...</span>
        <span class="n">it</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;__dict__&#39;</span><span class="p">,</span> <span class="s">&#39;__doc__&#39;</span><span class="p">,</span> <span class="s">&#39;__module__&#39;</span><span class="p">,</span>
                                <span class="s">&#39;__weakref__&#39;</span><span class="p">,</span> <span class="s">&#39;meth&#39;</span><span class="p">])</span>
</div>
    <span class="nd">@unittest.skipIf</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">&#39;gettrace&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettrace</span><span class="p">(),</span>
                        <span class="s">&#39;trace function introduces __local__&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="DictProxyTests.test_iter_values"><a class="viewcode-back" href="../../test.html#test.test_descr.DictProxyTests.test_iter_values">[docs]</a>    <span class="k">def</span> <span class="nf">test_iter_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing dict-proxy values...</span>
        <span class="n">it</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
</div>
    <span class="nd">@unittest.skipIf</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">&#39;gettrace&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettrace</span><span class="p">(),</span>
                        <span class="s">&#39;trace function introduces __local__&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="DictProxyTests.test_iter_items"><a class="viewcode-back" href="../../test.html#test.test_descr.DictProxyTests.test_iter_items">[docs]</a>    <span class="k">def</span> <span class="nf">test_iter_items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing dict-proxy iteritems...</span>
        <span class="n">it</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIsInstance</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;__dict__&#39;</span><span class="p">,</span> <span class="s">&#39;__doc__&#39;</span><span class="p">,</span> <span class="s">&#39;__module__&#39;</span><span class="p">,</span>
                                <span class="s">&#39;__weakref__&#39;</span><span class="p">,</span> <span class="s">&#39;meth&#39;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="DictProxyTests.test_dict_type_with_metaclass"><a class="viewcode-back" href="../../test.html#test.test_descr.DictProxyTests.test_dict_type_with_metaclass">[docs]</a>    <span class="k">def</span> <span class="nf">test_dict_type_with_metaclass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing type of __dict__ when metaclass set...</span>
        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">M</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">M</span><span class="p">):</span>
            <span class="c"># In 2.3a1, C.__dict__ was a real dict rather than a dict proxy</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">__dict__</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">__dict__</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="DictProxyTests.test_repr"><a class="viewcode-back" href="../../test.html#test.test_descr.DictProxyTests.test_repr">[docs]</a>    <span class="k">def</span> <span class="nf">test_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing mappingproxy.__repr__.</span>
        <span class="c"># We can&#39;t blindly compare with the repr of another dict as ordering</span>
        <span class="c"># of keys and values is arbitrary and may differ.</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">__dict__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;mappingproxy(&#39;</span><span class="p">),</span> <span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;)&#39;</span><span class="p">),</span> <span class="n">r</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&#39;{!r}: {!r}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">),</span> <span class="n">r</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="PTypesLongInitTest"><a class="viewcode-back" href="../../test.html#test.test_descr.PTypesLongInitTest">[docs]</a><span class="k">class</span> <span class="nc">PTypesLongInitTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="c"># This is in its own TestCase so that it can be run before any other tests.</span>
<div class="viewcode-block" id="PTypesLongInitTest.test_pytype_long_ready"><a class="viewcode-back" href="../../test.html#test.test_descr.PTypesLongInitTest.test_pytype_long_ready">[docs]</a>    <span class="k">def</span> <span class="nf">test_pytype_long_ready</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing SF bug 551412 ...</span>

        <span class="c"># This dumps core when SF bug 551412 isn&#39;t fixed --</span>
        <span class="c"># but only when test_descr.py is run separately.</span>
        <span class="c"># (That can&#39;t be helped -- as soon as PyType_Ready()</span>
        <span class="c"># is called for PyLong_Type, the bug is gone.)</span>
        <span class="k">class</span> <span class="nc">UserLong</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
                <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">pow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">UserLong</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c"># Another segfault only when run early</span>
        <span class="c"># (before PyType_Ready(tuple) is called)</span>
        <span class="nb">type</span><span class="o">.</span><span class="n">mro</span><span class="p">(</span><span class="nb">tuple</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="MiscTests"><a class="viewcode-back" href="../../test.html#test.test_descr.MiscTests">[docs]</a><span class="k">class</span> <span class="nc">MiscTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="MiscTests.test_type_lookup_mro_reference"><a class="viewcode-back" href="../../test.html#test.test_descr.MiscTests.test_type_lookup_mro_reference">[docs]</a>    <span class="k">def</span> <span class="nf">test_type_lookup_mro_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Issue #14199: _PyType_Lookup() has to keep a strong reference to</span>
        <span class="c"># the type MRO because it may be modified during the lookup, if</span>
        <span class="c"># __bases__ is set during the lookup for example.</span>
        <span class="k">class</span> <span class="nc">MyKey</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="s">&#39;mykey&#39;</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="n">X</span><span class="o">.</span><span class="n">__bases__</span> <span class="o">=</span> <span class="p">(</span><span class="n">Base2</span><span class="p">,)</span>

        <span class="k">class</span> <span class="nc">Base</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">mykey</span> <span class="o">=</span> <span class="s">&#39;from Base&#39;</span>
            <span class="n">mykey2</span> <span class="o">=</span> <span class="s">&#39;from Base&#39;</span>

        <span class="k">class</span> <span class="nc">Base2</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="n">mykey</span> <span class="o">=</span> <span class="s">&#39;from Base2&#39;</span>
            <span class="n">mykey2</span> <span class="o">=</span> <span class="s">&#39;from Base2&#39;</span>

        <span class="n">X</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s">&#39;X&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">Base</span><span class="p">,),</span> <span class="p">{</span><span class="n">MyKey</span><span class="p">():</span> <span class="mi">5</span><span class="p">})</span>
        <span class="c"># mykey is read from Base</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">mykey</span><span class="p">,</span> <span class="s">&#39;from Base&#39;</span><span class="p">)</span>
        <span class="c"># mykey2 is read from Base2 because MyKey.__eq__ has set __bases__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">mykey2</span><span class="p">,</span> <span class="s">&#39;from Base2&#39;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="PicklingTests"><a class="viewcode-back" href="../../test.html#test.test_descr.PicklingTests">[docs]</a><span class="k">class</span> <span class="nc">PicklingTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">_check_reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                      <span class="n">listitems</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dictitems</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">proto</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">reduce_value</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">__reduce_ex__</span><span class="p">(</span><span class="n">proto</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">reduce_value</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span>
                             <span class="p">(</span><span class="n">copyreg</span><span class="o">.</span><span class="n">__newobj_ex__</span><span class="p">,</span>
                              <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">),</span>
                              <span class="n">state</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">listitems</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertListEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">reduce_value</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="n">listitems</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">reduce_value</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">dictitems</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertDictEqual</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">reduce_value</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">dictitems</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">reduce_value</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">proto</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">reduce_value</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">__reduce_ex__</span><span class="p">(</span><span class="n">proto</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">reduce_value</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span>
                             <span class="p">(</span><span class="n">copyreg</span><span class="o">.</span><span class="n">__newobj__</span><span class="p">,</span>
                              <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">),)</span> <span class="o">+</span> <span class="n">args</span><span class="p">,</span>
                              <span class="n">state</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">listitems</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertListEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">reduce_value</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="n">listitems</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">reduce_value</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">dictitems</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertDictEqual</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">reduce_value</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">dictitems</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">reduce_value</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">base_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">__base__</span>
            <span class="n">reduce_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">copyreg</span><span class="o">.</span><span class="n">_reconstructor</span><span class="p">,</span>
                            <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span>
                             <span class="n">base_type</span><span class="p">,</span>
                             <span class="bp">None</span> <span class="k">if</span> <span class="n">base_type</span> <span class="ow">is</span> <span class="nb">object</span> <span class="k">else</span> <span class="n">base_type</span><span class="p">(</span><span class="n">obj</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">reduce_value</span> <span class="o">+=</span> <span class="p">(</span><span class="n">state</span><span class="p">,)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">__reduce_ex__</span><span class="p">(</span><span class="n">proto</span><span class="p">),</span> <span class="n">reduce_value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">__reduce__</span><span class="p">(),</span> <span class="n">reduce_value</span><span class="p">)</span>

<div class="viewcode-block" id="PicklingTests.test_reduce"><a class="viewcode-back" href="../../test.html#test.test_descr.PicklingTests.test_reduce">[docs]</a>    <span class="k">def</span> <span class="nf">test_reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">protocols</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">101</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;bacon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">201</span><span class="p">,</span> <span class="s">&#39;fish&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">301</span><span class="p">}</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;cheese&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">401</span><span class="p">}</span>

        <span class="k">class</span> <span class="nc">C1</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">args</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">C1</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_reduce</span><span class="p">(</span><span class="n">proto</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_reduce</span><span class="p">(</span><span class="n">proto</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C2</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;bad args&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">C2</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">proto</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">__reduce_ex__</span><span class="p">(</span><span class="n">proto</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C3</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__getnewargs_ex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">C3</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">proto</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_check_reduce</span><span class="p">(</span><span class="n">proto</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">proto</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">__reduce_ex__</span><span class="p">(</span><span class="n">proto</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C4</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__getnewargs_ex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="s">&quot;bad dict&quot;</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">C5</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__getnewargs_ex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="s">&quot;bad tuple&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">C6</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__getnewargs_ex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">()</span>
        <span class="k">class</span> <span class="nc">C7</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__getnewargs_ex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;bad args&quot;</span>
        <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cls</span> <span class="ow">in</span> <span class="n">C4</span><span class="p">,</span> <span class="n">C5</span><span class="p">,</span> <span class="n">C6</span><span class="p">,</span> <span class="n">C7</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">cls</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">proto</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">((</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)):</span>
                        <span class="n">obj</span><span class="o">.</span><span class="n">__reduce_ex__</span><span class="p">(</span><span class="n">proto</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C8</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__getnewargs_ex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">C8</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
            <span class="k">if</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">proto</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">__reduce_ex__</span><span class="p">(</span><span class="n">proto</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">C9</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__getnewargs_ex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">C9</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_reduce</span><span class="p">(</span><span class="n">proto</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C10</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__getnewargs_ex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">IndexError</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">C10</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">proto</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">):</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">__reduce_ex__</span><span class="p">(</span><span class="n">proto</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C11</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">state</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">C11</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_reduce</span><span class="p">(</span><span class="n">proto</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C12</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;not dict&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">C12</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_reduce</span><span class="p">(</span><span class="n">proto</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="s">&quot;not dict&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C13</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">IndexError</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">C13</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">):</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">__reduce_ex__</span><span class="p">(</span><span class="n">proto</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">proto</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">):</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">__reduce__</span><span class="p">()</span>

        <span class="k">class</span> <span class="nc">C14</span><span class="p">:</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">C14</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">proto</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_check_reduce</span><span class="p">(</span><span class="n">proto</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">__reduce_ex__</span><span class="p">(</span><span class="n">proto</span><span class="p">)</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">__reduce__</span><span class="p">()</span>

        <span class="k">class</span> <span class="nc">C15</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">C15</span><span class="p">({</span><span class="s">&quot;quebec&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">601</span><span class="p">})</span>
        <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_reduce</span><span class="p">(</span><span class="n">proto</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">dictitems</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>

        <span class="k">class</span> <span class="nc">C16</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">C16</span><span class="p">([</span><span class="s">&quot;yukon&quot;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_reduce</span><span class="p">(</span><span class="n">proto</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">listitems</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="PicklingTests.test_special_method_lookup"><a class="viewcode-back" href="../../test.html#test.test_descr.PicklingTests.test_special_method_lookup">[docs]</a>    <span class="k">def</span> <span class="nf">test_special_method_lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">protocols</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">Picky</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{}</span>

            <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;__getnewargs__&quot;</span><span class="p">,</span> <span class="s">&quot;__getnewargs_ex__&quot;</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">protocol</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">protocol</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="k">else</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_reduce</span><span class="p">(</span><span class="n">protocol</span><span class="p">,</span> <span class="n">Picky</span><span class="p">(),</span> <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_assert_is_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">objcopy</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Utility method to verify if two objects are copies of each others.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">msg</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;{!r} is not a copy of {!r}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">objcopy</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">__repr__</span> <span class="ow">is</span> <span class="nb">object</span><span class="o">.</span><span class="n">__repr__</span><span class="p">:</span>
            <span class="c"># We have this limitation for now because we use the object&#39;s repr</span>
            <span class="c"># to help us verify that the two objects are copies. This allows</span>
            <span class="c"># us to delegate the non-generic verification logic to the objects</span>
            <span class="c"># themselves.</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;object passed to _assert_is_copy must &quot;</span> <span class="o">+</span>
                             <span class="s">&quot;override the __repr__ method.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">objcopy</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">objcopy</span><span class="p">),</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s">&#39;__dict__&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertDictEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="n">objcopy</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="n">objcopy</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s">&#39;__slots__&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertListEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">__slots__</span><span class="p">,</span> <span class="n">objcopy</span><span class="o">.</span><span class="n">__slots__</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">__slots__</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
                    <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">slot</span><span class="p">),</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">objcopy</span><span class="p">,</span> <span class="n">slot</span><span class="p">),</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">slot</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
                                 <span class="nb">getattr</span><span class="p">(</span><span class="n">objcopy</span><span class="p">,</span> <span class="n">slot</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">objcopy</span><span class="p">),</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_generate_pickle_copiers</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Utility method to generate the many possible pickle configurations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">class</span> <span class="nc">PickleCopier</span><span class="p">:</span>
            <span class="s">&quot;This class copies object using pickle.&quot;</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">,</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">proto</span> <span class="o">=</span> <span class="n">proto</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dumps</span> <span class="o">=</span> <span class="n">dumps</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loads</span> <span class="o">=</span> <span class="n">loads</span>
            <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">proto</span><span class="p">))</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="c"># We try to be as descriptive as possible here since this is</span>
                <span class="c"># the string which we will allow us to tell the pickle</span>
                <span class="c"># configuration we are using during debugging.</span>
                <span class="k">return</span> <span class="p">(</span><span class="s">&quot;PickleCopier(proto={}, dumps={}.{}, loads={}.{})&quot;</span>
                        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proto</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">dumps</span><span class="o">.</span><span class="n">__module__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dumps</span><span class="o">.</span><span class="n">__qualname__</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">loads</span><span class="o">.</span><span class="n">__module__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">loads</span><span class="o">.</span><span class="n">__qualname__</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">PickleCopier</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="k">for</span> <span class="n">args</span> <span class="ow">in</span>
                   <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                                     <span class="p">{</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">,</span> <span class="n">pickle</span><span class="o">.</span><span class="n">_dumps</span><span class="p">},</span>
                                     <span class="p">{</span><span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">,</span> <span class="n">pickle</span><span class="o">.</span><span class="n">_loads</span><span class="p">}))</span>

<div class="viewcode-block" id="PicklingTests.test_pickle_slots"><a class="viewcode-back" href="../../test.html#test.test_descr.PicklingTests.test_pickle_slots">[docs]</a>    <span class="k">def</span> <span class="nf">test_pickle_slots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Tests pickling of classes with __slots__.</span>

        <span class="c"># Pickling of classes with __slots__ but without __getstate__ should</span>
        <span class="c"># fail (if using protocol 0 or 1)</span>
        <span class="k">global</span> <span class="n">C</span>
        <span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">C</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">global</span> <span class="n">D</span>
        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">D</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
            <span class="s">&quot;A class with __getstate__ and __setstate__ implemented.&quot;</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span>
            <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="n">state</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;__dict__&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">cls</span> <span class="ow">in</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__mro__</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;__slots__&#39;</span><span class="p">,</span> <span class="p">()):</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">state</span><span class="p">[</span><span class="n">slot</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slot</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                            <span class="k">pass</span>
                <span class="k">return</span> <span class="n">state</span>
            <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">()&lt;</span><span class="si">%r</span><span class="s">&gt;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getstate__</span><span class="p">())</span>

        <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="s">&quot;A subclass of a class with slots.&quot;</span>
            <span class="k">pass</span>

        <span class="k">global</span> <span class="n">E</span>
        <span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
            <span class="s">&quot;A subclass with an extra slot.&quot;</span>
            <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]</span>

        <span class="c"># Now it should work</span>
        <span class="k">for</span> <span class="n">pickle_copier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_pickle_copiers</span><span class="p">():</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">subTest</span><span class="p">(</span><span class="n">pickle_copier</span><span class="o">=</span><span class="n">pickle_copier</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">pickle_copier</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_assert_is_copy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

                <span class="n">x</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">42</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">pickle_copier</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_assert_is_copy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

                <span class="n">x</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
                <span class="n">x</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">42</span>
                <span class="n">x</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="mi">100</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">pickle_copier</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_assert_is_copy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

                <span class="n">x</span> <span class="o">=</span> <span class="n">E</span><span class="p">()</span>
                <span class="n">x</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">42</span>
                <span class="n">x</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="s">&quot;foo&quot;</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">pickle_copier</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_assert_is_copy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PicklingTests.test_reduce_copying"><a class="viewcode-back" href="../../test.html#test.test_descr.PicklingTests.test_reduce_copying">[docs]</a>    <span class="k">def</span> <span class="nf">test_reduce_copying</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Tests pickling and copying new-style classes and objects.</span>
        <span class="k">global</span> <span class="n">C1</span>
        <span class="k">class</span> <span class="nc">C1</span><span class="p">:</span>
            <span class="s">&quot;The state of this class is copyable via its instance dict.&quot;</span>
            <span class="n">ARGS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">NEED_DICT_COPYING</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;C1(</span><span class="si">%r</span><span class="s">, </span><span class="si">%r</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>

        <span class="k">global</span> <span class="n">C2</span>
        <span class="k">class</span> <span class="nc">C2</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
            <span class="s">&quot;A list subclass copyable via __getnewargs__.&quot;</span>
            <span class="n">ARGS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">NEED_DICT_COPYING</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
                <span class="bp">self</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
                <span class="k">return</span> <span class="bp">self</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
                <span class="c"># This helps testing that __init__ is not called during the</span>
                <span class="c"># unpickling process, which would cause extra appends.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;cheese&quot;</span><span class="p">)</span>
            <span class="nd">@classmethod</span>
            <span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">ARGS</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;C2(</span><span class="si">%r</span><span class="s">, </span><span class="si">%r</span><span class="s">)&lt;</span><span class="si">%r</span><span class="s">&gt;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="k">global</span> <span class="n">C3</span>
        <span class="k">class</span> <span class="nc">C3</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
            <span class="s">&quot;A list subclass copyable via __getstate__.&quot;</span>
            <span class="n">ARGS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">NEED_DICT_COPYING</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
                <span class="c"># This helps testing that __init__ is not called during the</span>
                <span class="c"># unpickling process, which would cause extra appends.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;cheese&quot;</span><span class="p">)</span>
            <span class="nd">@classmethod</span>
            <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">ARGS</span>
            <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
                <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">state</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;C3(</span><span class="si">%r</span><span class="s">, </span><span class="si">%r</span><span class="s">)&lt;</span><span class="si">%r</span><span class="s">&gt;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="k">global</span> <span class="n">C4</span>
        <span class="k">class</span> <span class="nc">C4</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
            <span class="s">&quot;An int subclass copyable via __getnewargs__.&quot;</span>
            <span class="n">ARGS</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">,</span> <span class="s">&quot;world&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">NEED_DICT_COPYING</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="bp">self</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
                <span class="k">return</span> <span class="bp">self</span>
            <span class="nd">@classmethod</span>
            <span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">ARGS</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;C4(</span><span class="si">%r</span><span class="s">, </span><span class="si">%r</span><span class="s">)&lt;</span><span class="si">%r</span><span class="s">&gt;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="k">global</span> <span class="n">C5</span>
        <span class="k">class</span> <span class="nc">C5</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
            <span class="s">&quot;An int subclass copyable via __getnewargs_ex__.&quot;</span>
            <span class="n">ARGS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">KWARGS</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;value&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
            <span class="n">NEED_DICT_COPYING</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
                <span class="bp">self</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
                <span class="k">return</span> <span class="bp">self</span>
            <span class="nd">@classmethod</span>
            <span class="k">def</span> <span class="nf">__getnewargs_ex__</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">ARGS</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">KWARGS</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&quot;C5(</span><span class="si">%r</span><span class="s">, </span><span class="si">%r</span><span class="s">)&lt;</span><span class="si">%r</span><span class="s">&gt;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="n">test_classes</span> <span class="o">=</span> <span class="p">(</span><span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">C3</span><span class="p">,</span> <span class="n">C4</span><span class="p">,</span> <span class="n">C5</span><span class="p">)</span>
        <span class="c"># Testing copying through pickle</span>
        <span class="n">pickle_copiers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_pickle_copiers</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">cls</span><span class="p">,</span> <span class="n">pickle_copier</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">test_classes</span><span class="p">,</span> <span class="n">pickle_copiers</span><span class="p">):</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">subTest</span><span class="p">(</span><span class="n">cls</span><span class="o">=</span><span class="n">cls</span><span class="p">,</span> <span class="n">pickle_copier</span><span class="o">=</span><span class="n">pickle_copier</span><span class="p">):</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="s">&#39;KWARGS&#39;</span><span class="p">,</span> <span class="p">{})</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">cls</span><span class="p">(</span><span class="o">*</span><span class="n">cls</span><span class="o">.</span><span class="n">ARGS</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">proto</span> <span class="o">=</span> <span class="n">pickle_copier</span><span class="o">.</span><span class="n">proto</span>
                <span class="k">if</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">proto</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="s">&#39;__getnewargs_ex__&#39;</span><span class="p">):</span>
                    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
                        <span class="n">pickle_copier</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">proto</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="n">objcopy</span> <span class="o">=</span> <span class="n">pickle_copier</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_assert_is_copy</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">objcopy</span><span class="p">)</span>
                <span class="c"># For test classes that supports this, make sure we didn&#39;t go</span>
                <span class="c"># around the reduce protocol by simply copying the attribute</span>
                <span class="c"># dictionary. We clear attributes using the previous copy to</span>
                <span class="c"># not mutate the original argument.</span>
                <span class="k">if</span> <span class="n">proto</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">cls</span><span class="o">.</span><span class="n">NEED_DICT_COPYING</span><span class="p">:</span>
                    <span class="n">objcopy</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                    <span class="n">objcopy2</span> <span class="o">=</span> <span class="n">pickle_copier</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">objcopy</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_assert_is_copy</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">objcopy2</span><span class="p">)</span>

        <span class="c"># Testing copying through copy.deepcopy()</span>
        <span class="k">for</span> <span class="n">cls</span> <span class="ow">in</span> <span class="n">test_classes</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">subTest</span><span class="p">(</span><span class="n">cls</span><span class="o">=</span><span class="n">cls</span><span class="p">):</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="s">&#39;KWARGS&#39;</span><span class="p">,</span> <span class="p">{})</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">cls</span><span class="p">(</span><span class="o">*</span><span class="n">cls</span><span class="o">.</span><span class="n">ARGS</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="c"># XXX: We need to modify the copy module to support PEP 3154&#39;s</span>
                <span class="c"># reduce protocol 4.</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="s">&#39;__getnewargs_ex__&#39;</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">objcopy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_assert_is_copy</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">objcopy</span><span class="p">)</span>
                <span class="c"># For test classes that supports this, make sure we didn&#39;t go</span>
                <span class="c"># around the reduce protocol by simply copying the attribute</span>
                <span class="c"># dictionary. We clear attributes using the previous copy to</span>
                <span class="c"># not mutate the original argument.</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">cls</span><span class="o">.</span><span class="n">NEED_DICT_COPYING</span><span class="p">:</span>
                    <span class="n">objcopy</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                    <span class="n">objcopy2</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">objcopy</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_assert_is_copy</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">objcopy2</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="SharedKeyTests"><a class="viewcode-back" href="../../test.html#test.test_descr.SharedKeyTests">[docs]</a><span class="k">class</span> <span class="nc">SharedKeyTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@support.cpython_only</span>
<div class="viewcode-block" id="SharedKeyTests.test_subclasses"><a class="viewcode-back" href="../../test.html#test.test_descr.SharedKeyTests.test_subclasses">[docs]</a>    <span class="k">def</span> <span class="nf">test_subclasses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Verify that subclasses can share keys (per PEP 412)</span>
        <span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">A</span><span class="p">(),</span> <span class="n">B</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">({}))</span>
        <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">a2</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">({}))</span>
        <span class="n">b</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">b</span><span class="p">)),</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">({}))</span>

</div></div>
<div class="viewcode-block" id="test_main"><a class="viewcode-back" href="../../test.html#test.test_descr.test_main">[docs]</a><span class="k">def</span> <span class="nf">test_main</span><span class="p">():</span>
    <span class="c"># Run all local test cases, with PTypesLongInitTest first.</span>
    <span class="n">support</span><span class="o">.</span><span class="n">run_unittest</span><span class="p">(</span><span class="n">PTypesLongInitTest</span><span class="p">,</span> <span class="n">OperatorsTest</span><span class="p">,</span>
                         <span class="n">ClassPropertiesAndMethods</span><span class="p">,</span> <span class="n">DictProxyTests</span><span class="p">,</span>
                         <span class="n">MiscTests</span><span class="p">,</span> <span class="n">PicklingTests</span><span class="p">,</span> <span class="n">SharedKeyTests</span><span class="p">)</span>
</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">test_main</span><span class="p">()</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>