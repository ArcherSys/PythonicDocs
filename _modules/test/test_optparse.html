

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_optparse &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_optparse</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_optparse</h1><div class="highlight"><pre>
<span class="c">#</span>
<span class="c"># Test suite for Optik.  Supplied by Johannes Gijsbers</span>
<span class="c"># (taradino@softhome.net) -- translated from the original Optik</span>
<span class="c"># test suite to this PyUnit-based version.</span>
<span class="c">#</span>
<span class="c"># $Id$</span>
<span class="c">#</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">unittest</span>

<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">support</span>


<span class="kn">from</span> <span class="nn">optparse</span> <span class="kn">import</span> <span class="n">make_option</span><span class="p">,</span> <span class="n">Option</span><span class="p">,</span> \
     <span class="n">TitledHelpFormatter</span><span class="p">,</span> <span class="n">OptionParser</span><span class="p">,</span> <span class="n">OptionGroup</span><span class="p">,</span> \
     <span class="n">SUPPRESS_USAGE</span><span class="p">,</span> <span class="n">OptionError</span><span class="p">,</span> <span class="n">OptionConflictError</span><span class="p">,</span> \
     <span class="n">BadOptionError</span><span class="p">,</span> <span class="n">OptionValueError</span><span class="p">,</span> <span class="n">Values</span>
<span class="kn">from</span> <span class="nn">optparse</span> <span class="kn">import</span> <span class="n">_match_abbrev</span>
<span class="kn">from</span> <span class="nn">optparse</span> <span class="kn">import</span> <span class="n">_parse_num</span>

<span class="n">retype</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">))</span>

<div class="viewcode-block" id="InterceptedError"><a class="viewcode-back" href="../../test.html#test.test_optparse.InterceptedError">[docs]</a><span class="k">class</span> <span class="nc">InterceptedError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">error_message</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">exit_status</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">exit_message</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_message</span> <span class="o">=</span> <span class="n">error_message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exit_status</span> <span class="o">=</span> <span class="n">exit_status</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exit_message</span> <span class="o">=</span> <span class="n">exit_message</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_message</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">exit_message</span> <span class="ow">or</span> <span class="s">&quot;intercepted error&quot;</span>
</div>
<div class="viewcode-block" id="InterceptingOptionParser"><a class="viewcode-back" href="../../test.html#test.test_optparse.InterceptingOptionParser">[docs]</a><span class="k">class</span> <span class="nc">InterceptingOptionParser</span><span class="p">(</span><span class="n">OptionParser</span><span class="p">):</span>
<div class="viewcode-block" id="InterceptingOptionParser.exit"><a class="viewcode-back" href="../../test.html#test.test_optparse.InterceptingOptionParser.exit">[docs]</a>    <span class="k">def</span> <span class="nf">exit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">InterceptedError</span><span class="p">(</span><span class="n">exit_status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span> <span class="n">exit_message</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="InterceptingOptionParser.error"><a class="viewcode-back" href="../../test.html#test.test_optparse.InterceptingOptionParser.error">[docs]</a>    <span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">InterceptedError</span><span class="p">(</span><span class="n">error_message</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="BaseTest"><a class="viewcode-back" href="../../test.html#test.test_optparse.BaseTest">[docs]</a><span class="k">class</span> <span class="nc">BaseTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="BaseTest.assertParseOK"><a class="viewcode-back" href="../../test.html#test.test_optparse.BaseTest.assertParseOK">[docs]</a>    <span class="k">def</span> <span class="nf">assertParseOK</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">expected_opts</span><span class="p">,</span> <span class="n">expected_positional_args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assert the options are what we expected when parsing arguments.</span>

<span class="sd">        Otherwise, fail with a nicely formatted message.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">        args -- A list of arguments to parse with OptionParser.</span>
<span class="sd">        expected_opts -- The options expected.</span>
<span class="sd">        expected_positional_args -- The positional arguments expected.</span>

<span class="sd">        Returns the options and positional args for further testing.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">positional_args</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="n">optdict</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">optdict</span><span class="p">,</span> <span class="n">expected_opts</span><span class="p">,</span>
                         <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Options are %(optdict)s.</span>
<span class="sd">Should be %(expected_opts)s.</span>
<span class="sd">Args were %(args)s.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="nb">locals</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">positional_args</span><span class="p">,</span> <span class="n">expected_positional_args</span><span class="p">,</span>
                         <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Positional arguments are %(positional_args)s.</span>
<span class="sd">Should be %(expected_positional_args)s.</span>
<span class="sd">Args were %(args)s.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="nb">locals</span> <span class="p">())</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">positional_args</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BaseTest.assertRaises"><a class="viewcode-back" href="../../test.html#test.test_optparse.BaseTest.assertRaises">[docs]</a>    <span class="k">def</span> <span class="nf">assertRaises</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">func</span><span class="p">,</span>
                     <span class="n">args</span><span class="p">,</span>
                     <span class="n">kwargs</span><span class="p">,</span>
                     <span class="n">expected_exception</span><span class="p">,</span>
                     <span class="n">expected_message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assert that the expected exception is raised when calling a</span>
<span class="sd">        function, and that the right error message is included with</span>
<span class="sd">        that exception.</span>

<span class="sd">        Arguments:</span>
<span class="sd">          func -- the function to call</span>
<span class="sd">          args -- positional arguments to `func`</span>
<span class="sd">          kwargs -- keyword arguments to `func`</span>
<span class="sd">          expected_exception -- exception that should be raised</span>
<span class="sd">          expected_message -- expected exception message (or pattern</span>
<span class="sd">            if a compiled regex object)</span>

<span class="sd">        Returns the exception raised for further testing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">args</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">expected_exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">actual_message</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expected_message</span><span class="p">,</span> <span class="n">retype</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">expected_message</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">actual_message</span><span class="p">),</span>
                             <span class="sd">&quot;&quot;&quot;\</span>
<span class="sd">expected exception message pattern:</span>
<span class="sd">/%s/</span>
<span class="sd">actual exception message:</span>
<span class="sd">&#39;&#39;&#39;%s&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expected_message</span><span class="o">.</span><span class="n">pattern</span><span class="p">,</span> <span class="n">actual_message</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">actual_message</span><span class="p">,</span>
                                 <span class="n">expected_message</span><span class="p">,</span>
                                 <span class="sd">&quot;&quot;&quot;\</span>
<span class="sd">expected exception message:</span>
<span class="sd">&#39;&#39;&#39;%s&#39;&#39;&#39;</span>
<span class="sd">actual exception message:</span>
<span class="sd">&#39;&#39;&#39;%s&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expected_message</span><span class="p">,</span> <span class="n">actual_message</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">err</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;&quot;&quot;expected exception </span><span class="si">%(expected_exception)s</span><span class="s"> not raised</span>
<span class="s">called </span><span class="si">%(func)r</span><span class="s"></span>
<span class="s">with args </span><span class="si">%(args)r</span><span class="s"></span>
<span class="s">and kwargs </span><span class="si">%(kwargs)r</span><span class="s"></span>
<span class="s">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="nb">locals</span> <span class="p">())</span>


    <span class="c"># -- Assertions used in more than one class --------------------</span>
</div>
<div class="viewcode-block" id="BaseTest.assertParseFail"><a class="viewcode-back" href="../../test.html#test.test_optparse.BaseTest.assertParseFail">[docs]</a>    <span class="k">def</span> <span class="nf">assertParseFail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmdline_args</span><span class="p">,</span> <span class="n">expected_output</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assert the parser fails with the expected message.  Caller</span>
<span class="sd">        must ensure that self.parser is an InterceptingOptionParser.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">cmdline_args</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">InterceptedError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">error_message</span><span class="p">,</span> <span class="n">expected_output</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="s">&quot;expected parse failure&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BaseTest.assertOutput"><a class="viewcode-back" href="../../test.html#test.test_optparse.BaseTest.assertOutput">[docs]</a>    <span class="k">def</span> <span class="nf">assertOutput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">cmdline_args</span><span class="p">,</span>
                     <span class="n">expected_output</span><span class="p">,</span>
                     <span class="n">expected_status</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                     <span class="n">expected_error</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assert the parser prints the expected output on stdout.&quot;&quot;&quot;</span>
        <span class="n">save_stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">cmdline_args</span><span class="p">)</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">save_stdout</span>

        <span class="k">except</span> <span class="n">InterceptedError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span>
                <span class="s">&quot;expected output to be an ordinary string, not </span><span class="si">%r</span><span class="s">&quot;</span>
                <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">output</span> <span class="o">!=</span> <span class="n">expected_output</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;expected: </span><span class="se">\n</span><span class="s">&#39;&#39;&#39;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">expected_output</span> <span class="o">+</span>
                          <span class="s">&quot;&#39;&#39;&#39;</span><span class="se">\n</span><span class="s">but got </span><span class="se">\n</span><span class="s">&#39;&#39;&#39;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">output</span> <span class="o">+</span> <span class="s">&quot;&#39;&#39;&#39;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">exit_status</span><span class="p">,</span> <span class="n">expected_status</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">exit_message</span><span class="p">,</span> <span class="n">expected_error</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="s">&quot;expected parser.exit()&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BaseTest.assertTypeError"><a class="viewcode-back" href="../../test.html#test.test_optparse.BaseTest.assertTypeError">[docs]</a>    <span class="k">def</span> <span class="nf">assertTypeError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">expected_message</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assert that TypeError is raised when executing func.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">expected_message</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BaseTest.assertHelp"><a class="viewcode-back" href="../../test.html#test.test_optparse.BaseTest.assertHelp">[docs]</a>    <span class="k">def</span> <span class="nf">assertHelp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">expected_help</span><span class="p">):</span>
        <span class="n">actual_help</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">format_help</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">actual_help</span> <span class="o">!=</span> <span class="n">expected_help</span><span class="p">:</span>
            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">failureException</span><span class="p">(</span>
                <span class="s">&#39;help text failure; expected:</span><span class="se">\n</span><span class="s">&quot;&#39;</span> <span class="o">+</span>
                <span class="n">expected_help</span> <span class="o">+</span> <span class="s">&#39;&quot;; got:</span><span class="se">\n</span><span class="s">&quot;&#39;</span> <span class="o">+</span>
                <span class="n">actual_help</span> <span class="o">+</span> <span class="s">&#39;&quot;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

<span class="c"># -- Test make_option() aka Option -------------------------------------</span>

<span class="c"># It&#39;s not necessary to test correct options here.  All the tests in the</span>
<span class="c"># parser.parse_args() section deal with those, because they&#39;re needed</span>
<span class="c"># there.</span>
</div></div>
<div class="viewcode-block" id="TestOptionChecks"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks">[docs]</a><span class="k">class</span> <span class="nc">TestOptionChecks</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestOptionChecks.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.assertOptionError"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.assertOptionError">[docs]</a>    <span class="k">def</span> <span class="nf">assertOptionError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expected_message</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[],</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">make_option</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span>
                          <span class="n">OptionError</span><span class="p">,</span> <span class="n">expected_message</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_opt_string_empty"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_opt_string_empty">[docs]</a>    <span class="k">def</span> <span class="nf">test_opt_string_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTypeError</span><span class="p">(</span><span class="n">make_option</span><span class="p">,</span>
                             <span class="s">&quot;at least one option string must be supplied&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_opt_string_too_short"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_opt_string_too_short">[docs]</a>    <span class="k">def</span> <span class="nf">test_opt_string_too_short</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;invalid option string &#39;b&#39;: must be at least two characters long&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;b&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_opt_string_short_invalid"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_opt_string_short_invalid">[docs]</a>    <span class="k">def</span> <span class="nf">test_opt_string_short_invalid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;invalid short option string &#39;--&#39;: must be &quot;</span>
            <span class="s">&quot;of the form -x, (x any non-dash char)&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;--&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_opt_string_long_invalid"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_opt_string_long_invalid">[docs]</a>    <span class="k">def</span> <span class="nf">test_opt_string_long_invalid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;invalid long option string &#39;---&#39;: &quot;</span>
            <span class="s">&quot;must start with --, followed by non-dash&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;---&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_attr_invalid"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_attr_invalid">[docs]</a>    <span class="k">def</span> <span class="nf">test_attr_invalid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b: invalid keyword arguments: bar, foo&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_action_invalid"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_action_invalid">[docs]</a>    <span class="k">def</span> <span class="nf">test_action_invalid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b: invalid action: &#39;foo&#39;&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;action&#39;</span><span class="p">:</span> <span class="s">&#39;foo&#39;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_type_invalid"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_type_invalid">[docs]</a>    <span class="k">def</span> <span class="nf">test_type_invalid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b: invalid option type: &#39;foo&#39;&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;foo&#39;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b: invalid option type: &#39;tuple&#39;&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_no_type_for_action"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_no_type_for_action">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_type_for_action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b: must not supply a type for action &#39;count&#39;&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;action&#39;</span><span class="p">:</span> <span class="s">&#39;count&#39;</span><span class="p">,</span> <span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;int&#39;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_no_choices_list"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_no_choices_list">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_choices_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b/--bad: must supply a list of &quot;</span>
            <span class="s">&quot;choices for type &#39;choice&#39;&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">,</span> <span class="s">&quot;--bad&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&quot;choice&quot;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_bad_choices_list"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_bad_choices_list">[docs]</a>    <span class="k">def</span> <span class="nf">test_bad_choices_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">typename</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b/--bad: choices must be a list of &quot;</span>
            <span class="s">&quot;strings (&#39;</span><span class="si">%s</span><span class="s">&#39; supplied)&quot;</span> <span class="o">%</span> <span class="n">typename</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">,</span> <span class="s">&quot;--bad&quot;</span><span class="p">],</span>
            <span class="p">{</span><span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&quot;choice&quot;</span><span class="p">,</span> <span class="s">&#39;choices&#39;</span><span class="p">:</span><span class="s">&quot;bad choices&quot;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_no_choices_for_type"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_no_choices_for_type">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_choices_for_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b: must not supply choices for type &#39;int&#39;&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;int&#39;</span><span class="p">,</span> <span class="s">&#39;choices&#39;</span><span class="p">:</span><span class="s">&quot;bad&quot;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_no_const_for_action"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_no_const_for_action">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_const_for_action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b: &#39;const&#39; must not be supplied for action &#39;store&#39;&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;action&#39;</span><span class="p">:</span> <span class="s">&#39;store&#39;</span><span class="p">,</span> <span class="s">&#39;const&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_no_nargs_for_action"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_no_nargs_for_action">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_nargs_for_action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b: &#39;nargs&#39; must not be supplied for action &#39;count&#39;&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;action&#39;</span><span class="p">:</span> <span class="s">&#39;count&#39;</span><span class="p">,</span> <span class="s">&#39;nargs&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_callback_not_callable"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_callback_not_callable">[docs]</a>    <span class="k">def</span> <span class="nf">test_callback_not_callable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b: callback not callable: &#39;foo&#39;&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;action&#39;</span><span class="p">:</span> <span class="s">&#39;callback&#39;</span><span class="p">,</span>
                     <span class="s">&#39;callback&#39;</span><span class="p">:</span> <span class="s">&#39;foo&#39;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.dummy"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.dummy">[docs]</a>    <span class="k">def</span> <span class="nf">dummy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_callback_args_no_tuple"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_callback_args_no_tuple">[docs]</a>    <span class="k">def</span> <span class="nf">test_callback_args_no_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b: callback_args, if supplied, &quot;</span>
            <span class="s">&quot;must be a tuple: not &#39;foo&#39;&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;action&#39;</span><span class="p">:</span> <span class="s">&#39;callback&#39;</span><span class="p">,</span>
                     <span class="s">&#39;callback&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dummy</span><span class="p">,</span>
                     <span class="s">&#39;callback_args&#39;</span><span class="p">:</span> <span class="s">&#39;foo&#39;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_callback_kwargs_no_dict"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_callback_kwargs_no_dict">[docs]</a>    <span class="k">def</span> <span class="nf">test_callback_kwargs_no_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b: callback_kwargs, if supplied, &quot;</span>
            <span class="s">&quot;must be a dict: not &#39;foo&#39;&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;action&#39;</span><span class="p">:</span> <span class="s">&#39;callback&#39;</span><span class="p">,</span>
                     <span class="s">&#39;callback&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dummy</span><span class="p">,</span>
                     <span class="s">&#39;callback_kwargs&#39;</span><span class="p">:</span> <span class="s">&#39;foo&#39;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_no_callback_for_action"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_no_callback_for_action">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_callback_for_action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b: callback supplied (&#39;foo&#39;) for non-callback option&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;action&#39;</span><span class="p">:</span> <span class="s">&#39;store&#39;</span><span class="p">,</span>
                     <span class="s">&#39;callback&#39;</span><span class="p">:</span> <span class="s">&#39;foo&#39;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_no_callback_args_for_action"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_no_callback_args_for_action">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_callback_args_for_action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b: callback_args supplied for non-callback option&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;action&#39;</span><span class="p">:</span> <span class="s">&#39;store&#39;</span><span class="p">,</span>
                     <span class="s">&#39;callback_args&#39;</span><span class="p">:</span> <span class="s">&#39;foo&#39;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_no_callback_kwargs_for_action"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_no_callback_kwargs_for_action">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_callback_kwargs_for_action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -b: callback_kwargs supplied for non-callback option&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-b&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;action&#39;</span><span class="p">:</span> <span class="s">&#39;store&#39;</span><span class="p">,</span>
                     <span class="s">&#39;callback_kwargs&#39;</span><span class="p">:</span> <span class="s">&#39;foo&#39;</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="TestOptionChecks.test_no_single_dash"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionChecks.test_no_single_dash">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_single_dash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;invalid long option string &#39;-debug&#39;: &quot;</span>
            <span class="s">&quot;must start with --, followed by non-dash&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-debug&quot;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;option -d: invalid long option string &#39;-debug&#39;: must start with&quot;</span>
            <span class="s">&quot; --, followed by non-dash&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-d&quot;</span><span class="p">,</span> <span class="s">&quot;-debug&quot;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertOptionError</span><span class="p">(</span>
            <span class="s">&quot;invalid long option string &#39;-debug&#39;: &quot;</span>
            <span class="s">&quot;must start with --, followed by non-dash&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&quot;-debug&quot;</span><span class="p">,</span> <span class="s">&quot;--debug&quot;</span><span class="p">])</span>
</div></div>
<div class="viewcode-block" id="TestOptionParser"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionParser">[docs]</a><span class="k">class</span> <span class="nc">TestOptionParser</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestOptionParser.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionParser.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">,</span> <span class="s">&quot;--verbose&quot;</span><span class="p">,</span> <span class="s">&quot;-n&quot;</span><span class="p">,</span> <span class="s">&quot;--noisy&quot;</span><span class="p">,</span>
                          <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;verbose&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-q&quot;</span><span class="p">,</span> <span class="s">&quot;--quiet&quot;</span><span class="p">,</span> <span class="s">&quot;--silent&quot;</span><span class="p">,</span>
                          <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_false&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;verbose&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOptionParser.test_add_option_no_Option"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionParser.test_add_option_no_Option">[docs]</a>    <span class="k">def</span> <span class="nf">test_add_option_no_Option</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTypeError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">,</span>
                             <span class="s">&quot;not an Option instance: None&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOptionParser.test_add_option_invalid_arguments"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionParser.test_add_option_invalid_arguments">[docs]</a>    <span class="k">def</span> <span class="nf">test_add_option_invalid_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTypeError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">,</span>
                             <span class="s">&quot;invalid arguments&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOptionParser.test_get_option"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionParser.test_get_option">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_option</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">opt1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">opt1</span><span class="p">,</span> <span class="n">Option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">opt1</span><span class="o">.</span><span class="n">_short_opts</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;-v&quot;</span><span class="p">,</span> <span class="s">&quot;-n&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">opt1</span><span class="o">.</span><span class="n">_long_opts</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;--verbose&quot;</span><span class="p">,</span> <span class="s">&quot;--noisy&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">opt1</span><span class="o">.</span><span class="n">action</span><span class="p">,</span> <span class="s">&quot;store_true&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">opt1</span><span class="o">.</span><span class="n">dest</span><span class="p">,</span> <span class="s">&quot;verbose&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOptionParser.test_get_option_equals"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionParser.test_get_option_equals">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_option_equals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">opt1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">)</span>
        <span class="n">opt2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;--verbose&quot;</span><span class="p">)</span>
        <span class="n">opt3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;-n&quot;</span><span class="p">)</span>
        <span class="n">opt4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;--noisy&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">opt1</span> <span class="ow">is</span> <span class="n">opt2</span> <span class="ow">is</span> <span class="n">opt3</span> <span class="ow">is</span> <span class="n">opt4</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOptionParser.test_has_option"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionParser.test_has_option">[docs]</a>    <span class="k">def</span> <span class="nf">test_has_option</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s">&quot;--verbose&quot;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestOptionParser.assertTrueremoved"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionParser.assertTrueremoved">[docs]</a>    <span class="k">def</span> <span class="nf">assertTrueremoved</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;--verbose&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;-n&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;--noisy&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s">&quot;--verbose&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s">&quot;-n&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s">&quot;--noisy&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s">&quot;-q&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s">&quot;--silent&quot;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestOptionParser.test_remove_short_opt"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionParser.test_remove_short_opt">[docs]</a>    <span class="k">def</span> <span class="nf">test_remove_short_opt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">remove_option</span><span class="p">(</span><span class="s">&quot;-n&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrueremoved</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TestOptionParser.test_remove_long_opt"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionParser.test_remove_long_opt">[docs]</a>    <span class="k">def</span> <span class="nf">test_remove_long_opt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">remove_option</span><span class="p">(</span><span class="s">&quot;--verbose&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrueremoved</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TestOptionParser.test_remove_nonexistent"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionParser.test_remove_nonexistent">[docs]</a>    <span class="k">def</span> <span class="nf">test_remove_nonexistent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">remove_option</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">,),</span> <span class="bp">None</span><span class="p">,</span>
                          <span class="ne">ValueError</span><span class="p">,</span> <span class="s">&quot;no such option &#39;foo&#39;&quot;</span><span class="p">)</span>
</div>
    <span class="nd">@support.impl_detail</span><span class="p">(</span><span class="s">&#39;Relies on sys.getrefcount&#39;</span><span class="p">,</span> <span class="n">cpython</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<div class="viewcode-block" id="TestOptionParser.test_refleak"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionParser.test_refleak">[docs]</a>    <span class="k">def</span> <span class="nf">test_refleak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># If an OptionParser is carrying around a reference to a large</span>
        <span class="c"># object, various cycles can prevent it from being GC&#39;d in</span>
        <span class="c"># a timely fashion.  destroy() breaks the cycles to ensure stuff</span>
        <span class="c"># can be cleaned up.</span>
        <span class="n">big_thing</span> <span class="o">=</span> <span class="p">[</span><span class="mi">42</span><span class="p">]</span>
        <span class="n">refcount</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getrefcount</span><span class="p">(</span><span class="n">big_thing</span><span class="p">)</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">()</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="s">&quot;--aaarggh&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">big_thing</span> <span class="o">=</span> <span class="n">big_thing</span>

        <span class="n">parser</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="c">#self.assertEqual(refcount, sys.getrefcount(big_thing))</span>
        <span class="k">del</span> <span class="n">parser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">refcount</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">getrefcount</span><span class="p">(</span><span class="n">big_thing</span><span class="p">))</span>

</div></div>
<div class="viewcode-block" id="TestOptionValues"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionValues">[docs]</a><span class="k">class</span> <span class="nc">TestOptionValues</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestOptionValues.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionValues.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
</div>
<div class="viewcode-block" id="TestOptionValues.test_basics"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionValues.test_basics">[docs]</a>    <span class="k">def</span> <span class="nf">test_basics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">Values</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;foo&quot;</span><span class="p">:</span> <span class="s">&quot;bar&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

        <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;foo&quot;</span><span class="p">:</span> <span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="s">&quot;baz&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">}</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">Values</span><span class="p">(</span><span class="n">defaults</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;foo&quot;</span><span class="p">:</span> <span class="s">&quot;bar&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="p">[])</span>

</div></div>
<div class="viewcode-block" id="TestTypeAliases"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestTypeAliases">[docs]</a><span class="k">class</span> <span class="nc">TestTypeAliases</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestTypeAliases.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestTypeAliases.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TestTypeAliases.test_str_aliases_string"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestTypeAliases.test_str_aliases_string">[docs]</a>    <span class="k">def</span> <span class="nf">test_str_aliases_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-s&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;str&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;-s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;string&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestTypeAliases.test_type_object"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestTypeAliases.test_type_object">[docs]</a>    <span class="k">def</span> <span class="nf">test_type_object</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-s&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;-s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;string&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-x&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;-x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">)</span>


<span class="c"># Custom type for testing processing of default values.</span></div></div>
<span class="n">_time_units</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;s&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;m&#39;</span> <span class="p">:</span> <span class="mi">60</span><span class="p">,</span> <span class="s">&#39;h&#39;</span> <span class="p">:</span> <span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="p">,</span> <span class="s">&#39;d&#39;</span> <span class="p">:</span> <span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">24</span> <span class="p">}</span>

<span class="k">def</span> <span class="nf">_check_duration</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">_time_units</span><span class="p">[</span><span class="n">value</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">OptionValueError</span><span class="p">(</span>
            <span class="s">&#39;option </span><span class="si">%s</span><span class="s">: invalid duration: </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>

<div class="viewcode-block" id="DurationOption"><a class="viewcode-back" href="../../test.html#test.test_optparse.DurationOption">[docs]</a><span class="k">class</span> <span class="nc">DurationOption</span><span class="p">(</span><span class="n">Option</span><span class="p">):</span>
    <span class="n">TYPES</span> <span class="o">=</span> <span class="n">Option</span><span class="o">.</span><span class="n">TYPES</span> <span class="o">+</span> <span class="p">(</span><span class="s">&#39;duration&#39;</span><span class="p">,)</span>
    <span class="n">TYPE_CHECKER</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">Option</span><span class="o">.</span><span class="n">TYPE_CHECKER</span><span class="p">)</span>
    <span class="n">TYPE_CHECKER</span><span class="p">[</span><span class="s">&#39;duration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_check_duration</span>
</div>
<div class="viewcode-block" id="TestDefaultValues"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestDefaultValues">[docs]</a><span class="k">class</span> <span class="nc">TestDefaultValues</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestDefaultValues.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestDefaultValues.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">,</span> <span class="s">&quot;--verbose&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-q&quot;</span><span class="p">,</span> <span class="s">&quot;--quiet&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&#39;verbose&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-n&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">37</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-m&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;int&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-s&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-t&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-u&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expected</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                          <span class="s">&#39;n&#39;</span><span class="p">:</span> <span class="mi">37</span><span class="p">,</span>
                          <span class="s">&#39;m&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                          <span class="s">&#39;s&#39;</span><span class="p">:</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span>
                          <span class="s">&#39;t&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                          <span class="s">&#39;u&#39;</span><span class="p">:</span> <span class="bp">None</span> <span class="p">}</span>
</div>
<div class="viewcode-block" id="TestDefaultValues.test_basic_defaults"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestDefaultValues.test_basic_defaults">[docs]</a>    <span class="k">def</span> <span class="nf">test_basic_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_default_values</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDefaultValues.test_mixed_defaults_post"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestDefaultValues.test_mixed_defaults_post">[docs]</a>    <span class="k">def</span> <span class="nf">test_mixed_defaults_post</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">m</span><span class="o">=-</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&#39;n&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s">&#39;m&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">100</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_default_values</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDefaultValues.test_mixed_defaults_pre"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestDefaultValues.test_mixed_defaults_pre">[docs]</a>    <span class="k">def</span> <span class="nf">test_mixed_defaults_pre</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&quot;barf&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&quot;blah&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-x&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&quot;frob&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-y&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="s">&quot;frob&quot;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="s">&quot;blah&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_default_values</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">remove_option</span><span class="p">(</span><span class="s">&quot;-y&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-y&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_default_values</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestDefaultValues.test_process_default"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestDefaultValues.test_process_default">[docs]</a>    <span class="k">def</span> <span class="nf">test_process_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">option_class</span> <span class="o">=</span> <span class="n">DurationOption</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-d&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;duration&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-e&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;duration&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&quot;6m&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="s">&quot;42&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&#39;d&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span> <span class="s">&#39;e&#39;</span><span class="p">:</span> <span class="mi">360</span><span class="p">,</span> <span class="s">&#39;n&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_default_values</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">set_process_default_values</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&#39;d&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span> <span class="s">&#39;e&#39;</span><span class="p">:</span> <span class="s">&quot;6m&quot;</span><span class="p">,</span> <span class="s">&#39;n&#39;</span><span class="p">:</span> <span class="s">&quot;42&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_default_values</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="TestProgName"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestProgName">[docs]</a><span class="k">class</span> <span class="nc">TestProgName</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that %prog expands to the right thing in usage, version,</span>
<span class="sd">    and help strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="TestProgName.assertUsage"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestProgName.assertUsage">[docs]</a>    <span class="k">def</span> <span class="nf">assertUsage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">expected_usage</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">get_usage</span><span class="p">(),</span> <span class="n">expected_usage</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestProgName.assertVersion"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestProgName.assertVersion">[docs]</a>    <span class="k">def</span> <span class="nf">assertVersion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">expected_version</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">get_version</span><span class="p">(),</span> <span class="n">expected_version</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="TestProgName.test_default_progname"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestProgName.test_default_progname">[docs]</a>    <span class="k">def</span> <span class="nf">test_default_progname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure that program name taken from sys.argv[0] by default.</span>
        <span class="n">save_argv</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[:]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="s">&quot;baz.py&quot;</span><span class="p">)</span>
            <span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="s">&quot;%prog ...&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s">&quot;%prog 1.2&quot;</span><span class="p">)</span>
            <span class="n">expected_usage</span> <span class="o">=</span> <span class="s">&quot;Usage: baz.py ...</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertUsage</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">expected_usage</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertVersion</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;baz.py 1.2&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertHelp</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span>
                            <span class="n">expected_usage</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
                            <span class="s">&quot;Options:</span><span class="se">\n</span><span class="s">&quot;</span>
                            <span class="s">&quot;  --version   show program&#39;s version number and exit</span><span class="se">\n</span><span class="s">&quot;</span>
                            <span class="s">&quot;  -h, --help  show this help message and exit</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">save_argv</span>
</div>
<div class="viewcode-block" id="TestProgName.test_custom_progname"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestProgName.test_custom_progname">[docs]</a>    <span class="k">def</span> <span class="nf">test_custom_progname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">prog</span><span class="o">=</span><span class="s">&quot;thingy&quot;</span><span class="p">,</span>
                              <span class="n">version</span><span class="o">=</span><span class="s">&quot;%prog 0.1&quot;</span><span class="p">,</span>
                              <span class="n">usage</span><span class="o">=</span><span class="s">&quot;%prog arg arg&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">remove_option</span><span class="p">(</span><span class="s">&quot;-h&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">remove_option</span><span class="p">(</span><span class="s">&quot;--version&quot;</span><span class="p">)</span>
        <span class="n">expected_usage</span> <span class="o">=</span> <span class="s">&quot;Usage: thingy arg arg</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertUsage</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">expected_usage</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertVersion</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;thingy 0.1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelp</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">expected_usage</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="TestExpandDefaults"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExpandDefaults">[docs]</a><span class="k">class</span> <span class="nc">TestExpandDefaults</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestExpandDefaults.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExpandDefaults.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">prog</span><span class="o">=</span><span class="s">&quot;test&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">help_prefix</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">Usage: test [options]</span>

<span class="s">Options:</span>
<span class="s">  -h, --help            show this help message and exit</span>
<span class="s">&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_help</span> <span class="o">=</span> <span class="s">&quot;read from FILE [default: </span><span class="si">%d</span><span class="s">efault]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expected_help_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">help_prefix</span> <span class="o">+</span> \
            <span class="s">&quot;  -f FILE, --file=FILE  read from FILE [default: foo.txt]</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expected_help_none</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">help_prefix</span> <span class="o">+</span> \
            <span class="s">&quot;  -f FILE, --file=FILE  read from FILE [default: none]</span><span class="se">\n</span><span class="s">&quot;</span>
</div>
<div class="viewcode-block" id="TestExpandDefaults.test_option_default"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExpandDefaults.test_option_default">[docs]</a>    <span class="k">def</span> <span class="nf">test_option_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-f&quot;</span><span class="p">,</span> <span class="s">&quot;--file&quot;</span><span class="p">,</span>
                               <span class="n">default</span><span class="o">=</span><span class="s">&quot;foo.txt&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_help</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_help_file</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestExpandDefaults.test_parser_default_1"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExpandDefaults.test_parser_default_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_parser_default_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-f&quot;</span><span class="p">,</span> <span class="s">&quot;--file&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_help</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">set_default</span><span class="p">(</span><span class="s">&#39;file&#39;</span><span class="p">,</span> <span class="s">&quot;foo.txt&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_help_file</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestExpandDefaults.test_parser_default_2"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExpandDefaults.test_parser_default_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_parser_default_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-f&quot;</span><span class="p">,</span> <span class="s">&quot;--file&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_help</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="s">&quot;foo.txt&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_help_file</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestExpandDefaults.test_no_default"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExpandDefaults.test_no_default">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-f&quot;</span><span class="p">,</span> <span class="s">&quot;--file&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_help</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_help_none</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestExpandDefaults.test_default_none_1"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExpandDefaults.test_default_none_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_default_none_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-f&quot;</span><span class="p">,</span> <span class="s">&quot;--file&quot;</span><span class="p">,</span>
                               <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_help</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_help_none</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestExpandDefaults.test_default_none_2"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExpandDefaults.test_default_none_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_default_none_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-f&quot;</span><span class="p">,</span> <span class="s">&quot;--file&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_help</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_help_none</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestExpandDefaults.test_float_default"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExpandDefaults.test_float_default">[docs]</a>    <span class="k">def</span> <span class="nf">test_float_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span>
            <span class="s">&quot;-p&quot;</span><span class="p">,</span> <span class="s">&quot;--prob&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&quot;blow up with probability PROB [default: </span><span class="si">%d</span><span class="s">efault]&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">prob</span><span class="o">=</span><span class="mf">0.43</span><span class="p">)</span>
        <span class="n">expected_help</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">help_prefix</span> <span class="o">+</span> \
            <span class="s">&quot;  -p PROB, --prob=PROB  blow up with probability PROB [default: 0.43]</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="n">expected_help</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestExpandDefaults.test_alt_expand"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExpandDefaults.test_alt_expand">[docs]</a>    <span class="k">def</span> <span class="nf">test_alt_expand</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-f&quot;</span><span class="p">,</span> <span class="s">&quot;--file&quot;</span><span class="p">,</span>
                               <span class="n">default</span><span class="o">=</span><span class="s">&quot;foo.txt&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="s">&quot;read from FILE [default: *DEFAULT*]&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">formatter</span><span class="o">.</span><span class="n">default_tag</span> <span class="o">=</span> <span class="s">&quot;*DEFAULT*&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_help_file</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestExpandDefaults.test_no_expand"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExpandDefaults.test_no_expand">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_expand</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-f&quot;</span><span class="p">,</span> <span class="s">&quot;--file&quot;</span><span class="p">,</span>
                               <span class="n">default</span><span class="o">=</span><span class="s">&quot;foo.txt&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="s">&quot;read from </span><span class="si">%d</span><span class="s">efault file&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">formatter</span><span class="o">.</span><span class="n">default_tag</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">expected_help</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">help_prefix</span> <span class="o">+</span> \
            <span class="s">&quot;  -f FILE, --file=FILE  read from </span><span class="si">%d</span><span class="s">efault file</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="n">expected_help</span><span class="p">)</span>


<span class="c"># -- Test parser.parse_args() ------------------------------------------</span>
</div></div>
<div class="viewcode-block" id="TestStandard"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard">[docs]</a><span class="k">class</span> <span class="nc">TestStandard</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestStandard.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;string&quot;</span><span class="p">),</span>
                   <span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-b&quot;</span><span class="p">,</span> <span class="s">&quot;--boo&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&#39;boo&#39;</span><span class="p">),</span>
                   <span class="n">make_option</span><span class="p">(</span><span class="s">&quot;--foo&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;append&quot;</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">InterceptingOptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">,</span>
                                               <span class="n">option_list</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestStandard.test_required_value"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_required_value">[docs]</a>    <span class="k">def</span> <span class="nf">test_required_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;-a&quot;</span><span class="p">],</span> <span class="s">&quot;-a option requires 1 argument&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestStandard.test_invalid_integer"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_invalid_integer">[docs]</a>    <span class="k">def</span> <span class="nf">test_invalid_integer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;-b&quot;</span><span class="p">,</span> <span class="s">&quot;5x&quot;</span><span class="p">],</span>
                             <span class="s">&quot;option -b: invalid integer value: &#39;5x&#39;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestStandard.test_no_such_option"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_no_such_option">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_such_option</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;--boo13&quot;</span><span class="p">],</span> <span class="s">&quot;no such option: --boo13&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestStandard.test_long_invalid_integer"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_long_invalid_integer">[docs]</a>    <span class="k">def</span> <span class="nf">test_long_invalid_integer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;--boo=x5&quot;</span><span class="p">],</span>
                             <span class="s">&quot;option --boo: invalid integer value: &#39;x5&#39;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestStandard.test_empty"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_empty">[docs]</a>    <span class="k">def</span> <span class="nf">test_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([],</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_shortopt_empty_longopt_append"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_shortopt_empty_longopt_append">[docs]</a>    <span class="k">def</span> <span class="nf">test_shortopt_empty_longopt_append</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;--foo=blah&quot;</span><span class="p">,</span> <span class="s">&quot;--foo=&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;blah&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">]},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_long_option_append"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_long_option_append">[docs]</a>    <span class="k">def</span> <span class="nf">test_long_option_append</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="s">&quot;--foo&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;--foo=x&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                            <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                            <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">]},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_option_argument_joined"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_option_argument_joined">[docs]</a>    <span class="k">def</span> <span class="nf">test_option_argument_joined</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-abc&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&quot;bc&quot;</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_option_argument_split"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_option_argument_split">[docs]</a>    <span class="k">def</span> <span class="nf">test_option_argument_split</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="s">&quot;34&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&quot;34&quot;</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_option_argument_joined_integer"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_option_argument_joined_integer">[docs]</a>    <span class="k">def</span> <span class="nf">test_option_argument_joined_integer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-b34&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_option_argument_split_negative_integer"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_option_argument_split_negative_integer">[docs]</a>    <span class="k">def</span> <span class="nf">test_option_argument_split_negative_integer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-b&quot;</span><span class="p">,</span> <span class="s">&quot;-5&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_long_option_argument_joined"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_long_option_argument_joined">[docs]</a>    <span class="k">def</span> <span class="nf">test_long_option_argument_joined</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--boo=13&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_long_option_argument_split"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_long_option_argument_split">[docs]</a>    <span class="k">def</span> <span class="nf">test_long_option_argument_split</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--boo&quot;</span><span class="p">,</span> <span class="s">&quot;111&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="mi">111</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_long_option_short_option"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_long_option_short_option">[docs]</a>    <span class="k">def</span> <span class="nf">test_long_option_short_option</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--foo=bar&quot;</span><span class="p">,</span> <span class="s">&quot;-axyz&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&#39;xyz&#39;</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;bar&quot;</span><span class="p">]},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_abbrev_long_option"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_abbrev_long_option">[docs]</a>    <span class="k">def</span> <span class="nf">test_abbrev_long_option</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--f=bar&quot;</span><span class="p">,</span> <span class="s">&quot;-axyz&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&#39;xyz&#39;</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;bar&quot;</span><span class="p">]},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_defaults"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_defaults">[docs]</a>    <span class="k">def</span> <span class="nf">test_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">([])</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_default_values</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">defaults</span><span class="p">),</span> <span class="nb">vars</span><span class="p">(</span><span class="n">options</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestStandard.test_ambiguous_option"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_ambiguous_option">[docs]</a>    <span class="k">def</span> <span class="nf">test_ambiguous_option</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;--foz&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;store&quot;</span><span class="p">,</span>
                               <span class="nb">type</span><span class="o">=</span><span class="s">&quot;string&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;--f=bar&quot;</span><span class="p">],</span>
                             <span class="s">&quot;ambiguous option: --f (--foo, --foz?)&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="TestStandard.test_short_and_long_option_split"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_short_and_long_option_split">[docs]</a>    <span class="k">def</span> <span class="nf">test_short_and_long_option_split</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="s">&quot;xyz&quot;</span><span class="p">,</span> <span class="s">&quot;--foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&#39;xyz&#39;</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;bar&quot;</span><span class="p">]},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_short_option_split_long_option_append"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_short_option_split_long_option_append">[docs]</a>    <span class="k">def</span> <span class="nf">test_short_option_split_long_option_append</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--foo=bar&quot;</span><span class="p">,</span> <span class="s">&quot;-b&quot;</span><span class="p">,</span> <span class="s">&quot;123&quot;</span><span class="p">,</span> <span class="s">&quot;--foo&quot;</span><span class="p">,</span> <span class="s">&quot;baz&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="s">&quot;baz&quot;</span><span class="p">]},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_short_option_split_one_positional_arg"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_short_option_split_one_positional_arg">[docs]</a>    <span class="k">def</span> <span class="nf">test_short_option_split_one_positional_arg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span>
                           <span class="p">[</span><span class="s">&quot;bar&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_short_option_consumes_separator"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_short_option_consumes_separator">[docs]</a>    <span class="k">def</span> <span class="nf">test_short_option_consumes_separator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="s">&quot;--&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&quot;--&quot;</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span>
                           <span class="p">[</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="s">&quot;--&quot;</span><span class="p">,</span> <span class="s">&quot;--foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&quot;--&quot;</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;bar&quot;</span><span class="p">]},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_short_option_joined_and_separator"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_short_option_joined_and_separator">[docs]</a>    <span class="k">def</span> <span class="nf">test_short_option_joined_and_separator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-ab&quot;</span><span class="p">,</span> <span class="s">&quot;--&quot;</span><span class="p">,</span> <span class="s">&quot;--foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span>
                           <span class="p">[</span><span class="s">&quot;--foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">]),</span>
</div>
<div class="viewcode-block" id="TestStandard.test_hyphen_becomes_positional_arg"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_hyphen_becomes_positional_arg">[docs]</a>    <span class="k">def</span> <span class="nf">test_hyphen_becomes_positional_arg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-ab&quot;</span><span class="p">,</span> <span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="s">&quot;--foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;bar&quot;</span><span class="p">]},</span>
                           <span class="p">[</span><span class="s">&quot;-&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_no_append_versus_append"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_no_append_versus_append">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_append_versus_append</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-b3&quot;</span><span class="p">,</span> <span class="s">&quot;-b&quot;</span><span class="p">,</span> <span class="s">&quot;5&quot;</span><span class="p">,</span> <span class="s">&quot;--foo=bar&quot;</span><span class="p">,</span> <span class="s">&quot;--foo&quot;</span><span class="p">,</span> <span class="s">&quot;baz&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="s">&quot;baz&quot;</span><span class="p">]},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_option_consumes_optionlike_string"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_option_consumes_optionlike_string">[docs]</a>    <span class="k">def</span> <span class="nf">test_option_consumes_optionlike_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="s">&quot;-b3&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&quot;-b3&quot;</span><span class="p">,</span> <span class="s">&#39;boo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestStandard.test_combined_single_invalid_option"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestStandard.test_combined_single_invalid_option">[docs]</a>    <span class="k">def</span> <span class="nf">test_combined_single_invalid_option</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-t&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_true&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;-test&quot;</span><span class="p">],</span>
                             <span class="s">&quot;no such option: -e&quot;</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="TestBool"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestBool">[docs]</a><span class="k">class</span> <span class="nc">TestBool</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestBool.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestBool.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">,</span>
                               <span class="s">&quot;--verbose&quot;</span><span class="p">,</span>
                               <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_true&quot;</span><span class="p">,</span>
                               <span class="n">dest</span><span class="o">=</span><span class="s">&quot;verbose&quot;</span><span class="p">,</span>
                               <span class="n">default</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">),</span>
                   <span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-q&quot;</span><span class="p">,</span>
                               <span class="s">&quot;--quiet&quot;</span><span class="p">,</span>
                               <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_false&quot;</span><span class="p">,</span>
                               <span class="n">dest</span><span class="o">=</span><span class="s">&quot;verbose&quot;</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">option_list</span> <span class="o">=</span> <span class="n">options</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestBool.test_bool_default"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestBool.test_bool_default">[docs]</a>    <span class="k">def</span> <span class="nf">test_bool_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([],</span>
                           <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestBool.test_bool_false"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestBool.test_bool_false">[docs]</a>    <span class="k">def</span> <span class="nf">test_bool_false</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-q&quot;</span><span class="p">],</span>
                                             <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
                                             <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">verbose</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestBool.test_bool_true"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestBool.test_bool_true">[docs]</a>    <span class="k">def</span> <span class="nf">test_bool_true</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-v&quot;</span><span class="p">],</span>
                                             <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
                                             <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">verbose</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestBool.test_bool_flicker_on_and_off"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestBool.test_bool_flicker_on_and_off">[docs]</a>    <span class="k">def</span> <span class="nf">test_bool_flicker_on_and_off</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-qvq&quot;</span><span class="p">,</span> <span class="s">&quot;-q&quot;</span><span class="p">,</span> <span class="s">&quot;-v&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
                           <span class="p">[])</span>
</div></div>
<div class="viewcode-block" id="TestChoice"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestChoice">[docs]</a><span class="k">class</span> <span class="nc">TestChoice</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestChoice.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestChoice.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">InterceptingOptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-c&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;store&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;choice&quot;</span><span class="p">,</span>
                               <span class="n">dest</span><span class="o">=</span><span class="s">&quot;choice&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;one&quot;</span><span class="p">,</span> <span class="s">&quot;two&quot;</span><span class="p">,</span> <span class="s">&quot;three&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestChoice.test_valid_choice"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestChoice.test_valid_choice">[docs]</a>    <span class="k">def</span> <span class="nf">test_valid_choice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-c&quot;</span><span class="p">,</span> <span class="s">&quot;one&quot;</span><span class="p">,</span> <span class="s">&quot;xyz&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;choice&#39;</span><span class="p">:</span> <span class="s">&#39;one&#39;</span><span class="p">},</span>
                           <span class="p">[</span><span class="s">&quot;xyz&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestChoice.test_invalid_choice"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestChoice.test_invalid_choice">[docs]</a>    <span class="k">def</span> <span class="nf">test_invalid_choice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;-c&quot;</span><span class="p">,</span> <span class="s">&quot;four&quot;</span><span class="p">,</span> <span class="s">&quot;abc&quot;</span><span class="p">],</span>
                             <span class="s">&quot;option -c: invalid choice: &#39;four&#39; &quot;</span>
                             <span class="s">&quot;(choose from &#39;one&#39;, &#39;two&#39;, &#39;three&#39;)&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestChoice.test_add_choice_option"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestChoice.test_add_choice_option">[docs]</a>    <span class="k">def</span> <span class="nf">test_add_choice_option</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-d&quot;</span><span class="p">,</span> <span class="s">&quot;--default&quot;</span><span class="p">,</span>
                               <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;four&quot;</span><span class="p">,</span> <span class="s">&quot;five&quot;</span><span class="p">,</span> <span class="s">&quot;six&quot;</span><span class="p">])</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;-d&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;choice&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">action</span><span class="p">,</span> <span class="s">&quot;store&quot;</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="TestCount"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCount">[docs]</a><span class="k">class</span> <span class="nc">TestCount</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestCount.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCount.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">InterceptingOptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_opt</span> <span class="o">=</span> <span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;count&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;verbose&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_opt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;--verbose&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;verbose&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-q&quot;</span><span class="p">,</span> <span class="s">&quot;--quiet&quot;</span><span class="p">,</span>
                               <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_const&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;verbose&quot;</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCount.test_empty"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCount.test_empty">[docs]</a>    <span class="k">def</span> <span class="nf">test_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([],</span> <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestCount.test_count_one"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCount.test_count_one">[docs]</a>    <span class="k">def</span> <span class="nf">test_count_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-v&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestCount.test_count_three"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCount.test_count_three">[docs]</a>    <span class="k">def</span> <span class="nf">test_count_three</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-vvv&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestCount.test_count_three_apart"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCount.test_count_three_apart">[docs]</a>    <span class="k">def</span> <span class="nf">test_count_three_apart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-v&quot;</span><span class="p">,</span> <span class="s">&quot;-v&quot;</span><span class="p">,</span> <span class="s">&quot;-v&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestCount.test_count_override_amount"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCount.test_count_override_amount">[docs]</a>    <span class="k">def</span> <span class="nf">test_count_override_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-vvv&quot;</span><span class="p">,</span> <span class="s">&quot;--verbose=2&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestCount.test_count_override_quiet"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCount.test_count_override_quiet">[docs]</a>    <span class="k">def</span> <span class="nf">test_count_override_quiet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-vvv&quot;</span><span class="p">,</span> <span class="s">&quot;--verbose=2&quot;</span><span class="p">,</span> <span class="s">&quot;-q&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestCount.test_count_overriding"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCount.test_count_overriding">[docs]</a>    <span class="k">def</span> <span class="nf">test_count_overriding</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-vvv&quot;</span><span class="p">,</span> <span class="s">&quot;--verbose=2&quot;</span><span class="p">,</span> <span class="s">&quot;-q&quot;</span><span class="p">,</span> <span class="s">&quot;-v&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestCount.test_count_interspersed_args"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCount.test_count_interspersed_args">[docs]</a>    <span class="k">def</span> <span class="nf">test_count_interspersed_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--quiet&quot;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">,</span> <span class="s">&quot;-v&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
                           <span class="p">[</span><span class="s">&quot;3&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestCount.test_count_no_interspersed_args"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCount.test_count_no_interspersed_args">[docs]</a>    <span class="k">def</span> <span class="nf">test_count_no_interspersed_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">disable_interspersed_args</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--quiet&quot;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">,</span> <span class="s">&quot;-v&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
                           <span class="p">[</span><span class="s">&quot;3&quot;</span><span class="p">,</span> <span class="s">&quot;-v&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestCount.test_count_no_such_option"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCount.test_count_no_such_option">[docs]</a>    <span class="k">def</span> <span class="nf">test_count_no_such_option</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;-q3&quot;</span><span class="p">,</span> <span class="s">&quot;-v&quot;</span><span class="p">],</span> <span class="s">&quot;no such option: -3&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCount.test_count_option_no_value"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCount.test_count_option_no_value">[docs]</a>    <span class="k">def</span> <span class="nf">test_count_option_no_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;--quiet=3&quot;</span><span class="p">,</span> <span class="s">&quot;-v&quot;</span><span class="p">],</span>
                             <span class="s">&quot;--quiet option does not take a value&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCount.test_count_with_default"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCount.test_count_with_default">[docs]</a>    <span class="k">def</span> <span class="nf">test_count_with_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">set_default</span><span class="p">(</span><span class="s">&#39;verbose&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([],</span> <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestCount.test_count_overriding_default"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCount.test_count_overriding_default">[docs]</a>    <span class="k">def</span> <span class="nf">test_count_overriding_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">set_default</span><span class="p">(</span><span class="s">&#39;verbose&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-vvv&quot;</span><span class="p">,</span> <span class="s">&quot;--verbose=2&quot;</span><span class="p">,</span> <span class="s">&quot;-q&quot;</span><span class="p">,</span> <span class="s">&quot;-v&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">[])</span>
</div></div>
<div class="viewcode-block" id="TestMultipleArgs"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestMultipleArgs">[docs]</a><span class="k">class</span> <span class="nc">TestMultipleArgs</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestMultipleArgs.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestMultipleArgs.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">InterceptingOptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-p&quot;</span><span class="p">,</span> <span class="s">&quot;--point&quot;</span><span class="p">,</span>
                               <span class="n">action</span><span class="o">=</span><span class="s">&quot;store&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;point&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestMultipleArgs.test_nargs_with_positional_args"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestMultipleArgs.test_nargs_with_positional_args">[docs]</a>    <span class="k">def</span> <span class="nf">test_nargs_with_positional_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;-p&quot;</span><span class="p">,</span> <span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="s">&quot;2.5&quot;</span><span class="p">,</span> <span class="s">&quot;-4.3&quot;</span><span class="p">,</span> <span class="s">&quot;xyz&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;point&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.3</span><span class="p">)},</span>
                           <span class="p">[</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;xyz&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestMultipleArgs.test_nargs_long_opt"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestMultipleArgs.test_nargs_long_opt">[docs]</a>    <span class="k">def</span> <span class="nf">test_nargs_long_opt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--point&quot;</span><span class="p">,</span> <span class="s">&quot;-1&quot;</span><span class="p">,</span> <span class="s">&quot;2.5&quot;</span><span class="p">,</span> <span class="s">&quot;-0&quot;</span><span class="p">,</span> <span class="s">&quot;xyz&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;point&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">)},</span>
                           <span class="p">[</span><span class="s">&quot;xyz&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestMultipleArgs.test_nargs_invalid_float_value"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestMultipleArgs.test_nargs_invalid_float_value">[docs]</a>    <span class="k">def</span> <span class="nf">test_nargs_invalid_float_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;-p&quot;</span><span class="p">,</span> <span class="s">&quot;1.0&quot;</span><span class="p">,</span> <span class="s">&quot;2x&quot;</span><span class="p">,</span> <span class="s">&quot;3.5&quot;</span><span class="p">],</span>
                             <span class="s">&quot;option -p: &quot;</span>
                             <span class="s">&quot;invalid floating-point value: &#39;2x&#39;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestMultipleArgs.test_nargs_required_values"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestMultipleArgs.test_nargs_required_values">[docs]</a>    <span class="k">def</span> <span class="nf">test_nargs_required_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;--point&quot;</span><span class="p">,</span> <span class="s">&quot;1.0&quot;</span><span class="p">,</span> <span class="s">&quot;3.5&quot;</span><span class="p">],</span>
                             <span class="s">&quot;--point option requires 3 arguments&quot;</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="TestMultipleArgsAppend"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestMultipleArgsAppend">[docs]</a><span class="k">class</span> <span class="nc">TestMultipleArgsAppend</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestMultipleArgsAppend.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestMultipleArgsAppend.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">InterceptingOptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-p&quot;</span><span class="p">,</span> <span class="s">&quot;--point&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;store&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                               <span class="nb">type</span><span class="o">=</span><span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;point&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-f&quot;</span><span class="p">,</span> <span class="s">&quot;--foo&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;append&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                               <span class="nb">type</span><span class="o">=</span><span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-z&quot;</span><span class="p">,</span> <span class="s">&quot;--zero&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;append_const&quot;</span><span class="p">,</span>
                               <span class="n">dest</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestMultipleArgsAppend.test_nargs_append"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestMultipleArgsAppend.test_nargs_append">[docs]</a>    <span class="k">def</span> <span class="nf">test_nargs_append</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-f&quot;</span><span class="p">,</span> <span class="s">&quot;4&quot;</span><span class="p">,</span> <span class="s">&quot;-3&quot;</span><span class="p">,</span> <span class="s">&quot;blah&quot;</span><span class="p">,</span> <span class="s">&quot;--foo&quot;</span><span class="p">,</span> <span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="s">&quot;666&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;point&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">666</span><span class="p">)]},</span>
                           <span class="p">[</span><span class="s">&quot;blah&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestMultipleArgsAppend.test_nargs_append_required_values"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestMultipleArgsAppend.test_nargs_append_required_values">[docs]</a>    <span class="k">def</span> <span class="nf">test_nargs_append_required_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;-f4,3&quot;</span><span class="p">],</span>
                             <span class="s">&quot;-f option requires 2 arguments&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestMultipleArgsAppend.test_nargs_append_simple"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestMultipleArgsAppend.test_nargs_append_simple">[docs]</a>    <span class="k">def</span> <span class="nf">test_nargs_append_simple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--foo=3&quot;</span><span class="p">,</span> <span class="s">&quot;4&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;point&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:[(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestMultipleArgsAppend.test_nargs_append_const"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestMultipleArgsAppend.test_nargs_append_const">[docs]</a>    <span class="k">def</span> <span class="nf">test_nargs_append_const</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--zero&quot;</span><span class="p">,</span> <span class="s">&quot;--foo&quot;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">,</span> <span class="s">&quot;4&quot;</span><span class="p">,</span> <span class="s">&quot;-z&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;point&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">:[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]},</span>
                           <span class="p">[])</span>
</div></div>
<div class="viewcode-block" id="TestVersion"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestVersion">[docs]</a><span class="k">class</span> <span class="nc">TestVersion</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestVersion.test_version"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestVersion.test_version">[docs]</a>    <span class="k">def</span> <span class="nf">test_version</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">InterceptingOptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">,</span>
                                               <span class="n">version</span><span class="o">=</span><span class="s">&quot;%prog 0.1&quot;</span><span class="p">)</span>
        <span class="n">save_argv</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[:]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">curdir</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertOutput</span><span class="p">([</span><span class="s">&quot;--version&quot;</span><span class="p">],</span> <span class="s">&quot;bar 0.1</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">save_argv</span>
</div>
<div class="viewcode-block" id="TestVersion.test_no_version"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestVersion.test_no_version">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_version</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">InterceptingOptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;--version&quot;</span><span class="p">],</span>
                             <span class="s">&quot;no such option: --version&quot;</span><span class="p">)</span>

<span class="c"># -- Test conflicting default values and parser.parse_args() -----------</span>
</div></div>
<div class="viewcode-block" id="TestConflictingDefaults"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictingDefaults">[docs]</a><span class="k">class</span> <span class="nc">TestConflictingDefaults</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Conflicting default values: the last one should win.&quot;&quot;&quot;</span>
<div class="viewcode-block" id="TestConflictingDefaults.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictingDefaults.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">option_list</span><span class="o">=</span><span class="p">[</span>
            <span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;verbose&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="TestConflictingDefaults.test_conflict_default"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictingDefaults.test_conflict_default">[docs]</a>    <span class="k">def</span> <span class="nf">test_conflict_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-q&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_false&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;verbose&quot;</span><span class="p">,</span>
                               <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([],</span> <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestConflictingDefaults.test_conflict_default_none"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictingDefaults.test_conflict_default_none">[docs]</a>    <span class="k">def</span> <span class="nf">test_conflict_default_none</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-q&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_false&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;verbose&quot;</span><span class="p">,</span>
                               <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([],</span> <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span> <span class="p">[])</span>
</div></div>
<div class="viewcode-block" id="TestOptionGroup"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionGroup">[docs]</a><span class="k">class</span> <span class="nc">TestOptionGroup</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestOptionGroup.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionGroup.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOptionGroup.test_option_group_create_instance"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionGroup.test_option_group_create_instance">[docs]</a>    <span class="k">def</span> <span class="nf">test_option_group_create_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">OptionGroup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;Spam&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option_group</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
        <span class="n">group</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;--spam&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_true&quot;</span><span class="p">,</span>
                         <span class="n">help</span><span class="o">=</span><span class="s">&quot;spam spam spam spam&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--spam&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;spam&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestOptionGroup.test_add_group_no_group"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionGroup.test_add_group_no_group">[docs]</a>    <span class="k">def</span> <span class="nf">test_add_group_no_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTypeError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option_group</span><span class="p">,</span>
                             <span class="s">&quot;not an OptionGroup instance: None&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOptionGroup.test_add_group_invalid_arguments"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionGroup.test_add_group_invalid_arguments">[docs]</a>    <span class="k">def</span> <span class="nf">test_add_group_invalid_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTypeError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option_group</span><span class="p">,</span>
                             <span class="s">&quot;invalid arguments&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOptionGroup.test_add_group_wrong_parser"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionGroup.test_add_group_wrong_parser">[docs]</a>    <span class="k">def</span> <span class="nf">test_add_group_wrong_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">OptionGroup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;Spam&quot;</span><span class="p">)</span>
        <span class="n">group</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option_group</span><span class="p">,</span> <span class="p">(</span><span class="n">group</span><span class="p">,),</span> <span class="bp">None</span><span class="p">,</span>
                          <span class="ne">ValueError</span><span class="p">,</span> <span class="s">&quot;invalid OptionGroup (wrong parser)&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestOptionGroup.test_group_manipulate"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestOptionGroup.test_group_manipulate">[docs]</a>    <span class="k">def</span> <span class="nf">test_group_manipulate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option_group</span><span class="p">(</span><span class="s">&quot;Group 2&quot;</span><span class="p">,</span>
                                             <span class="n">description</span><span class="o">=</span><span class="s">&quot;Some more options&quot;</span><span class="p">)</span>
        <span class="n">group</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Bacon&quot;</span><span class="p">)</span>
        <span class="n">group</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;--bacon&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;int&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option_group</span><span class="p">(</span><span class="s">&quot;--bacon&quot;</span><span class="p">),</span> <span class="n">group</span><span class="p">)</span>

<span class="c"># -- Test extending and parser.parse_args() ----------------------------</span>
</div></div>
<div class="viewcode-block" id="TestExtendAddTypes"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExtendAddTypes">[docs]</a><span class="k">class</span> <span class="nc">TestExtendAddTypes</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestExtendAddTypes.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExtendAddTypes.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">InterceptingOptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">,</span>
                                               <span class="n">option_class</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">MyOption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;string&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;a&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-f&quot;</span><span class="p">,</span> <span class="s">&quot;--file&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;file&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;file&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestExtendAddTypes.tearDown"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExtendAddTypes.tearDown">[docs]</a>    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestExtendAddTypes.MyOption"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExtendAddTypes.MyOption">[docs]</a>    <span class="k">class</span> <span class="nc">MyOption</span> <span class="p">(</span><span class="n">Option</span><span class="p">):</span>
<div class="viewcode-block" id="TestExtendAddTypes.MyOption.check_file"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExtendAddTypes.MyOption.check_file">[docs]</a>        <span class="k">def</span> <span class="nf">check_file</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">OptionValueError</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">: file does not exist&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">OptionValueError</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">: not a regular file&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>
</div>
        <span class="n">TYPES</span> <span class="o">=</span> <span class="n">Option</span><span class="o">.</span><span class="n">TYPES</span> <span class="o">+</span> <span class="p">(</span><span class="s">&quot;file&quot;</span><span class="p">,)</span>
        <span class="n">TYPE_CHECKER</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">Option</span><span class="o">.</span><span class="n">TYPE_CHECKER</span><span class="p">)</span>
        <span class="n">TYPE_CHECKER</span><span class="p">[</span><span class="s">&quot;file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">check_file</span>
</div>
<div class="viewcode-block" id="TestExtendAddTypes.test_filetype_ok"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExtendAddTypes.test_filetype_ok">[docs]</a>    <span class="k">def</span> <span class="nf">test_filetype_ok</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">support</span><span class="o">.</span><span class="n">create_empty_file</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--file&quot;</span><span class="p">,</span> <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&quot;-afoo&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;file&#39;</span><span class="p">:</span> <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&#39;foo&#39;</span><span class="p">},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestExtendAddTypes.test_filetype_noexist"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExtendAddTypes.test_filetype_noexist">[docs]</a>    <span class="k">def</span> <span class="nf">test_filetype_noexist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;--file&quot;</span><span class="p">,</span> <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&quot;-afoo&quot;</span><span class="p">],</span>
                             <span class="s">&quot;</span><span class="si">%s</span><span class="s">: file does not exist&quot;</span> <span class="o">%</span>
                             <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestExtendAddTypes.test_filetype_notfile"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExtendAddTypes.test_filetype_notfile">[docs]</a>    <span class="k">def</span> <span class="nf">test_filetype_notfile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;--file&quot;</span><span class="p">,</span> <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&quot;-afoo&quot;</span><span class="p">],</span>
                             <span class="s">&quot;</span><span class="si">%s</span><span class="s">: not a regular file&quot;</span> <span class="o">%</span>
                             <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="TestExtendAddActions"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExtendAddActions">[docs]</a><span class="k">class</span> <span class="nc">TestExtendAddActions</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestExtendAddActions.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExtendAddActions.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">MyOption</span><span class="p">(</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="s">&quot;--apple&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;extend&quot;</span><span class="p">,</span>
                                 <span class="nb">type</span><span class="o">=</span><span class="s">&quot;string&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;apple&quot;</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">option_list</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestExtendAddActions.MyOption"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExtendAddActions.MyOption">[docs]</a>    <span class="k">class</span> <span class="nc">MyOption</span> <span class="p">(</span><span class="n">Option</span><span class="p">):</span>
        <span class="n">ACTIONS</span> <span class="o">=</span> <span class="n">Option</span><span class="o">.</span><span class="n">ACTIONS</span> <span class="o">+</span> <span class="p">(</span><span class="s">&quot;extend&quot;</span><span class="p">,)</span>
        <span class="n">STORE_ACTIONS</span> <span class="o">=</span> <span class="n">Option</span><span class="o">.</span><span class="n">STORE_ACTIONS</span> <span class="o">+</span> <span class="p">(</span><span class="s">&quot;extend&quot;</span><span class="p">,)</span>
        <span class="n">TYPED_ACTIONS</span> <span class="o">=</span> <span class="n">Option</span><span class="o">.</span><span class="n">TYPED_ACTIONS</span> <span class="o">+</span> <span class="p">(</span><span class="s">&quot;extend&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="TestExtendAddActions.MyOption.take_action"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExtendAddActions.MyOption.take_action">[docs]</a>        <span class="k">def</span> <span class="nf">take_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s">&quot;extend&quot;</span><span class="p">:</span>
                <span class="n">lvalue</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">)</span>
                <span class="n">values</span><span class="o">.</span><span class="n">ensure_value</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">lvalue</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Option</span><span class="o">.</span><span class="n">take_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span>
                                   <span class="n">values</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="TestExtendAddActions.test_extend_add_action"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExtendAddActions.test_extend_add_action">[docs]</a>    <span class="k">def</span> <span class="nf">test_extend_add_action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-afoo,bar&quot;</span><span class="p">,</span> <span class="s">&quot;--apple=blah&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;apple&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="s">&quot;blah&quot;</span><span class="p">]},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestExtendAddActions.test_extend_add_action_normal"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestExtendAddActions.test_extend_add_action_normal">[docs]</a>    <span class="k">def</span> <span class="nf">test_extend_add_action_normal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;-abar&quot;</span><span class="p">,</span> <span class="s">&quot;--apple=x,y&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;apple&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">]},</span>
                           <span class="p">[])</span>

<span class="c"># -- Test callbacks and parser.parse_args() ----------------------------</span>
</div></div>
<div class="viewcode-block" id="TestCallback"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallback">[docs]</a><span class="k">class</span> <span class="nc">TestCallback</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestCallback.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallback.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-x&quot;</span><span class="p">,</span>
                               <span class="bp">None</span><span class="p">,</span>
                               <span class="n">action</span><span class="o">=</span><span class="s">&quot;callback&quot;</span><span class="p">,</span>
                               <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">process_opt</span><span class="p">),</span>
                   <span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-f&quot;</span><span class="p">,</span>
                               <span class="s">&quot;--file&quot;</span><span class="p">,</span>
                               <span class="n">action</span><span class="o">=</span><span class="s">&quot;callback&quot;</span><span class="p">,</span>
                               <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">process_opt</span><span class="p">,</span>
                               <span class="nb">type</span><span class="o">=</span><span class="s">&quot;string&quot;</span><span class="p">,</span>
                               <span class="n">dest</span><span class="o">=</span><span class="s">&quot;filename&quot;</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">option_list</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCallback.process_opt"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallback.process_opt">[docs]</a>    <span class="k">def</span> <span class="nf">process_opt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser_</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">opt</span> <span class="o">==</span> <span class="s">&quot;-x&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">_short_opts</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;-x&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">_long_opts</span><span class="p">,</span> <span class="p">[])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">parser_</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">parser_</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="p">{</span><span class="s">&#39;filename&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">})</span>

            <span class="n">parser_</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="k">elif</span> <span class="n">opt</span> <span class="o">==</span> <span class="s">&quot;--file&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">_short_opts</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;-f&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">_long_opts</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;--file&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">parser_</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">parser_</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="p">{</span><span class="s">&#39;filename&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">})</span>

            <span class="nb">setattr</span><span class="p">(</span><span class="n">parser_</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">dest</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Unknown option </span><span class="si">%r</span><span class="s"> in process_opt.&quot;</span> <span class="o">%</span> <span class="n">opt</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCallback.test_callback"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallback.test_callback">[docs]</a>    <span class="k">def</span> <span class="nf">test_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-x&quot;</span><span class="p">,</span> <span class="s">&quot;--file=foo&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;filename&#39;</span><span class="p">:</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestCallback.test_callback_help"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallback.test_callback_help">[docs]</a>    <span class="k">def</span> <span class="nf">test_callback_help</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># This test was prompted by SF bug #960515 -- the point is</span>
        <span class="c"># not to inspect the help text, just to make sure that</span>
        <span class="c"># format_help() doesn&#39;t crash.</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">remove_option</span><span class="p">(</span><span class="s">&quot;-h&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-t&quot;</span><span class="p">,</span> <span class="s">&quot;--test&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;callback&quot;</span><span class="p">,</span>
                          <span class="n">callback</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;string&quot;</span><span class="p">,</span>
                          <span class="n">help</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">)</span>

        <span class="n">expected_help</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Options:</span><span class="se">\n</span><span class="s">&quot;</span>
                         <span class="s">&quot;  -t TEST, --test=TEST  foo</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelp</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">expected_help</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="TestCallbackExtraArgs"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackExtraArgs">[docs]</a><span class="k">class</span> <span class="nc">TestCallbackExtraArgs</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestCallbackExtraArgs.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackExtraArgs.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-p&quot;</span><span class="p">,</span> <span class="s">&quot;--point&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;callback&quot;</span><span class="p">,</span>
                               <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">process_tuple</span><span class="p">,</span>
                               <span class="n">callback_args</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;string&quot;</span><span class="p">,</span>
                               <span class="n">dest</span><span class="o">=</span><span class="s">&quot;points&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">option_list</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCallbackExtraArgs.process_tuple"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackExtraArgs.process_tuple">[docs]</a>    <span class="k">def</span> <span class="nf">process_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser_</span><span class="p">,</span> <span class="nb">len</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">type</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">opt</span> <span class="o">==</span> <span class="s">&quot;-p&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;1,2,3&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">opt</span> <span class="o">==</span> <span class="s">&quot;--point&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;4,5,6&quot;</span><span class="p">)</span>

        <span class="n">value</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">)))</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="n">parser_</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">dest</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCallbackExtraArgs.test_callback_extra_args"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackExtraArgs.test_callback_extra_args">[docs]</a>    <span class="k">def</span> <span class="nf">test_callback_extra_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-p1,2,3&quot;</span><span class="p">,</span> <span class="s">&quot;--point&quot;</span><span class="p">,</span> <span class="s">&quot;4,5,6&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;points&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)]},</span>
                           <span class="p">[])</span>
</div></div>
<div class="viewcode-block" id="TestCallbackMeddleArgs"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackMeddleArgs">[docs]</a><span class="k">class</span> <span class="nc">TestCallbackMeddleArgs</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestCallbackMeddleArgs.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackMeddleArgs.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_option</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;callback&quot;</span><span class="p">,</span>
                               <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">process_n</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&#39;things&#39;</span><span class="p">)</span>
                   <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">option_list</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>

    <span class="c"># Callback that meddles in rargs, largs</span></div>
<div class="viewcode-block" id="TestCallbackMeddleArgs.process_n"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackMeddleArgs.process_n">[docs]</a>    <span class="k">def</span> <span class="nf">process_n</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser_</span><span class="p">):</span>
        <span class="c"># option is -3, -5, etc.</span>
        <span class="n">nargs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">opt</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">rargs</span> <span class="o">=</span> <span class="n">parser_</span><span class="o">.</span><span class="n">rargs</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rargs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">nargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Expected </span><span class="si">%d</span><span class="s"> arguments for </span><span class="si">%s</span><span class="s"> option.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nargs</span><span class="p">,</span> <span class="n">opt</span><span class="p">))</span>
        <span class="n">dest</span> <span class="o">=</span> <span class="n">parser_</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ensure_value</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">dest</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">dest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">rargs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">nargs</span><span class="p">]))</span>
        <span class="n">parser_</span><span class="o">.</span><span class="n">largs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nargs</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">rargs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">nargs</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="TestCallbackMeddleArgs.test_callback_meddle_args"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackMeddleArgs.test_callback_meddle_args">[docs]</a>    <span class="k">def</span> <span class="nf">test_callback_meddle_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-1&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;-3&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="s">&quot;baz&quot;</span><span class="p">,</span> <span class="s">&quot;qux&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;things&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s">&quot;foo&quot;</span><span class="p">,),</span> <span class="p">(</span><span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="s">&quot;baz&quot;</span><span class="p">,</span> <span class="s">&quot;qux&quot;</span><span class="p">)]},</span>
                           <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestCallbackMeddleArgs.test_callback_meddle_args_separator"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackMeddleArgs.test_callback_meddle_args_separator">[docs]</a>    <span class="k">def</span> <span class="nf">test_callback_meddle_args_separator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-2&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;--&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;things&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;--&#39;</span><span class="p">)]},</span>
                           <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</div></div>
<div class="viewcode-block" id="TestCallbackManyArgs"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackManyArgs">[docs]</a><span class="k">class</span> <span class="nc">TestCallbackManyArgs</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestCallbackManyArgs.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackManyArgs.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="s">&quot;--apple&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;callback&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                               <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">process_many</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;string&quot;</span><span class="p">),</span>
                   <span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-b&quot;</span><span class="p">,</span> <span class="s">&quot;--bob&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;callback&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                               <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">process_many</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;int&quot;</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">option_list</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCallbackManyArgs.process_many"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackManyArgs.process_many">[docs]</a>    <span class="k">def</span> <span class="nf">process_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser_</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">opt</span> <span class="o">==</span> <span class="s">&quot;-a&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">opt</span> <span class="o">==</span> <span class="s">&quot;--apple&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;ding&quot;</span><span class="p">,</span> <span class="s">&quot;dong&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">opt</span> <span class="o">==</span> <span class="s">&quot;-b&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">opt</span> <span class="o">==</span> <span class="s">&quot;--bob&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">666</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestCallbackManyArgs.test_many_args"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackManyArgs.test_many_args">[docs]</a>    <span class="k">def</span> <span class="nf">test_many_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="s">&quot;--apple&quot;</span><span class="p">,</span> <span class="s">&quot;ding&quot;</span><span class="p">,</span> <span class="s">&quot;dong&quot;</span><span class="p">,</span>
                            <span class="s">&quot;-b&quot;</span><span class="p">,</span> <span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="s">&quot;2&quot;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">,</span> <span class="s">&quot;--bob&quot;</span><span class="p">,</span> <span class="s">&quot;-666&quot;</span><span class="p">,</span> <span class="s">&quot;42&quot;</span><span class="p">,</span>
                            <span class="s">&quot;0&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&quot;apple&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&quot;bob&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span>
                           <span class="p">[])</span>
</div></div>
<div class="viewcode-block" id="TestCallbackCheckAbbrev"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackCheckAbbrev">[docs]</a><span class="k">class</span> <span class="nc">TestCallbackCheckAbbrev</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestCallbackCheckAbbrev.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackCheckAbbrev.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;--foo-bar&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;callback&quot;</span><span class="p">,</span>
                               <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_abbrev</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCallbackCheckAbbrev.check_abbrev"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackCheckAbbrev.check_abbrev">[docs]</a>    <span class="k">def</span> <span class="nf">check_abbrev</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="s">&quot;--foo-bar&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCallbackCheckAbbrev.test_abbrev_callback_expansion"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackCheckAbbrev.test_abbrev_callback_expansion">[docs]</a>    <span class="k">def</span> <span class="nf">test_abbrev_callback_expansion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--foo&quot;</span><span class="p">],</span> <span class="p">{},</span> <span class="p">[])</span>
</div></div>
<div class="viewcode-block" id="TestCallbackVarArgs"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackVarArgs">[docs]</a><span class="k">class</span> <span class="nc">TestCallbackVarArgs</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestCallbackVarArgs.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackVarArgs.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;a&quot;</span><span class="p">),</span>
                   <span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-b&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;b&quot;</span><span class="p">),</span>
                   <span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-c&quot;</span><span class="p">,</span> <span class="s">&quot;--callback&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;callback&quot;</span><span class="p">,</span>
                               <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">variable_args</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;c&quot;</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">InterceptingOptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">,</span>
                                               <span class="n">option_list</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCallbackVarArgs.variable_args"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackVarArgs.variable_args">[docs]</a>    <span class="k">def</span> <span class="nf">variable_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">rargs</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">rargs</span>
        <span class="k">while</span> <span class="n">rargs</span><span class="p">:</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="n">rargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">arg</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;--&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">arg</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;-&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">arg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;-&quot;</span><span class="p">)):</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">rargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">dest</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestCallbackVarArgs.test_variable_args"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackVarArgs.test_variable_args">[docs]</a>    <span class="k">def</span> <span class="nf">test_variable_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-a3&quot;</span><span class="p">,</span> <span class="s">&quot;-5&quot;</span><span class="p">,</span> <span class="s">&quot;--callback&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">]},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestCallbackVarArgs.test_consume_separator_stop_at_option"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackVarArgs.test_consume_separator_stop_at_option">[docs]</a>    <span class="k">def</span> <span class="nf">test_consume_separator_stop_at_option</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-c&quot;</span><span class="p">,</span> <span class="s">&quot;37&quot;</span><span class="p">,</span> <span class="s">&quot;--&quot;</span><span class="p">,</span> <span class="s">&quot;xxx&quot;</span><span class="p">,</span> <span class="s">&quot;-b&quot;</span><span class="p">,</span> <span class="s">&quot;hello&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                            <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                            <span class="s">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;37&quot;</span><span class="p">,</span> <span class="s">&quot;--&quot;</span><span class="p">,</span> <span class="s">&quot;xxx&quot;</span><span class="p">]},</span>
                           <span class="p">[</span><span class="s">&quot;hello&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestCallbackVarArgs.test_positional_arg_and_variable_args"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackVarArgs.test_positional_arg_and_variable_args">[docs]</a>    <span class="k">def</span> <span class="nf">test_positional_arg_and_variable_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;hello&quot;</span><span class="p">,</span> <span class="s">&quot;-c&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                            <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                            <span class="s">&#39;c&#39;</span><span class="p">:[</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">]},</span>
                           <span class="p">[</span><span class="s">&quot;hello&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestCallbackVarArgs.test_stop_at_option"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackVarArgs.test_stop_at_option">[docs]</a>    <span class="k">def</span> <span class="nf">test_stop_at_option</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-c&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;-b&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;foo&quot;</span><span class="p">]},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestCallbackVarArgs.test_stop_at_invalid_option"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestCallbackVarArgs.test_stop_at_invalid_option">[docs]</a>    <span class="k">def</span> <span class="nf">test_stop_at_invalid_option</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;-c&quot;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">,</span> <span class="s">&quot;-5&quot;</span><span class="p">,</span> <span class="s">&quot;-a&quot;</span><span class="p">],</span> <span class="s">&quot;no such option: -5&quot;</span><span class="p">)</span>


<span class="c"># -- Test conflict handling and parser.parse_args() --------------------</span>
</div></div>
<div class="viewcode-block" id="ConflictBase"><a class="viewcode-back" href="../../test.html#test.test_optparse.ConflictBase">[docs]</a><span class="k">class</span> <span class="nc">ConflictBase</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="ConflictBase.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.ConflictBase.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">,</span> <span class="s">&quot;--verbose&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;count&quot;</span><span class="p">,</span>
                               <span class="n">dest</span><span class="o">=</span><span class="s">&quot;verbose&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;increment verbosity&quot;</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">InterceptingOptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">,</span>
                                               <span class="n">option_list</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ConflictBase.show_version"><a class="viewcode-back" href="../../test.html#test.test_optparse.ConflictBase.show_version">[docs]</a>    <span class="k">def</span> <span class="nf">show_version</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">show_version</span> <span class="o">=</span> <span class="mi">1</span>
</div></div>
<div class="viewcode-block" id="TestConflict"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflict">[docs]</a><span class="k">class</span> <span class="nc">TestConflict</span><span class="p">(</span><span class="n">ConflictBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Use the default conflict resolution for Optik 1.2: error.&quot;&quot;&quot;</span>
<div class="viewcode-block" id="TestConflict.assertTrueconflict_error"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflict.assertTrueconflict_error">[docs]</a>    <span class="k">def</span> <span class="nf">assertTrueconflict_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span>
            <span class="n">func</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">,</span> <span class="s">&quot;--version&quot;</span><span class="p">),</span> <span class="p">{</span><span class="s">&#39;action&#39;</span> <span class="p">:</span> <span class="s">&quot;callback&quot;</span><span class="p">,</span>
                                        <span class="s">&#39;callback&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_version</span><span class="p">,</span>
                                        <span class="s">&#39;help&#39;</span> <span class="p">:</span> <span class="s">&quot;show version&quot;</span><span class="p">},</span>
            <span class="n">OptionConflictError</span><span class="p">,</span>
            <span class="s">&quot;option -v/--version: conflicting option string(s): -v&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">msg</span><span class="p">,</span> <span class="s">&quot;conflicting option string(s): -v&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">option_id</span><span class="p">,</span> <span class="s">&quot;-v/--version&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestConflict.test_conflict_error"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflict.test_conflict_error">[docs]</a>    <span class="k">def</span> <span class="nf">test_conflict_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrueconflict_error</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestConflict.test_conflict_error_group"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflict.test_conflict_error_group">[docs]</a>    <span class="k">def</span> <span class="nf">test_conflict_error_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">OptionGroup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;Group 1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrueconflict_error</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">add_option</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestConflict.test_no_such_conflict_handler"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflict.test_no_such_conflict_handler">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_such_conflict_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">set_conflict_handler</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">,),</span> <span class="bp">None</span><span class="p">,</span>
            <span class="ne">ValueError</span><span class="p">,</span> <span class="s">&quot;invalid conflict_resolution value &#39;foo&#39;&quot;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="TestConflictResolve"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictResolve">[docs]</a><span class="k">class</span> <span class="nc">TestConflictResolve</span><span class="p">(</span><span class="n">ConflictBase</span><span class="p">):</span>
<div class="viewcode-block" id="TestConflictResolve.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictResolve.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ConflictBase</span><span class="o">.</span><span class="n">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">set_conflict_handler</span><span class="p">(</span><span class="s">&quot;resolve&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">,</span> <span class="s">&quot;--version&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;callback&quot;</span><span class="p">,</span>
                               <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_version</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;show version&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestConflictResolve.test_conflict_resolve"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictResolve.test_conflict_resolve">[docs]</a>    <span class="k">def</span> <span class="nf">test_conflict_resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">v_opt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">)</span>
        <span class="n">verbose_opt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;--verbose&quot;</span><span class="p">)</span>
        <span class="n">version_opt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;--version&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">v_opt</span> <span class="ow">is</span> <span class="n">version_opt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">v_opt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">verbose_opt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">v_opt</span><span class="o">.</span><span class="n">_long_opts</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;--version&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">version_opt</span><span class="o">.</span><span class="n">_short_opts</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;-v&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">version_opt</span><span class="o">.</span><span class="n">_long_opts</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;--version&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">verbose_opt</span><span class="o">.</span><span class="n">_short_opts</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">verbose_opt</span><span class="o">.</span><span class="n">_long_opts</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;--verbose&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestConflictResolve.test_conflict_resolve_help"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictResolve.test_conflict_resolve_help">[docs]</a>    <span class="k">def</span> <span class="nf">test_conflict_resolve_help</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOutput</span><span class="p">([</span><span class="s">&quot;-h&quot;</span><span class="p">],</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">Options:</span>
<span class="s">  --verbose      increment verbosity</span>
<span class="s">  -h, --help     show this help message and exit</span>
<span class="s">  -v, --version  show version</span>
<span class="s">&quot;&quot;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestConflictResolve.test_conflict_resolve_short_opt"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictResolve.test_conflict_resolve_short_opt">[docs]</a>    <span class="k">def</span> <span class="nf">test_conflict_resolve_short_opt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-v&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;show_version&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestConflictResolve.test_conflict_resolve_long_opt"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictResolve.test_conflict_resolve_long_opt">[docs]</a>    <span class="k">def</span> <span class="nf">test_conflict_resolve_long_opt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--verbose&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
                           <span class="p">[])</span>
</div>
<div class="viewcode-block" id="TestConflictResolve.test_conflict_resolve_long_opts"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictResolve.test_conflict_resolve_long_opts">[docs]</a>    <span class="k">def</span> <span class="nf">test_conflict_resolve_long_opts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;--verbose&quot;</span><span class="p">,</span> <span class="s">&quot;--version&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;show_version&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
                           <span class="p">[])</span>
</div></div>
<div class="viewcode-block" id="TestConflictOverride"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictOverride">[docs]</a><span class="k">class</span> <span class="nc">TestConflictOverride</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestConflictOverride.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictOverride.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">InterceptingOptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">set_conflict_handler</span><span class="p">(</span><span class="s">&quot;resolve&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-n&quot;</span><span class="p">,</span> <span class="s">&quot;--dry-run&quot;</span><span class="p">,</span>
                               <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;dry_run&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="s">&quot;don&#39;t do anything&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;--dry-run&quot;</span><span class="p">,</span> <span class="s">&quot;-n&quot;</span><span class="p">,</span>
                               <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_const&quot;</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;dry_run&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="s">&quot;dry run mode&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestConflictOverride.test_conflict_override_opts"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictOverride.test_conflict_override_opts">[docs]</a>    <span class="k">def</span> <span class="nf">test_conflict_override_opts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&quot;--dry-run&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">_short_opts</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;-n&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">_long_opts</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;--dry-run&quot;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TestConflictOverride.test_conflict_override_help"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictOverride.test_conflict_override_help">[docs]</a>    <span class="k">def</span> <span class="nf">test_conflict_override_help</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertOutput</span><span class="p">([</span><span class="s">&quot;-h&quot;</span><span class="p">],</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">Options:</span>
<span class="s">  -h, --help     show this help message and exit</span>
<span class="s">  -n, --dry-run  dry run mode</span>
<span class="s">&quot;&quot;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestConflictOverride.test_conflict_override_args"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestConflictOverride.test_conflict_override_args">[docs]</a>    <span class="k">def</span> <span class="nf">test_conflict_override_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-n&quot;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s">&#39;dry_run&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">},</span>
                           <span class="p">[])</span>

<span class="c"># -- Other testing. ----------------------------------------------------</span>
</div></div>
<span class="n">_expected_help_basic</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">Usage: bar.py [options]</span>

<span class="s">Options:</span>
<span class="s">  -a APPLE           throw APPLEs at basket</span>
<span class="s">  -b NUM, --boo=NUM  shout &quot;boo!&quot; NUM times (in order to frighten away all the</span>
<span class="s">                     evil spirits that cause trouble and mayhem)</span>
<span class="s">  --foo=FOO          store FOO in the foo list for later fooing</span>
<span class="s">  -h, --help         show this help message and exit</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">_expected_help_long_opts_first</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">Usage: bar.py [options]</span>

<span class="s">Options:</span>
<span class="s">  -a APPLE           throw APPLEs at basket</span>
<span class="s">  --boo=NUM, -b NUM  shout &quot;boo!&quot; NUM times (in order to frighten away all the</span>
<span class="s">                     evil spirits that cause trouble and mayhem)</span>
<span class="s">  --foo=FOO          store FOO in the foo list for later fooing</span>
<span class="s">  --help, -h         show this help message and exit</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">_expected_help_title_formatter</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">Usage</span>
<span class="s">=====</span>
<span class="s">  bar.py [options]</span>

<span class="s">Options</span>
<span class="s">=======</span>
<span class="s">-a APPLE           throw APPLEs at basket</span>
<span class="s">--boo=NUM, -b NUM  shout &quot;boo!&quot; NUM times (in order to frighten away all the</span>
<span class="s">                   evil spirits that cause trouble and mayhem)</span>
<span class="s">--foo=FOO          store FOO in the foo list for later fooing</span>
<span class="s">--help, -h         show this help message and exit</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">_expected_help_short_lines</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">Usage: bar.py [options]</span>

<span class="s">Options:</span>
<span class="s">  -a APPLE           throw APPLEs at basket</span>
<span class="s">  -b NUM, --boo=NUM  shout &quot;boo!&quot; NUM times (in order to</span>
<span class="s">                     frighten away all the evil spirits</span>
<span class="s">                     that cause trouble and mayhem)</span>
<span class="s">  --foo=FOO          store FOO in the foo list for later</span>
<span class="s">                     fooing</span>
<span class="s">  -h, --help         show this help message and exit</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">_expected_very_help_short_lines</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">Usage: bar.py [options]</span>

<span class="s">Options:</span>
<span class="s">  -a APPLE</span>
<span class="s">    throw</span>
<span class="s">    APPLEs at</span>
<span class="s">    basket</span>
<span class="s">  -b NUM, --boo=NUM</span>
<span class="s">    shout</span>
<span class="s">    &quot;boo!&quot; NUM</span>
<span class="s">    times (in</span>
<span class="s">    order to</span>
<span class="s">    frighten</span>
<span class="s">    away all</span>
<span class="s">    the evil</span>
<span class="s">    spirits</span>
<span class="s">    that cause</span>
<span class="s">    trouble and</span>
<span class="s">    mayhem)</span>
<span class="s">  --foo=FOO</span>
<span class="s">    store FOO</span>
<span class="s">    in the foo</span>
<span class="s">    list for</span>
<span class="s">    later</span>
<span class="s">    fooing</span>
<span class="s">  -h, --help</span>
<span class="s">    show this</span>
<span class="s">    help</span>
<span class="s">    message and</span>
<span class="s">    exit</span>
<span class="s">&quot;&quot;&quot;</span>

<div class="viewcode-block" id="TestHelp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestHelp">[docs]</a><span class="k">class</span> <span class="nc">TestHelp</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestHelp.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestHelp.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_parser</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestHelp.make_parser"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestHelp.make_parser">[docs]</a>    <span class="k">def</span> <span class="nf">make_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">columns</span><span class="p">):</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;string&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span>
                        <span class="n">metavar</span><span class="o">=</span><span class="s">&quot;APPLE&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;throw APPLEs at basket&quot;</span><span class="p">),</span>
            <span class="n">make_option</span><span class="p">(</span><span class="s">&quot;-b&quot;</span><span class="p">,</span> <span class="s">&quot;--boo&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&#39;boo&#39;</span><span class="p">,</span>
                        <span class="n">metavar</span><span class="o">=</span><span class="s">&quot;NUM&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span>
                        <span class="s">&quot;shout </span><span class="se">\&quot;</span><span class="s">boo!</span><span class="se">\&quot;</span><span class="s"> NUM times (in order to frighten away &quot;</span>
                        <span class="s">&quot;all the evil spirits that cause trouble and mayhem)&quot;</span><span class="p">),</span>
            <span class="n">make_option</span><span class="p">(</span><span class="s">&quot;--foo&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;append&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;string&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&#39;foo&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s">&quot;store FOO in the foo list for later fooing&quot;</span><span class="p">),</span>
            <span class="p">]</span>

        <span class="c"># We need to set COLUMNS for the OptionParser constructor, but</span>
        <span class="c"># we must restore its original value -- otherwise, this test</span>
        <span class="c"># screws things up for other tests when it&#39;s part of the Python</span>
        <span class="c"># test suite.</span>
        <span class="k">with</span> <span class="n">support</span><span class="o">.</span><span class="n">EnvironmentVarGuard</span><span class="p">()</span> <span class="k">as</span> <span class="n">env</span><span class="p">:</span>
            <span class="n">env</span><span class="p">[</span><span class="s">&#39;COLUMNS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">InterceptingOptionParser</span><span class="p">(</span><span class="n">option_list</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestHelp.assertHelpEquals"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestHelp.assertHelpEquals">[docs]</a>    <span class="k">def</span> <span class="nf">assertHelpEquals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expected_output</span><span class="p">):</span>
        <span class="n">save_argv</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[:]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c"># Make optparse believe bar.py is being executed.</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar.py&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertOutput</span><span class="p">([</span><span class="s">&quot;-h&quot;</span><span class="p">],</span> <span class="n">expected_output</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">save_argv</span>
</div>
<div class="viewcode-block" id="TestHelp.test_help"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestHelp.test_help">[docs]</a>    <span class="k">def</span> <span class="nf">test_help</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelpEquals</span><span class="p">(</span><span class="n">_expected_help_basic</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestHelp.test_help_old_usage"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestHelp.test_help_old_usage">[docs]</a>    <span class="k">def</span> <span class="nf">test_help_old_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">set_usage</span><span class="p">(</span><span class="s">&quot;Usage: %prog [options]&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelpEquals</span><span class="p">(</span><span class="n">_expected_help_basic</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestHelp.test_help_long_opts_first"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestHelp.test_help_long_opts_first">[docs]</a>    <span class="k">def</span> <span class="nf">test_help_long_opts_first</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">formatter</span><span class="o">.</span><span class="n">short_first</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelpEquals</span><span class="p">(</span><span class="n">_expected_help_long_opts_first</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestHelp.test_help_title_formatter"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestHelp.test_help_title_formatter">[docs]</a>    <span class="k">def</span> <span class="nf">test_help_title_formatter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">support</span><span class="o">.</span><span class="n">EnvironmentVarGuard</span><span class="p">()</span> <span class="k">as</span> <span class="n">env</span><span class="p">:</span>
            <span class="n">env</span><span class="p">[</span><span class="s">&quot;COLUMNS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;80&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">formatter</span> <span class="o">=</span> <span class="n">TitledHelpFormatter</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertHelpEquals</span><span class="p">(</span><span class="n">_expected_help_title_formatter</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestHelp.test_wrap_columns"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestHelp.test_wrap_columns">[docs]</a>    <span class="k">def</span> <span class="nf">test_wrap_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Ensure that wrapping respects $COLUMNS environment variable.</span>
        <span class="c"># Need to reconstruct the parser, since that&#39;s the only time</span>
        <span class="c"># we look at $COLUMNS.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_parser</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelpEquals</span><span class="p">(</span><span class="n">_expected_help_short_lines</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_parser</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelpEquals</span><span class="p">(</span><span class="n">_expected_very_help_short_lines</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestHelp.test_help_unicode"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestHelp.test_help_unicode">[docs]</a>    <span class="k">def</span> <span class="nf">test_help_unicode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">InterceptingOptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-a&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;ol</span><span class="se">\u00E9</span><span class="s">!&quot;</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">Options:</span>
<span class="s">  -h, --help  show this help message and exit</span>
<span class="s">  -a          ol</span><span class="se">\u00E9</span><span class="s">!</span>
<span class="s">&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelpEquals</span><span class="p">(</span><span class="n">expect</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestHelp.test_help_unicode_description"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestHelp.test_help_unicode_description">[docs]</a>    <span class="k">def</span> <span class="nf">test_help_unicode_description</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">InterceptingOptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">SUPPRESS_USAGE</span><span class="p">,</span>
                                               <span class="n">description</span><span class="o">=</span><span class="s">&quot;ol</span><span class="se">\u00E9</span><span class="s">!&quot;</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">ol</span><span class="se">\u00E9</span><span class="s">!</span>

<span class="s">Options:</span>
<span class="s">  -h, --help  show this help message and exit</span>
<span class="s">&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelpEquals</span><span class="p">(</span><span class="n">expect</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestHelp.test_help_description_groups"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestHelp.test_help_description_groups">[docs]</a>    <span class="k">def</span> <span class="nf">test_help_description_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span>
            <span class="s">&quot;This is the program description for %prog.  %prog has &quot;</span>
            <span class="s">&quot;an option group as well as single options.&quot;</span><span class="p">)</span>

        <span class="n">group</span> <span class="o">=</span> <span class="n">OptionGroup</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;Dangerous Options&quot;</span><span class="p">,</span>
            <span class="s">&quot;Caution: use of these options is at your own risk.  &quot;</span>
            <span class="s">&quot;It is believed that some of them bite.&quot;</span><span class="p">)</span>
        <span class="n">group</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-g&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Group option.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option_group</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>

        <span class="n">expect</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">Usage: bar.py [options]</span>

<span class="s">This is the program description for bar.py.  bar.py has an option group as</span>
<span class="s">well as single options.</span>

<span class="s">Options:</span>
<span class="s">  -a APPLE           throw APPLEs at basket</span>
<span class="s">  -b NUM, --boo=NUM  shout &quot;boo!&quot; NUM times (in order to frighten away all the</span>
<span class="s">                     evil spirits that cause trouble and mayhem)</span>
<span class="s">  --foo=FOO          store FOO in the foo list for later fooing</span>
<span class="s">  -h, --help         show this help message and exit</span>

<span class="s">  Dangerous Options:</span>
<span class="s">    Caution: use of these options is at your own risk.  It is believed</span>
<span class="s">    that some of them bite.</span>

<span class="s">    -g               Group option.</span>
<span class="s">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelpEquals</span><span class="p">(</span><span class="n">expect</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">epilog</span> <span class="o">=</span> <span class="s">&quot;Please report bugs to /dev/null.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertHelpEquals</span><span class="p">(</span><span class="n">expect</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Please report bugs to /dev/null.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="TestMatchAbbrev"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestMatchAbbrev">[docs]</a><span class="k">class</span> <span class="nc">TestMatchAbbrev</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestMatchAbbrev.test_match_abbrev"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestMatchAbbrev.test_match_abbrev">[docs]</a>    <span class="k">def</span> <span class="nf">test_match_abbrev</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">_match_abbrev</span><span class="p">(</span><span class="s">&quot;--f&quot;</span><span class="p">,</span>
                                       <span class="p">{</span><span class="s">&quot;--foz&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                                        <span class="s">&quot;--foo&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                                        <span class="s">&quot;--fie&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                                        <span class="s">&quot;--f&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">}),</span>
                         <span class="s">&quot;--f&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestMatchAbbrev.test_match_abbrev_error"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestMatchAbbrev.test_match_abbrev_error">[docs]</a>    <span class="k">def</span> <span class="nf">test_match_abbrev_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;--f&quot;</span>
        <span class="n">wordmap</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;--foz&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&quot;--foo&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&quot;--fie&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span>
            <span class="n">_match_abbrev</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">wordmap</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span>
            <span class="n">BadOptionError</span><span class="p">,</span> <span class="s">&quot;ambiguous option: --f (--fie, --foo, --foz?)&quot;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="TestParseNumber"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestParseNumber">[docs]</a><span class="k">class</span> <span class="nc">TestParseNumber</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestParseNumber.setUp"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestParseNumber.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">InterceptingOptionParser</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-n&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-l&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestParseNumber.test_parse_num_fail"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestParseNumber.test_parse_num_fail">[docs]</a>    <span class="k">def</span> <span class="nf">test_parse_num_fail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span>
            <span class="n">_parse_num</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="p">{},</span>
            <span class="ne">ValueError</span><span class="p">,</span>
            <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;invalid literal for int().*: &#39;?&#39;?&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span>
            <span class="n">_parse_num</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;0xOoops&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="p">{},</span>
            <span class="ne">ValueError</span><span class="p">,</span>
            <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;invalid literal for int().*: s?&#39;?0xOoops&#39;?&quot;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TestParseNumber.test_parse_num_ok"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestParseNumber.test_parse_num_ok">[docs]</a>    <span class="k">def</span> <span class="nf">test_parse_num_ok</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">_parse_num</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">_parse_num</span><span class="p">(</span><span class="s">&quot;0x10&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">_parse_num</span><span class="p">(</span><span class="s">&quot;0XA&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">_parse_num</span><span class="p">(</span><span class="s">&quot;010&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">_parse_num</span><span class="p">(</span><span class="s">&quot;0b11&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">_parse_num</span><span class="p">(</span><span class="s">&quot;0b&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestParseNumber.test_numeric_options"><a class="viewcode-back" href="../../test.html#test.test_optparse.TestParseNumber.test_numeric_options">[docs]</a>    <span class="k">def</span> <span class="nf">test_numeric_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-n&quot;</span><span class="p">,</span> <span class="s">&quot;42&quot;</span><span class="p">,</span> <span class="s">&quot;-l&quot;</span><span class="p">,</span> <span class="s">&quot;0x20&quot;</span><span class="p">],</span>
                           <span class="p">{</span> <span class="s">&quot;n&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s">&quot;l&quot;</span><span class="p">:</span> <span class="mh">0x20</span> <span class="p">},</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseOK</span><span class="p">([</span><span class="s">&quot;-n&quot;</span><span class="p">,</span> <span class="s">&quot;0b0101&quot;</span><span class="p">,</span> <span class="s">&quot;-l010&quot;</span><span class="p">],</span>
                           <span class="p">{</span> <span class="s">&quot;n&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&quot;l&quot;</span><span class="p">:</span> <span class="mi">8</span> <span class="p">},</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;-n008&quot;</span><span class="p">],</span>
                             <span class="s">&quot;option -n: invalid integer value: &#39;008&#39;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;-l0b0123&quot;</span><span class="p">],</span>
                             <span class="s">&quot;option -l: invalid integer value: &#39;0b0123&#39;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertParseFail</span><span class="p">([</span><span class="s">&quot;-l&quot;</span><span class="p">,</span> <span class="s">&quot;0x12x&quot;</span><span class="p">],</span>
                             <span class="s">&quot;option -l: invalid integer value: &#39;0x12x&#39;&quot;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="test_main"><a class="viewcode-back" href="../../test.html#test.test_optparse.test_main">[docs]</a><span class="k">def</span> <span class="nf">test_main</span><span class="p">():</span>
    <span class="n">support</span><span class="o">.</span><span class="n">run_unittest</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">test_main</span><span class="p">()</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>