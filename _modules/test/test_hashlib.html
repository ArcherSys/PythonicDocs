

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_hashlib &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_hashlib</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_hashlib</h1><div class="highlight"><pre>
<span class="c"># Test hashlib module</span>
<span class="c">#</span>
<span class="c"># $Id$</span>
<span class="c">#</span>
<span class="c">#  Copyright (C) 2005-2010   Gregory P. Smith (greg@krypto.org)</span>
<span class="c">#  Licensed to PSF under a Contributor Agreement.</span>
<span class="c">#</span>

<span class="kn">import</span> <span class="nn">array</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">threading</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">threading</span> <span class="o">=</span> <span class="bp">None</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">support</span>
<span class="kn">from</span> <span class="nn">test.support</span> <span class="kn">import</span> <span class="n">_4G</span><span class="p">,</span> <span class="n">bigmemtest</span><span class="p">,</span> <span class="n">import_fresh_module</span>

<span class="c"># Were we compiled --with-pydebug or with #define Py_DEBUG?</span>
<span class="n">COMPILED_WITH_PYDEBUG</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">&#39;gettotalrefcount&#39;</span><span class="p">)</span>

<span class="n">c_hashlib</span> <span class="o">=</span> <span class="n">import_fresh_module</span><span class="p">(</span><span class="s">&#39;hashlib&#39;</span><span class="p">,</span> <span class="n">fresh</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;_hashlib&#39;</span><span class="p">])</span>
<span class="n">py_hashlib</span> <span class="o">=</span> <span class="n">import_fresh_module</span><span class="p">(</span><span class="s">&#39;hashlib&#39;</span><span class="p">,</span> <span class="n">blocked</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;_hashlib&#39;</span><span class="p">])</span>

<div class="viewcode-block" id="hexstr"><a class="viewcode-back" href="../../test.html#test.test_hashlib.hexstr">[docs]</a><span class="k">def</span> <span class="nf">hexstr</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="s">&quot;0123456789abcdef&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">+=</span> <span class="n">h</span><span class="p">[(</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">r</span>

</div>
<div class="viewcode-block" id="HashLibTestCase"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase">[docs]</a><span class="k">class</span> <span class="nc">HashLibTestCase</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">supported_hash_names</span> <span class="o">=</span> <span class="p">(</span> <span class="s">&#39;md5&#39;</span><span class="p">,</span> <span class="s">&#39;MD5&#39;</span><span class="p">,</span> <span class="s">&#39;sha1&#39;</span><span class="p">,</span> <span class="s">&#39;SHA1&#39;</span><span class="p">,</span>
                             <span class="s">&#39;sha224&#39;</span><span class="p">,</span> <span class="s">&#39;SHA224&#39;</span><span class="p">,</span> <span class="s">&#39;sha256&#39;</span><span class="p">,</span> <span class="s">&#39;SHA256&#39;</span><span class="p">,</span>
                             <span class="s">&#39;sha384&#39;</span><span class="p">,</span> <span class="s">&#39;SHA384&#39;</span><span class="p">,</span> <span class="s">&#39;sha512&#39;</span><span class="p">,</span> <span class="s">&#39;SHA512&#39;</span><span class="p">)</span>

    <span class="c"># Issue #14693: fallback modules are always compiled under POSIX</span>
    <span class="n">_warn_on_extension_import</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;posix&#39;</span> <span class="ow">or</span> <span class="n">COMPILED_WITH_PYDEBUG</span>

    <span class="k">def</span> <span class="nf">_conditional_import_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Import a module and return a reference to it or None on failure.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">exec</span><span class="p">(</span><span class="s">&#39;import &#39;</span><span class="o">+</span><span class="n">module_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warn_on_extension_import</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;Did a C extension fail to compile? </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">error</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">algorithms</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">supported_hash_names</span><span class="p">:</span>
            <span class="n">algorithms</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">algorithm</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constructors_to_test</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">algorithms</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">constructors_to_test</span><span class="p">[</span><span class="n">algorithm</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c"># For each algorithm, test the direct constructor and the use</span>
        <span class="c"># of hashlib.new given the algorithm name.</span>
        <span class="k">for</span> <span class="n">algorithm</span><span class="p">,</span> <span class="n">constructors</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constructors_to_test</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">constructors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">hashlib</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">))</span>
            <span class="k">def</span> <span class="nf">_test_algorithm_via_hashlib_new</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">_alg</span><span class="o">=</span><span class="n">algorithm</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">_alg</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">_alg</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">constructors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">_test_algorithm_via_hashlib_new</span><span class="p">)</span>

        <span class="n">_hashlib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conditional_import_module</span><span class="p">(</span><span class="s">&#39;_hashlib&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_hashlib</span><span class="p">:</span>
            <span class="c"># These two algorithms should always be present when this module</span>
            <span class="c"># is compiled.  If not, something was compiled wrong.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">_hashlib</span><span class="p">,</span> <span class="s">&#39;openssl_md5&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">_hashlib</span><span class="p">,</span> <span class="s">&#39;openssl_sha1&#39;</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">algorithm</span><span class="p">,</span> <span class="n">constructors</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constructors_to_test</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">constructor</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">_hashlib</span><span class="p">,</span> <span class="s">&#39;openssl_&#39;</span><span class="o">+</span><span class="n">algorithm</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">constructor</span><span class="p">:</span>
                    <span class="n">constructors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">constructor</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">add_builtin_constructor</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="n">constructor</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">hashlib</span><span class="p">,</span> <span class="s">&quot;__get_builtin_constructor&quot;</span><span class="p">)(</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">constructors_to_test</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">constructor</span><span class="p">)</span>

        <span class="n">_md5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conditional_import_module</span><span class="p">(</span><span class="s">&#39;_md5&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_md5</span><span class="p">:</span>
            <span class="n">add_builtin_constructor</span><span class="p">(</span><span class="s">&#39;md5&#39;</span><span class="p">)</span>
        <span class="n">_sha1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conditional_import_module</span><span class="p">(</span><span class="s">&#39;_sha1&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_sha1</span><span class="p">:</span>
            <span class="n">add_builtin_constructor</span><span class="p">(</span><span class="s">&#39;sha1&#39;</span><span class="p">)</span>
        <span class="n">_sha256</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conditional_import_module</span><span class="p">(</span><span class="s">&#39;_sha256&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_sha256</span><span class="p">:</span>
            <span class="n">add_builtin_constructor</span><span class="p">(</span><span class="s">&#39;sha224&#39;</span><span class="p">)</span>
            <span class="n">add_builtin_constructor</span><span class="p">(</span><span class="s">&#39;sha256&#39;</span><span class="p">)</span>
        <span class="n">_sha512</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conditional_import_module</span><span class="p">(</span><span class="s">&#39;_sha512&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_sha512</span><span class="p">:</span>
            <span class="n">add_builtin_constructor</span><span class="p">(</span><span class="s">&#39;sha384&#39;</span><span class="p">)</span>
            <span class="n">add_builtin_constructor</span><span class="p">(</span><span class="s">&#39;sha512&#39;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">HashLibTestCase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hash_constructors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">constructors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constructors_to_test</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">constructors</span><span class="p">)</span>

<div class="viewcode-block" id="HashLibTestCase.test_hash_array"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_hash_array">[docs]</a>    <span class="k">def</span> <span class="nf">test_hash_array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">cons</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_constructors</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">cons</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_algorithms_guaranteed"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_algorithms_guaranteed">[docs]</a>    <span class="k">def</span> <span class="nf">test_algorithms_guaranteed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">hashlib</span><span class="o">.</span><span class="n">algorithms_guaranteed</span><span class="p">,</span>
            <span class="nb">set</span><span class="p">(</span><span class="n">_algo</span> <span class="k">for</span> <span class="n">_algo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">supported_hash_names</span>
                  <span class="k">if</span> <span class="n">_algo</span><span class="o">.</span><span class="n">islower</span><span class="p">()))</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_algorithms_available"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_algorithms_available">[docs]</a>    <span class="k">def</span> <span class="nf">test_algorithms_available</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">hashlib</span><span class="o">.</span><span class="n">algorithms_guaranteed</span><span class="p">)</span><span class="o">.</span>
                            <span class="n">issubset</span><span class="p">(</span><span class="n">hashlib</span><span class="o">.</span><span class="n">algorithms_available</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_unknown_hash"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_unknown_hash">[docs]</a>    <span class="k">def</span> <span class="nf">test_unknown_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">,</span> <span class="s">&#39;spam spam spam spam spam&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_get_builtin_constructor"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_get_builtin_constructor">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_builtin_constructor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">get_builtin_constructor</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">hashlib</span><span class="p">,</span>
                                          <span class="s">&#39;__get_builtin_constructor&#39;</span><span class="p">)</span>
        <span class="n">builtin_constructor_cache</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">hashlib</span><span class="p">,</span>
                                            <span class="s">&#39;__builtin_constructor_cache&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">get_builtin_constructor</span><span class="p">,</span> <span class="s">&#39;test&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">_md5</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="c"># This forces an ImportError for &quot;import _md5&quot; statements</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;_md5&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c"># clear the cache</span>
        <span class="n">builtin_constructor_cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">get_builtin_constructor</span><span class="p">,</span> <span class="s">&#39;md5&#39;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="s">&#39;_md5&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;_md5&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_md5</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;_md5&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">get_builtin_constructor</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">constructor</span> <span class="o">=</span> <span class="n">get_builtin_constructor</span><span class="p">(</span><span class="s">&#39;md5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">constructor</span><span class="p">,</span> <span class="n">_md5</span><span class="o">.</span><span class="n">md5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">builtin_constructor_cache</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;MD5&#39;</span><span class="p">,</span> <span class="s">&#39;md5&#39;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_hexdigest"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_hexdigest">[docs]</a>    <span class="k">def</span> <span class="nf">test_hexdigest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">cons</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_constructors</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">cons</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">digest</span><span class="p">(),</span> <span class="nb">bytes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">hexstr</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">digest</span><span class="p">()),</span> <span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_name_attribute"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_name_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">test_name_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">cons</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_constructors</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">cons</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">supported_hash_names</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_large_update"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_large_update">[docs]</a>    <span class="k">def</span> <span class="nf">test_large_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">aas</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;a&#39;</span> <span class="o">*</span> <span class="mi">128</span>
        <span class="n">bees</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;b&#39;</span> <span class="o">*</span> <span class="mi">127</span>
        <span class="n">cees</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;c&#39;</span> <span class="o">*</span> <span class="mi">126</span>
        <span class="n">dees</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;d&#39;</span> <span class="o">*</span> <span class="mi">2048</span> <span class="c">#  HASHLIB_GIL_MINSIZE</span>

        <span class="k">for</span> <span class="n">cons</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_constructors</span><span class="p">:</span>
            <span class="n">m1</span> <span class="o">=</span> <span class="n">cons</span><span class="p">()</span>
            <span class="n">m1</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">aas</span><span class="p">)</span>
            <span class="n">m1</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">bees</span><span class="p">)</span>
            <span class="n">m1</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cees</span><span class="p">)</span>
            <span class="n">m1</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dees</span><span class="p">)</span>

            <span class="n">m2</span> <span class="o">=</span> <span class="n">cons</span><span class="p">()</span>
            <span class="n">m2</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">aas</span> <span class="o">+</span> <span class="n">bees</span> <span class="o">+</span> <span class="n">cees</span> <span class="o">+</span> <span class="n">dees</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">digest</span><span class="p">(),</span> <span class="n">m2</span><span class="o">.</span><span class="n">digest</span><span class="p">())</span>

            <span class="n">m3</span> <span class="o">=</span> <span class="n">cons</span><span class="p">(</span><span class="n">aas</span> <span class="o">+</span> <span class="n">bees</span> <span class="o">+</span> <span class="n">cees</span> <span class="o">+</span> <span class="n">dees</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">digest</span><span class="p">(),</span> <span class="n">m3</span><span class="o">.</span><span class="n">digest</span><span class="p">())</span>

            <span class="c"># verify copy() doesn&#39;t touch original</span>
            <span class="n">m4</span> <span class="o">=</span> <span class="n">cons</span><span class="p">(</span><span class="n">aas</span> <span class="o">+</span> <span class="n">bees</span> <span class="o">+</span> <span class="n">cees</span><span class="p">)</span>
            <span class="n">m4_digest</span> <span class="o">=</span> <span class="n">m4</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
            <span class="n">m4_copy</span> <span class="o">=</span> <span class="n">m4</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">m4_copy</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dees</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">digest</span><span class="p">(),</span> <span class="n">m4_copy</span><span class="o">.</span><span class="n">digest</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m4</span><span class="o">.</span><span class="n">digest</span><span class="p">(),</span> <span class="n">m4_digest</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.check"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.check">[docs]</a>    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">hexdigest</span><span class="p">):</span>
        <span class="n">hexdigest</span> <span class="o">=</span> <span class="n">hexdigest</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">constructors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constructors_to_test</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="c"># 2 is for hashlib.name(...) and hashlib.new(name, ...)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreaterEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">constructors</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">hash_object_constructor</span> <span class="ow">in</span> <span class="n">constructors</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">hash_object_constructor</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">computed</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
                    <span class="n">computed</span><span class="p">,</span> <span class="n">hexdigest</span><span class="p">,</span>
                    <span class="s">&quot;Hash algorithm </span><span class="si">%s</span><span class="s"> constructed using </span><span class="si">%s</span><span class="s"> returned hexdigest&quot;</span>
                    <span class="s">&quot; </span><span class="si">%r</span><span class="s"> for </span><span class="si">%d</span><span class="s"> byte input data that should have hashed to </span><span class="si">%r</span><span class="s">.&quot;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">hash_object_constructor</span><span class="p">,</span>
                       <span class="n">computed</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">hexdigest</span><span class="p">))</span>
            <span class="n">computed</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
            <span class="n">digest</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">hexdigest</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">computed</span><span class="p">,</span> <span class="n">digest</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">digest</span><span class="p">),</span> <span class="n">m</span><span class="o">.</span><span class="n">digest_size</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.check_no_unicode"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.check_no_unicode">[docs]</a>    <span class="k">def</span> <span class="nf">check_no_unicode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">algorithm_name</span><span class="p">):</span>
        <span class="c"># Unicode objects are not allowed as input.</span>
        <span class="n">constructors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constructors_to_test</span><span class="p">[</span><span class="n">algorithm_name</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">hash_object_constructor</span> <span class="ow">in</span> <span class="n">constructors</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">hash_object_constructor</span><span class="p">,</span> <span class="s">&#39;spam&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_no_unicode"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_no_unicode">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_unicode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_no_unicode</span><span class="p">(</span><span class="s">&#39;md5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_no_unicode</span><span class="p">(</span><span class="s">&#39;sha1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_no_unicode</span><span class="p">(</span><span class="s">&#39;sha224&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_no_unicode</span><span class="p">(</span><span class="s">&#39;sha256&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_no_unicode</span><span class="p">(</span><span class="s">&#39;sha384&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_no_unicode</span><span class="p">(</span><span class="s">&#39;sha512&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.check_blocksize_name"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.check_blocksize_name">[docs]</a>    <span class="k">def</span> <span class="nf">check_blocksize_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">block_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">digest_size</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">constructors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constructors_to_test</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">hash_object_constructor</span> <span class="ow">in</span> <span class="n">constructors</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">hash_object_constructor</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">block_size</span><span class="p">,</span> <span class="n">block_size</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">digest_size</span><span class="p">,</span> <span class="n">digest_size</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">digest</span><span class="p">()),</span> <span class="n">digest_size</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="c"># split for sha3_512 / _sha3.sha3 object</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">repr</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_blocksize_name"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_blocksize_name">[docs]</a>    <span class="k">def</span> <span class="nf">test_blocksize_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_blocksize_name</span><span class="p">(</span><span class="s">&#39;md5&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_blocksize_name</span><span class="p">(</span><span class="s">&#39;sha1&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_blocksize_name</span><span class="p">(</span><span class="s">&#39;sha224&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_blocksize_name</span><span class="p">(</span><span class="s">&#39;sha256&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_blocksize_name</span><span class="p">(</span><span class="s">&#39;sha384&#39;</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_blocksize_name</span><span class="p">(</span><span class="s">&#39;sha512&#39;</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_md5_0"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_md5_0">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_md5_0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;md5&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;d41d8cd98f00b204e9800998ecf8427e&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_md5_1"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_md5_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_md5_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;md5&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="s">&#39;900150983cd24fb0d6963f7d28e17f72&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_md5_2"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_md5_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_md5_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;md5&#39;</span><span class="p">,</span>
                   <span class="n">b</span><span class="s">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;</span><span class="p">,</span>
                   <span class="s">&#39;d174ab98d277d9f5a5611c2c9f419d9f&#39;</span><span class="p">)</span>
</div>
    <span class="nd">@unittest.skipIf</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span> <span class="o">&lt;</span> <span class="n">_4G</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;test cannot run on 32-bit systems&#39;</span><span class="p">)</span>
    <span class="nd">@bigmemtest</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">_4G</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="n">memuse</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dry_run</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_case_md5_huge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;md5&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;A&#39;</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="s">&#39;c9af2dff37468ce5dfee8f2cfc0a9c6d&#39;</span><span class="p">)</span>

    <span class="nd">@unittest.skipIf</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span> <span class="o">&lt;</span> <span class="n">_4G</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;test cannot run on 32-bit systems&#39;</span><span class="p">)</span>
    <span class="nd">@bigmemtest</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">_4G</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">memuse</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dry_run</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_case_md5_uintmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;md5&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;A&#39;</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="s">&#39;28138d306ff1b8281f1a9067e1a1a2b3&#39;</span><span class="p">)</span>

    <span class="c"># use the three examples from Federal Information Processing Standards</span>
    <span class="c"># Publication 180-1, Secure Hash Standard,  1995 April 17</span>
    <span class="c"># http://www.itl.nist.gov/div897/pubs/fip180-1.htm</span>

<div class="viewcode-block" id="HashLibTestCase.test_case_sha1_0"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha1_0">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha1_0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha1&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">,</span>
                   <span class="s">&quot;da39a3ee5e6b4b0d3255bfef95601890afd80709&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha1_1"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha1_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha1_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha1&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;abc&quot;</span><span class="p">,</span>
                   <span class="s">&quot;a9993e364706816aba3e25717850c26c9cd0d89d&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha1_2"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha1_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha1_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha1&#39;</span><span class="p">,</span>
                   <span class="n">b</span><span class="s">&quot;abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq&quot;</span><span class="p">,</span>
                   <span class="s">&quot;84983e441c3bd26ebaae4aa1f95129e5e54670f1&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha1_3"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha1_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha1_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha1&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;a&quot;</span> <span class="o">*</span> <span class="mi">1000000</span><span class="p">,</span>
                   <span class="s">&quot;34aa973cd4c4daa4f61eeb2bdbad27316534016f&quot;</span><span class="p">)</span>


    <span class="c"># use the examples from Federal Information Processing Standards</span>
    <span class="c"># Publication 180-2, Secure Hash Standard,  2002 August 1</span>
    <span class="c"># http://csrc.nist.gov/publications/fips/fips180-2/fips180-2.pdf</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha224_0"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha224_0">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha224_0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha224&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">,</span>
          <span class="s">&quot;d14a028c2a3a2bc9476102bb288234c415a2b01f828ea62ac5b3e42f&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha224_1"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha224_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha224_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha224&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;abc&quot;</span><span class="p">,</span>
          <span class="s">&quot;23097d223405d8228642a477bda255b32aadbce4bda0b3f7e36c9da7&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha224_2"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha224_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha224_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha224&#39;</span><span class="p">,</span>
          <span class="n">b</span><span class="s">&quot;abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq&quot;</span><span class="p">,</span>
          <span class="s">&quot;75388b16512776cc5dba5da1fd890150b0c6455cb4f58b1952522525&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha224_3"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha224_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha224_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha224&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;a&quot;</span> <span class="o">*</span> <span class="mi">1000000</span><span class="p">,</span>
          <span class="s">&quot;20794655980c91d8bbb4c1ea97618a4bf03f42581948b2ee4ee7ad67&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha256_0"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha256_0">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha256_0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha256&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">,</span>
          <span class="s">&quot;e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha256_1"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha256_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha256_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha256&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;abc&quot;</span><span class="p">,</span>
          <span class="s">&quot;ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha256_2"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha256_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha256_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha256&#39;</span><span class="p">,</span>
          <span class="n">b</span><span class="s">&quot;abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq&quot;</span><span class="p">,</span>
          <span class="s">&quot;248d6a61d20638b8e5c026930c3e6039a33ce45964ff2167f6ecedd419db06c1&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha256_3"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha256_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha256_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha256&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;a&quot;</span> <span class="o">*</span> <span class="mi">1000000</span><span class="p">,</span>
          <span class="s">&quot;cdc76e5c9914fb9281a1c7e284d73e67f1809a48a497200e046d39ccc7112cd0&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha384_0"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha384_0">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha384_0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha384&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">,</span>
          <span class="s">&quot;38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da&quot;</span><span class="o">+</span>
          <span class="s">&quot;274edebfe76f65fbd51ad2f14898b95b&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha384_1"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha384_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha384_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha384&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;abc&quot;</span><span class="p">,</span>
          <span class="s">&quot;cb00753f45a35e8bb5a03d699ac65007272c32ab0eded1631a8b605a43ff5bed&quot;</span><span class="o">+</span>
          <span class="s">&quot;8086072ba1e7cc2358baeca134c825a7&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha384_2"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha384_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha384_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha384&#39;</span><span class="p">,</span>
                   <span class="n">b</span><span class="s">&quot;abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmn&quot;</span><span class="o">+</span>
                   <span class="n">b</span><span class="s">&quot;hijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu&quot;</span><span class="p">,</span>
          <span class="s">&quot;09330c33f71147e83d192fc782cd1b4753111b173b3b05d22fa08086e3b0f712&quot;</span><span class="o">+</span>
          <span class="s">&quot;fcc7c71a557e2db966c3e9fa91746039&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha384_3"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha384_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha384_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha384&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;a&quot;</span> <span class="o">*</span> <span class="mi">1000000</span><span class="p">,</span>
          <span class="s">&quot;9d0e1809716474cb086e834e310a4a1ced149e9c00f248527972cec5704c2a5b&quot;</span><span class="o">+</span>
          <span class="s">&quot;07b8b3dc38ecc4ebae97ddd87f3d8985&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha512_0"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha512_0">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha512_0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha512&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">,</span>
          <span class="s">&quot;cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce&quot;</span><span class="o">+</span>
          <span class="s">&quot;47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha512_1"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha512_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha512_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha512&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;abc&quot;</span><span class="p">,</span>
          <span class="s">&quot;ddaf35a193617abacc417349ae20413112e6fa4e89a97ea20a9eeee64b55d39a&quot;</span><span class="o">+</span>
          <span class="s">&quot;2192992a274fc1a836ba3c23a3feebbd454d4423643ce80e2a9ac94fa54ca49f&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha512_2"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha512_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha512_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha512&#39;</span><span class="p">,</span>
                   <span class="n">b</span><span class="s">&quot;abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmn&quot;</span><span class="o">+</span>
                   <span class="n">b</span><span class="s">&quot;hijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu&quot;</span><span class="p">,</span>
          <span class="s">&quot;8e959b75dae313da8cf4f72814fc143f8f7779c6eb9f7fa17299aeadb6889018&quot;</span><span class="o">+</span>
          <span class="s">&quot;501d289e4900f7e4331b99dec4b5433ac7d329eeb6dd26545e96e55b874be909&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HashLibTestCase.test_case_sha512_3"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_case_sha512_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_case_sha512_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha512&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;a&quot;</span> <span class="o">*</span> <span class="mi">1000000</span><span class="p">,</span>
          <span class="s">&quot;e718483d0ce769644e2e42c7bc15b4638e1f98b13b2044285632a803afa973eb&quot;</span><span class="o">+</span>
          <span class="s">&quot;de0ff244877ea60a4cb0432ce577c31beb009c5c2c49aa2e4eadb217ad8cc09b&quot;</span><span class="p">)</span>
</div>
    <span class="nd">@unittest.skipIf</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span> <span class="o">&lt;</span> <span class="n">_4G</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;test cannot run on 32-bit systems&#39;</span><span class="p">)</span>
    <span class="nd">@bigmemtest</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">_4G</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="n">memuse</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dry_run</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_case_sha3_224_huge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s">&#39;sha3_224&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;A&#39;</span><span class="o">*</span><span class="n">size</span><span class="p">,</span>
                   <span class="s">&#39;58ef60057c9dddb6a87477e9ace5a26f0d9db01881cf9b10a9f8c224&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="HashLibTestCase.test_gil"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_gil">[docs]</a>    <span class="k">def</span> <span class="nf">test_gil</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Check things work fine with an input larger than the size required</span>
        <span class="c"># for multithreaded operation (which is hardwired to 2048).</span>
        <span class="n">gil_minsize</span> <span class="o">=</span> <span class="mi">2048</span>

        <span class="k">for</span> <span class="n">cons</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_constructors</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">cons</span><span class="p">()</span>
            <span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;1&#39;</span><span class="p">)</span>
            <span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;#&#39;</span> <span class="o">*</span> <span class="n">gil_minsize</span><span class="p">)</span>
            <span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;1&#39;</span><span class="p">)</span>

            <span class="n">m</span> <span class="o">=</span> <span class="n">cons</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;x&#39;</span> <span class="o">*</span> <span class="n">gil_minsize</span><span class="p">)</span>
            <span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;1&#39;</span><span class="p">)</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span>
        <span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;1&#39;</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;#&#39;</span> <span class="o">*</span> <span class="n">gil_minsize</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(),</span> <span class="s">&#39;cb1e1a2cbc80be75e19935d621fb9b21&#39;</span><span class="p">)</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;x&#39;</span> <span class="o">*</span> <span class="n">gil_minsize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(),</span> <span class="s">&#39;cfb767f225d58469c5de3632a8803958&#39;</span><span class="p">)</span>
</div>
    <span class="nd">@unittest.skipUnless</span><span class="p">(</span><span class="n">threading</span><span class="p">,</span> <span class="s">&#39;Threading required for this test.&#39;</span><span class="p">)</span>
    <span class="nd">@support.reap_threads</span>
<div class="viewcode-block" id="HashLibTestCase.test_threaded_hashing"><a class="viewcode-back" href="../../test.html#test.test_hashlib.HashLibTestCase.test_threaded_hashing">[docs]</a>    <span class="k">def</span> <span class="nf">test_threaded_hashing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Updating the same hash object from several threads at once</span>
        <span class="c"># using data chunk sizes containing the same byte sequences.</span>
        <span class="c">#</span>
        <span class="c"># If the internal locks are working to prevent multiple</span>
        <span class="c"># updates on the same object from running at once, the resulting</span>
        <span class="c"># hash will be the same as doing it single threaded upfront.</span>
        <span class="n">hasher</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">()</span>
        <span class="n">num_threads</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">smallest_data</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;swineflu&#39;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">smallest_data</span><span class="o">*</span><span class="mi">200000</span>
        <span class="n">expected_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">data</span><span class="o">*</span><span class="n">num_threads</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">hash_in_chunks</span><span class="p">(</span><span class="n">chunk_size</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
            <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="n">hasher</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span><span class="o">+</span><span class="n">chunk_size</span><span class="p">])</span>
                <span class="n">index</span> <span class="o">+=</span> <span class="n">chunk_size</span>
            <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

        <span class="n">events</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">threadnum</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_threads</span><span class="p">):</span>
            <span class="n">chunk_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">threadnum</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="n">chunk_size</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">chunk_size</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">smallest_data</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
            <span class="n">events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">hash_in_chunks</span><span class="p">,</span>
                             <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">chunk_size</span><span class="p">,</span> <span class="n">event</span><span class="p">))</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expected_hash</span><span class="p">,</span> <span class="n">hasher</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())</span>

</div></div>
<div class="viewcode-block" id="KDFTests"><a class="viewcode-back" href="../../test.html#test.test_hashlib.KDFTests">[docs]</a><span class="k">class</span> <span class="nc">KDFTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="n">pbkdf2_test_vectors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">b</span><span class="s">&#39;password&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;salt&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
        <span class="p">(</span><span class="n">b</span><span class="s">&#39;password&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;salt&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
        <span class="p">(</span><span class="n">b</span><span class="s">&#39;password&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;salt&#39;</span><span class="p">,</span> <span class="mi">4096</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
        <span class="c"># too slow, it takes over a minute on a fast CPU.</span>
        <span class="c">#(b&#39;password&#39;, b&#39;salt&#39;, 16777216, None),</span>
        <span class="p">(</span><span class="n">b</span><span class="s">&#39;passwordPASSWORDpassword&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;saltSALTsaltSALTsaltSALTsaltSALTsalt&#39;</span><span class="p">,</span>
         <span class="mi">4096</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="n">b</span><span class="s">&#39;pass</span><span class="se">\0</span><span class="s">word&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;sa</span><span class="se">\0</span><span class="s">lt&#39;</span><span class="p">,</span> <span class="mi">4096</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">pbkdf2_results</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&quot;sha1&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="c"># offical test vectors from RFC 6070</span>
            <span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;0c60c80f961f0e71f3a9b524af6012062fe037a6&#39;</span><span class="p">),</span> <span class="bp">None</span><span class="p">),</span>
            <span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;ea6c014dc72d6f8ccd1ed92ace1d41f0d8de8957&#39;</span><span class="p">),</span> <span class="bp">None</span><span class="p">),</span>
            <span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;4b007901b765489abead49d926f721d065a429c1&#39;</span><span class="p">),</span> <span class="bp">None</span><span class="p">),</span>
            <span class="c">#(bytes.fromhex(&#39;eefe3d61cd4da4e4e9945b3d6ba2158c2634e984&#39;), None),</span>
            <span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;3d2eec4fe41c849b80c8d83662c0e44a8b291a964c&#39;</span>
                           <span class="s">&#39;f2f07038&#39;</span><span class="p">),</span> <span class="mi">25</span><span class="p">),</span>
            <span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;56fa6aa75548099dcc37d7f03425e0c3&#39;</span><span class="p">),</span> <span class="bp">None</span><span class="p">),],</span>
        <span class="s">&quot;sha256&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;120fb6cffcf8b32c43e7225256c4f837&#39;</span>
                           <span class="s">&#39;a86548c92ccc35480805987cb70be17b&#39;</span><span class="p">),</span> <span class="bp">None</span><span class="p">),</span>
            <span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;ae4d0c95af6b46d32d0adff928f06dd0&#39;</span>
                           <span class="s">&#39;2a303f8ef3c251dfd6e2d85a95474c43&#39;</span><span class="p">),</span> <span class="bp">None</span><span class="p">),</span>
            <span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;c5e478d59288c841aa530db6845c4c8d&#39;</span>
                           <span class="s">&#39;962893a001ce4e11a4963873aa98134a&#39;</span><span class="p">),</span> <span class="bp">None</span><span class="p">),</span>
            <span class="c">#(bytes.fromhex(&#39;cf81c66fe8cfc04d1f31ecb65dab4089&#39;</span>
            <span class="c">#               &#39;f7f179e89b3b0bcb17ad10e3ac6eba46&#39;), None),</span>
            <span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;348c89dbcbd32b2f32d814b8116e84cf2b17&#39;</span>
                           <span class="s">&#39;347ebc1800181c4e2a1fb8dd53e1c635518c7dac47e9&#39;</span><span class="p">),</span> <span class="mi">40</span><span class="p">),</span>
            <span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;89b69d0516f829893c696226650a8687&#39;</span><span class="p">),</span> <span class="bp">None</span><span class="p">),],</span>
        <span class="s">&quot;sha512&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;867f70cf1ade02cff3752599a3a53dc4af34c7a669815ae5&#39;</span>
                           <span class="s">&#39;d513554e1c8cf252c02d470a285a0501bad999bfe943c08f&#39;</span>
                           <span class="s">&#39;050235d7d68b1da55e63f73b60a57fce&#39;</span><span class="p">),</span> <span class="bp">None</span><span class="p">),</span>
            <span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;e1d9c16aa681708a45f5c7c4e215ceb66e011a2e9f004071&#39;</span>
                           <span class="s">&#39;3f18aefdb866d53cf76cab2868a39b9f7840edce4fef5a82&#39;</span>
                           <span class="s">&#39;be67335c77a6068e04112754f27ccf4e&#39;</span><span class="p">),</span> <span class="bp">None</span><span class="p">),</span>
            <span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;d197b1b33db0143e018b12f3d1d1479e6cdebdcc97c5c0f8&#39;</span>
                           <span class="s">&#39;7f6902e072f457b5143f30602641b3d55cd335988cb36b84&#39;</span>
                           <span class="s">&#39;376060ecd532e039b742a239434af2d5&#39;</span><span class="p">),</span> <span class="bp">None</span><span class="p">),</span>
            <span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;8c0511f4c6e597c6ac6315d8f0362e225f3c501495ba23b8&#39;</span>
                           <span class="s">&#39;68c005174dc4ee71115b59f9e60cd9532fa33e0f75aefe30&#39;</span>
                           <span class="s">&#39;225c583a186cd82bd4daea9724a3d3b8&#39;</span><span class="p">),</span> <span class="mi">64</span><span class="p">),</span>
            <span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;9d9e9c4cd21fe4be24d5b8244c759665&#39;</span><span class="p">),</span> <span class="bp">None</span><span class="p">),],</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_test_pbkdf2_hmac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbkdf2</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">digest_name</span><span class="p">,</span> <span class="n">results</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pbkdf2_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vector</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pbkdf2_test_vectors</span><span class="p">):</span>
                <span class="n">password</span><span class="p">,</span> <span class="n">salt</span><span class="p">,</span> <span class="n">rounds</span><span class="p">,</span> <span class="n">dklen</span> <span class="o">=</span> <span class="n">vector</span>
                <span class="n">expected</span><span class="p">,</span> <span class="n">overwrite_dklen</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">overwrite_dklen</span><span class="p">:</span>
                    <span class="n">dklen</span> <span class="o">=</span> <span class="n">overwrite_dklen</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">pbkdf2</span><span class="p">(</span><span class="n">digest_name</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">salt</span><span class="p">,</span> <span class="n">rounds</span><span class="p">,</span> <span class="n">dklen</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span>
                                 <span class="p">(</span><span class="n">digest_name</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">salt</span><span class="p">,</span> <span class="n">rounds</span><span class="p">,</span> <span class="n">dklen</span><span class="p">))</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">pbkdf2</span><span class="p">(</span><span class="n">digest_name</span><span class="p">,</span> <span class="n">memoryview</span><span class="p">(</span><span class="n">password</span><span class="p">),</span>
                             <span class="n">memoryview</span><span class="p">(</span><span class="n">salt</span><span class="p">),</span> <span class="n">rounds</span><span class="p">,</span> <span class="n">dklen</span><span class="p">)</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">pbkdf2</span><span class="p">(</span><span class="n">digest_name</span><span class="p">,</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">password</span><span class="p">),</span>
                             <span class="nb">bytearray</span><span class="p">(</span><span class="n">salt</span><span class="p">),</span> <span class="n">rounds</span><span class="p">,</span> <span class="n">dklen</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">dklen</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">pbkdf2</span><span class="p">(</span><span class="n">digest_name</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">salt</span><span class="p">,</span> <span class="n">rounds</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span>
                                     <span class="p">(</span><span class="n">digest_name</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">salt</span><span class="p">,</span> <span class="n">rounds</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">pbkdf2</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;sha1&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;pass&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;salt&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">pbkdf2</span><span class="p">,</span> <span class="s">&#39;sha1&#39;</span><span class="p">,</span> <span class="s">&#39;pass&#39;</span><span class="p">,</span> <span class="s">&#39;salt&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">pbkdf2</span><span class="p">,</span> <span class="s">&#39;sha1&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;pass&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;salt&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">pbkdf2</span><span class="p">,</span> <span class="s">&#39;sha1&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;pass&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;salt&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">pbkdf2</span><span class="p">,</span> <span class="s">&#39;sha1&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;pass&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;salt&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">pbkdf2</span><span class="p">,</span> <span class="s">&#39;sha1&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;pass&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;salt&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="s">&#39;unsupported hash type&#39;</span><span class="p">):</span>
            <span class="n">pbkdf2</span><span class="p">(</span><span class="s">&#39;unknown&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;pass&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;salt&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<div class="viewcode-block" id="KDFTests.test_pbkdf2_hmac_py"><a class="viewcode-back" href="../../test.html#test.test_hashlib.KDFTests.test_pbkdf2_hmac_py">[docs]</a>    <span class="k">def</span> <span class="nf">test_pbkdf2_hmac_py</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_test_pbkdf2_hmac</span><span class="p">(</span><span class="n">py_hashlib</span><span class="o">.</span><span class="n">pbkdf2_hmac</span><span class="p">)</span>
</div>
    <span class="nd">@unittest.skipUnless</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">c_hashlib</span><span class="p">,</span> <span class="s">&#39;pbkdf2_hmac&#39;</span><span class="p">),</span>
                     <span class="s">&#39;   test requires OpenSSL &gt; 1.0&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="KDFTests.test_pbkdf2_hmac_c"><a class="viewcode-back" href="../../test.html#test.test_hashlib.KDFTests.test_pbkdf2_hmac_c">[docs]</a>    <span class="k">def</span> <span class="nf">test_pbkdf2_hmac_c</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_test_pbkdf2_hmac</span><span class="p">(</span><span class="n">c_hashlib</span><span class="o">.</span><span class="n">pbkdf2_hmac</span><span class="p">)</span>

</div></div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>