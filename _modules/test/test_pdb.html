

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_pdb &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_pdb</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_pdb</h1><div class="highlight"><pre>
<span class="c"># A test suite for pdb; not very comprehensive at the moment.</span>

<span class="kn">import</span> <span class="nn">doctest</span>
<span class="kn">import</span> <span class="nn">pdb</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">types</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">textwrap</span>

<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">support</span>
<span class="c"># This little helper class is essential for testing pdb under doctest.</span>
<span class="kn">from</span> <span class="nn">test.test_doctest</span> <span class="kn">import</span> <span class="n">_FakeInput</span>


<div class="viewcode-block" id="PdbTestInput"><a class="viewcode-back" href="../../test.html#test.test_pdb.PdbTestInput">[docs]</a><span class="k">class</span> <span class="nc">PdbTestInput</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Context manager that makes testing Pdb in doctests easier.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="nb">input</span>

    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">real_stdin</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span> <span class="o">=</span> <span class="n">_FakeInput</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orig_trace</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettrace</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">&#39;gettrace&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">exc</span><span class="p">):</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_stdin</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_trace</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">settrace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">orig_trace</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="test_pdb_displayhook"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_pdb_displayhook">[docs]</a><span class="k">def</span> <span class="nf">test_pdb_displayhook</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;This tests the custom displayhook for pdb.</span>

<span class="sd">    &gt;&gt;&gt; def test_function(foo, bar):</span>
<span class="sd">    ...     import pdb; pdb.Pdb(nosigint=True).set_trace()</span>
<span class="sd">    ...     pass</span>

<span class="sd">    &gt;&gt;&gt; with PdbTestInput([</span>
<span class="sd">    ...     &#39;foo&#39;,</span>
<span class="sd">    ...     &#39;bar&#39;,</span>
<span class="sd">    ...     &#39;for i in range(5): print(i)&#39;,</span>
<span class="sd">    ...     &#39;continue&#39;,</span>
<span class="sd">    ... ]):</span>
<span class="sd">    ...     test_function(1, None)</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_displayhook[0]&gt;(3)test_function()</span>
<span class="sd">    -&gt; pass</span>
<span class="sd">    (Pdb) foo</span>
<span class="sd">    1</span>
<span class="sd">    (Pdb) bar</span>
<span class="sd">    (Pdb) for i in range(5): print(i)</span>
<span class="sd">    0</span>
<span class="sd">    1</span>
<span class="sd">    2</span>
<span class="sd">    3</span>
<span class="sd">    4</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<div class="viewcode-block" id="test_pdb_basic_commands"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_pdb_basic_commands">[docs]</a><span class="k">def</span> <span class="nf">test_pdb_basic_commands</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test the basic commands of pdb.</span>

<span class="sd">    &gt;&gt;&gt; def test_function_2(foo, bar=&#39;default&#39;):</span>
<span class="sd">    ...     print(foo)</span>
<span class="sd">    ...     for i in range(5):</span>
<span class="sd">    ...         print(i)</span>
<span class="sd">    ...     print(bar)</span>
<span class="sd">    ...     for i in range(10):</span>
<span class="sd">    ...         never_executed</span>
<span class="sd">    ...     print(&#39;after for&#39;)</span>
<span class="sd">    ...     print(&#39;...&#39;)</span>
<span class="sd">    ...     return foo.upper()</span>

<span class="sd">    &gt;&gt;&gt; def test_function():</span>
<span class="sd">    ...     import pdb; pdb.Pdb(nosigint=True).set_trace()</span>
<span class="sd">    ...     ret = test_function_2(&#39;baz&#39;)</span>
<span class="sd">    ...     print(ret)</span>

<span class="sd">    &gt;&gt;&gt; with PdbTestInput([  # doctest: +ELLIPSIS, +NORMALIZE_WHITESPACE</span>
<span class="sd">    ...     &#39;step&#39;,       # entering the function call</span>
<span class="sd">    ...     &#39;args&#39;,       # display function args</span>
<span class="sd">    ...     &#39;list&#39;,       # list function source</span>
<span class="sd">    ...     &#39;bt&#39;,         # display backtrace</span>
<span class="sd">    ...     &#39;up&#39;,         # step up to test_function()</span>
<span class="sd">    ...     &#39;down&#39;,       # step down to test_function_2() again</span>
<span class="sd">    ...     &#39;next&#39;,       # stepping to print(foo)</span>
<span class="sd">    ...     &#39;next&#39;,       # stepping to the for loop</span>
<span class="sd">    ...     &#39;step&#39;,       # stepping into the for loop</span>
<span class="sd">    ...     &#39;until&#39;,      # continuing until out of the for loop</span>
<span class="sd">    ...     &#39;next&#39;,       # executing the print(bar)</span>
<span class="sd">    ...     &#39;jump 8&#39;,     # jump over second for loop</span>
<span class="sd">    ...     &#39;return&#39;,     # return out of function</span>
<span class="sd">    ...     &#39;retval&#39;,     # display return value</span>
<span class="sd">    ...     &#39;continue&#39;,</span>
<span class="sd">    ... ]):</span>
<span class="sd">    ...    test_function()</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_basic_commands[1]&gt;(3)test_function()</span>
<span class="sd">    -&gt; ret = test_function_2(&#39;baz&#39;)</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    --Call--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_basic_commands[0]&gt;(1)test_function_2()</span>
<span class="sd">    -&gt; def test_function_2(foo, bar=&#39;default&#39;):</span>
<span class="sd">    (Pdb) args</span>
<span class="sd">    foo = &#39;baz&#39;</span>
<span class="sd">    bar = &#39;default&#39;</span>
<span class="sd">    (Pdb) list</span>
<span class="sd">      1  -&gt;     def test_function_2(foo, bar=&#39;default&#39;):</span>
<span class="sd">      2             print(foo)</span>
<span class="sd">      3             for i in range(5):</span>
<span class="sd">      4                 print(i)</span>
<span class="sd">      5             print(bar)</span>
<span class="sd">      6             for i in range(10):</span>
<span class="sd">      7                 never_executed</span>
<span class="sd">      8             print(&#39;after for&#39;)</span>
<span class="sd">      9             print(&#39;...&#39;)</span>
<span class="sd">     10             return foo.upper()</span>
<span class="sd">    [EOF]</span>
<span class="sd">    (Pdb) bt</span>
<span class="sd">    ...</span>
<span class="sd">      &lt;doctest test.test_pdb.test_pdb_basic_commands[2]&gt;(18)&lt;module&gt;()</span>
<span class="sd">    -&gt; test_function()</span>
<span class="sd">      &lt;doctest test.test_pdb.test_pdb_basic_commands[1]&gt;(3)test_function()</span>
<span class="sd">    -&gt; ret = test_function_2(&#39;baz&#39;)</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_basic_commands[0]&gt;(1)test_function_2()</span>
<span class="sd">    -&gt; def test_function_2(foo, bar=&#39;default&#39;):</span>
<span class="sd">    (Pdb) up</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_basic_commands[1]&gt;(3)test_function()</span>
<span class="sd">    -&gt; ret = test_function_2(&#39;baz&#39;)</span>
<span class="sd">    (Pdb) down</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_basic_commands[0]&gt;(1)test_function_2()</span>
<span class="sd">    -&gt; def test_function_2(foo, bar=&#39;default&#39;):</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_basic_commands[0]&gt;(2)test_function_2()</span>
<span class="sd">    -&gt; print(foo)</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    baz</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_basic_commands[0]&gt;(3)test_function_2()</span>
<span class="sd">    -&gt; for i in range(5):</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_basic_commands[0]&gt;(4)test_function_2()</span>
<span class="sd">    -&gt; print(i)</span>
<span class="sd">    (Pdb) until</span>
<span class="sd">    0</span>
<span class="sd">    1</span>
<span class="sd">    2</span>
<span class="sd">    3</span>
<span class="sd">    4</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_basic_commands[0]&gt;(5)test_function_2()</span>
<span class="sd">    -&gt; print(bar)</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    default</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_basic_commands[0]&gt;(6)test_function_2()</span>
<span class="sd">    -&gt; for i in range(10):</span>
<span class="sd">    (Pdb) jump 8</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_basic_commands[0]&gt;(8)test_function_2()</span>
<span class="sd">    -&gt; print(&#39;after for&#39;)</span>
<span class="sd">    (Pdb) return</span>
<span class="sd">    after for</span>
<span class="sd">    ...</span>
<span class="sd">    --Return--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_basic_commands[0]&gt;(10)test_function_2()-&gt;&#39;BAZ&#39;</span>
<span class="sd">    -&gt; return foo.upper()</span>
<span class="sd">    (Pdb) retval</span>
<span class="sd">    &#39;BAZ&#39;</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    BAZ</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<div class="viewcode-block" id="test_pdb_breakpoint_commands"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_pdb_breakpoint_commands">[docs]</a><span class="k">def</span> <span class="nf">test_pdb_breakpoint_commands</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test basic commands related to breakpoints.</span>

<span class="sd">    &gt;&gt;&gt; def test_function():</span>
<span class="sd">    ...     import pdb; pdb.Pdb(nosigint=True).set_trace()</span>
<span class="sd">    ...     print(1)</span>
<span class="sd">    ...     print(2)</span>
<span class="sd">    ...     print(3)</span>
<span class="sd">    ...     print(4)</span>

<span class="sd">    First, need to clear bdb state that might be left over from previous tests.</span>
<span class="sd">    Otherwise, the new breakpoints might get assigned different numbers.</span>

<span class="sd">    &gt;&gt;&gt; from bdb import Breakpoint</span>
<span class="sd">    &gt;&gt;&gt; Breakpoint.next = 1</span>
<span class="sd">    &gt;&gt;&gt; Breakpoint.bplist = {}</span>
<span class="sd">    &gt;&gt;&gt; Breakpoint.bpbynumber = [None]</span>

<span class="sd">    Now test the breakpoint commands.  NORMALIZE_WHITESPACE is needed because</span>
<span class="sd">    the breakpoint list outputs a tab for the &quot;stop only&quot; and &quot;ignore next&quot;</span>
<span class="sd">    lines, which we don&#39;t want to put in here.</span>

<span class="sd">    &gt;&gt;&gt; with PdbTestInput([  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">    ...     &#39;break 3&#39;,</span>
<span class="sd">    ...     &#39;disable 1&#39;,</span>
<span class="sd">    ...     &#39;ignore 1 10&#39;,</span>
<span class="sd">    ...     &#39;condition 1 1 &lt; 2&#39;,</span>
<span class="sd">    ...     &#39;break 4&#39;,</span>
<span class="sd">    ...     &#39;break 4&#39;,</span>
<span class="sd">    ...     &#39;break&#39;,</span>
<span class="sd">    ...     &#39;clear 3&#39;,</span>
<span class="sd">    ...     &#39;break&#39;,</span>
<span class="sd">    ...     &#39;condition 1&#39;,</span>
<span class="sd">    ...     &#39;enable 1&#39;,</span>
<span class="sd">    ...     &#39;clear 1&#39;,</span>
<span class="sd">    ...     &#39;commands 2&#39;,</span>
<span class="sd">    ...     &#39;p &quot;42&quot;&#39;,</span>
<span class="sd">    ...     &#39;print(&quot;42&quot;, 7*6)&#39;,     # Issue 18764 (not about breakpoints)</span>
<span class="sd">    ...     &#39;end&#39;,</span>
<span class="sd">    ...     &#39;continue&#39;,  # will stop at breakpoint 2 (line 4)</span>
<span class="sd">    ...     &#39;clear&#39;,     # clear all!</span>
<span class="sd">    ...     &#39;y&#39;,</span>
<span class="sd">    ...     &#39;tbreak 5&#39;,</span>
<span class="sd">    ...     &#39;continue&#39;,  # will stop at temporary breakpoint</span>
<span class="sd">    ...     &#39;break&#39;,     # make sure breakpoint is gone</span>
<span class="sd">    ...     &#39;continue&#39;,</span>
<span class="sd">    ... ]):</span>
<span class="sd">    ...    test_function()</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;(3)test_function()</span>
<span class="sd">    -&gt; print(1)</span>
<span class="sd">    (Pdb) break 3</span>
<span class="sd">    Breakpoint 1 at &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;:3</span>
<span class="sd">    (Pdb) disable 1</span>
<span class="sd">    Disabled breakpoint 1 at &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;:3</span>
<span class="sd">    (Pdb) ignore 1 10</span>
<span class="sd">    Will ignore next 10 crossings of breakpoint 1.</span>
<span class="sd">    (Pdb) condition 1 1 &lt; 2</span>
<span class="sd">    New condition set for breakpoint 1.</span>
<span class="sd">    (Pdb) break 4</span>
<span class="sd">    Breakpoint 2 at &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;:4</span>
<span class="sd">    (Pdb) break 4</span>
<span class="sd">    Breakpoint 3 at &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;:4</span>
<span class="sd">    (Pdb) break</span>
<span class="sd">    Num Type         Disp Enb   Where</span>
<span class="sd">    1   breakpoint   keep no    at &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;:3</span>
<span class="sd">            stop only if 1 &lt; 2</span>
<span class="sd">            ignore next 10 hits</span>
<span class="sd">    2   breakpoint   keep yes   at &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;:4</span>
<span class="sd">    3   breakpoint   keep yes   at &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;:4</span>
<span class="sd">    (Pdb) clear 3</span>
<span class="sd">    Deleted breakpoint 3 at &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;:4</span>
<span class="sd">    (Pdb) break</span>
<span class="sd">    Num Type         Disp Enb   Where</span>
<span class="sd">    1   breakpoint   keep no    at &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;:3</span>
<span class="sd">            stop only if 1 &lt; 2</span>
<span class="sd">            ignore next 10 hits</span>
<span class="sd">    2   breakpoint   keep yes   at &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;:4</span>
<span class="sd">    (Pdb) condition 1</span>
<span class="sd">    Breakpoint 1 is now unconditional.</span>
<span class="sd">    (Pdb) enable 1</span>
<span class="sd">    Enabled breakpoint 1 at &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;:3</span>
<span class="sd">    (Pdb) clear 1</span>
<span class="sd">    Deleted breakpoint 1 at &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;:3</span>
<span class="sd">    (Pdb) commands 2</span>
<span class="sd">    (com) p &quot;42&quot;</span>
<span class="sd">    (com) print(&quot;42&quot;, 7*6)</span>
<span class="sd">    (com) end</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    1</span>
<span class="sd">    &#39;42&#39;</span>
<span class="sd">    42 42</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;(4)test_function()</span>
<span class="sd">    -&gt; print(2)</span>
<span class="sd">    (Pdb) clear</span>
<span class="sd">    Clear all breaks? y</span>
<span class="sd">    Deleted breakpoint 2 at &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;:4</span>
<span class="sd">    (Pdb) tbreak 5</span>
<span class="sd">    Breakpoint 4 at &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;:5</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    2</span>
<span class="sd">    Deleted breakpoint 4 at &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;:5</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_breakpoint_commands[0]&gt;(5)test_function()</span>
<span class="sd">    -&gt; print(3)</span>
<span class="sd">    (Pdb) break</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    3</span>
<span class="sd">    4</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<div class="viewcode-block" id="do_nothing"><a class="viewcode-back" href="../../test.html#test.test_pdb.do_nothing">[docs]</a><span class="k">def</span> <span class="nf">do_nothing</span><span class="p">():</span>
    <span class="k">pass</span>
</div>
<div class="viewcode-block" id="do_something"><a class="viewcode-back" href="../../test.html#test.test_pdb.do_something">[docs]</a><span class="k">def</span> <span class="nf">do_something</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="test_list_commands"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_list_commands">[docs]</a><span class="k">def</span> <span class="nf">test_list_commands</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test the list and source commands of pdb.</span>

<span class="sd">    &gt;&gt;&gt; def test_function_2(foo):</span>
<span class="sd">    ...     import test.test_pdb</span>
<span class="sd">    ...     test.test_pdb.do_nothing()</span>
<span class="sd">    ...     &#39;some...&#39;</span>
<span class="sd">    ...     &#39;more...&#39;</span>
<span class="sd">    ...     &#39;code...&#39;</span>
<span class="sd">    ...     &#39;to...&#39;</span>
<span class="sd">    ...     &#39;make...&#39;</span>
<span class="sd">    ...     &#39;a...&#39;</span>
<span class="sd">    ...     &#39;long...&#39;</span>
<span class="sd">    ...     &#39;listing...&#39;</span>
<span class="sd">    ...     &#39;useful...&#39;</span>
<span class="sd">    ...     &#39;...&#39;</span>
<span class="sd">    ...     &#39;...&#39;</span>
<span class="sd">    ...     return foo</span>

<span class="sd">    &gt;&gt;&gt; def test_function():</span>
<span class="sd">    ...     import pdb; pdb.Pdb(nosigint=True).set_trace()</span>
<span class="sd">    ...     ret = test_function_2(&#39;baz&#39;)</span>

<span class="sd">    &gt;&gt;&gt; with PdbTestInput([  # doctest: +ELLIPSIS, +NORMALIZE_WHITESPACE</span>
<span class="sd">    ...     &#39;list&#39;,      # list first function</span>
<span class="sd">    ...     &#39;step&#39;,      # step into second function</span>
<span class="sd">    ...     &#39;list&#39;,      # list second function</span>
<span class="sd">    ...     &#39;list&#39;,      # continue listing to EOF</span>
<span class="sd">    ...     &#39;list 1,3&#39;,  # list specific lines</span>
<span class="sd">    ...     &#39;list x&#39;,    # invalid argument</span>
<span class="sd">    ...     &#39;next&#39;,      # step to import</span>
<span class="sd">    ...     &#39;next&#39;,      # step over import</span>
<span class="sd">    ...     &#39;step&#39;,      # step into do_nothing</span>
<span class="sd">    ...     &#39;longlist&#39;,  # list all lines</span>
<span class="sd">    ...     &#39;source do_something&#39;,  # list all lines of function</span>
<span class="sd">    ...     &#39;source fooxxx&#39;,        # something that doesn&#39;t exit</span>
<span class="sd">    ...     &#39;continue&#39;,</span>
<span class="sd">    ... ]):</span>
<span class="sd">    ...    test_function()</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_list_commands[1]&gt;(3)test_function()</span>
<span class="sd">    -&gt; ret = test_function_2(&#39;baz&#39;)</span>
<span class="sd">    (Pdb) list</span>
<span class="sd">      1         def test_function():</span>
<span class="sd">      2             import pdb; pdb.Pdb(nosigint=True).set_trace()</span>
<span class="sd">      3  -&gt;         ret = test_function_2(&#39;baz&#39;)</span>
<span class="sd">    [EOF]</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    --Call--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_list_commands[0]&gt;(1)test_function_2()</span>
<span class="sd">    -&gt; def test_function_2(foo):</span>
<span class="sd">    (Pdb) list</span>
<span class="sd">      1  -&gt;     def test_function_2(foo):</span>
<span class="sd">      2             import test.test_pdb</span>
<span class="sd">      3             test.test_pdb.do_nothing()</span>
<span class="sd">      4             &#39;some...&#39;</span>
<span class="sd">      5             &#39;more...&#39;</span>
<span class="sd">      6             &#39;code...&#39;</span>
<span class="sd">      7             &#39;to...&#39;</span>
<span class="sd">      8             &#39;make...&#39;</span>
<span class="sd">      9             &#39;a...&#39;</span>
<span class="sd">     10             &#39;long...&#39;</span>
<span class="sd">     11             &#39;listing...&#39;</span>
<span class="sd">    (Pdb) list</span>
<span class="sd">     12             &#39;useful...&#39;</span>
<span class="sd">     13             &#39;...&#39;</span>
<span class="sd">     14             &#39;...&#39;</span>
<span class="sd">     15             return foo</span>
<span class="sd">    [EOF]</span>
<span class="sd">    (Pdb) list 1,3</span>
<span class="sd">      1  -&gt;     def test_function_2(foo):</span>
<span class="sd">      2             import test.test_pdb</span>
<span class="sd">      3             test.test_pdb.do_nothing()</span>
<span class="sd">    (Pdb) list x</span>
<span class="sd">    *** ...</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_list_commands[0]&gt;(2)test_function_2()</span>
<span class="sd">    -&gt; import test.test_pdb</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_list_commands[0]&gt;(3)test_function_2()</span>
<span class="sd">    -&gt; test.test_pdb.do_nothing()</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    --Call--</span>
<span class="sd">    &gt; ...test_pdb.py(...)do_nothing()</span>
<span class="sd">    -&gt; def do_nothing():</span>
<span class="sd">    (Pdb) longlist</span>
<span class="sd">    ...  -&gt;     def do_nothing():</span>
<span class="sd">    ...             pass</span>
<span class="sd">    (Pdb) source do_something</span>
<span class="sd">    ...         def do_something():</span>
<span class="sd">    ...             print(42)</span>
<span class="sd">    (Pdb) source fooxxx</span>
<span class="sd">    *** ...</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<div class="viewcode-block" id="test_post_mortem"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_post_mortem">[docs]</a><span class="k">def</span> <span class="nf">test_post_mortem</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test post mortem traceback debugging.</span>

<span class="sd">    &gt;&gt;&gt; def test_function_2():</span>
<span class="sd">    ...     try:</span>
<span class="sd">    ...         1/0</span>
<span class="sd">    ...     finally:</span>
<span class="sd">    ...         print(&#39;Exception!&#39;)</span>

<span class="sd">    &gt;&gt;&gt; def test_function():</span>
<span class="sd">    ...     import pdb; pdb.Pdb(nosigint=True).set_trace()</span>
<span class="sd">    ...     test_function_2()</span>
<span class="sd">    ...     print(&#39;Not reached.&#39;)</span>

<span class="sd">    &gt;&gt;&gt; with PdbTestInput([  # doctest: +ELLIPSIS, +NORMALIZE_WHITESPACE</span>
<span class="sd">    ...     &#39;next&#39;,      # step over exception-raising call</span>
<span class="sd">    ...     &#39;bt&#39;,        # get a backtrace</span>
<span class="sd">    ...     &#39;list&#39;,      # list code of test_function()</span>
<span class="sd">    ...     &#39;down&#39;,      # step into test_function_2()</span>
<span class="sd">    ...     &#39;list&#39;,      # list code of test_function_2()</span>
<span class="sd">    ...     &#39;continue&#39;,</span>
<span class="sd">    ... ]):</span>
<span class="sd">    ...    try:</span>
<span class="sd">    ...        test_function()</span>
<span class="sd">    ...    except ZeroDivisionError:</span>
<span class="sd">    ...        print(&#39;Correctly reraised.&#39;)</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_post_mortem[1]&gt;(3)test_function()</span>
<span class="sd">    -&gt; test_function_2()</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    Exception!</span>
<span class="sd">    ZeroDivisionError: division by zero</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_post_mortem[1]&gt;(3)test_function()</span>
<span class="sd">    -&gt; test_function_2()</span>
<span class="sd">    (Pdb) bt</span>
<span class="sd">    ...</span>
<span class="sd">      &lt;doctest test.test_pdb.test_post_mortem[2]&gt;(10)&lt;module&gt;()</span>
<span class="sd">    -&gt; test_function()</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_post_mortem[1]&gt;(3)test_function()</span>
<span class="sd">    -&gt; test_function_2()</span>
<span class="sd">      &lt;doctest test.test_pdb.test_post_mortem[0]&gt;(3)test_function_2()</span>
<span class="sd">    -&gt; 1/0</span>
<span class="sd">    (Pdb) list</span>
<span class="sd">      1         def test_function():</span>
<span class="sd">      2             import pdb; pdb.Pdb(nosigint=True).set_trace()</span>
<span class="sd">      3  -&gt;         test_function_2()</span>
<span class="sd">      4             print(&#39;Not reached.&#39;)</span>
<span class="sd">    [EOF]</span>
<span class="sd">    (Pdb) down</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_post_mortem[0]&gt;(3)test_function_2()</span>
<span class="sd">    -&gt; 1/0</span>
<span class="sd">    (Pdb) list</span>
<span class="sd">      1         def test_function_2():</span>
<span class="sd">      2             try:</span>
<span class="sd">      3  &gt;&gt;             1/0</span>
<span class="sd">      4             finally:</span>
<span class="sd">      5  -&gt;             print(&#39;Exception!&#39;)</span>
<span class="sd">    [EOF]</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    Correctly reraised.</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<div class="viewcode-block" id="test_pdb_skip_modules"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_pdb_skip_modules">[docs]</a><span class="k">def</span> <span class="nf">test_pdb_skip_modules</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;This illustrates the simple case of module skipping.</span>

<span class="sd">    &gt;&gt;&gt; def skip_module():</span>
<span class="sd">    ...     import string</span>
<span class="sd">    ...     import pdb; pdb.Pdb(skip=[&#39;stri*&#39;], nosigint=True).set_trace()</span>
<span class="sd">    ...     string.capwords(&#39;FOO&#39;)</span>

<span class="sd">    &gt;&gt;&gt; with PdbTestInput([</span>
<span class="sd">    ...     &#39;step&#39;,</span>
<span class="sd">    ...     &#39;continue&#39;,</span>
<span class="sd">    ... ]):</span>
<span class="sd">    ...     skip_module()</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_skip_modules[0]&gt;(4)skip_module()</span>
<span class="sd">    -&gt; string.capwords(&#39;FOO&#39;)</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    --Return--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_skip_modules[0]&gt;(4)skip_module()-&gt;None</span>
<span class="sd">    -&gt; string.capwords(&#39;FOO&#39;)</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    &quot;&quot;&quot;</span>


<span class="c"># Module for testing skipping of module that makes a callback</span></div>
<span class="n">mod</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">(</span><span class="s">&#39;module_to_skip&#39;</span><span class="p">)</span>
<span class="k">exec</span><span class="p">(</span><span class="s">&#39;def foo_pony(callback): x = 1; callback(); return None&#39;</span><span class="p">,</span> <span class="n">mod</span><span class="o">.</span><span class="n">__dict__</span><span class="p">)</span>


<div class="viewcode-block" id="test_pdb_skip_modules_with_callback"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_pdb_skip_modules_with_callback">[docs]</a><span class="k">def</span> <span class="nf">test_pdb_skip_modules_with_callback</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;This illustrates skipping of modules that call into other code.</span>

<span class="sd">    &gt;&gt;&gt; def skip_module():</span>
<span class="sd">    ...     def callback():</span>
<span class="sd">    ...         return None</span>
<span class="sd">    ...     import pdb; pdb.Pdb(skip=[&#39;module_to_skip*&#39;], nosigint=True).set_trace()</span>
<span class="sd">    ...     mod.foo_pony(callback)</span>

<span class="sd">    &gt;&gt;&gt; with PdbTestInput([</span>
<span class="sd">    ...     &#39;step&#39;,</span>
<span class="sd">    ...     &#39;step&#39;,</span>
<span class="sd">    ...     &#39;step&#39;,</span>
<span class="sd">    ...     &#39;step&#39;,</span>
<span class="sd">    ...     &#39;step&#39;,</span>
<span class="sd">    ...     &#39;continue&#39;,</span>
<span class="sd">    ... ]):</span>
<span class="sd">    ...     skip_module()</span>
<span class="sd">    ...     pass  # provides something to &quot;step&quot; to</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_skip_modules_with_callback[0]&gt;(5)skip_module()</span>
<span class="sd">    -&gt; mod.foo_pony(callback)</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    --Call--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_skip_modules_with_callback[0]&gt;(2)callback()</span>
<span class="sd">    -&gt; def callback():</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_skip_modules_with_callback[0]&gt;(3)callback()</span>
<span class="sd">    -&gt; return None</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    --Return--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_skip_modules_with_callback[0]&gt;(3)callback()-&gt;None</span>
<span class="sd">    -&gt; return None</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    --Return--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_skip_modules_with_callback[0]&gt;(5)skip_module()-&gt;None</span>
<span class="sd">    -&gt; mod.foo_pony(callback)</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_skip_modules_with_callback[1]&gt;(10)&lt;module&gt;()</span>
<span class="sd">    -&gt; pass  # provides something to &quot;step&quot; to</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<div class="viewcode-block" id="test_pdb_continue_in_bottomframe"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_pdb_continue_in_bottomframe">[docs]</a><span class="k">def</span> <span class="nf">test_pdb_continue_in_bottomframe</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test that &quot;continue&quot; and &quot;next&quot; work properly in bottom frame (issue #5294).</span>

<span class="sd">    &gt;&gt;&gt; def test_function():</span>
<span class="sd">    ...     import pdb, sys; inst = pdb.Pdb(nosigint=True)</span>
<span class="sd">    ...     inst.set_trace()</span>
<span class="sd">    ...     inst.botframe = sys._getframe()  # hackery to get the right botframe</span>
<span class="sd">    ...     print(1)</span>
<span class="sd">    ...     print(2)</span>
<span class="sd">    ...     print(3)</span>
<span class="sd">    ...     print(4)</span>

<span class="sd">    &gt;&gt;&gt; with PdbTestInput([  # doctest: +ELLIPSIS</span>
<span class="sd">    ...     &#39;next&#39;,</span>
<span class="sd">    ...     &#39;break 7&#39;,</span>
<span class="sd">    ...     &#39;continue&#39;,</span>
<span class="sd">    ...     &#39;next&#39;,</span>
<span class="sd">    ...     &#39;continue&#39;,</span>
<span class="sd">    ...     &#39;continue&#39;,</span>
<span class="sd">    ... ]):</span>
<span class="sd">    ...    test_function()</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_continue_in_bottomframe[0]&gt;(4)test_function()</span>
<span class="sd">    -&gt; inst.botframe = sys._getframe()  # hackery to get the right botframe</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_continue_in_bottomframe[0]&gt;(5)test_function()</span>
<span class="sd">    -&gt; print(1)</span>
<span class="sd">    (Pdb) break 7</span>
<span class="sd">    Breakpoint ... at &lt;doctest test.test_pdb.test_pdb_continue_in_bottomframe[0]&gt;:7</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    1</span>
<span class="sd">    2</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_continue_in_bottomframe[0]&gt;(7)test_function()</span>
<span class="sd">    -&gt; print(3)</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    3</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_continue_in_bottomframe[0]&gt;(8)test_function()</span>
<span class="sd">    -&gt; print(4)</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    4</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<div class="viewcode-block" id="pdb_invoke"><a class="viewcode-back" href="../../test.html#test.test_pdb.pdb_invoke">[docs]</a><span class="k">def</span> <span class="nf">pdb_invoke</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Run pdb.method(arg).&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pdb</span>
    <span class="nb">getattr</span><span class="p">(</span><span class="n">pdb</span><span class="o">.</span><span class="n">Pdb</span><span class="p">(</span><span class="n">nosigint</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span> <span class="n">method</span><span class="p">)(</span><span class="n">arg</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="test_pdb_run_with_incorrect_argument"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_pdb_run_with_incorrect_argument">[docs]</a><span class="k">def</span> <span class="nf">test_pdb_run_with_incorrect_argument</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Testing run and runeval with incorrect first argument.</span>

<span class="sd">    &gt;&gt;&gt; pti = PdbTestInput([&#39;continue&#39;,])</span>
<span class="sd">    &gt;&gt;&gt; with pti:</span>
<span class="sd">    ...     pdb_invoke(&#39;run&#39;, lambda x: x)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    TypeError: exec() arg 1 must be a string, bytes or code object</span>

<span class="sd">    &gt;&gt;&gt; with pti:</span>
<span class="sd">    ...     pdb_invoke(&#39;runeval&#39;, lambda x: x)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    TypeError: eval() arg 1 must be a string, bytes or code object</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<div class="viewcode-block" id="test_pdb_run_with_code_object"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_pdb_run_with_code_object">[docs]</a><span class="k">def</span> <span class="nf">test_pdb_run_with_code_object</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Testing run and runeval with code object as a first argument.</span>

<span class="sd">    &gt;&gt;&gt; with PdbTestInput([&#39;step&#39;,&#39;x&#39;, &#39;continue&#39;]):  # doctest: +ELLIPSIS</span>
<span class="sd">    ...     pdb_invoke(&#39;run&#39;, compile(&#39;x=1&#39;, &#39;&lt;string&gt;&#39;, &#39;exec&#39;))</span>
<span class="sd">    &gt; &lt;string&gt;(1)&lt;module&gt;()...</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    --Return--</span>
<span class="sd">    &gt; &lt;string&gt;(1)&lt;module&gt;()-&gt;None</span>
<span class="sd">    (Pdb) x</span>
<span class="sd">    1</span>
<span class="sd">    (Pdb) continue</span>

<span class="sd">    &gt;&gt;&gt; with PdbTestInput([&#39;x&#39;, &#39;continue&#39;]):</span>
<span class="sd">    ...     x=0</span>
<span class="sd">    ...     pdb_invoke(&#39;runeval&#39;, compile(&#39;x+1&#39;, &#39;&lt;string&gt;&#39;, &#39;eval&#39;))</span>
<span class="sd">    &gt; &lt;string&gt;(1)&lt;module&gt;()-&gt;None</span>
<span class="sd">    (Pdb) x</span>
<span class="sd">    1</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="test_next_until_return_at_return_event"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_next_until_return_at_return_event">[docs]</a><span class="k">def</span> <span class="nf">test_next_until_return_at_return_event</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test that pdb stops after a next/until/return issued at a return debug event.</span>

<span class="sd">    &gt;&gt;&gt; def test_function_2():</span>
<span class="sd">    ...     x = 1</span>
<span class="sd">    ...     x = 2</span>

<span class="sd">    &gt;&gt;&gt; def test_function():</span>
<span class="sd">    ...     import pdb; pdb.Pdb(nosigint=True).set_trace()</span>
<span class="sd">    ...     test_function_2()</span>
<span class="sd">    ...     test_function_2()</span>
<span class="sd">    ...     test_function_2()</span>
<span class="sd">    ...     end = 1</span>

<span class="sd">    &gt;&gt;&gt; from bdb import Breakpoint</span>
<span class="sd">    &gt;&gt;&gt; Breakpoint.next = 1</span>
<span class="sd">    &gt;&gt;&gt; with PdbTestInput([&#39;break test_function_2&#39;,</span>
<span class="sd">    ...                    &#39;continue&#39;,</span>
<span class="sd">    ...                    &#39;return&#39;,</span>
<span class="sd">    ...                    &#39;next&#39;,</span>
<span class="sd">    ...                    &#39;continue&#39;,</span>
<span class="sd">    ...                    &#39;return&#39;,</span>
<span class="sd">    ...                    &#39;until&#39;,</span>
<span class="sd">    ...                    &#39;continue&#39;,</span>
<span class="sd">    ...                    &#39;return&#39;,</span>
<span class="sd">    ...                    &#39;return&#39;,</span>
<span class="sd">    ...                    &#39;continue&#39;]):</span>
<span class="sd">    ...     test_function()</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_next_until_return_at_return_event[1]&gt;(3)test_function()</span>
<span class="sd">    -&gt; test_function_2()</span>
<span class="sd">    (Pdb) break test_function_2</span>
<span class="sd">    Breakpoint 1 at &lt;doctest test.test_pdb.test_next_until_return_at_return_event[0]&gt;:1</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_next_until_return_at_return_event[0]&gt;(2)test_function_2()</span>
<span class="sd">    -&gt; x = 1</span>
<span class="sd">    (Pdb) return</span>
<span class="sd">    --Return--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_next_until_return_at_return_event[0]&gt;(3)test_function_2()-&gt;None</span>
<span class="sd">    -&gt; x = 2</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_next_until_return_at_return_event[1]&gt;(4)test_function()</span>
<span class="sd">    -&gt; test_function_2()</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_next_until_return_at_return_event[0]&gt;(2)test_function_2()</span>
<span class="sd">    -&gt; x = 1</span>
<span class="sd">    (Pdb) return</span>
<span class="sd">    --Return--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_next_until_return_at_return_event[0]&gt;(3)test_function_2()-&gt;None</span>
<span class="sd">    -&gt; x = 2</span>
<span class="sd">    (Pdb) until</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_next_until_return_at_return_event[1]&gt;(5)test_function()</span>
<span class="sd">    -&gt; test_function_2()</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_next_until_return_at_return_event[0]&gt;(2)test_function_2()</span>
<span class="sd">    -&gt; x = 1</span>
<span class="sd">    (Pdb) return</span>
<span class="sd">    --Return--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_next_until_return_at_return_event[0]&gt;(3)test_function_2()-&gt;None</span>
<span class="sd">    -&gt; x = 2</span>
<span class="sd">    (Pdb) return</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_next_until_return_at_return_event[1]&gt;(6)test_function()</span>
<span class="sd">    -&gt; end = 1</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="test_pdb_next_command_for_generator"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_pdb_next_command_for_generator">[docs]</a><span class="k">def</span> <span class="nf">test_pdb_next_command_for_generator</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Testing skip unwindng stack on yield for generators for &quot;next&quot; command</span>

<span class="sd">    &gt;&gt;&gt; def test_gen():</span>
<span class="sd">    ...     yield 0</span>
<span class="sd">    ...     return 1</span>
<span class="sd">    ...     yield 2</span>

<span class="sd">    &gt;&gt;&gt; def test_function():</span>
<span class="sd">    ...     import pdb; pdb.Pdb(nosigint=True).set_trace()</span>
<span class="sd">    ...     it = test_gen()</span>
<span class="sd">    ...     try:</span>
<span class="sd">    ...         assert next(it) == 0</span>
<span class="sd">    ...         next(it)</span>
<span class="sd">    ...     except StopIteration as ex:</span>
<span class="sd">    ...         assert ex.value == 1</span>
<span class="sd">    ...     print(&quot;finished&quot;)</span>

<span class="sd">    &gt;&gt;&gt; with PdbTestInput([&#39;step&#39;,</span>
<span class="sd">    ...                    &#39;step&#39;,</span>
<span class="sd">    ...                    &#39;step&#39;,</span>
<span class="sd">    ...                    &#39;next&#39;,</span>
<span class="sd">    ...                    &#39;next&#39;,</span>
<span class="sd">    ...                    &#39;step&#39;,</span>
<span class="sd">    ...                    &#39;step&#39;,</span>
<span class="sd">    ...                    &#39;continue&#39;]):</span>
<span class="sd">    ...     test_function()</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_for_generator[1]&gt;(3)test_function()</span>
<span class="sd">    -&gt; it = test_gen()</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_for_generator[1]&gt;(4)test_function()</span>
<span class="sd">    -&gt; try:</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_for_generator[1]&gt;(5)test_function()</span>
<span class="sd">    -&gt; assert next(it) == 0</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    --Call--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_for_generator[0]&gt;(1)test_gen()</span>
<span class="sd">    -&gt; def test_gen():</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_for_generator[0]&gt;(2)test_gen()</span>
<span class="sd">    -&gt; yield 0</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_for_generator[0]&gt;(3)test_gen()</span>
<span class="sd">    -&gt; return 1</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    --Return--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_for_generator[0]&gt;(3)test_gen()-&gt;1</span>
<span class="sd">    -&gt; return 1</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    StopIteration: 1</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_for_generator[1]&gt;(6)test_function()</span>
<span class="sd">    -&gt; next(it)</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    finished</span>
<span class="sd">    &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="test_pdb_return_command_for_generator"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_pdb_return_command_for_generator">[docs]</a><span class="k">def</span> <span class="nf">test_pdb_return_command_for_generator</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Testing no unwindng stack on yield for generators</span>
<span class="sd">       for &quot;return&quot; command</span>

<span class="sd">    &gt;&gt;&gt; def test_gen():</span>
<span class="sd">    ...     yield 0</span>
<span class="sd">    ...     return 1</span>
<span class="sd">    ...     yield 2</span>

<span class="sd">    &gt;&gt;&gt; def test_function():</span>
<span class="sd">    ...     import pdb; pdb.Pdb(nosigint=True).set_trace()</span>
<span class="sd">    ...     it = test_gen()</span>
<span class="sd">    ...     try:</span>
<span class="sd">    ...         assert next(it) == 0</span>
<span class="sd">    ...         next(it)</span>
<span class="sd">    ...     except StopIteration as ex:</span>
<span class="sd">    ...         assert ex.value == 1</span>
<span class="sd">    ...     print(&quot;finished&quot;)</span>

<span class="sd">    &gt;&gt;&gt; with PdbTestInput([&#39;step&#39;,</span>
<span class="sd">    ...                    &#39;step&#39;,</span>
<span class="sd">    ...                    &#39;step&#39;,</span>
<span class="sd">    ...                    &#39;return&#39;,</span>
<span class="sd">    ...                    &#39;step&#39;,</span>
<span class="sd">    ...                    &#39;step&#39;,</span>
<span class="sd">    ...                    &#39;continue&#39;]):</span>
<span class="sd">    ...     test_function()</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_return_command_for_generator[1]&gt;(3)test_function()</span>
<span class="sd">    -&gt; it = test_gen()</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_return_command_for_generator[1]&gt;(4)test_function()</span>
<span class="sd">    -&gt; try:</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_return_command_for_generator[1]&gt;(5)test_function()</span>
<span class="sd">    -&gt; assert next(it) == 0</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    --Call--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_return_command_for_generator[0]&gt;(1)test_gen()</span>
<span class="sd">    -&gt; def test_gen():</span>
<span class="sd">    (Pdb) return</span>
<span class="sd">    StopIteration: 1</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_return_command_for_generator[1]&gt;(6)test_function()</span>
<span class="sd">    -&gt; next(it)</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_return_command_for_generator[1]&gt;(7)test_function()</span>
<span class="sd">    -&gt; except StopIteration as ex:</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_return_command_for_generator[1]&gt;(8)test_function()</span>
<span class="sd">    -&gt; assert ex.value == 1</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    finished</span>
<span class="sd">    &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="test_pdb_until_command_for_generator"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_pdb_until_command_for_generator">[docs]</a><span class="k">def</span> <span class="nf">test_pdb_until_command_for_generator</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Testing no unwindng stack on yield for generators</span>
<span class="sd">       for &quot;until&quot; command if target breakpoing is not reached</span>

<span class="sd">    &gt;&gt;&gt; def test_gen():</span>
<span class="sd">    ...     yield 0</span>
<span class="sd">    ...     yield 1</span>
<span class="sd">    ...     yield 2</span>

<span class="sd">    &gt;&gt;&gt; def test_function():</span>
<span class="sd">    ...     import pdb; pdb.Pdb(nosigint=True).set_trace()</span>
<span class="sd">    ...     for i in test_gen():</span>
<span class="sd">    ...         print(i)</span>
<span class="sd">    ...     print(&quot;finished&quot;)</span>

<span class="sd">    &gt;&gt;&gt; with PdbTestInput([&#39;step&#39;,</span>
<span class="sd">    ...                    &#39;until 4&#39;,</span>
<span class="sd">    ...                    &#39;step&#39;,</span>
<span class="sd">    ...                    &#39;step&#39;,</span>
<span class="sd">    ...                    &#39;continue&#39;]):</span>
<span class="sd">    ...     test_function()</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_until_command_for_generator[1]&gt;(3)test_function()</span>
<span class="sd">    -&gt; for i in test_gen():</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    --Call--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_until_command_for_generator[0]&gt;(1)test_gen()</span>
<span class="sd">    -&gt; def test_gen():</span>
<span class="sd">    (Pdb) until 4</span>
<span class="sd">    0</span>
<span class="sd">    1</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_until_command_for_generator[0]&gt;(4)test_gen()</span>
<span class="sd">    -&gt; yield 2</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    --Return--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_until_command_for_generator[0]&gt;(4)test_gen()-&gt;2</span>
<span class="sd">    -&gt; yield 2</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_until_command_for_generator[1]&gt;(4)test_function()</span>
<span class="sd">    -&gt; print(i)</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    2</span>
<span class="sd">    finished</span>
<span class="sd">    &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="test_pdb_next_command_in_generator_for_loop"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_pdb_next_command_in_generator_for_loop">[docs]</a><span class="k">def</span> <span class="nf">test_pdb_next_command_in_generator_for_loop</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;The next command on returning from a generator controled by a for loop.</span>

<span class="sd">    &gt;&gt;&gt; def test_gen():</span>
<span class="sd">    ...     yield 0</span>
<span class="sd">    ...     return 1</span>

<span class="sd">    &gt;&gt;&gt; def test_function():</span>
<span class="sd">    ...     import pdb; pdb.Pdb(nosigint=True).set_trace()</span>
<span class="sd">    ...     for i in test_gen():</span>
<span class="sd">    ...         print(&#39;value&#39;, i)</span>
<span class="sd">    ...     x = 123</span>

<span class="sd">    &gt;&gt;&gt; with PdbTestInput([&#39;break test_gen&#39;,</span>
<span class="sd">    ...                    &#39;continue&#39;,</span>
<span class="sd">    ...                    &#39;next&#39;,</span>
<span class="sd">    ...                    &#39;next&#39;,</span>
<span class="sd">    ...                    &#39;next&#39;,</span>
<span class="sd">    ...                    &#39;continue&#39;]):</span>
<span class="sd">    ...     test_function()</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_in_generator_for_loop[1]&gt;(3)test_function()</span>
<span class="sd">    -&gt; for i in test_gen():</span>
<span class="sd">    (Pdb) break test_gen</span>
<span class="sd">    Breakpoint 6 at &lt;doctest test.test_pdb.test_pdb_next_command_in_generator_for_loop[0]&gt;:1</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_in_generator_for_loop[0]&gt;(2)test_gen()</span>
<span class="sd">    -&gt; yield 0</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    value 0</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_in_generator_for_loop[0]&gt;(3)test_gen()</span>
<span class="sd">    -&gt; return 1</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    Internal StopIteration: 1</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_in_generator_for_loop[1]&gt;(3)test_function()</span>
<span class="sd">    -&gt; for i in test_gen():</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_in_generator_for_loop[1]&gt;(5)test_function()</span>
<span class="sd">    -&gt; x = 123</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="test_pdb_next_command_subiterator"><a class="viewcode-back" href="../../test.html#test.test_pdb.test_pdb_next_command_subiterator">[docs]</a><span class="k">def</span> <span class="nf">test_pdb_next_command_subiterator</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;The next command in a generator with a subiterator.</span>

<span class="sd">    &gt;&gt;&gt; def test_subgenerator():</span>
<span class="sd">    ...     yield 0</span>
<span class="sd">    ...     return 1</span>

<span class="sd">    &gt;&gt;&gt; def test_gen():</span>
<span class="sd">    ...     x = yield from test_subgenerator()</span>
<span class="sd">    ...     return x</span>

<span class="sd">    &gt;&gt;&gt; def test_function():</span>
<span class="sd">    ...     import pdb; pdb.Pdb(nosigint=True).set_trace()</span>
<span class="sd">    ...     for i in test_gen():</span>
<span class="sd">    ...         print(&#39;value&#39;, i)</span>
<span class="sd">    ...     x = 123</span>

<span class="sd">    &gt;&gt;&gt; with PdbTestInput([&#39;step&#39;,</span>
<span class="sd">    ...                    &#39;step&#39;,</span>
<span class="sd">    ...                    &#39;next&#39;,</span>
<span class="sd">    ...                    &#39;next&#39;,</span>
<span class="sd">    ...                    &#39;next&#39;,</span>
<span class="sd">    ...                    &#39;continue&#39;]):</span>
<span class="sd">    ...     test_function()</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_subiterator[2]&gt;(3)test_function()</span>
<span class="sd">    -&gt; for i in test_gen():</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    --Call--</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_subiterator[1]&gt;(1)test_gen()</span>
<span class="sd">    -&gt; def test_gen():</span>
<span class="sd">    (Pdb) step</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_subiterator[1]&gt;(2)test_gen()</span>
<span class="sd">    -&gt; x = yield from test_subgenerator()</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    value 0</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_subiterator[1]&gt;(3)test_gen()</span>
<span class="sd">    -&gt; return x</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    Internal StopIteration: 1</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_subiterator[2]&gt;(3)test_function()</span>
<span class="sd">    -&gt; for i in test_gen():</span>
<span class="sd">    (Pdb) next</span>
<span class="sd">    &gt; &lt;doctest test.test_pdb.test_pdb_next_command_subiterator[2]&gt;(5)test_function()</span>
<span class="sd">    -&gt; x = 123</span>
<span class="sd">    (Pdb) continue</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<div class="viewcode-block" id="PdbTestCase"><a class="viewcode-back" href="../../test.html#test.test_pdb.PdbTestCase">[docs]</a><span class="k">class</span> <span class="nc">PdbTestCase</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="PdbTestCase.run_pdb"><a class="viewcode-back" href="../../test.html#test.test_pdb.PdbTestCase.run_pdb">[docs]</a>    <span class="k">def</span> <span class="nf">run_pdb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">script</span><span class="p">,</span> <span class="n">commands</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run &#39;script&#39; lines with pdb and the pdb &#39;commands&#39;.&quot;&quot;&quot;</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s">&#39;main.py&#39;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="n">script</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addCleanup</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">unlink</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span> <span class="s">&#39;-m&#39;</span><span class="p">,</span> <span class="s">&#39;pdb&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">]</span>
        <span class="n">stdout</span> <span class="o">=</span> <span class="n">stderr</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">with</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                                   <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                                   <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">,</span>
                                   <span class="p">)</span> <span class="k">as</span> <span class="n">proc</span><span class="p">:</span>
            <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">communicate</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">commands</span><span class="p">))</span>
        <span class="n">stdout</span> <span class="o">=</span> <span class="n">stdout</span> <span class="ow">and</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">stdout</span><span class="p">)</span>
        <span class="n">stderr</span> <span class="o">=</span> <span class="n">stderr</span> <span class="ow">and</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">stderr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span>
</div>
    <span class="k">def</span> <span class="nf">_assert_find_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_content</span><span class="p">,</span> <span class="n">func_name</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
        <span class="n">file_content</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="n">file_content</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_content</span><span class="p">)</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">expected</span> <span class="k">else</span> <span class="p">(</span>
            <span class="n">expected</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">,</span> <span class="n">expected</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">expected</span><span class="p">,</span> <span class="n">pdb</span><span class="o">.</span><span class="n">find_function</span><span class="p">(</span><span class="n">func_name</span><span class="p">,</span> <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">))</span>

<div class="viewcode-block" id="PdbTestCase.test_find_function_empty_file"><a class="viewcode-back" href="../../test.html#test.test_pdb.PdbTestCase.test_find_function_empty_file">[docs]</a>    <span class="k">def</span> <span class="nf">test_find_function_empty_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_find_function</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PdbTestCase.test_find_function_found"><a class="viewcode-back" href="../../test.html#test.test_pdb.PdbTestCase.test_find_function_found">[docs]</a>    <span class="k">def</span> <span class="nf">test_find_function_found</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_find_function</span><span class="p">(</span>
            <span class="sd">&quot;&quot;&quot;\</span>
<span class="sd">            def foo():</span>
<span class="sd">                pass</span>

<span class="sd">            def bar():</span>
<span class="sd">                pass</span>

<span class="sd">            def quux():</span>
<span class="sd">                pass</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
            <span class="s">&#39;bar&#39;</span><span class="p">,</span>
            <span class="p">(</span><span class="s">&#39;bar&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
        <span class="p">)</span>
</div>
<div class="viewcode-block" id="PdbTestCase.test_issue7964"><a class="viewcode-back" href="../../test.html#test.test_pdb.PdbTestCase.test_issue7964">[docs]</a>    <span class="k">def</span> <span class="nf">test_issue7964</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># open the file as binary so we can force \r\n newline</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;print(&quot;testing my pdb&quot;)</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span> <span class="s">&#39;-m&#39;</span><span class="p">,</span> <span class="s">&#39;pdb&#39;</span><span class="p">,</span> <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">]</span>
        <span class="n">proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span>
            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addCleanup</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">communicate</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;quit</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;SyntaxError&#39;</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span>
                         <span class="s">&quot;Got a syntax error running test script under PDB&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PdbTestCase.test_issue13183"><a class="viewcode-back" href="../../test.html#test.test_pdb.PdbTestCase.test_issue13183">[docs]</a>    <span class="k">def</span> <span class="nf">test_issue13183</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">script</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">            from bar import bar</span>

<span class="s">            def foo():</span>
<span class="s">                bar()</span>

<span class="s">            def nope():</span>
<span class="s">                pass</span>

<span class="s">            def foobar():</span>
<span class="s">                foo()</span>
<span class="s">                nope()</span>

<span class="s">            foobar()</span>
<span class="s">        &quot;&quot;&quot;</span>
        <span class="n">commands</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">            from bar import bar</span>
<span class="s">            break bar</span>
<span class="s">            continue</span>
<span class="s">            step</span>
<span class="s">            step</span>
<span class="s">            quit</span>
<span class="s">        &quot;&quot;&quot;</span>
        <span class="n">bar</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">            def bar():</span>
<span class="s">                pass</span>
<span class="s">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;bar.py&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="n">bar</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addCleanup</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">unlink</span><span class="p">,</span> <span class="s">&#39;bar.py&#39;</span><span class="p">)</span>
        <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_pdb</span><span class="p">(</span><span class="n">script</span><span class="p">,</span> <span class="n">commands</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span>
            <span class="nb">any</span><span class="p">(</span><span class="s">&#39;main.py(5)foo()-&gt;None&#39;</span> <span class="ow">in</span> <span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">stdout</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()),</span>
            <span class="s">&#39;Fail to step into the caller after a return&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PdbTestCase.test_issue13210"><a class="viewcode-back" href="../../test.html#test.test_pdb.PdbTestCase.test_issue13210">[docs]</a>    <span class="k">def</span> <span class="nf">test_issue13210</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># invoking &quot;continue&quot; on a non-main thread triggered an exception</span>
        <span class="c"># inside signal.signal</span>

        <span class="c"># raises SkipTest if python was built without threads</span>
        <span class="n">support</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="s">&#39;threading&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">                import threading</span>
<span class="s">                import pdb</span>

<span class="s">                def start_pdb():</span>
<span class="s">                    pdb.Pdb().set_trace()</span>
<span class="s">                    x = 1</span>
<span class="s">                    y = 1</span>

<span class="s">                t = threading.Thread(target=start_pdb)</span>
<span class="s">                t.start()&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">))</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span> <span class="s">&#39;-u&#39;</span><span class="p">,</span> <span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">]</span>
        <span class="n">proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span>
            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addCleanup</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">communicate</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;cont</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="s">&#39;Error&#39;</span><span class="p">,</span> <span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">(),</span>
                         <span class="s">&quot;Got an error running test script under PDB&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PdbTestCase.tearDown"><a class="viewcode-back" href="../../test.html#test.test_pdb.PdbTestCase.tearDown">[docs]</a>    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">support</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">support</span><span class="o">.</span><span class="n">TESTFN</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="load_tests"><a class="viewcode-back" href="../../test.html#test.test_pdb.load_tests">[docs]</a><span class="k">def</span> <span class="nf">load_tests</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">test_pdb</span>
    <span class="n">suites</span> <span class="o">=</span> <span class="p">[</span><span class="n">unittest</span><span class="o">.</span><span class="n">makeSuite</span><span class="p">(</span><span class="n">PdbTestCase</span><span class="p">),</span> <span class="n">doctest</span><span class="o">.</span><span class="n">DocTestSuite</span><span class="p">(</span><span class="n">test_pdb</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestSuite</span><span class="p">(</span><span class="n">suites</span><span class="p">)</span>

</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>