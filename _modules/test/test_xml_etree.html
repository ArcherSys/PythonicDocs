

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_xml_etree &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_xml_etree</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_xml_etree</h1><div class="highlight"><pre>
<span class="c"># IMPORTANT: the same tests are run from &quot;test_xml_etree_c&quot; in order</span>
<span class="c"># to ensure consistency between the C implementation and the Python</span>
<span class="c"># implementation.</span>
<span class="c">#</span>
<span class="c"># For this purpose, the module-level &quot;ET&quot; symbol is temporarily</span>
<span class="c"># monkey-patched when running the &quot;test_xml_etree_c&quot; test suite.</span>

<span class="kn">import</span> <span class="nn">html</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">types</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">weakref</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">support</span>
<span class="kn">from</span> <span class="nn">test.support</span> <span class="kn">import</span> <span class="n">TESTFN</span><span class="p">,</span> <span class="n">findfile</span><span class="p">,</span> <span class="n">import_fresh_module</span><span class="p">,</span> <span class="n">gc_collect</span>

<span class="c"># pyET is the pure-Python implementation.</span>
<span class="c">#</span>
<span class="c"># ET is pyET in test_xml_etree and is the C accelerated version in</span>
<span class="c"># test_xml_etree_c.</span>
<span class="n">pyET</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">ET</span> <span class="o">=</span> <span class="bp">None</span>

<span class="n">SIMPLE_XMLFILE</span> <span class="o">=</span> <span class="n">findfile</span><span class="p">(</span><span class="s">&quot;simple.xml&quot;</span><span class="p">,</span> <span class="n">subdir</span><span class="o">=</span><span class="s">&quot;xmltestdata&quot;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">SIMPLE_XMLFILE</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;utf-8&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">UnicodeEncodeError</span><span class="p">:</span>
    <span class="k">raise</span> <span class="n">unittest</span><span class="o">.</span><span class="n">SkipTest</span><span class="p">(</span><span class="s">&quot;filename is not encodable to utf8&quot;</span><span class="p">)</span>
<span class="n">SIMPLE_NS_XMLFILE</span> <span class="o">=</span> <span class="n">findfile</span><span class="p">(</span><span class="s">&quot;simple-ns.xml&quot;</span><span class="p">,</span> <span class="n">subdir</span><span class="o">=</span><span class="s">&quot;xmltestdata&quot;</span><span class="p">)</span>

<span class="n">SAMPLE_XML</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">&lt;body&gt;</span>
<span class="s">  &lt;tag class=&#39;a&#39;&gt;text&lt;/tag&gt;</span>
<span class="s">  &lt;tag class=&#39;b&#39; /&gt;</span>
<span class="s">  &lt;section&gt;</span>
<span class="s">    &lt;tag class=&#39;b&#39; id=&#39;inner&#39;&gt;subtext&lt;/tag&gt;</span>
<span class="s">  &lt;/section&gt;</span>
<span class="s">&lt;/body&gt;</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">SAMPLE_SECTION</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">&lt;section&gt;</span>
<span class="s">  &lt;tag class=&#39;b&#39; id=&#39;inner&#39;&gt;subtext&lt;/tag&gt;</span>
<span class="s">  &lt;nexttag /&gt;</span>
<span class="s">  &lt;nextsection&gt;</span>
<span class="s">    &lt;tag /&gt;</span>
<span class="s">  &lt;/nextsection&gt;</span>
<span class="s">&lt;/section&gt;</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">SAMPLE_XML_NS</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">&lt;body xmlns=&quot;http://effbot.org/ns&quot;&gt;</span>
<span class="s">  &lt;tag&gt;text&lt;/tag&gt;</span>
<span class="s">  &lt;tag /&gt;</span>
<span class="s">  &lt;section&gt;</span>
<span class="s">    &lt;tag&gt;subtext&lt;/tag&gt;</span>
<span class="s">  &lt;/section&gt;</span>
<span class="s">&lt;/body&gt;</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">SAMPLE_XML_NS_ELEMS</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">&lt;root&gt;</span>
<span class="s">&lt;h:table xmlns:h=&quot;hello&quot;&gt;</span>
<span class="s">  &lt;h:tr&gt;</span>
<span class="s">    &lt;h:td&gt;Apples&lt;/h:td&gt;</span>
<span class="s">    &lt;h:td&gt;Bananas&lt;/h:td&gt;</span>
<span class="s">  &lt;/h:tr&gt;</span>
<span class="s">&lt;/h:table&gt;</span>

<span class="s">&lt;f:table xmlns:f=&quot;foo&quot;&gt;</span>
<span class="s">  &lt;f:name&gt;African Coffee Table&lt;/f:name&gt;</span>
<span class="s">  &lt;f:width&gt;80&lt;/f:width&gt;</span>
<span class="s">  &lt;f:length&gt;120&lt;/f:length&gt;</span>
<span class="s">&lt;/f:table&gt;</span>
<span class="s">&lt;/root&gt;</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">ENTITY_XML</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">&lt;!DOCTYPE points [</span>
<span class="s">&lt;!ENTITY </span><span class="si">% u</span><span class="s">ser-entities SYSTEM &#39;user-entities.xml&#39;&gt;</span>
<span class="si">%u</span><span class="s">ser-entities;</span>
<span class="s">]&gt;</span>
<span class="s">&lt;document&gt;&amp;entity;&lt;/document&gt;</span>
<span class="s">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="ModuleTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ModuleTest">[docs]</a><span class="k">class</span> <span class="nc">ModuleTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="c"># TODO: this should be removed once we get rid of the global module vars</span>

<div class="viewcode-block" id="ModuleTest.test_sanity"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ModuleTest.test_sanity">[docs]</a>    <span class="k">def</span> <span class="nf">test_sanity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Import sanity.</span>

        <span class="kn">from</span> <span class="nn">xml.etree</span> <span class="kn">import</span> <span class="n">ElementTree</span>
        <span class="kn">from</span> <span class="nn">xml.etree</span> <span class="kn">import</span> <span class="n">ElementInclude</span>
        <span class="kn">from</span> <span class="nn">xml.etree</span> <span class="kn">import</span> <span class="n">ElementPath</span>

</div></div>
<div class="viewcode-block" id="serialize"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.serialize">[docs]</a><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">to_string</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;unicode&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">encoding</span> <span class="o">!=</span> <span class="s">&#39;unicode&#39;</span><span class="p">:</span>
        <span class="nb">file</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">file</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">to_string</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">file</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">file</span>
</div>
<div class="viewcode-block" id="summarize_list"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.summarize_list">[docs]</a><span class="k">def</span> <span class="nf">summarize_list</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">tag</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">seq</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="ElementTestCase"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTestCase">[docs]</a><span class="k">class</span> <span class="nc">ElementTestCase</span><span class="p">:</span>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="ElementTestCase.setUpClass"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTestCase.setUpClass">[docs]</a>    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">modules</span> <span class="o">=</span> <span class="p">{</span><span class="n">pyET</span><span class="p">,</span> <span class="n">ET</span><span class="p">}</span>
</div>
<div class="viewcode-block" id="ElementTestCase.pickleRoundTrip"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTestCase.pickleRoundTrip">[docs]</a>    <span class="k">def</span> <span class="nf">pickleRoundTrip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">dumper</span><span class="p">,</span> <span class="n">loader</span><span class="p">):</span>
        <span class="n">save_m</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">dumper</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">loader</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">pickle</span><span class="o">.</span><span class="n">PicklingError</span> <span class="k">as</span> <span class="n">pe</span><span class="p">:</span>
            <span class="c"># pyET must be second, because pyET may be (equal to) ET.</span>
            <span class="n">human</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">ET</span><span class="p">,</span> <span class="s">&quot;cET&quot;</span><span class="p">),</span> <span class="p">(</span><span class="n">pyET</span><span class="p">,</span> <span class="s">&quot;pyET&quot;</span><span class="p">)])</span>
            <span class="k">raise</span> <span class="n">support</span><span class="o">.</span><span class="n">TestFailed</span><span class="p">(</span><span class="s">&quot;Failed to round-trip </span><span class="si">%r</span><span class="s"> from </span><span class="si">%r</span><span class="s"> to </span><span class="si">%r</span><span class="s">&quot;</span>
                                     <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span>
                                        <span class="n">human</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dumper</span><span class="p">,</span> <span class="n">dumper</span><span class="p">),</span>
                                        <span class="n">human</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">loader</span><span class="p">,</span> <span class="n">loader</span><span class="p">)))</span> <span class="kn">from</span> <span class="nn">pe</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">save_m</span>
        <span class="k">return</span> <span class="n">result</span>
</div>
<div class="viewcode-block" id="ElementTestCase.assertEqualElements"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTestCase.assertEqualElements">[docs]</a>    <span class="k">def</span> <span class="nf">assertEqualElements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alice</span><span class="p">,</span> <span class="n">bob</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">,</span> <span class="n">pyET</span><span class="o">.</span><span class="n">Element</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">bob</span><span class="p">,</span> <span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">,</span> <span class="n">pyET</span><span class="o">.</span><span class="n">Element</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">alice</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">bob</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="n">bob</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqualElements</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s">&#39;tag&#39;</span><span class="p">,</span> <span class="s">&#39;tail&#39;</span><span class="p">,</span> <span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;attrib&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">properties</span><span class="p">(</span><span class="n">alice</span><span class="p">),</span> <span class="n">properties</span><span class="p">(</span><span class="n">bob</span><span class="p">))</span>

<span class="c"># --------------------------------------------------------------------</span>
<span class="c"># element tree tests</span>
</div></div>
<div class="viewcode-block" id="ElementTreeTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest">[docs]</a><span class="k">class</span> <span class="nc">ElementTreeTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="ElementTreeTest.serialize_check"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.serialize_check">[docs]</a>    <span class="k">def</span> <span class="nf">serialize_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">),</span> <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_interface"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_interface">[docs]</a>    <span class="k">def</span> <span class="nf">test_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test element tree interface.</span>

        <span class="k">def</span> <span class="nf">check_string</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">char</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s">&quot;expected one-character string, got </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">char</span><span class="p">)</span>
            <span class="n">new_string</span> <span class="o">=</span> <span class="n">string</span> <span class="o">+</span> <span class="s">&quot;&quot;</span>
            <span class="n">new_string</span> <span class="o">=</span> <span class="n">string</span> <span class="o">+</span> <span class="s">&quot; &quot;</span>
            <span class="n">string</span><span class="p">[:</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">check_mapping</span><span class="p">(</span><span class="n">mapping</span><span class="p">):</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="n">items</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">mapping</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">mapping</span><span class="p">[</span><span class="s">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;value&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mapping</span><span class="p">[</span><span class="s">&quot;key&quot;</span><span class="p">],</span> <span class="s">&quot;value&quot;</span><span class="p">,</span>
                    <span class="n">msg</span><span class="o">=</span><span class="s">&quot;expected value string, got </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">mapping</span><span class="p">[</span><span class="s">&quot;key&quot;</span><span class="p">])</span>

        <span class="k">def</span> <span class="nf">check_element</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">iselement</span><span class="p">(</span><span class="n">element</span><span class="p">),</span> <span class="n">msg</span><span class="o">=</span><span class="s">&quot;not an element&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s">&quot;tag&quot;</span><span class="p">),</span> <span class="n">msg</span><span class="o">=</span><span class="s">&quot;no tag member&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s">&quot;attrib&quot;</span><span class="p">),</span> <span class="n">msg</span><span class="o">=</span><span class="s">&quot;no attrib member&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s">&quot;text&quot;</span><span class="p">),</span> <span class="n">msg</span><span class="o">=</span><span class="s">&quot;no text member&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s">&quot;tail&quot;</span><span class="p">),</span> <span class="n">msg</span><span class="o">=</span><span class="s">&quot;no tail member&quot;</span><span class="p">)</span>

            <span class="n">check_string</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">check_mapping</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">attrib</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">check_string</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">tail</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">check_string</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">tail</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">element</span><span class="p">:</span>
                <span class="n">check_element</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

        <span class="n">element</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">)</span>
        <span class="n">check_element</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="n">check_element</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">())</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;t</span><span class="se">\xe4</span><span class="s">g&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s">&quot;value&quot;</span><span class="p">)</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRegex</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">element</span><span class="p">),</span> <span class="s">r&quot;^&lt;Element &#39;t\xe4g&#39; at 0x.*&gt;$&quot;</span><span class="p">)</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s">&quot;value&quot;</span><span class="p">)</span>

        <span class="c"># Make sure all standard element methods exist.</span>

        <span class="k">def</span> <span class="nf">check_method</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="s">&#39;__call__&#39;</span><span class="p">),</span>
                    <span class="n">msg</span><span class="o">=</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> not callable&quot;</span> <span class="o">%</span> <span class="n">method</span><span class="p">)</span>

        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">append</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">extend</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">insert</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">remove</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">getchildren</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">find</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">iterfind</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">findall</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">findtext</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">clear</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">keys</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">items</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">iter</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">itertext</span><span class="p">)</span>
        <span class="n">check_method</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">getiterator</span><span class="p">)</span>

        <span class="c"># These methods return an iterable. See bug 6472.</span>

        <span class="k">def</span> <span class="nf">check_iter</span><span class="p">(</span><span class="n">it</span><span class="p">):</span>
            <span class="n">check_method</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">__next__</span><span class="p">)</span>

        <span class="n">check_iter</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">iterfind</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">))</span>
        <span class="n">check_iter</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">iterfind</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">))</span>
        <span class="n">check_iter</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">iterfind</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">))</span>
        <span class="n">check_iter</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">iterfind</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">))</span>

        <span class="c"># These aliases are provided:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">,</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">PI</span><span class="p">,</span> <span class="n">ET</span><span class="o">.</span><span class="n">ProcessingInstruction</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_simpleops"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_simpleops">[docs]</a>    <span class="k">def</span> <span class="nf">test_simpleops</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Basic method sanity checks.</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;body&gt;&lt;tag/&gt;&lt;/body&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;body&gt;&lt;tag /&gt;&lt;/body&gt;&#39;</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag2&quot;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;body&gt;&lt;tag /&gt;&lt;tag2 /&gt;&lt;/body&gt;&#39;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;body&gt;&lt;tag /&gt;&lt;/body&gt;&#39;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;body&gt;&lt;tag2 /&gt;&lt;tag /&gt;&lt;/body&gt;&#39;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">e</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;body&gt;&lt;tag /&gt;&lt;tag2 /&gt;&lt;/body&gt;&#39;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="n">element</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s">&quot;value&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s">&#39;&lt;tag key=&quot;value&quot; /&gt;&#39;</span><span class="p">)</span> <span class="c"># 1</span>
        <span class="n">subelement</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;subtag&quot;</span><span class="p">)</span>
        <span class="n">element</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subelement</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s">&#39;&lt;tag key=&quot;value&quot;&gt;&lt;subtag /&gt;&lt;/tag&gt;&#39;</span><span class="p">)</span> <span class="c"># 2</span>
        <span class="n">element</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">subelement</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">element</span><span class="p">,</span>
                <span class="s">&#39;&lt;tag key=&quot;value&quot;&gt;&lt;subtag /&gt;&lt;subtag /&gt;&lt;/tag&gt;&#39;</span><span class="p">)</span> <span class="c"># 3</span>
        <span class="n">element</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">subelement</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s">&#39;&lt;tag key=&quot;value&quot;&gt;&lt;subtag /&gt;&lt;/tag&gt;&#39;</span><span class="p">)</span> <span class="c"># 4</span>
        <span class="n">element</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">subelement</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s">&#39;&lt;tag key=&quot;value&quot; /&gt;&#39;</span><span class="p">)</span> <span class="c"># 5</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">element</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">subelement</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span> <span class="s">&#39;list.remove(x): x not in list&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s">&#39;&lt;tag key=&quot;value&quot; /&gt;&#39;</span><span class="p">)</span> <span class="c"># 6</span>
        <span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">subelement</span><span class="p">,</span> <span class="n">subelement</span><span class="p">,</span> <span class="n">subelement</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;&lt;subtag /&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="n">element</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">element</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">element</span><span class="p">[:</span><span class="mi">9</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">element</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
        <span class="k">del</span> <span class="n">element</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">element</span><span class="p">,</span>
                <span class="s">&#39;&lt;tag key=&quot;value&quot;&gt;&lt;subtag /&gt;&lt;subtag /&gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_cdata"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_cdata">[docs]</a>    <span class="k">def</span> <span class="nf">test_cdata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test CDATA handling (etc).</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;tag&gt;hello&lt;/tag&gt;&quot;</span><span class="p">),</span>
                <span class="s">&#39;&lt;tag&gt;hello&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;tag&gt;&amp;#104;&amp;#101;&amp;#108;&amp;#108;&amp;#111;&lt;/tag&gt;&quot;</span><span class="p">),</span>
                <span class="s">&#39;&lt;tag&gt;hello&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;tag&gt;&lt;![CDATA[hello]]&gt;&lt;/tag&gt;&quot;</span><span class="p">),</span>
                <span class="s">&#39;&lt;tag&gt;hello&lt;/tag&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_file_init"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_file_init">[docs]</a>    <span class="k">def</span> <span class="nf">test_file_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">stringfile</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">SAMPLE_XML</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;utf-8&quot;</span><span class="p">))</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="n">stringfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;section/tag&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">)</span>

        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="n">SIMPLE_XMLFILE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;element&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;element/../empty-element&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span>
                <span class="s">&#39;empty-element&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_path_cache"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_path_cache">[docs]</a>    <span class="k">def</span> <span class="nf">test_path_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Check that the path cache behaves sanely.</span>

        <span class="kn">from</span> <span class="nn">xml.etree</span> <span class="kn">import</span> <span class="n">ElementPath</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">SAMPLE_XML</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;./&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">cache_len_10</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ElementPath</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;./&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ElementPath</span><span class="o">.</span><span class="n">_cache</span><span class="p">),</span> <span class="n">cache_len_10</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;./&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ElementPath</span><span class="o">.</span><span class="n">_cache</span><span class="p">),</span> <span class="n">cache_len_10</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">600</span><span class="p">):</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;./&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ElementPath</span><span class="o">.</span><span class="n">_cache</span><span class="p">),</span> <span class="mi">500</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_copy"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_copy">[docs]</a>    <span class="k">def</span> <span class="nf">test_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test copy handling (etc).</span>

        <span class="kn">import</span> <span class="nn">copy</span>
        <span class="n">e1</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;tag&gt;hello&lt;foo/&gt;&lt;/tag&gt;&quot;</span><span class="p">)</span>
        <span class="n">e2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span>
        <span class="n">e3</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span>
        <span class="n">e1</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="s">&quot;bar&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="s">&#39;&lt;tag&gt;hello&lt;bar /&gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">e2</span><span class="p">,</span> <span class="s">&#39;&lt;tag&gt;hello&lt;bar /&gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">e3</span><span class="p">,</span> <span class="s">&#39;&lt;tag&gt;hello&lt;foo /&gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_attrib"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_attrib">[docs]</a>    <span class="k">def</span> <span class="nf">test_attrib</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test attribute handling.</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">)</span> <span class="c"># 1.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">,</span> <span class="s">&quot;default&quot;</span><span class="p">),</span> <span class="s">&#39;default&#39;</span><span class="p">)</span> <span class="c"># 1.2</span>

        <span class="n">elem</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">,</span> <span class="s">&quot;value&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">),</span> <span class="s">&#39;value&#39;</span><span class="p">)</span> <span class="c"># 1.3</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s">&quot;value&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">),</span> <span class="s">&#39;value&#39;</span><span class="p">)</span> <span class="c"># 2.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">attrib</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;key&#39;</span><span class="p">:</span> <span class="s">&#39;value&#39;</span><span class="p">})</span> <span class="c"># 2.2</span>

        <span class="n">attrib</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;key&quot;</span><span class="p">:</span> <span class="s">&quot;value&quot;</span><span class="p">}</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">,</span> <span class="n">attrib</span><span class="p">)</span>
        <span class="n">attrib</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span> <span class="c"># check for aliasing issues</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">),</span> <span class="s">&#39;value&#39;</span><span class="p">)</span> <span class="c"># 3.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">attrib</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;key&#39;</span><span class="p">:</span> <span class="s">&#39;value&#39;</span><span class="p">})</span> <span class="c"># 3.2</span>

        <span class="n">attrib</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;key&quot;</span><span class="p">:</span> <span class="s">&quot;value&quot;</span><span class="p">}</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">attrib</span><span class="p">)</span>
        <span class="n">attrib</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span> <span class="c"># check for aliasing issues</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">),</span> <span class="s">&#39;value&#39;</span><span class="p">)</span> <span class="c"># 4.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">attrib</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;key&#39;</span><span class="p">:</span> <span class="s">&#39;value&#39;</span><span class="p">})</span> <span class="c"># 4.2</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;key&quot;</span><span class="p">:</span> <span class="s">&quot;other&quot;</span><span class="p">},</span> <span class="n">key</span><span class="o">=</span><span class="s">&quot;value&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">),</span> <span class="s">&#39;value&#39;</span><span class="p">)</span> <span class="c"># 5.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">attrib</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;key&#39;</span><span class="p">:</span> <span class="s">&#39;value&#39;</span><span class="p">})</span> <span class="c"># 5.2</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;test&#39;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">&quot;aa&quot;</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;testa&#39;</span><span class="p">,</span> <span class="s">&#39;testval&#39;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;testb&#39;</span><span class="p">,</span> <span class="s">&#39;test2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">elem</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;test testa=&quot;testval&quot; testb=&quot;test2&quot;&gt;aa&lt;/test&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="p">[</span><span class="s">&#39;testa&#39;</span><span class="p">,</span> <span class="s">&#39;testb&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span>
                <span class="p">[(</span><span class="s">&#39;testa&#39;</span><span class="p">,</span> <span class="s">&#39;testval&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;testb&#39;</span><span class="p">,</span> <span class="s">&#39;test2&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;testb&#39;</span><span class="p">],</span> <span class="s">&#39;test2&#39;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;testb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;test1&#39;</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;testc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;test2&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">elem</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;test testa=&quot;testval&quot; testb=&quot;test1&quot; testc=&quot;test2&quot;&gt;aa&lt;/test&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_makeelement"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_makeelement">[docs]</a>    <span class="k">def</span> <span class="nf">test_makeelement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test makeelement handling.</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">)</span>
        <span class="n">attrib</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;key&quot;</span><span class="p">:</span> <span class="s">&quot;value&quot;</span><span class="p">}</span>
        <span class="n">subelem</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">makeelement</span><span class="p">(</span><span class="s">&quot;subtag&quot;</span><span class="p">,</span> <span class="n">attrib</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">subelem</span><span class="o">.</span><span class="n">attrib</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s">&quot;attrib aliasing&quot;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subelem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;tag&gt;&lt;subtag key=&quot;value&quot; /&gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>

        <span class="n">elem</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;tag /&gt;&#39;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subelem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;tag&gt;&lt;subtag key=&quot;value&quot; /&gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">subelem</span><span class="p">,</span> <span class="n">subelem</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span>
            <span class="s">&#39;&lt;tag&gt;&lt;subtag key=&quot;value&quot; /&gt;&lt;subtag key=&quot;value&quot; /&gt;&lt;subtag key=&quot;value&quot; /&gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="n">elem</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">subelem</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;tag&gt;&lt;subtag key=&quot;value&quot; /&gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="n">elem</span><span class="p">[:]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">subelem</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;tag&gt;&lt;subtag key=&quot;value&quot; /&gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_parsefile"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_parsefile">[docs]</a>    <span class="k">def</span> <span class="nf">test_parsefile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test parsing from file.</span>

        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">SIMPLE_XMLFILE</span><span class="p">)</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;unicode&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span>
                <span class="s">&#39;&lt;root&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;   &lt;element key=&quot;value&quot;&gt;text&lt;/element&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;   &lt;element&gt;text&lt;/element&gt;tail</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;   &lt;empty-element /&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;&lt;/root&gt;&#39;</span><span class="p">)</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">SIMPLE_NS_XMLFILE</span><span class="p">)</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;unicode&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span>
                <span class="s">&#39;&lt;ns0:root xmlns:ns0=&quot;namespace&quot;&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;   &lt;ns0:element key=&quot;value&quot;&gt;text&lt;/ns0:element&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;   &lt;ns0:element&gt;text&lt;/ns0:element&gt;tail</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;   &lt;ns0:empty-element /&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;&lt;/ns0:root&gt;&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">SIMPLE_XMLFILE</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRegex</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">version</span><span class="p">,</span> <span class="s">r&#39;^Expat &#39;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">(),</span>
                <span class="s">&#39;&lt;root&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;   &lt;element key=&quot;value&quot;&gt;text&lt;/element&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;   &lt;element&gt;text&lt;/element&gt;tail</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;   &lt;empty-element /&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;&lt;/root&gt;&#39;</span><span class="p">)</span>

        <span class="n">target</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">TreeBuilder</span><span class="p">()</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">(),</span>
                <span class="s">&#39;&lt;root&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;   &lt;element key=&quot;value&quot;&gt;text&lt;/element&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;   &lt;element&gt;text&lt;/element&gt;tail</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;   &lt;empty-element /&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="s">&#39;&lt;/root&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_parseliteral"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_parseliteral">[docs]</a>    <span class="k">def</span> <span class="nf">test_parseliteral</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;html&gt;&lt;body&gt;text&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;unicode&#39;</span><span class="p">),</span>
                <span class="s">&#39;&lt;html&gt;&lt;body&gt;text&lt;/body&gt;&lt;/html&gt;&#39;</span><span class="p">)</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s">&quot;&lt;html&gt;&lt;body&gt;text&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;unicode&#39;</span><span class="p">),</span>
                <span class="s">&#39;&lt;html&gt;&lt;body&gt;text&lt;/body&gt;&lt;/html&gt;&#39;</span><span class="p">)</span>
        <span class="n">sequence</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;&lt;html&gt;&lt;body&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;text&lt;/bo&quot;</span><span class="p">,</span> <span class="s">&quot;dy&gt;&lt;/html&gt;&quot;</span><span class="p">]</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstringlist</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">element</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;html&gt;&lt;body&gt;text&lt;/body&gt;&lt;/html&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostringlist</span><span class="p">(</span><span class="n">element</span><span class="p">)),</span>
                <span class="n">b</span><span class="s">&#39;&lt;html&gt;&lt;body&gt;text&lt;/body&gt;&lt;/html&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s">&quot;ascii&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;ascii&#39;?&gt;</span><span class="se">\n</span><span class="s">&quot;</span>
                <span class="n">b</span><span class="s">&quot;&lt;html&gt;&lt;body&gt;text&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">ids</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLID</span><span class="p">(</span><span class="s">&quot;&lt;html&gt;&lt;body&gt;text&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">ids</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLID</span><span class="p">(</span><span class="s">&quot;&lt;html&gt;&lt;body id=&#39;body&#39;&gt;text&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="s">&quot;body&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;body&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_iterparse"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_iterparse">[docs]</a>    <span class="k">def</span> <span class="nf">test_iterparse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test iterparse interface.</span>

        <span class="n">iterparse</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">iterparse</span>

        <span class="n">context</span> <span class="o">=</span> <span class="n">iterparse</span><span class="p">(</span><span class="n">SIMPLE_XMLFILE</span><span class="p">)</span>
        <span class="n">action</span><span class="p">,</span> <span class="n">elem</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="n">action</span><span class="p">,</span> <span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([(</span><span class="n">action</span><span class="p">,</span> <span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span> <span class="k">for</span> <span class="n">action</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">context</span><span class="p">],</span> <span class="p">[</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;empty-element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;root&#39;</span><span class="p">),</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;root&#39;</span><span class="p">)</span>

        <span class="n">context</span> <span class="o">=</span> <span class="n">iterparse</span><span class="p">(</span><span class="n">SIMPLE_NS_XMLFILE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([(</span><span class="n">action</span><span class="p">,</span> <span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span> <span class="k">for</span> <span class="n">action</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">context</span><span class="p">],</span> <span class="p">[</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}empty-element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}root&#39;</span><span class="p">),</span>
            <span class="p">])</span>

        <span class="n">events</span> <span class="o">=</span> <span class="p">()</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">iterparse</span><span class="p">(</span><span class="n">SIMPLE_XMLFILE</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([(</span><span class="n">action</span><span class="p">,</span> <span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span> <span class="k">for</span> <span class="n">action</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">context</span><span class="p">],</span> <span class="p">[])</span>

        <span class="n">events</span> <span class="o">=</span> <span class="p">()</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">iterparse</span><span class="p">(</span><span class="n">SIMPLE_XMLFILE</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([(</span><span class="n">action</span><span class="p">,</span> <span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span> <span class="k">for</span> <span class="n">action</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">context</span><span class="p">],</span> <span class="p">[])</span>

        <span class="n">events</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;start&quot;</span><span class="p">,</span> <span class="s">&quot;end&quot;</span><span class="p">)</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">iterparse</span><span class="p">(</span><span class="n">SIMPLE_XMLFILE</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([(</span><span class="n">action</span><span class="p">,</span> <span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span> <span class="k">for</span> <span class="n">action</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">context</span><span class="p">],</span> <span class="p">[</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;root&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;empty-element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;empty-element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;root&#39;</span><span class="p">),</span>
            <span class="p">])</span>

        <span class="n">events</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;start&quot;</span><span class="p">,</span> <span class="s">&quot;end&quot;</span><span class="p">,</span> <span class="s">&quot;start-ns&quot;</span><span class="p">,</span> <span class="s">&quot;end-ns&quot;</span><span class="p">)</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">iterparse</span><span class="p">(</span><span class="n">SIMPLE_NS_XMLFILE</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([(</span><span class="n">action</span><span class="p">,</span> <span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span> <span class="k">if</span> <span class="n">action</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;start&quot;</span><span class="p">,</span> <span class="s">&quot;end&quot;</span><span class="p">)</span>
                                             <span class="k">else</span> <span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">elem</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">action</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">context</span><span class="p">],</span> <span class="p">[</span>
                <span class="p">(</span><span class="s">&#39;start-ns&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;namespace&#39;</span><span class="p">)),</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}root&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}empty-element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}empty-element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}root&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end-ns&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
            <span class="p">])</span>

        <span class="n">events</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;start-ns&#39;</span><span class="p">,</span> <span class="s">&#39;end-ns&#39;</span><span class="p">)</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">iterparse</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="s">r&quot;&lt;root xmlns=&#39;&#39;/&gt;&quot;</span><span class="p">),</span> <span class="n">events</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">action</span> <span class="k">for</span> <span class="n">action</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">context</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;start-ns&#39;</span><span class="p">,</span> <span class="s">&#39;end-ns&#39;</span><span class="p">])</span>

        <span class="n">events</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;start&quot;</span><span class="p">,</span> <span class="s">&quot;end&quot;</span><span class="p">,</span> <span class="s">&quot;bogus&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">SIMPLE_XMLFILE</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">iterparse</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span> <span class="s">&quot;unknown event &#39;bogus&#39;&quot;</span><span class="p">)</span>

        <span class="n">source</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span>
            <span class="n">b</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;iso-8859-1&#39;?&gt;</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">b</span><span class="s">&quot;&lt;body xmlns=&#39;http://&amp;#233;ffbot.org/ns&#39;</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">b</span><span class="s">&quot;      xmlns:cl</span><span class="se">\xe9</span><span class="s">=&#39;http://effbot.org/ns&#39;&gt;text&lt;/body&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">events</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;start-ns&quot;</span><span class="p">,)</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">iterparse</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([(</span><span class="n">action</span><span class="p">,</span> <span class="n">elem</span><span class="p">)</span> <span class="k">for</span> <span class="n">action</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">context</span><span class="p">],</span> <span class="p">[</span>
                <span class="p">(</span><span class="s">&#39;start-ns&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;http://</span><span class="se">\xe9</span><span class="s">ffbot.org/ns&#39;</span><span class="p">)),</span>
                <span class="p">(</span><span class="s">&#39;start-ns&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;cl</span><span class="se">\xe9</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;http://effbot.org/ns&#39;</span><span class="p">)),</span>
            <span class="p">])</span>

        <span class="n">source</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="s">&quot;&lt;document /&gt;junk&quot;</span><span class="p">)</span>
        <span class="n">it</span> <span class="o">=</span> <span class="n">iterparse</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="n">action</span><span class="p">,</span> <span class="n">elem</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="n">action</span><span class="p">,</span> <span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;document&#39;</span><span class="p">))</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">ParseError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                <span class="s">&#39;junk after document element: line 1, column 12&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_writefile"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_writefile">[docs]</a>    <span class="k">def</span> <span class="nf">test_writefile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">&quot;text&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;tag&gt;text&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&quot;subtag&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">&quot;subtext&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;tag&gt;text&lt;subtag&gt;subtext&lt;/subtag&gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>

        <span class="c"># Test tag suppression</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;text&lt;subtag&gt;subtext&lt;/subtag&gt;&#39;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ET</span><span class="o">.</span><span class="n">Comment</span><span class="p">(</span><span class="s">&quot;comment&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span>
                <span class="s">&#39;text&lt;!--comment--&gt;&lt;subtag&gt;subtext&lt;/subtag&gt;&#39;</span><span class="p">)</span>     <span class="c"># assumes 1.3</span>

        <span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">PI</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">,</span> <span class="s">&quot;value&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;text&lt;?key value?&gt;&lt;subtag&gt;subtext&lt;/subtag&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_custom_builder"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_custom_builder">[docs]</a>    <span class="k">def</span> <span class="nf">test_custom_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test parser w. custom builder.</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">SIMPLE_XMLFILE</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">class</span> <span class="nc">Builder</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">attrib</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;start&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="p">))</span>
            <span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;end&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="p">))</span>
            <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
                <span class="k">pass</span>
        <span class="n">builder</span> <span class="o">=</span> <span class="n">Builder</span><span class="p">()</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">builder</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">builder</span><span class="p">,</span> <span class="p">[</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;root&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;empty-element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;empty-element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;root&#39;</span><span class="p">),</span>
            <span class="p">])</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">SIMPLE_NS_XMLFILE</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">class</span> <span class="nc">Builder</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">attrib</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;start&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="p">))</span>
            <span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;end&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="p">))</span>
            <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">def</span> <span class="nf">pi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;pi&quot;</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
            <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&quot;comment&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
        <span class="n">builder</span> <span class="o">=</span> <span class="n">Builder</span><span class="p">()</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">builder</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">builder</span><span class="p">,</span> <span class="p">[</span>
                <span class="p">(</span><span class="s">&#39;pi&#39;</span><span class="p">,</span> <span class="s">&#39;pi&#39;</span><span class="p">,</span> <span class="s">&#39;data&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39; comment &#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}root&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}empty-element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}empty-element&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}root&#39;</span><span class="p">),</span>
            <span class="p">])</span>

</div>
<div class="viewcode-block" id="ElementTreeTest.test_getchildren"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_getchildren">[docs]</a>    <span class="k">def</span> <span class="nf">test_getchildren</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test Element.getchildren()</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">SIMPLE_XMLFILE</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">getchildren</span><span class="p">())</span>
                          <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span><span class="o">.</span><span class="n">iter</span><span class="p">()],</span> <span class="p">[</span>
                <span class="p">[</span><span class="s">&#39;element&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">,</span> <span class="s">&#39;empty-element&#39;</span><span class="p">],</span>
                <span class="p">[],</span>
                <span class="p">[],</span>
                <span class="p">[],</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">getchildren</span><span class="p">())</span>
                          <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">getiterator</span><span class="p">()],</span> <span class="p">[</span>
                <span class="p">[</span><span class="s">&#39;element&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">,</span> <span class="s">&#39;empty-element&#39;</span><span class="p">],</span>
                <span class="p">[],</span>
                <span class="p">[],</span>
                <span class="p">[],</span>
            <span class="p">])</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">SAMPLE_XML</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">getchildren</span><span class="p">()),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">getchildren</span><span class="p">()),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">elem</span><span class="p">[:],</span> <span class="n">elem</span><span class="o">.</span><span class="n">getchildren</span><span class="p">())</span>
        <span class="n">child1</span> <span class="o">=</span> <span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">child2</span> <span class="o">=</span> <span class="n">elem</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">elem</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">getchildren</span><span class="p">()),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">child1</span><span class="p">,</span> <span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">child2</span><span class="p">,</span> <span class="n">elem</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">child2</span><span class="p">,</span> <span class="n">child1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">child2</span><span class="p">,</span> <span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">child1</span><span class="p">,</span> <span class="n">elem</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">child1</span><span class="p">,</span> <span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">getchildren</span><span class="p">(),</span> <span class="p">[])</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_writestring"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_writestring">[docs]</a>    <span class="k">def</span> <span class="nf">test_writestring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;html&gt;&lt;body&gt;text&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">elem</span><span class="p">),</span> <span class="n">b</span><span class="s">&#39;&lt;html&gt;&lt;body&gt;text&lt;/body&gt;&lt;/html&gt;&#39;</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s">&quot;&lt;html&gt;&lt;body&gt;text&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">elem</span><span class="p">),</span> <span class="n">b</span><span class="s">&#39;&lt;html&gt;&lt;body&gt;text&lt;/body&gt;&lt;/html&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_encoding"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_encoding">[docs]</a>    <span class="k">def</span> <span class="nf">test_encoding</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">encoding</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
            <span class="n">xml</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;</span><span class="si">%s</span><span class="s">&#39;?&gt;&lt;xml&gt;</span><span class="si">%s</span><span class="s">&lt;/xml&gt;&quot;</span> <span class="o">%</span>
                   <span class="p">(</span><span class="n">encoding</span><span class="p">,</span> <span class="n">body</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">xml</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">xml</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;ascii&quot;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;us-ascii&quot;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;iso-8859-1&quot;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\xbd</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;iso-8859-15&quot;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\u20ac</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;cp437&quot;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\u221a</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;mac-roman&quot;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\u02da</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">xml</span><span class="p">(</span><span class="n">encoding</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;</span><span class="si">%s</span><span class="s">&#39;?&gt;&lt;xml /&gt;&quot;</span> <span class="o">%</span> <span class="n">encoding</span>
        <span class="k">def</span> <span class="nf">bxml</span><span class="p">(</span><span class="n">encoding</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">xml</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span>
        <span class="n">supported_encodings</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s">&#39;ascii&#39;</span><span class="p">,</span> <span class="s">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s">&#39;utf-8-sig&#39;</span><span class="p">,</span> <span class="s">&#39;utf-16&#39;</span><span class="p">,</span> <span class="s">&#39;utf-16be&#39;</span><span class="p">,</span> <span class="s">&#39;utf-16le&#39;</span><span class="p">,</span>
            <span class="s">&#39;iso8859-1&#39;</span><span class="p">,</span> <span class="s">&#39;iso8859-2&#39;</span><span class="p">,</span> <span class="s">&#39;iso8859-3&#39;</span><span class="p">,</span> <span class="s">&#39;iso8859-4&#39;</span><span class="p">,</span> <span class="s">&#39;iso8859-5&#39;</span><span class="p">,</span>
            <span class="s">&#39;iso8859-6&#39;</span><span class="p">,</span> <span class="s">&#39;iso8859-7&#39;</span><span class="p">,</span> <span class="s">&#39;iso8859-8&#39;</span><span class="p">,</span> <span class="s">&#39;iso8859-9&#39;</span><span class="p">,</span> <span class="s">&#39;iso8859-10&#39;</span><span class="p">,</span>
            <span class="s">&#39;iso8859-13&#39;</span><span class="p">,</span> <span class="s">&#39;iso8859-14&#39;</span><span class="p">,</span> <span class="s">&#39;iso8859-15&#39;</span><span class="p">,</span> <span class="s">&#39;iso8859-16&#39;</span><span class="p">,</span>
            <span class="s">&#39;cp437&#39;</span><span class="p">,</span> <span class="s">&#39;cp720&#39;</span><span class="p">,</span> <span class="s">&#39;cp737&#39;</span><span class="p">,</span> <span class="s">&#39;cp775&#39;</span><span class="p">,</span> <span class="s">&#39;cp850&#39;</span><span class="p">,</span> <span class="s">&#39;cp852&#39;</span><span class="p">,</span>
            <span class="s">&#39;cp855&#39;</span><span class="p">,</span> <span class="s">&#39;cp856&#39;</span><span class="p">,</span> <span class="s">&#39;cp857&#39;</span><span class="p">,</span> <span class="s">&#39;cp858&#39;</span><span class="p">,</span> <span class="s">&#39;cp860&#39;</span><span class="p">,</span> <span class="s">&#39;cp861&#39;</span><span class="p">,</span> <span class="s">&#39;cp862&#39;</span><span class="p">,</span>
            <span class="s">&#39;cp863&#39;</span><span class="p">,</span> <span class="s">&#39;cp865&#39;</span><span class="p">,</span> <span class="s">&#39;cp866&#39;</span><span class="p">,</span> <span class="s">&#39;cp869&#39;</span><span class="p">,</span> <span class="s">&#39;cp874&#39;</span><span class="p">,</span> <span class="s">&#39;cp1006&#39;</span><span class="p">,</span> <span class="s">&#39;cp1125&#39;</span><span class="p">,</span>
            <span class="s">&#39;cp1250&#39;</span><span class="p">,</span> <span class="s">&#39;cp1251&#39;</span><span class="p">,</span> <span class="s">&#39;cp1252&#39;</span><span class="p">,</span> <span class="s">&#39;cp1253&#39;</span><span class="p">,</span> <span class="s">&#39;cp1254&#39;</span><span class="p">,</span> <span class="s">&#39;cp1255&#39;</span><span class="p">,</span>
            <span class="s">&#39;cp1256&#39;</span><span class="p">,</span> <span class="s">&#39;cp1257&#39;</span><span class="p">,</span> <span class="s">&#39;cp1258&#39;</span><span class="p">,</span>
            <span class="s">&#39;mac-cyrillic&#39;</span><span class="p">,</span> <span class="s">&#39;mac-greek&#39;</span><span class="p">,</span> <span class="s">&#39;mac-iceland&#39;</span><span class="p">,</span> <span class="s">&#39;mac-latin2&#39;</span><span class="p">,</span>
            <span class="s">&#39;mac-roman&#39;</span><span class="p">,</span> <span class="s">&#39;mac-turkish&#39;</span><span class="p">,</span>
            <span class="s">&#39;iso2022-jp&#39;</span><span class="p">,</span> <span class="s">&#39;iso2022-jp-1&#39;</span><span class="p">,</span> <span class="s">&#39;iso2022-jp-2&#39;</span><span class="p">,</span> <span class="s">&#39;iso2022-jp-2004&#39;</span><span class="p">,</span>
            <span class="s">&#39;iso2022-jp-3&#39;</span><span class="p">,</span> <span class="s">&#39;iso2022-jp-ext&#39;</span><span class="p">,</span>
            <span class="s">&#39;koi8-r&#39;</span><span class="p">,</span> <span class="s">&#39;koi8-u&#39;</span><span class="p">,</span>
            <span class="s">&#39;hz&#39;</span><span class="p">,</span> <span class="s">&#39;ptcp154&#39;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">encoding</span> <span class="ow">in</span> <span class="n">supported_encodings</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">bxml</span><span class="p">(</span><span class="n">encoding</span><span class="p">))),</span> <span class="n">b</span><span class="s">&#39;&lt;xml /&gt;&#39;</span><span class="p">)</span>

        <span class="n">unsupported_ascii_compatible_encodings</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s">&#39;big5&#39;</span><span class="p">,</span> <span class="s">&#39;big5hkscs&#39;</span><span class="p">,</span>
            <span class="s">&#39;cp932&#39;</span><span class="p">,</span> <span class="s">&#39;cp949&#39;</span><span class="p">,</span> <span class="s">&#39;cp950&#39;</span><span class="p">,</span>
            <span class="s">&#39;euc-jp&#39;</span><span class="p">,</span> <span class="s">&#39;euc-jis-2004&#39;</span><span class="p">,</span> <span class="s">&#39;euc-jisx0213&#39;</span><span class="p">,</span> <span class="s">&#39;euc-kr&#39;</span><span class="p">,</span>
            <span class="s">&#39;gb2312&#39;</span><span class="p">,</span> <span class="s">&#39;gbk&#39;</span><span class="p">,</span> <span class="s">&#39;gb18030&#39;</span><span class="p">,</span>
            <span class="s">&#39;iso2022-kr&#39;</span><span class="p">,</span> <span class="s">&#39;johab&#39;</span><span class="p">,</span>
            <span class="s">&#39;shift-jis&#39;</span><span class="p">,</span> <span class="s">&#39;shift-jis-2004&#39;</span><span class="p">,</span> <span class="s">&#39;shift-jisx0213&#39;</span><span class="p">,</span>
            <span class="s">&#39;utf-7&#39;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">encoding</span> <span class="ow">in</span> <span class="n">unsupported_ascii_compatible_encodings</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">,</span> <span class="n">bxml</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>

        <span class="n">unsupported_ascii_incompatible_encodings</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s">&#39;cp037&#39;</span><span class="p">,</span> <span class="s">&#39;cp424&#39;</span><span class="p">,</span> <span class="s">&#39;cp500&#39;</span><span class="p">,</span> <span class="s">&#39;cp864&#39;</span><span class="p">,</span> <span class="s">&#39;cp875&#39;</span><span class="p">,</span> <span class="s">&#39;cp1026&#39;</span><span class="p">,</span> <span class="s">&#39;cp1140&#39;</span><span class="p">,</span>
            <span class="s">&#39;utf_32&#39;</span><span class="p">,</span> <span class="s">&#39;utf_32_be&#39;</span><span class="p">,</span> <span class="s">&#39;utf_32_le&#39;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">encoding</span> <span class="ow">in</span> <span class="n">unsupported_ascii_incompatible_encodings</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">ParseError</span><span class="p">,</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">,</span> <span class="n">bxml</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">,</span> <span class="n">xml</span><span class="p">(</span><span class="s">&#39;undefined&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">LookupError</span><span class="p">,</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">,</span> <span class="n">xml</span><span class="p">(</span><span class="s">&#39;xxx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_methods"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_methods">[docs]</a>    <span class="k">def</span> <span class="nf">test_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test serialization methods.</span>

        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;html&gt;&lt;link/&gt;&lt;script&gt;1 &amp;lt; 2&lt;/script&gt;&lt;/html&gt;&quot;</span><span class="p">)</span>
        <span class="n">e</span><span class="o">.</span><span class="n">tail</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="s">&#39;&lt;html&gt;&lt;link /&gt;&lt;script&gt;1 &amp;lt; 2&lt;/script&gt;&lt;/html&gt;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="bp">None</span><span class="p">),</span>
                <span class="s">&#39;&lt;html&gt;&lt;link /&gt;&lt;script&gt;1 &amp;lt; 2&lt;/script&gt;&lt;/html&gt;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;xml&quot;</span><span class="p">),</span>
                <span class="s">&#39;&lt;html&gt;&lt;link /&gt;&lt;script&gt;1 &amp;lt; 2&lt;/script&gt;&lt;/html&gt;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;html&quot;</span><span class="p">),</span>
                <span class="s">&#39;&lt;html&gt;&lt;link&gt;&lt;script&gt;1 &lt; 2&lt;/script&gt;&lt;/html&gt;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">),</span> <span class="s">&#39;1 &lt; 2</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_issue18347"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_issue18347">[docs]</a>    <span class="k">def</span> <span class="nf">test_issue18347</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&lt;html&gt;&lt;CamelCase&gt;text&lt;/CamelCase&gt;&lt;/html&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="s">&#39;&lt;html&gt;&lt;CamelCase&gt;text&lt;/CamelCase&gt;&lt;/html&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;html&quot;</span><span class="p">),</span>
                <span class="s">&#39;&lt;html&gt;&lt;CamelCase&gt;text&lt;/CamelCase&gt;&lt;/html&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_entity"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_entity">[docs]</a>    <span class="k">def</span> <span class="nf">test_entity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test entity handling.</span>

        <span class="c"># 1) good entities</span>

        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;document title=&#39;&amp;#x8230;&#39;&gt;test&lt;/document&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;us-ascii&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;document title=&quot;&amp;#33328;&quot;&gt;test&lt;/document&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s">&#39;&lt;document title=&quot;</span><span class="se">\u8230</span><span class="s">&quot;&gt;test&lt;/document&gt;&#39;</span><span class="p">)</span>

        <span class="c"># 2) bad entities</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">ParseError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;document&gt;&amp;entity;&lt;/document&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                <span class="s">&#39;undefined entity: line 1, column 10&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">ParseError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">ENTITY_XML</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                <span class="s">&#39;undefined entity &amp;entity;: line 5, column 10&#39;</span><span class="p">)</span>

        <span class="c"># 3) custom entity</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">()</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">entity</span><span class="p">[</span><span class="s">&quot;entity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;text&quot;</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="n">ENTITY_XML</span><span class="p">)</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s">&#39;&lt;document&gt;text&lt;/document&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_namespace"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_namespace">[docs]</a>    <span class="k">def</span> <span class="nf">test_namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test namespace issues.</span>

        <span class="c"># 1) xml namespace</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;tag xml:lang=&#39;en&#39; /&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;tag xml:lang=&quot;en&quot; /&gt;&#39;</span><span class="p">)</span> <span class="c"># 1.1</span>

        <span class="c"># 2) other &quot;well-known&quot; namespaces</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;rdf:RDF xmlns:rdf=&#39;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#39; /&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span>
            <span class="s">&#39;&lt;rdf:RDF xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot; /&gt;&#39;</span><span class="p">)</span> <span class="c"># 2.1</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;html:html xmlns:html=&#39;http://www.w3.org/1999/xhtml&#39; /&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span>
            <span class="s">&#39;&lt;html:html xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot; /&gt;&#39;</span><span class="p">)</span> <span class="c"># 2.2</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;soap:Envelope xmlns:soap=&#39;http://schemas.xmlsoap.org/soap/envelope&#39; /&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span>
            <span class="s">&#39;&lt;ns0:Envelope xmlns:ns0=&quot;http://schemas.xmlsoap.org/soap/envelope&quot; /&gt;&#39;</span><span class="p">)</span> <span class="c"># 2.3</span>

        <span class="c"># 3) unknown namespaces</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">SAMPLE_XML_NS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span>
            <span class="s">&#39;&lt;ns0:body xmlns:ns0=&quot;http://effbot.org/ns&quot;&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  &lt;ns0:tag&gt;text&lt;/ns0:tag&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  &lt;ns0:tag /&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  &lt;ns0:section&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;    &lt;ns0:tag&gt;subtext&lt;/ns0:tag&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  &lt;/ns0:section&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;&lt;/ns0:body&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_qname"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_qname">[docs]</a>    <span class="k">def</span> <span class="nf">test_qname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test QName handling.</span>

        <span class="c"># 1) decorated tags</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;{uri}tag&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;ns0:tag xmlns:ns0=&quot;uri&quot; /&gt;&#39;</span><span class="p">)</span> <span class="c"># 1.1</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="s">&quot;{uri}tag&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;ns0:tag xmlns:ns0=&quot;uri&quot; /&gt;&#39;</span><span class="p">)</span> <span class="c"># 1.2</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="s">&quot;uri&quot;</span><span class="p">,</span> <span class="s">&quot;tag&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s">&#39;&lt;ns0:tag xmlns:ns0=&quot;uri&quot; /&gt;&#39;</span><span class="p">)</span> <span class="c"># 1.3</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="s">&quot;uri&quot;</span><span class="p">,</span> <span class="s">&quot;tag&quot;</span><span class="p">))</span>
        <span class="n">subelem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">ET</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="s">&quot;uri&quot;</span><span class="p">,</span> <span class="s">&quot;tag1&quot;</span><span class="p">))</span>
        <span class="n">subelem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">ET</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="s">&quot;uri&quot;</span><span class="p">,</span> <span class="s">&quot;tag2&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span>
            <span class="s">&#39;&lt;ns0:tag xmlns:ns0=&quot;uri&quot;&gt;&lt;ns0:tag1 /&gt;&lt;ns0:tag2 /&gt;&lt;/ns0:tag&gt;&#39;</span><span class="p">)</span> <span class="c"># 1.4</span>

        <span class="c"># 2) decorated attributes</span>

        <span class="n">elem</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&quot;{uri}key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;value&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span>
            <span class="s">&#39;&lt;ns0:tag xmlns:ns0=&quot;uri&quot; ns0:key=&quot;value&quot; /&gt;&#39;</span><span class="p">)</span> <span class="c"># 2.1</span>

        <span class="n">elem</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="n">ET</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="s">&quot;{uri}key&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="s">&quot;value&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span>
            <span class="s">&#39;&lt;ns0:tag xmlns:ns0=&quot;uri&quot; ns0:key=&quot;value&quot; /&gt;&#39;</span><span class="p">)</span> <span class="c"># 2.2</span>

        <span class="c"># 3) decorated values are not converted by default, but the</span>
        <span class="c"># QName wrapper can be used for values</span>

        <span class="n">elem</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&quot;{uri}key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;{uri}value&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span>
            <span class="s">&#39;&lt;ns0:tag xmlns:ns0=&quot;uri&quot; ns0:key=&quot;{uri}value&quot; /&gt;&#39;</span><span class="p">)</span> <span class="c"># 3.1</span>

        <span class="n">elem</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&quot;{uri}key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="s">&quot;{uri}value&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span>
            <span class="s">&#39;&lt;ns0:tag xmlns:ns0=&quot;uri&quot; ns0:key=&quot;ns0:value&quot; /&gt;&#39;</span><span class="p">)</span> <span class="c"># 3.2</span>

        <span class="n">elem</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">subelem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">)</span>
        <span class="n">subelem</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&quot;{uri1}key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="s">&quot;{uri2}value&quot;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subelem</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subelem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_check</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span>
            <span class="s">&#39;&lt;ns0:tag xmlns:ns0=&quot;uri&quot; xmlns:ns1=&quot;uri1&quot; xmlns:ns2=&quot;uri2&quot;&gt;&#39;</span>
            <span class="s">&#39;&lt;tag ns1:key=&quot;ns2:value&quot; /&gt;&#39;</span>
            <span class="s">&#39;&lt;tag ns1:key=&quot;ns2:value&quot; /&gt;&#39;</span>
            <span class="s">&#39;&lt;/ns0:tag&gt;&#39;</span><span class="p">)</span> <span class="c"># 3.3</span>

        <span class="c"># 4) Direct QName tests</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="s">&#39;ns&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">)),</span> <span class="s">&#39;{ns}tag&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="s">&#39;{ns}tag&#39;</span><span class="p">)),</span> <span class="s">&#39;{ns}tag&#39;</span><span class="p">)</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="s">&#39;ns&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">)</span>
        <span class="n">q2</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="s">&#39;ns&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
        <span class="n">q2</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">QName</span><span class="p">(</span><span class="s">&#39;ns&#39;</span><span class="p">,</span> <span class="s">&#39;other-tag&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="s">&#39;ns:tag&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="s">&#39;{ns}tag&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_doctype_public"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_doctype_public">[docs]</a>    <span class="k">def</span> <span class="nf">test_doctype_public</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test PUBLIC doctype.</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&lt;!DOCTYPE html PUBLIC&#39;</span>
                <span class="s">&#39; &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;&#39;</span>
                <span class="s">&#39; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&#39;</span>
                <span class="s">&#39;&lt;html&gt;text&lt;/html&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_xpath_tokenizer"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_xpath_tokenizer">[docs]</a>    <span class="k">def</span> <span class="nf">test_xpath_tokenizer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test the XPath tokenizer.</span>
        <span class="kn">from</span> <span class="nn">xml.etree</span> <span class="kn">import</span> <span class="n">ElementPath</span>
        <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([</span><span class="n">op</span> <span class="ow">or</span> <span class="n">tag</span>
                              <span class="k">for</span> <span class="n">op</span><span class="p">,</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">ElementPath</span><span class="o">.</span><span class="n">xpath_tokenizer</span><span class="p">(</span><span class="n">p</span><span class="p">)],</span>
                             <span class="n">expected</span><span class="p">)</span>

        <span class="c"># tests from the xml specification</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;*&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;text()&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;()&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;@name&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;@&#39;</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;@*&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;@&#39;</span><span class="p">,</span> <span class="s">&#39;*&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;para[1]&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;para&#39;</span><span class="p">,</span> <span class="s">&#39;[&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;]&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;para[last()]&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;para&#39;</span><span class="p">,</span> <span class="s">&#39;[&#39;</span><span class="p">,</span> <span class="s">&#39;last&#39;</span><span class="p">,</span> <span class="s">&#39;()&#39;</span><span class="p">,</span> <span class="s">&#39;]&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;*/para&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;*&#39;</span><span class="p">,</span> <span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="s">&#39;para&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;/doc/chapter[5]/section[2]&quot;</span><span class="p">,</span>
              <span class="p">[</span><span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="s">&#39;doc&#39;</span><span class="p">,</span> <span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="s">&#39;chapter&#39;</span><span class="p">,</span> <span class="s">&#39;[&#39;</span><span class="p">,</span> <span class="s">&#39;5&#39;</span><span class="p">,</span> <span class="s">&#39;]&#39;</span><span class="p">,</span>
               <span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="s">&#39;section&#39;</span><span class="p">,</span> <span class="s">&#39;[&#39;</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&#39;]&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;chapter//para&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;chapter&#39;</span><span class="p">,</span> <span class="s">&#39;//&#39;</span><span class="p">,</span> <span class="s">&#39;para&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;//para&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;//&#39;</span><span class="p">,</span> <span class="s">&#39;para&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;//olist/item&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;//&#39;</span><span class="p">,</span> <span class="s">&#39;olist&#39;</span><span class="p">,</span> <span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="s">&#39;item&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;.&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;.//para&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;//&#39;</span><span class="p">,</span> <span class="s">&#39;para&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;..&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;..&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;../@lang&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;..&#39;</span><span class="p">,</span> <span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="s">&#39;@&#39;</span><span class="p">,</span> <span class="s">&#39;lang&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;chapter[title]&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;chapter&#39;</span><span class="p">,</span> <span class="s">&#39;[&#39;</span><span class="p">,</span> <span class="s">&#39;title&#39;</span><span class="p">,</span> <span class="s">&#39;]&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;employee[@secretary and @assistant]&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;employee&#39;</span><span class="p">,</span>
              <span class="s">&#39;[&#39;</span><span class="p">,</span> <span class="s">&#39;@&#39;</span><span class="p">,</span> <span class="s">&#39;secretary&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;and&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;@&#39;</span><span class="p">,</span> <span class="s">&#39;assistant&#39;</span><span class="p">,</span> <span class="s">&#39;]&#39;</span><span class="p">])</span>

        <span class="c"># additional tests</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;{http://spam}egg&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;{http://spam}egg&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;./spam.egg&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="s">&#39;spam.egg&#39;</span><span class="p">])</span>
        <span class="n">check</span><span class="p">(</span><span class="s">&quot;.//{http://spam}egg&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;//&#39;</span><span class="p">,</span> <span class="s">&#39;{http://spam}egg&#39;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_processinginstruction"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_processinginstruction">[docs]</a>    <span class="k">def</span> <span class="nf">test_processinginstruction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test ProcessingInstruction directly</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">ProcessingInstruction</span><span class="p">(</span><span class="s">&#39;test&#39;</span><span class="p">,</span> <span class="s">&#39;instruction&#39;</span><span class="p">)),</span>
                <span class="n">b</span><span class="s">&#39;&lt;?test instruction?&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">PI</span><span class="p">(</span><span class="s">&#39;test&#39;</span><span class="p">,</span> <span class="s">&#39;instruction&#39;</span><span class="p">)),</span>
                <span class="n">b</span><span class="s">&#39;&lt;?test instruction?&gt;&#39;</span><span class="p">)</span>

        <span class="c"># Issue #2746</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">PI</span><span class="p">(</span><span class="s">&#39;test&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;testing&amp;&gt;&#39;</span><span class="p">)),</span>
                <span class="n">b</span><span class="s">&#39;&lt;?test &lt;testing&amp;&gt;?&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">PI</span><span class="p">(</span><span class="s">&#39;test&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;testing&amp;&gt;</span><span class="se">\xe3</span><span class="s">&#39;</span><span class="p">),</span> <span class="s">&#39;latin-1&#39;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;latin-1&#39;?&gt;</span><span class="se">\n</span><span class="s">&quot;</span>
                <span class="n">b</span><span class="s">&quot;&lt;?test &lt;testing&amp;&gt;</span><span class="se">\xe3</span><span class="s">?&gt;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTest.test_html_empty_elems_serialization"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTest.test_html_empty_elems_serialization">[docs]</a>    <span class="k">def</span> <span class="nf">test_html_empty_elems_serialization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># issue 15970</span>
        <span class="c"># from http://www.w3.org/TR/html401/index/elements.html</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;AREA&#39;</span><span class="p">,</span> <span class="s">&#39;BASE&#39;</span><span class="p">,</span> <span class="s">&#39;BASEFONT&#39;</span><span class="p">,</span> <span class="s">&#39;BR&#39;</span><span class="p">,</span> <span class="s">&#39;COL&#39;</span><span class="p">,</span> <span class="s">&#39;FRAME&#39;</span><span class="p">,</span> <span class="s">&#39;HR&#39;</span><span class="p">,</span>
                        <span class="s">&#39;IMG&#39;</span><span class="p">,</span> <span class="s">&#39;INPUT&#39;</span><span class="p">,</span> <span class="s">&#39;ISINDEX&#39;</span><span class="p">,</span> <span class="s">&#39;LINK&#39;</span><span class="p">,</span> <span class="s">&#39;META&#39;</span><span class="p">,</span> <span class="s">&#39;PARAM&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="p">[</span><span class="n">element</span><span class="p">,</span> <span class="n">element</span><span class="o">.</span><span class="n">lower</span><span class="p">()]:</span>
                <span class="n">expected</span> <span class="o">=</span> <span class="s">&#39;&lt;</span><span class="si">%s</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="n">elem</span>
                <span class="n">serialized</span> <span class="o">=</span> <span class="n">serialize</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&lt;</span><span class="si">%s</span><span class="s"> /&gt;&#39;</span> <span class="o">%</span> <span class="n">elem</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;html&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialized</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
                <span class="n">serialized</span> <span class="o">=</span> <span class="n">serialize</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&lt;</span><span class="si">%s</span><span class="s">&gt;&lt;/</span><span class="si">%s</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">elem</span><span class="p">,</span><span class="n">elem</span><span class="p">)),</span>
                                       <span class="n">method</span><span class="o">=</span><span class="s">&#39;html&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialized</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="XMLPullParserTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XMLPullParserTest">[docs]</a><span class="k">class</span> <span class="nc">XMLPullParserTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">_feed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">chunk_size</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">):</span>
                <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">chunk_size</span><span class="p">])</span>

<div class="viewcode-block" id="XMLPullParserTest.assert_event_tags"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XMLPullParserTest.assert_event_tags">[docs]</a>    <span class="k">def</span> <span class="nf">assert_event_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
        <span class="n">events</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">read_events</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">([(</span><span class="n">action</span><span class="p">,</span> <span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span> <span class="k">for</span> <span class="n">action</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">events</span><span class="p">],</span>
                         <span class="n">expected</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="XMLPullParserTest.test_simple_xml"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XMLPullParserTest.test_simple_xml">[docs]</a>    <span class="k">def</span> <span class="nf">test_simple_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">chunk_size</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">subTest</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">):</span>
                <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLPullParser</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;!-- comment --&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span>
                           <span class="s">&quot;&lt;root&gt;</span><span class="se">\n</span><span class="s">  &lt;element key=&#39;value&#39;&gt;text&lt;/element&quot;</span><span class="p">,</span>
                           <span class="n">chunk_size</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">)])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;element&gt;text&lt;/element&gt;tail</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;empty-element/&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[</span>
                    <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;empty-element&#39;</span><span class="p">),</span>
                    <span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;/root&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;root&#39;</span><span class="p">)])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="XMLPullParserTest.test_feed_while_iterating"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XMLPullParserTest.test_feed_while_iterating">[docs]</a>    <span class="k">def</span> <span class="nf">test_feed_while_iterating</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLPullParser</span><span class="p">()</span>
        <span class="n">it</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">read_events</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;root&gt;</span><span class="se">\n</span><span class="s">  &lt;element key=&#39;value&#39;&gt;text&lt;/element&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">action</span><span class="p">,</span> <span class="n">elem</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="n">action</span><span class="p">,</span> <span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;/root&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">action</span><span class="p">,</span> <span class="n">elem</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="n">action</span><span class="p">,</span> <span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;root&#39;</span><span class="p">))</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">StopIteration</span><span class="p">):</span>
            <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="XMLPullParserTest.test_simple_xml_with_ns"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XMLPullParserTest.test_simple_xml_with_ns">[docs]</a>    <span class="k">def</span> <span class="nf">test_simple_xml_with_ns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLPullParser</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;!-- comment --&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;root xmlns=&#39;namespace&#39;&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;element key=&#39;value&#39;&gt;text&lt;/element&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}element&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;element&gt;text&lt;/element&gt;tail</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;empty-element/&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}element&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}empty-element&#39;</span><span class="p">),</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;/root&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{namespace}root&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="XMLPullParserTest.test_ns_events"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XMLPullParserTest.test_ns_events">[docs]</a>    <span class="k">def</span> <span class="nf">test_ns_events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLPullParser</span><span class="p">(</span><span class="n">events</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;start-ns&#39;</span><span class="p">,</span> <span class="s">&#39;end-ns&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;!-- comment --&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;root xmlns=&#39;namespace&#39;&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">read_events</span><span class="p">()),</span>
            <span class="p">[(</span><span class="s">&#39;start-ns&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;namespace&#39;</span><span class="p">))])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;element key=&#39;value&#39;&gt;text&lt;/element&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;element&gt;text&lt;/element&gt;tail</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;empty-element/&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;/root&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">read_events</span><span class="p">()),</span> <span class="p">[(</span><span class="s">&#39;end-ns&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="XMLPullParserTest.test_events"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XMLPullParserTest.test_events">[docs]</a>    <span class="k">def</span> <span class="nf">test_events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLPullParser</span><span class="p">(</span><span class="n">events</span><span class="o">=</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;root/&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[])</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLPullParser</span><span class="p">(</span><span class="n">events</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;end&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;!-- comment --&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;root&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;root&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;element key=&#39;value&#39;&gt;text&lt;/element&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span>
                   <span class="s">&quot;&lt;element xmlns=&#39;foo&#39;&gt;text&lt;empty-element/&gt;&lt;/element&gt;tail</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;{foo}element&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;{foo}empty-element&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{foo}empty-element&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;{foo}element&#39;</span><span class="p">),</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;/root&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;root&#39;</span><span class="p">)])</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLPullParser</span><span class="p">(</span><span class="n">events</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;!-- comment --&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;root&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;root&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;element key=&#39;value&#39;&gt;text&lt;/element&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span>
                   <span class="s">&quot;&lt;element xmlns=&#39;foo&#39;&gt;text&lt;empty-element/&gt;&lt;/element&gt;tail</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[</span>
            <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;{foo}element&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;{foo}empty-element&#39;</span><span class="p">),</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;/root&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="XMLPullParserTest.test_events_sequence"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XMLPullParserTest.test_events_sequence">[docs]</a>    <span class="k">def</span> <span class="nf">test_events_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test that events can be some sequence that&#39;s not just a tuple or list</span>
        <span class="n">eventset</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;start&#39;</span><span class="p">}</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLPullParser</span><span class="p">(</span><span class="n">events</span><span class="o">=</span><span class="n">eventset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;foo&gt;bar&lt;/foo&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">)])</span>

        <span class="k">class</span> <span class="nc">DummyIter</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">([</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;start-ns&#39;</span><span class="p">])</span>
            <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span>
            <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">)</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLPullParser</span><span class="p">(</span><span class="n">events</span><span class="o">=</span><span class="n">DummyIter</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s">&quot;&lt;foo&gt;bar&lt;/foo&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_event_tags</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">)])</span>

</div>
<div class="viewcode-block" id="XMLPullParserTest.test_unknown_event"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XMLPullParserTest.test_unknown_event">[docs]</a>    <span class="k">def</span> <span class="nf">test_unknown_event</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">XMLPullParser</span><span class="p">(</span><span class="n">events</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="s">&#39;bogus&#39;</span><span class="p">))</span>


<span class="c">#</span>
<span class="c"># xinclude tests (samples from appendix C of the xinclude specification)</span>
</div></div>
<span class="n">XINCLUDE</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">XINCLUDE</span><span class="p">[</span><span class="s">&quot;C1.xml&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">&lt;?xml version=&#39;1.0&#39;?&gt;</span>
<span class="s">&lt;document xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&gt;</span>
<span class="s">  &lt;p&gt;120 Mz is adequate for an average home user.&lt;/p&gt;</span>
<span class="s">  &lt;xi:include href=&quot;disclaimer.xml&quot;/&gt;</span>
<span class="s">&lt;/document&gt;</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">XINCLUDE</span><span class="p">[</span><span class="s">&quot;disclaimer.xml&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">&lt;?xml version=&#39;1.0&#39;?&gt;</span>
<span class="s">&lt;disclaimer&gt;</span>
<span class="s">  &lt;p&gt;The opinions represented herein represent those of the individual</span>
<span class="s">  and should not be interpreted as official policy endorsed by this</span>
<span class="s">  organization.&lt;/p&gt;</span>
<span class="s">&lt;/disclaimer&gt;</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">XINCLUDE</span><span class="p">[</span><span class="s">&quot;C2.xml&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">&lt;?xml version=&#39;1.0&#39;?&gt;</span>
<span class="s">&lt;document xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&gt;</span>
<span class="s">  &lt;p&gt;This document has been accessed</span>
<span class="s">  &lt;xi:include href=&quot;count.txt&quot; parse=&quot;text&quot;/&gt; times.&lt;/p&gt;</span>
<span class="s">&lt;/document&gt;</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">XINCLUDE</span><span class="p">[</span><span class="s">&quot;count.txt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;324387&quot;</span>

<span class="n">XINCLUDE</span><span class="p">[</span><span class="s">&quot;C2b.xml&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">&lt;?xml version=&#39;1.0&#39;?&gt;</span>
<span class="s">&lt;document xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&gt;</span>
<span class="s">  &lt;p&gt;This document has been &lt;em&gt;accessed&lt;/em&gt;</span>
<span class="s">  &lt;xi:include href=&quot;count.txt&quot; parse=&quot;text&quot;/&gt; times.&lt;/p&gt;</span>
<span class="s">&lt;/document&gt;</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">XINCLUDE</span><span class="p">[</span><span class="s">&quot;C3.xml&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">&lt;?xml version=&#39;1.0&#39;?&gt;</span>
<span class="s">&lt;document xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&gt;</span>
<span class="s">  &lt;p&gt;The following is the source of the &quot;data.xml&quot; resource:&lt;/p&gt;</span>
<span class="s">  &lt;example&gt;&lt;xi:include href=&quot;data.xml&quot; parse=&quot;text&quot;/&gt;&lt;/example&gt;</span>
<span class="s">&lt;/document&gt;</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">XINCLUDE</span><span class="p">[</span><span class="s">&quot;data.xml&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">&lt;?xml version=&#39;1.0&#39;?&gt;</span>
<span class="s">&lt;data&gt;</span>
<span class="s">  &lt;item&gt;&lt;![CDATA[Brooks &amp; Shields]]&gt;&lt;/item&gt;</span>
<span class="s">&lt;/data&gt;</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">XINCLUDE</span><span class="p">[</span><span class="s">&quot;C5.xml&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">&lt;?xml version=&#39;1.0&#39;?&gt;</span>
<span class="s">&lt;div xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&gt;</span>
<span class="s">  &lt;xi:include href=&quot;example.txt&quot; parse=&quot;text&quot;&gt;</span>
<span class="s">    &lt;xi:fallback&gt;</span>
<span class="s">      &lt;xi:include href=&quot;fallback-example.txt&quot; parse=&quot;text&quot;&gt;</span>
<span class="s">        &lt;xi:fallback&gt;&lt;a href=&quot;mailto:bob@example.org&quot;&gt;Report error&lt;/a&gt;&lt;/xi:fallback&gt;</span>
<span class="s">      &lt;/xi:include&gt;</span>
<span class="s">    &lt;/xi:fallback&gt;</span>
<span class="s">  &lt;/xi:include&gt;</span>
<span class="s">&lt;/div&gt;</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">XINCLUDE</span><span class="p">[</span><span class="s">&quot;default.xml&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">&lt;?xml version=&#39;1.0&#39;?&gt;</span>
<span class="s">&lt;document xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&gt;</span>
<span class="s">  &lt;p&gt;Example.&lt;/p&gt;</span>
<span class="s">  &lt;xi:include href=&quot;{}&quot;/&gt;</span>
<span class="s">&lt;/document&gt;</span>
<span class="s">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">SIMPLE_XMLFILE</span><span class="p">,</span> <span class="bp">True</span><span class="p">))</span>

<span class="c">#</span>
<span class="c"># badly formatted xi:include tags</span>

<span class="n">XINCLUDE_BAD</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">XINCLUDE_BAD</span><span class="p">[</span><span class="s">&quot;B1.xml&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">&lt;?xml version=&#39;1.0&#39;?&gt;</span>
<span class="s">&lt;document xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&gt;</span>
<span class="s">  &lt;p&gt;120 Mz is adequate for an average home user.&lt;/p&gt;</span>
<span class="s">  &lt;xi:include href=&quot;disclaimer.xml&quot; parse=&quot;BAD_TYPE&quot;/&gt;</span>
<span class="s">&lt;/document&gt;</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">XINCLUDE_BAD</span><span class="p">[</span><span class="s">&quot;B2.xml&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">&lt;?xml version=&#39;1.0&#39;?&gt;</span>
<span class="s">&lt;div xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&gt;</span>
<span class="s">    &lt;xi:fallback&gt;&lt;/xi:fallback&gt;</span>
<span class="s">&lt;/div&gt;</span>
<span class="s">&quot;&quot;&quot;</span>

<div class="viewcode-block" id="XIncludeTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XIncludeTest">[docs]</a><span class="k">class</span> <span class="nc">XIncludeTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="XIncludeTest.xinclude_loader"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XIncludeTest.xinclude_loader">[docs]</a>    <span class="k">def</span> <span class="nf">xinclude_loader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">href</span><span class="p">,</span> <span class="n">parse</span><span class="o">=</span><span class="s">&quot;xml&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">XINCLUDE</span><span class="p">[</span><span class="n">href</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="s">&quot;resource not found&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parse</span> <span class="o">==</span> <span class="s">&quot;xml&quot;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>
</div>
<div class="viewcode-block" id="XIncludeTest.none_loader"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XIncludeTest.none_loader">[docs]</a>    <span class="k">def</span> <span class="nf">none_loader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">href</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">None</span>
</div>
    <span class="k">def</span> <span class="nf">_my_loader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">href</span><span class="p">,</span> <span class="n">parse</span><span class="p">):</span>
        <span class="c"># Used to avoid a test-dependency problem where the default loader</span>
        <span class="c"># of ElementInclude uses the pyET parser for cET tests.</span>
        <span class="k">if</span> <span class="n">parse</span> <span class="o">==</span> <span class="s">&#39;xml&#39;</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">href</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

<div class="viewcode-block" id="XIncludeTest.test_xinclude_default"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XIncludeTest.test_xinclude_default">[docs]</a>    <span class="k">def</span> <span class="nf">test_xinclude_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">xml.etree</span> <span class="kn">import</span> <span class="n">ElementInclude</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xinclude_loader</span><span class="p">(</span><span class="s">&#39;default.xml&#39;</span><span class="p">)</span>
        <span class="n">ElementInclude</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_my_loader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span>
            <span class="s">&#39;&lt;document&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  &lt;p&gt;Example.&lt;/p&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  &lt;root&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;   &lt;element key=&quot;value&quot;&gt;text&lt;/element&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;   &lt;element&gt;text&lt;/element&gt;tail</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;   &lt;empty-element /&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;&lt;/root&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;&lt;/document&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="XIncludeTest.test_xinclude"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XIncludeTest.test_xinclude">[docs]</a>    <span class="k">def</span> <span class="nf">test_xinclude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">xml.etree</span> <span class="kn">import</span> <span class="n">ElementInclude</span>

        <span class="c"># Basic inclusion example (XInclude C.1)</span>
        <span class="n">document</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xinclude_loader</span><span class="p">(</span><span class="s">&quot;C1.xml&quot;</span><span class="p">)</span>
        <span class="n">ElementInclude</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xinclude_loader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">document</span><span class="p">),</span>
            <span class="s">&#39;&lt;document&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  &lt;p&gt;120 Mz is adequate for an average home user.&lt;/p&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  &lt;disclaimer&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  &lt;p&gt;The opinions represented herein represent those of the individual</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  and should not be interpreted as official policy endorsed by this</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  organization.&lt;/p&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;&lt;/disclaimer&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;&lt;/document&gt;&#39;</span><span class="p">)</span> <span class="c"># C1</span>

        <span class="c"># Textual inclusion example (XInclude C.2)</span>
        <span class="n">document</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xinclude_loader</span><span class="p">(</span><span class="s">&quot;C2.xml&quot;</span><span class="p">)</span>
        <span class="n">ElementInclude</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xinclude_loader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">document</span><span class="p">),</span>
            <span class="s">&#39;&lt;document&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  &lt;p&gt;This document has been accessed</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  324387 times.&lt;/p&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;&lt;/document&gt;&#39;</span><span class="p">)</span> <span class="c"># C2</span>

        <span class="c"># Textual inclusion after sibling element (based on modified XInclude C.2)</span>
        <span class="n">document</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xinclude_loader</span><span class="p">(</span><span class="s">&quot;C2b.xml&quot;</span><span class="p">)</span>
        <span class="n">ElementInclude</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xinclude_loader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">document</span><span class="p">),</span>
            <span class="s">&#39;&lt;document&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  &lt;p&gt;This document has been &lt;em&gt;accessed&lt;/em&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  324387 times.&lt;/p&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;&lt;/document&gt;&#39;</span><span class="p">)</span> <span class="c"># C2b</span>

        <span class="c"># Textual inclusion of XML example (XInclude C.3)</span>
        <span class="n">document</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xinclude_loader</span><span class="p">(</span><span class="s">&quot;C3.xml&quot;</span><span class="p">)</span>
        <span class="n">ElementInclude</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xinclude_loader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">document</span><span class="p">),</span>
            <span class="s">&#39;&lt;document&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  &lt;p&gt;The following is the source of the &quot;data.xml&quot; resource:&lt;/p&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&quot;  &lt;example&gt;&amp;lt;?xml version=&#39;1.0&#39;?&amp;gt;</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="s">&#39;&amp;lt;data&amp;gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  &amp;lt;item&amp;gt;&amp;lt;![CDATA[Brooks &amp;amp; Shields]]&amp;gt;&amp;lt;/item&amp;gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;&amp;lt;/data&amp;gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;&lt;/example&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;&lt;/document&gt;&#39;</span><span class="p">)</span> <span class="c"># C3</span>

        <span class="c"># Fallback example (XInclude C.5)</span>
        <span class="c"># Note! Fallback support is not yet implemented</span>
        <span class="n">document</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xinclude_loader</span><span class="p">(</span><span class="s">&quot;C5.xml&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">ElementInclude</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xinclude_loader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span> <span class="s">&#39;resource not found&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">document</span><span class="p">),</span>
            <span class="s">&#39;&lt;div xmlns:ns0=&quot;http://www.w3.org/2001/XInclude&quot;&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  &lt;ns0:include href=&quot;example.txt&quot; parse=&quot;text&quot;&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;    &lt;ns0:fallback&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;      &lt;ns0:include href=&quot;fallback-example.txt&quot; parse=&quot;text&quot;&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;        &lt;ns0:fallback&gt;&lt;a href=&quot;mailto:bob@example.org&quot;&gt;Report error&lt;/a&gt;&lt;/ns0:fallback&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;      &lt;/ns0:include&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;    &lt;/ns0:fallback&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;  &lt;/ns0:include&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="s">&#39;&lt;/div&gt;&#39;</span><span class="p">)</span> <span class="c"># C5</span>
</div>
<div class="viewcode-block" id="XIncludeTest.test_xinclude_failures"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XIncludeTest.test_xinclude_failures">[docs]</a>    <span class="k">def</span> <span class="nf">test_xinclude_failures</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">xml.etree</span> <span class="kn">import</span> <span class="n">ElementInclude</span>

        <span class="c"># Test failure to locate included XML file.</span>
        <span class="n">document</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">XINCLUDE</span><span class="p">[</span><span class="s">&quot;C1.xml&quot;</span><span class="p">])</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">ElementInclude</span><span class="o">.</span><span class="n">FatalIncludeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">ElementInclude</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">loader</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">none_loader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                <span class="s">&quot;cannot load &#39;disclaimer.xml&#39; as &#39;xml&#39;&quot;</span><span class="p">)</span>

        <span class="c"># Test failure to locate included text file.</span>
        <span class="n">document</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">XINCLUDE</span><span class="p">[</span><span class="s">&quot;C2.xml&quot;</span><span class="p">])</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">ElementInclude</span><span class="o">.</span><span class="n">FatalIncludeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">ElementInclude</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">loader</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">none_loader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                <span class="s">&quot;cannot load &#39;count.txt&#39; as &#39;text&#39;&quot;</span><span class="p">)</span>

        <span class="c"># Test bad parse type.</span>
        <span class="n">document</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">XINCLUDE_BAD</span><span class="p">[</span><span class="s">&quot;B1.xml&quot;</span><span class="p">])</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">ElementInclude</span><span class="o">.</span><span class="n">FatalIncludeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">ElementInclude</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">loader</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">none_loader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                <span class="s">&quot;unknown parse type in xi:include tag (&#39;BAD_TYPE&#39;)&quot;</span><span class="p">)</span>

        <span class="c"># Test xi:fallback outside xi:include.</span>
        <span class="n">document</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">XINCLUDE_BAD</span><span class="p">[</span><span class="s">&quot;B2.xml&quot;</span><span class="p">])</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">ElementInclude</span><span class="o">.</span><span class="n">FatalIncludeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">ElementInclude</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">loader</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">none_loader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                <span class="s">&quot;xi:fallback tag must be child of xi:include &quot;</span>
                <span class="s">&quot;(&#39;{http://www.w3.org/2001/XInclude}fallback&#39;)&quot;</span><span class="p">)</span>

<span class="c"># --------------------------------------------------------------------</span>
<span class="c"># reported bugs</span>
</div></div>
<div class="viewcode-block" id="BugsTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest">[docs]</a><span class="k">class</span> <span class="nc">BugsTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="BugsTest.test_bug_xmltoolkit21"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_xmltoolkit21">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_xmltoolkit21</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># marshaller gives obscure errors for non-string values</span>

        <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">elem</span><span class="p">):</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
                <span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                    <span class="s">&#39;cannot serialize 123 (type int)&#39;</span><span class="p">)</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
        <span class="n">check</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="c"># tag</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;elem&quot;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="mi">123</span>
        <span class="n">check</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="c"># text</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;elem&quot;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">tail</span> <span class="o">=</span> <span class="mi">123</span>
        <span class="n">check</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="c"># tail</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;elem&quot;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="s">&quot;123&quot;</span><span class="p">)</span>
        <span class="n">check</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="c"># attribute key</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;elem&quot;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;123&quot;</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span>
        <span class="n">check</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="c"># attribute value</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_xmltoolkit25"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_xmltoolkit25">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_xmltoolkit25</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># typo in ElementTree.findtext</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">SAMPLE_XML</span><span class="p">)</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">),</span> <span class="s">&#39;text&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s">&quot;section/tag&quot;</span><span class="p">),</span> <span class="s">&#39;subtext&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_xmltoolkit28"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_xmltoolkit28">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_xmltoolkit28</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># .//tag causes exceptions</span>

        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;doc&gt;&lt;table&gt;&lt;tbody/&gt;&lt;/table&gt;&lt;/doc&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&quot;.//thead&quot;</span><span class="p">)),</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&quot;.//tbody&quot;</span><span class="p">)),</span> <span class="p">[</span><span class="s">&#39;tbody&#39;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_xmltoolkitX1"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_xmltoolkitX1">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_xmltoolkitX1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># dump() doesn&#39;t flush the output buffer</span>

        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;doc&gt;&lt;table&gt;&lt;tbody/&gt;&lt;/table&gt;&lt;/doc&gt;&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">support</span><span class="o">.</span><span class="n">captured_stdout</span><span class="p">()</span> <span class="k">as</span> <span class="n">stdout</span><span class="p">:</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">stdout</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span> <span class="s">&#39;&lt;doc&gt;&lt;table&gt;&lt;tbody /&gt;&lt;/table&gt;&lt;/doc&gt;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_xmltoolkit39"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_xmltoolkit39">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_xmltoolkit39</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># non-ascii element and attribute names doesn&#39;t work</span>

        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;iso-8859-1&#39;?&gt;&lt;t</span><span class="se">\xe4</span><span class="s">g /&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="s">&quot;utf-8&quot;</span><span class="p">),</span> <span class="n">b</span><span class="s">&#39;&lt;t</span><span class="se">\xc3\xa4</span><span class="s">g /&gt;&#39;</span><span class="p">)</span>

        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;iso-8859-1&#39;?&gt;&quot;</span>
                      <span class="n">b</span><span class="s">&quot;&lt;tag </span><span class="se">\xe4</span><span class="s">ttr=&#39;v&amp;#228;lue&#39; /&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">attrib</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;</span><span class="se">\xe4</span><span class="s">ttr&#39;</span><span class="p">:</span> <span class="s">&#39;v</span><span class="se">\xe4</span><span class="s">lue&#39;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="s">&quot;utf-8&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;tag </span><span class="se">\xc3\xa4</span><span class="s">ttr=&quot;v</span><span class="se">\xc3\xa4</span><span class="s">lue&quot; /&gt;&#39;</span><span class="p">)</span>

        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;iso-8859-1&#39;?&gt;&quot;</span>
                      <span class="n">b</span><span class="s">&#39;&lt;t</span><span class="se">\xe4</span><span class="s">g&gt;text&lt;/t</span><span class="se">\xe4</span><span class="s">g&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="s">&quot;utf-8&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;t</span><span class="se">\xc3\xa4</span><span class="s">g&gt;text&lt;/t</span><span class="se">\xc3\xa4</span><span class="s">g&gt;&#39;</span><span class="p">)</span>

        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;t</span><span class="se">\u00e4</span><span class="s">g&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="s">&quot;utf-8&quot;</span><span class="p">),</span> <span class="n">b</span><span class="s">&#39;&lt;t</span><span class="se">\xc3\xa4</span><span class="s">g /&gt;&#39;</span><span class="p">)</span>

        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">)</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\u00e4</span><span class="s">ttr&quot;</span><span class="p">,</span> <span class="s">&quot;v</span><span class="se">\u00e4</span><span class="s">lue&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="s">&quot;utf-8&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;tag </span><span class="se">\xc3\xa4</span><span class="s">ttr=&quot;v</span><span class="se">\xc3\xa4</span><span class="s">lue&quot; /&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_xmltoolkit54"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_xmltoolkit54">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_xmltoolkit54</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># problems handling internally defined entities</span>

        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;!DOCTYPE doc [&lt;!ENTITY ldots &#39;&amp;#x8230;&#39;&gt;]&gt;&quot;</span>
                   <span class="s">&#39;&lt;doc&gt;&amp;ldots;&lt;/doc&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;us-ascii&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;doc&gt;&amp;#33328;&lt;/doc&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s">&#39;&lt;doc&gt;</span><span class="se">\u8230</span><span class="s">&lt;/doc&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_xmltoolkit55"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_xmltoolkit55">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_xmltoolkit55</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># make sure we&#39;re reporting the first error, not the last</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">ParseError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;!DOCTYPE doc SYSTEM &#39;doc.dtd&#39;&gt;&quot;</span>
                   <span class="n">b</span><span class="s">&#39;&lt;doc&gt;&amp;ldots;&amp;ndots;&amp;rdots;&lt;/doc&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                <span class="s">&#39;undefined entity &amp;ldots;: line 1, column 36&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_xmltoolkit60"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_xmltoolkit60">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_xmltoolkit60</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Handle crash in stream source.</span>

        <span class="k">class</span> <span class="nc">ExceptionFile</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">OSError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">,</span> <span class="n">ExceptionFile</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_xmltoolkit62"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_xmltoolkit62">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_xmltoolkit62</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Don&#39;t crash when using custom entities.</span>

        <span class="n">ENTITIES</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;rsquo&#39;</span><span class="p">:</span> <span class="s">&#39;</span><span class="se">\u2019</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;lsquo&#39;</span><span class="p">:</span> <span class="s">&#39;</span><span class="se">\u2018</span><span class="s">&#39;</span><span class="p">}</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">()</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ENTITIES</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="s">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="s">&lt;!DOCTYPE patent-application-publication SYSTEM &quot;pap-v15-2001-01-31.dtd&quot; []&gt;</span>
<span class="s">&lt;patent-application-publication&gt;</span>
<span class="s">&lt;subdoc-abstract&gt;</span>
<span class="s">&lt;paragraph id=&quot;A-0001&quot; lvl=&quot;0&quot;&gt;A new cultivar of Begonia plant named &amp;lsquo;BCT9801BEG&amp;rsquo;.&lt;/paragraph&gt;</span>
<span class="s">&lt;/subdoc-abstract&gt;</span>
<span class="s">&lt;/patent-application-publication&gt;&quot;&quot;&quot;</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;.//paragraph&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
            <span class="s">&#39;A new cultivar of Begonia plant named </span><span class="se">\u2018</span><span class="s">BCT9801BEG</span><span class="se">\u2019</span><span class="s">.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_xmltoolkit63"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_xmltoolkit63">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_xmltoolkit63</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Check reference leak.</span>
        <span class="k">def</span> <span class="nf">xmltoolkit63</span><span class="p">():</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">TreeBuilder</span><span class="p">()</span>
            <span class="n">tree</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">tree</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">)</span>
            <span class="n">tree</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">)</span>

        <span class="n">xmltoolkit63</span><span class="p">()</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getrefcount</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
            <span class="n">xmltoolkit63</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">getrefcount</span><span class="p">(</span><span class="bp">None</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_200708_newline"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_200708_newline">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_200708_newline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Preserve newlines in attributes.</span>

        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;SomeTag&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">&quot;def _f():</span><span class="se">\n</span><span class="s">  return 3</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;SomeTag text=&quot;def _f():&amp;#10;  return 3&amp;#10;&quot; /&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">e</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">),</span>
                <span class="s">&#39;def _f():</span><span class="se">\n</span><span class="s">  return 3</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">e</span><span class="p">))),</span>
                <span class="n">b</span><span class="s">&#39;&lt;SomeTag text=&quot;def _f():&amp;#10;  return 3&amp;#10;&quot; /&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_200708_close"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_200708_close">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_200708_close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test default builder.</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">()</span> <span class="c"># default</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="s">&quot;&lt;element&gt;some text&lt;/element&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">)</span>

        <span class="c"># Test custom builder.</span>
        <span class="k">class</span> <span class="nc">EchoTarget</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;element&quot;</span><span class="p">)</span> <span class="c"># simulate root</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">EchoTarget</span><span class="p">())</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="s">&quot;&lt;element&gt;some text&lt;/element&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;element&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_200709_default_namespace"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_200709_default_namespace">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_200709_default_namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;{default}elem&quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s">&quot;{default}elem&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">default_namespace</span><span class="o">=</span><span class="s">&quot;default&quot;</span><span class="p">),</span> <span class="c"># 1</span>
                <span class="s">&#39;&lt;elem xmlns=&quot;default&quot;&gt;&lt;elem /&gt;&lt;/elem&gt;&#39;</span><span class="p">)</span>

        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;{default}elem&quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s">&quot;{default}elem&quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s">&quot;{not-default}elem&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">default_namespace</span><span class="o">=</span><span class="s">&quot;default&quot;</span><span class="p">),</span> <span class="c"># 2</span>
            <span class="s">&#39;&lt;elem xmlns=&quot;default&quot; xmlns:ns1=&quot;not-default&quot;&gt;&#39;</span>
            <span class="s">&#39;&lt;elem /&gt;&#39;</span>
            <span class="s">&#39;&lt;ns1:elem /&gt;&#39;</span>
            <span class="s">&#39;&lt;/elem&gt;&#39;</span><span class="p">)</span>

        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;{default}elem&quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s">&quot;{default}elem&quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s">&quot;elem&quot;</span><span class="p">)</span> <span class="c"># unprefixed name</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="n">serialize</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">default_namespace</span><span class="o">=</span><span class="s">&quot;default&quot;</span><span class="p">)</span> <span class="c"># 3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="p">),</span>
                <span class="s">&#39;cannot use non-qualified names with default_namespace option&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_200709_register_namespace"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_200709_register_namespace">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_200709_register_namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;{http://namespace.invalid/does/not/exist/}title&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
            <span class="n">b</span><span class="s">&#39;&lt;ns0:title xmlns:ns0=&quot;http://namespace.invalid/does/not/exist/&quot; /&gt;&#39;</span><span class="p">)</span>
        <span class="n">ET</span><span class="o">.</span><span class="n">register_namespace</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;http://namespace.invalid/does/not/exist/&quot;</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;{http://namespace.invalid/does/not/exist/}title&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
            <span class="n">b</span><span class="s">&#39;&lt;foo:title xmlns:foo=&quot;http://namespace.invalid/does/not/exist/&quot; /&gt;&#39;</span><span class="p">)</span>

        <span class="c"># And the Dublin Core namespace is in the default list:</span>

        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;{http://purl.org/dc/elements/1.1/}title&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
            <span class="n">b</span><span class="s">&#39;&lt;dc:title xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot; /&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_200709_element_comment"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_200709_element_comment">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_200709_element_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Not sure if this can be fixed, really (since the serializer needs</span>
        <span class="c"># ET.Comment, not cET.comment).</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">Comment</span><span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="n">ET</span><span class="o">.</span><span class="n">Comment</span><span class="p">)</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">PI</span><span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="n">ET</span><span class="o">.</span><span class="n">PI</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_200709_element_insert"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_200709_element_insert">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_200709_element_insert</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">])</span>
        <span class="n">a</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_200709_iter_comment"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_200709_iter_comment">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_200709_iter_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">comment_b</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Comment</span><span class="p">(</span><span class="s">&quot;TEST-b&quot;</span><span class="p">)</span>
        <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comment_b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">iter</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">Comment</span><span class="p">)),</span> <span class="p">[</span><span class="n">ET</span><span class="o">.</span><span class="n">Comment</span><span class="p">])</span>

    <span class="c"># --------------------------------------------------------------------</span>
    <span class="c"># reported on bugs.python.org</span>
</div>
<div class="viewcode-block" id="BugsTest.test_bug_1534630"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_bug_1534630">[docs]</a>    <span class="k">def</span> <span class="nf">test_bug_1534630</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bob</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">TreeBuilder</span><span class="p">()</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s">&#39;&lt;tag /&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BugsTest.test_issue6233"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_issue6233">[docs]</a>    <span class="k">def</span> <span class="nf">test_issue6233</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-8&#39;?&gt;&quot;</span>
                   <span class="n">b</span><span class="s">&#39;&lt;body&gt;t</span><span class="se">\xc3\xa3</span><span class="s">g&lt;/body&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s">&#39;ascii&#39;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;ascii&#39;?&gt;</span><span class="se">\n</span><span class="s">&quot;</span>
                <span class="n">b</span><span class="s">&#39;&lt;body&gt;t&amp;#227;g&lt;/body&gt;&#39;</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;iso-8859-1&#39;?&gt;&quot;</span>
                   <span class="n">b</span><span class="s">&#39;&lt;body&gt;t</span><span class="se">\xe3</span><span class="s">g&lt;/body&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s">&#39;ascii&#39;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;ascii&#39;?&gt;</span><span class="se">\n</span><span class="s">&quot;</span>
                <span class="n">b</span><span class="s">&#39;&lt;body&gt;t&amp;#227;g&lt;/body&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BugsTest.test_issue3151"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_issue3151">[docs]</a>    <span class="k">def</span> <span class="nf">test_issue3151</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&lt;prefix:localname xmlns:prefix=&quot;${stuff}&quot;/&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;{${stuff}}localname&#39;</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">b</span><span class="s">&#39;&lt;ns0:localname xmlns:ns0=&quot;${stuff}&quot; /&gt;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BugsTest.test_issue6565"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_issue6565">[docs]</a>    <span class="k">def</span> <span class="nf">test_issue6565</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;body&gt;&lt;tag/&gt;&lt;/body&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">elem</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">])</span>
        <span class="n">newelem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">SAMPLE_XML</span><span class="p">)</span>
        <span class="n">elem</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">newelem</span><span class="p">[:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">elem</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">,</span> <span class="s">&#39;section&#39;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="BugsTest.test_issue10777"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BugsTest.test_issue10777">[docs]</a>    <span class="k">def</span> <span class="nf">test_issue10777</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Registering a namespace twice caused a &quot;dictionary changed size during</span>
        <span class="c"># iteration&quot; bug.</span>

        <span class="n">ET</span><span class="o">.</span><span class="n">register_namespace</span><span class="p">(</span><span class="s">&#39;test10777&#39;</span><span class="p">,</span> <span class="s">&#39;http://myuri/&#39;</span><span class="p">)</span>
        <span class="n">ET</span><span class="o">.</span><span class="n">register_namespace</span><span class="p">(</span><span class="s">&#39;test10777&#39;</span><span class="p">,</span> <span class="s">&#39;http://myuri/&#39;</span><span class="p">)</span>


<span class="c"># --------------------------------------------------------------------</span>

</div></div>
<div class="viewcode-block" id="BasicElementTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BasicElementTest">[docs]</a><span class="k">class</span> <span class="nc">BasicElementTest</span><span class="p">(</span><span class="n">ElementTestCase</span><span class="p">,</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="BasicElementTest.test_augmentation_type_errors"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BasicElementTest.test_augmentation_type_errors">[docs]</a>    <span class="k">def</span> <span class="nf">test_augmentation_type_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;joe&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">append</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">extend</span><span class="p">,</span> <span class="p">[</span><span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;bar&#39;</span><span class="p">),</span> <span class="s">&#39;foo&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">insert</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BasicElementTest.test_cyclic_gc"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BasicElementTest.test_cyclic_gc">[docs]</a>    <span class="k">def</span> <span class="nf">test_cyclic_gc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">Dummy</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c"># Test the shortest cycle: d-&gt;element-&gt;d</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">()</span>
        <span class="n">d</span><span class="o">.</span><span class="n">dummyref</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;joe&#39;</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
        <span class="n">wref</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">d</span>
        <span class="n">gc_collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">wref</span><span class="p">())</span>

        <span class="c"># A longer cycle: d-&gt;e-&gt;e2-&gt;d</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;joe&#39;</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">()</span>
        <span class="n">d</span><span class="o">.</span><span class="n">dummyref</span> <span class="o">=</span> <span class="n">e</span>
        <span class="n">wref</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">e2</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">e2</span>
        <span class="n">gc_collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">wref</span><span class="p">())</span>

        <span class="c"># A cycle between Element objects as children of one another</span>
        <span class="c"># e1-&gt;e2-&gt;e3-&gt;e1</span>
        <span class="n">e1</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;e1&#39;</span><span class="p">)</span>
        <span class="n">e2</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;e2&#39;</span><span class="p">)</span>
        <span class="n">e3</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;e3&#39;</span><span class="p">)</span>
        <span class="n">e1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e2</span><span class="p">)</span>
        <span class="n">e2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e2</span><span class="p">)</span>
        <span class="n">e3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span>
        <span class="n">wref</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">e3</span>
        <span class="n">gc_collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">wref</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="BasicElementTest.test_weakref"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BasicElementTest.test_weakref">[docs]</a>    <span class="k">def</span> <span class="nf">test_weakref</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">def</span> <span class="nf">wref_cb</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
            <span class="n">nonlocal</span> <span class="n">flag</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">)</span>
        <span class="n">wref</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">wref_cb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">wref</span><span class="p">()</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;e&#39;</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">e</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">wref</span><span class="p">(),</span> <span class="bp">None</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BasicElementTest.test_get_keyword_args"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BasicElementTest.test_get_keyword_args">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_keyword_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e1</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;foo&#39;</span> <span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">7</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;w&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">7</span><span class="p">),</span> <span class="mi">7</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BasicElementTest.test_pickle"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BasicElementTest.test_pickle">[docs]</a>    <span class="k">def</span> <span class="nf">test_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># issue #16076: the C implementation wasn&#39;t pickleable.</span>
        <span class="k">for</span> <span class="n">dumper</span><span class="p">,</span> <span class="n">loader</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">dumper</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="n">bar</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
            <span class="n">e</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">&quot;text goes here&quot;</span>
            <span class="n">e</span><span class="o">.</span><span class="n">tail</span> <span class="o">=</span> <span class="s">&quot;opposite of head&quot;</span>
            <span class="n">dumper</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s">&#39;child&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dumper</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;grandchild&#39;</span><span class="p">))</span>
            <span class="n">e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dumper</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;child&#39;</span><span class="p">))</span>
            <span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;.//grandchild&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;attr&#39;</span><span class="p">,</span> <span class="s">&#39;other value&#39;</span><span class="p">)</span>

            <span class="n">e2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pickleRoundTrip</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s">&#39;xml.etree.ElementTree&#39;</span><span class="p">,</span>
                                      <span class="n">dumper</span><span class="p">,</span> <span class="n">loader</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e2</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e2</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;bar&#39;</span><span class="p">],</span> <span class="mi">42</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqualElements</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BasicElementTest.test_pickle_issue18997"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.BasicElementTest.test_pickle_issue18997">[docs]</a>    <span class="k">def</span> <span class="nf">test_pickle_issue18997</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">dumper</span><span class="p">,</span> <span class="n">loader</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">XMLTEXT</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="s">                &lt;group&gt;&lt;dogs&gt;4&lt;/dogs&gt;</span>
<span class="s">                &lt;/group&gt;&quot;&quot;&quot;</span>
            <span class="n">e1</span> <span class="o">=</span> <span class="n">dumper</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">XMLTEXT</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="s">&#39;__getstate__&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">__getstate__</span><span class="p">()[</span><span class="s">&#39;tag&#39;</span><span class="p">],</span> <span class="s">&#39;group&#39;</span><span class="p">)</span>
            <span class="n">e2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pickleRoundTrip</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="s">&#39;xml.etree.ElementTree&#39;</span><span class="p">,</span> <span class="n">dumper</span><span class="p">,</span> <span class="n">loader</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e2</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;group&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;dogs&#39;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="ElementTreeTypeTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTypeTest">[docs]</a><span class="k">class</span> <span class="nc">ElementTreeTypeTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="ElementTreeTypeTest.test_istype"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTypeTest.test_istype">[docs]</a>    <span class="k">def</span> <span class="nf">test_istype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">ParseError</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">QName</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">TreeBuilder</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTypeTest.test_Element_subclass_trivial"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTypeTest.test_Element_subclass_trivial">[docs]</a>    <span class="k">def</span> <span class="nf">test_Element_subclass_trivial</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">MyElement</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="n">mye</span> <span class="o">=</span> <span class="n">MyElement</span><span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">mye</span><span class="p">,</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">mye</span><span class="p">,</span> <span class="n">MyElement</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mye</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">)</span>

        <span class="c"># test that attribute assignment works (issue 14849)</span>
        <span class="n">mye</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">&quot;joe&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mye</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s">&quot;joe&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementTreeTypeTest.test_Element_subclass_constructor"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTypeTest.test_Element_subclass_constructor">[docs]</a>    <span class="k">def</span> <span class="nf">test_Element_subclass_constructor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">MyElement</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">attrib</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">extra</span><span class="p">):</span>
                <span class="nb">super</span><span class="p">(</span><span class="n">MyElement</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">tag</span> <span class="o">+</span> <span class="s">&#39;__&#39;</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="o">**</span><span class="n">extra</span><span class="p">)</span>

        <span class="n">mye</span> <span class="o">=</span> <span class="n">MyElement</span><span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mye</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;foo__&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">mye</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span>
            <span class="p">[(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="ElementTreeTypeTest.test_Element_subclass_new_method"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementTreeTypeTest.test_Element_subclass_new_method">[docs]</a>    <span class="k">def</span> <span class="nf">test_Element_subclass_new_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">MyElement</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">newmethod</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span>

        <span class="n">mye</span> <span class="o">=</span> <span class="n">MyElement</span><span class="p">(</span><span class="s">&#39;joe&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mye</span><span class="o">.</span><span class="n">newmethod</span><span class="p">(),</span> <span class="s">&#39;joe&#39;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="ElementFindTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementFindTest">[docs]</a><span class="k">class</span> <span class="nc">ElementFindTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="ElementFindTest.test_find_simple"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementFindTest.test_find_simple">[docs]</a>    <span class="k">def</span> <span class="nf">test_find_simple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">SAMPLE_XML</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;tag&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;section/tag&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;./tag&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">)</span>

        <span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">SAMPLE_SECTION</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;section/nexttag&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;nexttag&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s">&#39;./tag&#39;</span><span class="p">),</span> <span class="s">&#39;text&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s">&#39;section/tag&#39;</span><span class="p">),</span> <span class="s">&#39;subtext&#39;</span><span class="p">)</span>

        <span class="c"># section/nexttag is found but has no text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s">&#39;section/nexttag&#39;</span><span class="p">),</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s">&#39;section/nexttag&#39;</span><span class="p">,</span> <span class="s">&#39;default&#39;</span><span class="p">),</span> <span class="s">&#39;&#39;</span><span class="p">)</span>

        <span class="c"># tog doesn&#39;t exist and &#39;default&#39; kicks in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s">&#39;tog&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s">&#39;tog&#39;</span><span class="p">,</span> <span class="s">&#39;default&#39;</span><span class="p">),</span> <span class="s">&#39;default&#39;</span><span class="p">)</span>

        <span class="c"># Issue #16922</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&lt;tag&gt;&lt;empty /&gt;&lt;/tag&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s">&#39;empty&#39;</span><span class="p">),</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementFindTest.test_find_xpath"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementFindTest.test_find_xpath">[docs]</a>    <span class="k">def</span> <span class="nf">test_find_xpath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">LINEAR_XML</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;</span>
<span class="s">        &lt;body&gt;</span>
<span class="s">            &lt;tag class=&#39;a&#39;/&gt;</span>
<span class="s">            &lt;tag class=&#39;b&#39;/&gt;</span>
<span class="s">            &lt;tag class=&#39;c&#39;/&gt;</span>
<span class="s">            &lt;tag class=&#39;d&#39;/&gt;</span>
<span class="s">        &lt;/body&gt;&#39;&#39;&#39;</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">LINEAR_XML</span><span class="p">)</span>

        <span class="c"># Test for numeric indexing and last()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;./tag[1]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;class&#39;</span><span class="p">],</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;./tag[2]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;class&#39;</span><span class="p">],</span> <span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;./tag[last()]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;class&#39;</span><span class="p">],</span> <span class="s">&#39;d&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;./tag[last()-1]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;class&#39;</span><span class="p">],</span> <span class="s">&#39;c&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;./tag[last()-2]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;class&#39;</span><span class="p">],</span> <span class="s">&#39;b&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="s">&#39;XPath&#39;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">find</span><span class="p">,</span> <span class="s">&#39;./tag[0]&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="s">&#39;XPath&#39;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">find</span><span class="p">,</span> <span class="s">&#39;./tag[-1]&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="s">&#39;XPath&#39;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">find</span><span class="p">,</span> <span class="s">&#39;./tag[last()-0]&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="s">&#39;XPath&#39;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">find</span><span class="p">,</span> <span class="s">&#39;./tag[last()+1]&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementFindTest.test_findall"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementFindTest.test_findall">[docs]</a>    <span class="k">def</span> <span class="nf">test_findall</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">SAMPLE_XML</span><span class="p">)</span>
        <span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">SAMPLE_SECTION</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)),</span> <span class="p">[</span><span class="s">&#39;body&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;tag&#39;</span><span class="p">)),</span> <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;tog&#39;</span><span class="p">)),</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;tog/foo&#39;</span><span class="p">)),</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;*&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">,</span> <span class="s">&#39;section&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;.//tag&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;section/tag&#39;</span><span class="p">)),</span> <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;section//tag&#39;</span><span class="p">)),</span> <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;section/*&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">,</span> <span class="s">&#39;nexttag&#39;</span><span class="p">,</span> <span class="s">&#39;nextsection&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;section//*&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">,</span> <span class="s">&#39;nexttag&#39;</span><span class="p">,</span> <span class="s">&#39;nextsection&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;section/.//*&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">,</span> <span class="s">&#39;nexttag&#39;</span><span class="p">,</span> <span class="s">&#39;nextsection&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;*/*&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">,</span> <span class="s">&#39;nexttag&#39;</span><span class="p">,</span> <span class="s">&#39;nextsection&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;*//*&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">,</span> <span class="s">&#39;nexttag&#39;</span><span class="p">,</span> <span class="s">&#39;nextsection&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;*/tag&#39;</span><span class="p">)),</span> <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;*/./tag&#39;</span><span class="p">)),</span> <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;./tag&#39;</span><span class="p">)),</span> <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;././tag&#39;</span><span class="p">)),</span> <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;.//tag[@class]&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;.//tag[@class=&quot;a&quot;]&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;.//tag[@class=&quot;b&quot;]&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;.//tag[@id]&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;.//section[tag]&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;section&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;.//section[element]&#39;</span><span class="p">)),</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;../tag&#39;</span><span class="p">)),</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;section/../tag&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;section//&#39;</span><span class="p">),</span> <span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;section//*&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ElementFindTest.test_test_find_with_ns"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementFindTest.test_test_find_with_ns">[docs]</a>    <span class="k">def</span> <span class="nf">test_test_find_with_ns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">SAMPLE_XML_NS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;tag&#39;</span><span class="p">)),</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&quot;{http://effbot.org/ns}tag&quot;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;{http://effbot.org/ns}tag&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">summarize_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&quot;.//{http://effbot.org/ns}tag&quot;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;{http://effbot.org/ns}tag&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementFindTest.test_findall_different_nsmaps"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementFindTest.test_findall_different_nsmaps">[docs]</a>    <span class="k">def</span> <span class="nf">test_findall_different_nsmaps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">            &lt;a xmlns:x=&quot;X&quot; xmlns:y=&quot;Y&quot;&gt;</span>
<span class="s">                &lt;x:b&gt;&lt;c/&gt;&lt;/x:b&gt;</span>
<span class="s">                &lt;b/&gt;</span>
<span class="s">                &lt;c&gt;&lt;x:b/&gt;&lt;b/&gt;&lt;/c&gt;&lt;y:b/&gt;</span>
<span class="s">            &lt;/a&gt;&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="n">nsmap</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;xx&#39;</span><span class="p">:</span> <span class="s">&#39;X&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&quot;.//xx:b&quot;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="n">nsmap</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&quot;.//b&quot;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="n">nsmap</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">nsmap</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;xx&#39;</span><span class="p">:</span> <span class="s">&#39;Y&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&quot;.//xx:b&quot;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="n">nsmap</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&quot;.//b&quot;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="n">nsmap</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementFindTest.test_bad_find"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementFindTest.test_bad_find">[docs]</a>    <span class="k">def</span> <span class="nf">test_bad_find</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">SAMPLE_XML</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="s">&#39;cannot use absolute path&#39;</span><span class="p">):</span>
            <span class="n">e</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;/tag&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementFindTest.test_find_through_ElementTree"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementFindTest.test_find_through_ElementTree">[docs]</a>    <span class="k">def</span> <span class="nf">test_find_through_ElementTree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">SAMPLE_XML</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;tag&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s">&#39;tag&#39;</span><span class="p">),</span> <span class="s">&#39;text&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;tag&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c"># this produces a warning</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">summarize_list</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;//tag&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="ElementIterTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementIterTest">[docs]</a><span class="k">class</span> <span class="nc">ElementIterTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_ilist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">summarize_list</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">iter</span><span class="p">(</span><span class="n">tag</span><span class="p">))</span>

<div class="viewcode-block" id="ElementIterTest.test_basic"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementIterTest.test_basic">[docs]</a>    <span class="k">def</span> <span class="nf">test_basic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;html&gt;&lt;body&gt;this is a &lt;i&gt;paragraph&lt;/i&gt;.&lt;/body&gt;..&lt;/html&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ilist</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;html&#39;</span><span class="p">,</span> <span class="s">&#39;body&#39;</span><span class="p">,</span> <span class="s">&#39;i&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ilist</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;body&#39;</span><span class="p">)),</span> <span class="p">[</span><span class="s">&#39;body&#39;</span><span class="p">,</span> <span class="s">&#39;i&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">iter</span><span class="p">())</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;html&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">itertext</span><span class="p">()),</span> <span class="s">&#39;this is a paragraph...&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;body&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">itertext</span><span class="p">()),</span>
            <span class="s">&#39;this is a paragraph.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">itertext</span><span class="p">()),</span> <span class="s">&#39;this is a &#39;</span><span class="p">)</span>

        <span class="c"># iterparse should return an iterator</span>
        <span class="n">sourcefile</span> <span class="o">=</span> <span class="n">serialize</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">to_string</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">iterparse</span><span class="p">(</span><span class="n">sourcefile</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&#39;end&#39;</span><span class="p">)</span>

        <span class="c"># With an explitit parser too (issue #9708)</span>
        <span class="n">sourcefile</span> <span class="o">=</span> <span class="n">serialize</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">to_string</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">ET</span><span class="o">.</span><span class="n">TreeBuilder</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">iterparse</span><span class="p">(</span><span class="n">sourcefile</span><span class="p">,</span> <span class="n">parser</span><span class="o">=</span><span class="n">parser</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>
                         <span class="s">&#39;end&#39;</span><span class="p">)</span>

        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">iter</span><span class="p">)</span>

        <span class="c"># Issue #16913</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;root&gt;a&amp;amp;&lt;sub&gt;b&amp;amp;&lt;/sub&gt;c&amp;amp;&lt;/root&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">itertext</span><span class="p">()),</span> <span class="s">&#39;a&amp;b&amp;c&amp;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ElementIterTest.test_corners"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementIterTest.test_corners">[docs]</a>    <span class="k">def</span> <span class="nf">test_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># single root, no subelements</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ilist</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">])</span>

        <span class="c"># one child</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ilist</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">])</span>

        <span class="c"># one child and one grandchild</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ilist</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">])</span>

        <span class="c"># two children, only first with grandchild</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ilist</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">])</span>

        <span class="c"># replace first child by second</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ilist</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="ElementIterTest.test_iter_by_tag"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementIterTest.test_iter_by_tag">[docs]</a>    <span class="k">def</span> <span class="nf">test_iter_by_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">            &lt;document&gt;</span>
<span class="s">                &lt;house&gt;</span>
<span class="s">                    &lt;room&gt;bedroom1&lt;/room&gt;</span>
<span class="s">                    &lt;room&gt;bedroom2&lt;/room&gt;</span>
<span class="s">                &lt;/house&gt;</span>
<span class="s">                &lt;shed&gt;nothing here</span>
<span class="s">                &lt;/shed&gt;</span>
<span class="s">                &lt;house&gt;</span>
<span class="s">                    &lt;room&gt;bedroom8&lt;/room&gt;</span>
<span class="s">                &lt;/house&gt;</span>
<span class="s">            &lt;/document&gt;&#39;&#39;&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ilist</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&#39;room&#39;</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;room&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ilist</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&#39;house&#39;</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;house&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c"># test that iter also accepts &#39;tag&#39; as a keyword arg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">summarize_list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">iter</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s">&#39;room&#39;</span><span class="p">)),</span>
            <span class="p">[</span><span class="s">&#39;room&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>

        <span class="c"># make sure both tag=None and tag=&#39;*&#39; return all tags</span>
        <span class="n">all_tags</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;document&#39;</span><span class="p">,</span> <span class="s">&#39;house&#39;</span><span class="p">,</span> <span class="s">&#39;room&#39;</span><span class="p">,</span> <span class="s">&#39;room&#39;</span><span class="p">,</span>
                    <span class="s">&#39;shed&#39;</span><span class="p">,</span> <span class="s">&#39;house&#39;</span><span class="p">,</span> <span class="s">&#39;room&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ilist</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span> <span class="n">all_tags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ilist</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&#39;*&#39;</span><span class="p">),</span> <span class="n">all_tags</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="TreeBuilderTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.TreeBuilderTest">[docs]</a><span class="k">class</span> <span class="nc">TreeBuilderTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">sample1</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;&lt;!DOCTYPE html PUBLIC&#39;</span>
        <span class="s">&#39; &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;&#39;</span>
        <span class="s">&#39; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&#39;</span>
        <span class="s">&#39;&lt;html&gt;text&lt;div&gt;subtext&lt;/div&gt;tail&lt;/html&gt;&#39;</span><span class="p">)</span>

    <span class="n">sample2</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;&lt;toplevel&gt;sometext&lt;/toplevel&gt;&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">_check_sample1_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;html&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s">&#39;text&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">tail</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">attrib</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">children</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">child</span> <span class="o">=</span> <span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;div&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s">&#39;subtext&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">tail</span><span class="p">,</span> <span class="s">&#39;tail&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">attrib</span><span class="p">,</span> <span class="p">{})</span>

<div class="viewcode-block" id="TreeBuilderTest.test_dummy_builder"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.TreeBuilderTest.test_dummy_builder">[docs]</a>    <span class="k">def</span> <span class="nf">test_dummy_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">BaseDummyBuilder</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">42</span>

        <span class="k">class</span> <span class="nc">DummyBuilder</span><span class="p">(</span><span class="n">BaseDummyBuilder</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">start</span> <span class="o">=</span> <span class="n">end</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">a</span><span class="p">:</span> <span class="bp">None</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">DummyBuilder</span><span class="p">())</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">(),</span> <span class="mi">42</span><span class="p">)</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">BaseDummyBuilder</span><span class="p">())</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">(),</span> <span class="mi">42</span><span class="p">)</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="nb">object</span><span class="p">())</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="TreeBuilderTest.test_treebuilder_elementfactory_none"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.TreeBuilderTest.test_treebuilder_elementfactory_none">[docs]</a>    <span class="k">def</span> <span class="nf">test_treebuilder_elementfactory_none</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">ET</span><span class="o">.</span><span class="n">TreeBuilder</span><span class="p">(</span><span class="n">element_factory</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample1</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_sample1_element</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TreeBuilderTest.test_subclass"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.TreeBuilderTest.test_subclass">[docs]</a>    <span class="k">def</span> <span class="nf">test_subclass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">MyTreeBuilder</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">TreeBuilder</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">foobar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="n">tb</span> <span class="o">=</span> <span class="n">MyTreeBuilder</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tb</span><span class="o">.</span><span class="n">foobar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="mi">20</span><span class="p">)</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">tb</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample1</span><span class="p">)</span>

        <span class="n">e</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_sample1_element</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TreeBuilderTest.test_element_factory"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.TreeBuilderTest.test_element_factory">[docs]</a>    <span class="k">def</span> <span class="nf">test_element_factory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">def</span> <span class="nf">myfactory</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">attrib</span><span class="p">):</span>
            <span class="n">nonlocal</span> <span class="n">lst</span>
            <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">attrib</span><span class="p">)</span>

        <span class="n">tb</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">TreeBuilder</span><span class="p">(</span><span class="n">element_factory</span><span class="o">=</span><span class="n">myfactory</span><span class="p">)</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">tb</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample2</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;toplevel&#39;</span><span class="p">])</span>
</div>
    <span class="k">def</span> <span class="nf">_check_element_factory_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls</span><span class="p">):</span>
        <span class="n">tb</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">TreeBuilder</span><span class="p">(</span><span class="n">element_factory</span><span class="o">=</span><span class="n">cls</span><span class="p">)</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">tb</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample1</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">cls</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_sample1_element</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<div class="viewcode-block" id="TreeBuilderTest.test_element_factory_subclass"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.TreeBuilderTest.test_element_factory_subclass">[docs]</a>    <span class="k">def</span> <span class="nf">test_element_factory_subclass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">MyElement</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_element_factory_class</span><span class="p">(</span><span class="n">MyElement</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TreeBuilderTest.test_element_factory_pure_python_subclass"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.TreeBuilderTest.test_element_factory_pure_python_subclass">[docs]</a>    <span class="k">def</span> <span class="nf">test_element_factory_pure_python_subclass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Mimick SimpleTAL&#39;s behaviour (issue #16089): both versions of</span>
        <span class="c"># TreeBuilder should be able to cope with a subclass of the</span>
        <span class="c"># pure Python Element class.</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">_Element_Py</span>
        <span class="c"># Not from a C extension</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">__module__</span><span class="p">,</span> <span class="s">&#39;xml.etree.ElementTree&#39;</span><span class="p">)</span>
        <span class="c"># Force some multiple inheritance with a C class to make things</span>
        <span class="c"># more interesting.</span>
        <span class="k">class</span> <span class="nc">MyElement</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_element_factory_class</span><span class="p">(</span><span class="n">MyElement</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TreeBuilderTest.test_doctype"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.TreeBuilderTest.test_doctype">[docs]</a>    <span class="k">def</span> <span class="nf">test_doctype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">DoctypeParser</span><span class="p">:</span>
            <span class="n">_doctype</span> <span class="o">=</span> <span class="bp">None</span>

            <span class="k">def</span> <span class="nf">doctype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">pubid</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_doctype</span> <span class="o">=</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">pubid</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_doctype</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">DoctypeParser</span><span class="p">())</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">(),</span>
            <span class="p">(</span><span class="s">&#39;html&#39;</span><span class="p">,</span> <span class="s">&#39;-//W3C//DTD XHTML 1.0 Transitional//EN&#39;</span><span class="p">,</span>
             <span class="s">&#39;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#39;</span><span class="p">))</span>

</div></div>
<div class="viewcode-block" id="XMLParserTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XMLParserTest">[docs]</a><span class="k">class</span> <span class="nc">XMLParserTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">sample1</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;&lt;file&gt;&lt;line&gt;22&lt;/line&gt;&lt;/file&gt;&#39;</span>
    <span class="n">sample2</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="s">&#39;&lt;!DOCTYPE html PUBLIC&#39;</span>
        <span class="n">b</span><span class="s">&#39; &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;&#39;</span>
        <span class="n">b</span><span class="s">&#39; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&#39;</span>
        <span class="n">b</span><span class="s">&#39;&lt;html&gt;text&lt;/html&gt;&#39;</span><span class="p">)</span>
    <span class="n">sample3</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="s">&#39;&lt;money value=&quot;$</span><span class="se">\xa3\u20ac\U0001017b</span><span class="s">&quot;&gt;$</span><span class="se">\xa3\u20ac\U0001017b</span><span class="s">&lt;/money&gt;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_sample_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;file&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;line&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s">&#39;22&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="XMLParserTest.test_constructor_args"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XMLParserTest.test_constructor_args">[docs]</a>    <span class="k">def</span> <span class="nf">test_constructor_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Positional args. The first (html) is not supported, but should be</span>
        <span class="c"># nevertheless correctly accepted.</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">ET</span><span class="o">.</span><span class="n">TreeBuilder</span><span class="p">(),</span> <span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_sample_element</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">())</span>

        <span class="c"># Now as keyword args.</span>
        <span class="n">parser2</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">encoding</span><span class="o">=</span><span class="s">&#39;utf-8&#39;</span><span class="p">,</span>
                               <span class="n">html</span><span class="o">=</span><span class="p">[{}],</span>
                               <span class="n">target</span><span class="o">=</span><span class="n">ET</span><span class="o">.</span><span class="n">TreeBuilder</span><span class="p">())</span>
        <span class="n">parser2</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_sample_element</span><span class="p">(</span><span class="n">parser2</span><span class="o">.</span><span class="n">close</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="XMLParserTest.test_subclass"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XMLParserTest.test_subclass">[docs]</a>    <span class="k">def</span> <span class="nf">test_subclass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">MyParser</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">MyParser</span><span class="p">()</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_sample_element</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="XMLParserTest.test_subclass_doctype"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XMLParserTest.test_subclass_doctype">[docs]</a>    <span class="k">def</span> <span class="nf">test_subclass_doctype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">_doctype</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">class</span> <span class="nc">MyParserWithDoctype</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">doctype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">pubid</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
                <span class="n">nonlocal</span> <span class="n">_doctype</span>
                <span class="n">_doctype</span> <span class="o">=</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">pubid</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">MyParserWithDoctype</span><span class="p">()</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertWarns</span><span class="p">(</span><span class="ne">DeprecationWarning</span><span class="p">):</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample2</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">_doctype</span><span class="p">,</span>
            <span class="p">(</span><span class="s">&#39;html&#39;</span><span class="p">,</span> <span class="s">&#39;-//W3C//DTD XHTML 1.0 Transitional//EN&#39;</span><span class="p">,</span>
             <span class="s">&#39;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#39;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="XMLParserTest.test_parse_string"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.XMLParserTest.test_parse_string">[docs]</a>    <span class="k">def</span> <span class="nf">test_parse_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">ET</span><span class="o">.</span><span class="n">TreeBuilder</span><span class="p">())</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample3</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;money&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">],</span> <span class="s">&#39;$</span><span class="se">\xa3\u20ac\U0001017b</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s">&#39;$</span><span class="se">\xa3\u20ac\U0001017b</span><span class="s">&#39;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="NamespaceParseTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.NamespaceParseTest">[docs]</a><span class="k">class</span> <span class="nc">NamespaceParseTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="NamespaceParseTest.test_find_with_namespace"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.NamespaceParseTest.test_find_with_namespace">[docs]</a>    <span class="k">def</span> <span class="nf">test_find_with_namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">nsmap</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;h&#39;</span><span class="p">:</span> <span class="s">&#39;hello&#39;</span><span class="p">,</span> <span class="s">&#39;f&#39;</span><span class="p">:</span> <span class="s">&#39;foo&#39;</span><span class="p">}</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">SAMPLE_XML_NS_ELEMS</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;{hello}table&#39;</span><span class="p">,</span> <span class="n">nsmap</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;.//{hello}td&#39;</span><span class="p">,</span> <span class="n">nsmap</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;.//{foo}name&#39;</span><span class="p">,</span> <span class="n">nsmap</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="ElementSlicingTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementSlicingTest">[docs]</a><span class="k">class</span> <span class="nc">ElementSlicingTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_elem_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elemlist</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">tag</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">elemlist</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_subelem_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elem_tags</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_make_elem_with_children</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numchildren</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an Element with a tag &#39;a&#39;, with the given amount of children</span>
<span class="sd">           named &#39;a0&#39;, &#39;a1&#39; ... and so on.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numchildren</span><span class="p">):</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s">&#39;a</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">e</span>

<div class="viewcode-block" id="ElementSlicingTest.test_getslice_single_index"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementSlicingTest.test_getslice_single_index">[docs]</a>    <span class="k">def</span> <span class="nf">test_getslice_single_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_elem_with_children</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;a1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;a8&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="ElementSlicingTest.test_getslice_range"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementSlicingTest.test_getslice_range">[docs]</a>    <span class="k">def</span> <span class="nf">test_getslice_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_elem_with_children</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_elem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">3</span><span class="p">:]),</span> <span class="p">[</span><span class="s">&#39;a3&#39;</span><span class="p">,</span> <span class="s">&#39;a4&#39;</span><span class="p">,</span> <span class="s">&#39;a5&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_elem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]),</span> <span class="p">[</span><span class="s">&#39;a3&#39;</span><span class="p">,</span> <span class="s">&#39;a4&#39;</span><span class="p">,</span> <span class="s">&#39;a5&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_elem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">16</span><span class="p">]),</span> <span class="p">[</span><span class="s">&#39;a3&#39;</span><span class="p">,</span> <span class="s">&#39;a4&#39;</span><span class="p">,</span> <span class="s">&#39;a5&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_elem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]),</span> <span class="p">[</span><span class="s">&#39;a3&#39;</span><span class="p">,</span> <span class="s">&#39;a4&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_elem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="p">[</span><span class="s">&#39;a3&#39;</span><span class="p">,</span> <span class="s">&#39;a4&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_elem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">[:</span><span class="mi">2</span><span class="p">]),</span> <span class="p">[</span><span class="s">&#39;a0&#39;</span><span class="p">,</span> <span class="s">&#39;a1&#39;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="ElementSlicingTest.test_getslice_steps"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementSlicingTest.test_getslice_steps">[docs]</a>    <span class="k">def</span> <span class="nf">test_getslice_steps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_elem_with_children</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_elem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">1</span><span class="p">]),</span> <span class="p">[</span><span class="s">&#39;a8&#39;</span><span class="p">,</span> <span class="s">&#39;a9&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_elem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">[::</span><span class="mi">3</span><span class="p">]),</span> <span class="p">[</span><span class="s">&#39;a0&#39;</span><span class="p">,</span> <span class="s">&#39;a3&#39;</span><span class="p">,</span> <span class="s">&#39;a6&#39;</span><span class="p">,</span> <span class="s">&#39;a9&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_elem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">[::</span><span class="mi">8</span><span class="p">]),</span> <span class="p">[</span><span class="s">&#39;a0&#39;</span><span class="p">,</span> <span class="s">&#39;a8&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_elem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">8</span><span class="p">]),</span> <span class="p">[</span><span class="s">&#39;a1&#39;</span><span class="p">,</span> <span class="s">&#39;a9&#39;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="ElementSlicingTest.test_getslice_negative_steps"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementSlicingTest.test_getslice_negative_steps">[docs]</a>    <span class="k">def</span> <span class="nf">test_getslice_negative_steps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_elem_with_children</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_elem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="p">[</span><span class="s">&#39;a3&#39;</span><span class="p">,</span> <span class="s">&#39;a2&#39;</span><span class="p">,</span> <span class="s">&#39;a1&#39;</span><span class="p">,</span> <span class="s">&#39;a0&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_elem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">[::</span><span class="o">-</span><span class="mi">2</span><span class="p">]),</span> <span class="p">[</span><span class="s">&#39;a3&#39;</span><span class="p">,</span> <span class="s">&#39;a1&#39;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="ElementSlicingTest.test_delslice"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ElementSlicingTest.test_delslice">[docs]</a>    <span class="k">def</span> <span class="nf">test_delslice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_elem_with_children</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subelem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;a2&#39;</span><span class="p">,</span> <span class="s">&#39;a3&#39;</span><span class="p">])</span>

        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_elem_with_children</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subelem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="p">[])</span>

        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_elem_with_children</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">e</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subelem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="p">[])</span>

        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_elem_with_children</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">e</span><span class="p">[::</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subelem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;a0&#39;</span><span class="p">,</span> <span class="s">&#39;a2&#39;</span><span class="p">])</span>

        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_elem_with_children</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subelem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;a0&#39;</span><span class="p">,</span> <span class="s">&#39;a2&#39;</span><span class="p">])</span>

        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_elem_with_children</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">e</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subelem_tags</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="p">[</span><span class="s">&#39;a1&#39;</span><span class="p">])</span>

</div></div>
<div class="viewcode-block" id="IOTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest">[docs]</a><span class="k">class</span> <span class="nc">IOTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="IOTest.tearDown"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.tearDown">[docs]</a>    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">support</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">TESTFN</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IOTest.test_encoding"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_encoding">[docs]</a>    <span class="k">def</span> <span class="nf">test_encoding</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test encoding issues.</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">&quot;abc&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">),</span> <span class="s">&#39;&lt;tag&gt;abc&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;tag&gt;abc&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;us-ascii&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;tag&gt;abc&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">enc</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;iso-8859-1&quot;</span><span class="p">,</span> <span class="s">&quot;utf-16&quot;</span><span class="p">,</span> <span class="s">&quot;utf-32&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">enc</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;</span><span class="si">%s</span><span class="s">&#39;?&gt;</span><span class="se">\n</span><span class="s">&quot;</span>
                     <span class="s">&quot;&lt;tag&gt;abc&lt;/tag&gt;&quot;</span> <span class="o">%</span> <span class="n">enc</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">enc</span><span class="p">))</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">&quot;&lt;&amp;</span><span class="se">\&quot;\&#39;</span><span class="s">&gt;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">),</span> <span class="s">&#39;&lt;tag&gt;&amp;lt;&amp;amp;&quot;</span><span class="se">\&#39;</span><span class="s">&amp;gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;tag&gt;&amp;lt;&amp;amp;&quot;</span><span class="se">\&#39;</span><span class="s">&amp;gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;us-ascii&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;tag&gt;&amp;lt;&amp;amp;&quot;</span><span class="se">\&#39;</span><span class="s">&amp;gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">enc</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;iso-8859-1&quot;</span><span class="p">,</span> <span class="s">&quot;utf-16&quot;</span><span class="p">,</span> <span class="s">&quot;utf-32&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">enc</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;</span><span class="si">%s</span><span class="s">&#39;?&gt;</span><span class="se">\n</span><span class="s">&quot;</span>
                     <span class="s">&quot;&lt;tag&gt;&amp;lt;&amp;amp;</span><span class="se">\&quot;</span><span class="s">&#39;&amp;gt;&lt;/tag&gt;&quot;</span> <span class="o">%</span> <span class="n">enc</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">enc</span><span class="p">))</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;&lt;&amp;</span><span class="se">\&quot;\&#39;</span><span class="s">&gt;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">),</span> <span class="s">&#39;&lt;tag key=&quot;&amp;lt;&amp;amp;&amp;quot;</span><span class="se">\&#39;</span><span class="s">&amp;gt;&quot; /&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;tag key=&quot;&amp;lt;&amp;amp;&amp;quot;</span><span class="se">\&#39;</span><span class="s">&amp;gt;&quot; /&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;us-ascii&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;tag key=&quot;&amp;lt;&amp;amp;&amp;quot;</span><span class="se">\&#39;</span><span class="s">&amp;gt;&quot; /&gt;&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">enc</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;iso-8859-1&quot;</span><span class="p">,</span> <span class="s">&quot;utf-16&quot;</span><span class="p">,</span> <span class="s">&quot;utf-32&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">enc</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;</span><span class="si">%s</span><span class="s">&#39;?&gt;</span><span class="se">\n</span><span class="s">&quot;</span>
                     <span class="s">&quot;&lt;tag key=</span><span class="se">\&quot;</span><span class="s">&amp;lt;&amp;amp;&amp;quot;&#39;&amp;gt;</span><span class="se">\&quot;</span><span class="s"> /&gt;&quot;</span> <span class="o">%</span> <span class="n">enc</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">enc</span><span class="p">))</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\xe5\xf6\xf6</span><span class="s">&lt;&gt;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">),</span> <span class="s">&#39;&lt;tag&gt;</span><span class="se">\xe5\xf6\xf6</span><span class="s">&amp;lt;&amp;gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;tag&gt;</span><span class="se">\xc3\xa5\xc3\xb6\xc3\xb6</span><span class="s">&amp;lt;&amp;gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;us-ascii&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;tag&gt;&amp;#229;&amp;#246;&amp;#246;&amp;lt;&amp;gt;&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">enc</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;iso-8859-1&quot;</span><span class="p">,</span> <span class="s">&quot;utf-16&quot;</span><span class="p">,</span> <span class="s">&quot;utf-32&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">enc</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;</span><span class="si">%s</span><span class="s">&#39;?&gt;</span><span class="se">\n</span><span class="s">&quot;</span>
                     <span class="s">&quot;&lt;tag&gt;&amp;lt;&amp;gt;&lt;/tag&gt;&quot;</span> <span class="o">%</span> <span class="n">enc</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">enc</span><span class="p">))</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\xe5\xf6\xf6</span><span class="s">&lt;&gt;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">),</span> <span class="s">&#39;&lt;tag key=&quot;</span><span class="se">\xe5\xf6\xf6</span><span class="s">&amp;lt;&amp;gt;&quot; /&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;tag key=&quot;</span><span class="se">\xc3\xa5\xc3\xb6\xc3\xb6</span><span class="s">&amp;lt;&amp;gt;&quot; /&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;us-ascii&quot;</span><span class="p">),</span>
                <span class="n">b</span><span class="s">&#39;&lt;tag key=&quot;&amp;#229;&amp;#246;&amp;#246;&amp;lt;&amp;gt;&quot; /&gt;&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">enc</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;iso-8859-1&quot;</span><span class="p">,</span> <span class="s">&quot;utf-16&quot;</span><span class="p">,</span> <span class="s">&quot;utf-16le&quot;</span><span class="p">,</span> <span class="s">&quot;utf-16be&quot;</span><span class="p">,</span> <span class="s">&quot;utf-32&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">enc</span><span class="p">),</span>
                    <span class="p">(</span><span class="s">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;</span><span class="si">%s</span><span class="s">&#39;?&gt;</span><span class="se">\n</span><span class="s">&quot;</span>
                     <span class="s">&quot;&lt;tag key=</span><span class="se">\&quot;</span><span class="s">&amp;lt;&amp;gt;</span><span class="se">\&quot;</span><span class="s"> /&gt;&quot;</span> <span class="o">%</span> <span class="n">enc</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">enc</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="IOTest.test_write_to_filename"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_write_to_filename">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_to_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">))</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">TESTFN</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">b</span><span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IOTest.test_write_to_text_file"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_write_to_text_file">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_to_text_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;unicode&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">closed</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">b</span><span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IOTest.test_write_to_binary_file"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_write_to_binary_file">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_to_binary_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">closed</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">b</span><span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IOTest.test_write_to_binary_file_with_bom"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_write_to_binary_file_with_bom">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_to_binary_file_with_bom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">))</span>
        <span class="c"># test BOM writing to buffered file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;utf-16&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">closed</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
                    <span class="sd">&#39;&#39;&#39;&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-16&#39;?&gt;\n&#39;&#39;&#39;</span>
                    <span class="sd">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;utf-16&quot;</span><span class="p">))</span>
        <span class="c"># test BOM writing to non-buffered file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">,</span> <span class="n">buffering</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;utf-16&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">closed</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">TESTFN</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
                    <span class="sd">&#39;&#39;&#39;&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-16&#39;?&gt;\n&#39;&#39;&#39;</span>
                    <span class="sd">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;utf-16&quot;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="IOTest.test_read_from_stringio"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_read_from_stringio">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_from_stringio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">()</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="s">&#39;&#39;&#39;&lt;?xml version=&quot;1.0&quot;?&gt;&lt;site&gt;&lt;/site&gt;&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;site&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IOTest.test_write_to_stringio"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_write_to_stringio">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_to_stringio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">))</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;unicode&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span> <span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IOTest.test_read_from_bytesio"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_read_from_bytesio">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_from_bytesio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">()</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;&#39;&#39;&lt;?xml version=&quot;1.0&quot;?&gt;&lt;site&gt;&lt;/site&gt;&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;site&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IOTest.test_write_to_bytesio"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_write_to_bytesio">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_to_bytesio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">))</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span> <span class="n">b</span><span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IOTest.dummy"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.dummy">[docs]</a>    <span class="k">class</span> <span class="nc">dummy</span><span class="p">:</span>
        <span class="k">pass</span>
</div>
<div class="viewcode-block" id="IOTest.test_read_from_user_text_reader"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_read_from_user_text_reader">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_from_user_text_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="s">&#39;&#39;&#39;&lt;?xml version=&quot;1.0&quot;?&gt;&lt;site&gt;&lt;/site&gt;&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dummy</span><span class="p">()</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">read</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">read</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">()</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;site&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IOTest.test_write_to_user_text_writer"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_write_to_user_text_writer">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_to_user_text_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">))</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dummy</span><span class="p">()</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">write</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">write</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;unicode&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span> <span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IOTest.test_read_from_user_binary_reader"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_read_from_user_binary_reader">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_from_user_binary_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;&#39;&#39;&lt;?xml version=&quot;1.0&quot;?&gt;&lt;site&gt;&lt;/site&gt;&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dummy</span><span class="p">()</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">read</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">read</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">()</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;site&#39;</span><span class="p">)</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="IOTest.test_write_to_user_binary_writer"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_write_to_user_binary_writer">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_to_user_binary_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">))</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dummy</span><span class="p">()</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">write</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">write</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">writer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span> <span class="n">b</span><span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IOTest.test_write_to_user_binary_writer_with_bom"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_write_to_user_binary_writer_with_bom">[docs]</a>    <span class="k">def</span> <span class="nf">test_write_to_user_binary_writer_with_bom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="p">))</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dummy</span><span class="p">()</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">write</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">write</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">seekable</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">True</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">tell</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">tell</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-16&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span>
                <span class="sd">&#39;&#39;&#39;&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-16&#39;?&gt;\n&#39;&#39;&#39;</span>
                <span class="sd">&#39;&#39;&#39;&lt;site /&gt;&#39;&#39;&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;utf-16&quot;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="IOTest.test_tostringlist_invariant"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_tostringlist_invariant">[docs]</a>    <span class="k">def</span> <span class="nf">test_tostringlist_invariant</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s">&#39;&lt;tag&gt;foo&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s">&#39;unicode&#39;</span><span class="p">),</span>
            <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostringlist</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s">&#39;unicode&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s">&#39;utf-16&#39;</span><span class="p">),</span>
            <span class="n">b</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">tostringlist</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s">&#39;utf-16&#39;</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="IOTest.test_short_empty_elements"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.IOTest.test_short_empty_elements">[docs]</a>    <span class="k">def</span> <span class="nf">test_short_empty_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s">&#39;&lt;tag&gt;a&lt;x /&gt;b&lt;y&gt;&lt;/y&gt;c&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s">&#39;unicode&#39;</span><span class="p">),</span>
            <span class="s">&#39;&lt;tag&gt;a&lt;x /&gt;b&lt;y /&gt;c&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s">&#39;unicode&#39;</span><span class="p">,</span> <span class="n">short_empty_elements</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
            <span class="s">&#39;&lt;tag&gt;a&lt;x /&gt;b&lt;y /&gt;c&lt;/tag&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s">&#39;unicode&#39;</span><span class="p">,</span> <span class="n">short_empty_elements</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
            <span class="s">&#39;&lt;tag&gt;a&lt;x&gt;&lt;/x&gt;b&lt;y&gt;&lt;/y&gt;c&lt;/tag&gt;&#39;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="ParseErrorTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ParseErrorTest">[docs]</a><span class="k">class</span> <span class="nc">ParseErrorTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="ParseErrorTest.test_subclass"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ParseErrorTest.test_subclass">[docs]</a>    <span class="k">def</span> <span class="nf">test_subclass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">ParseError</span><span class="p">(),</span> <span class="ne">SyntaxError</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_get_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ET</span><span class="o">.</span><span class="n">ParseError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">e</span>

<div class="viewcode-block" id="ParseErrorTest.test_error_position"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ParseErrorTest.test_error_position">[docs]</a>    <span class="k">def</span> <span class="nf">test_error_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_error</span><span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_error</span><span class="p">(</span><span class="s">&#39;&lt;tag&gt;&amp;foo;&lt;/tag&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_error</span><span class="p">(</span><span class="s">&#39;foobar&lt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ParseErrorTest.test_error_code"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.ParseErrorTest.test_error_code">[docs]</a>    <span class="k">def</span> <span class="nf">test_error_code</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">xml.parsers.expat.errors</span> <span class="kn">as</span> <span class="nn">ERRORS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_error</span><span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
                <span class="n">ERRORS</span><span class="o">.</span><span class="n">codes</span><span class="p">[</span><span class="n">ERRORS</span><span class="o">.</span><span class="n">XML_ERROR_SYNTAX</span><span class="p">])</span>

</div></div>
<div class="viewcode-block" id="KeywordArgsTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.KeywordArgsTest">[docs]</a><span class="k">class</span> <span class="nc">KeywordArgsTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="c"># Test various issues with keyword arguments passed to ET.Element</span>
    <span class="c"># constructor and methods</span>
<div class="viewcode-block" id="KeywordArgsTest.test_issue14818"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.KeywordArgsTest.test_issue14818">[docs]</a>    <span class="k">def</span> <span class="nf">test_issue14818</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&quot;&lt;a&gt;foo&lt;/a&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
                         <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
                         <span class="n">x</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
                         <span class="n">x</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">iterfind</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)),</span>
                         <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">iterfind</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="bp">None</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">attrib</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">)),</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="n">attrib</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">)),</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">),</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">),</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">),</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">),</span> <span class="n">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">attrib</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">))</span>

        <span class="n">e2</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&#39;foobar&#39;</span><span class="p">,</span> <span class="n">attrib</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;key1&#39;</span><span class="p">:</span> <span class="s">&#39;value1&#39;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">e2</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;key1&#39;</span><span class="p">],</span> <span class="s">&#39;value1&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="s">&#39;must be dict, not str&#39;</span><span class="p">):</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&quot;I&#39;m not a dict&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="s">&#39;must be dict, not str&#39;</span><span class="p">):</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="n">attrib</span><span class="o">=</span><span class="s">&quot;I&#39;m not a dict&quot;</span><span class="p">)</span>

<span class="c"># --------------------------------------------------------------------</span>
</div></div>
<div class="viewcode-block" id="NoAcceleratorTest"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.NoAcceleratorTest">[docs]</a><span class="k">class</span> <span class="nc">NoAcceleratorTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="NoAcceleratorTest.setUp"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.NoAcceleratorTest.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pyET</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">unittest</span><span class="o">.</span><span class="n">SkipTest</span><span class="p">(</span><span class="s">&#39;only for the Python version&#39;</span><span class="p">)</span>

    <span class="c"># Test that the C accelerator was not imported for pyET</span></div>
<div class="viewcode-block" id="NoAcceleratorTest.test_correct_import_pyET"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.NoAcceleratorTest.test_correct_import_pyET">[docs]</a>    <span class="k">def</span> <span class="nf">test_correct_import_pyET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># The type of methods defined in Python code is types.FunctionType,</span>
        <span class="c"># while the type of methods defined inside _elementtree is</span>
        <span class="c"># &lt;class &#39;wrapper_descriptor&#39;&gt;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">pyET</span><span class="o">.</span><span class="n">Element</span><span class="o">.</span><span class="n">__init__</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">FunctionType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">pyET</span><span class="o">.</span><span class="n">XMLParser</span><span class="o">.</span><span class="n">__init__</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">FunctionType</span><span class="p">)</span>

<span class="c"># --------------------------------------------------------------------</span>

</div></div>
<div class="viewcode-block" id="CleanContext"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.CleanContext">[docs]</a><span class="k">class</span> <span class="nc">CleanContext</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Provide default namespace mapping and path cache.&quot;&quot;&quot;</span>
    <span class="n">checkwarnings</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">optimize</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c"># under -OO, doctests cannot be run and therefore not all warnings</span>
            <span class="c"># will be emitted</span>
            <span class="n">quiet</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">deprecations</span> <span class="o">=</span> <span class="p">(</span>
            <span class="c"># Search behaviour is broken if search path starts with &quot;/&quot;.</span>
            <span class="p">(</span><span class="s">&quot;This search is broken in 1.3 and earlier, and will be fixed &quot;</span>
             <span class="s">&quot;in a future version.  If you rely on the current behaviour, &quot;</span>
             <span class="s">&quot;change it to &#39;.+&#39;&quot;</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">),</span>
            <span class="c"># Element.getchildren() and Element.getiterator() are deprecated.</span>
            <span class="p">(</span><span class="s">&quot;This method will be removed in future versions.  &quot;</span>
             <span class="s">&quot;Use .+ instead.&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&quot;This method will be removed in future versions.  &quot;</span>
             <span class="s">&quot;Use .+ instead.&quot;</span><span class="p">,</span> <span class="ne">PendingDeprecationWarning</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkwarnings</span> <span class="o">=</span> <span class="n">support</span><span class="o">.</span><span class="n">check_warnings</span><span class="p">(</span><span class="o">*</span><span class="n">deprecations</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">xml.etree</span> <span class="kn">import</span> <span class="n">ElementPath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nsmap</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">register_namespace</span><span class="o">.</span><span class="n">_namespace_map</span>
        <span class="c"># Copy the default namespace mapping</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nsmap_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nsmap</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c"># Copy the path cache (should be empty)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path_cache</span> <span class="o">=</span> <span class="n">ElementPath</span><span class="o">.</span><span class="n">_cache</span>
        <span class="n">ElementPath</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_cache</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkwarnings</span><span class="o">.</span><span class="n">__enter__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">xml.etree</span> <span class="kn">import</span> <span class="n">ElementPath</span>
        <span class="c"># Restore mapping and path cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nsmap</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nsmap</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nsmap_copy</span><span class="p">)</span>
        <span class="n">ElementPath</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkwarnings</span><span class="o">.</span><span class="n">__exit__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="test_main"><a class="viewcode-back" href="../../test.html#test.test_xml_etree.test_main">[docs]</a><span class="k">def</span> <span class="nf">test_main</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c"># When invoked without a module, runs the Python ET tests by loading pyET.</span>
    <span class="c"># Otherwise, uses the given module as the ET.</span>
    <span class="k">global</span> <span class="n">pyET</span>
    <span class="n">pyET</span> <span class="o">=</span> <span class="n">import_fresh_module</span><span class="p">(</span><span class="s">&#39;xml.etree.ElementTree&#39;</span><span class="p">,</span>
                               <span class="n">blocked</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;_elementtree&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">module</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">module</span> <span class="o">=</span> <span class="n">pyET</span>

    <span class="k">global</span> <span class="n">ET</span>
    <span class="n">ET</span> <span class="o">=</span> <span class="n">module</span>

    <span class="n">test_classes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">ModuleTest</span><span class="p">,</span>
        <span class="n">ElementSlicingTest</span><span class="p">,</span>
        <span class="n">BasicElementTest</span><span class="p">,</span>
        <span class="n">ElementTreeTest</span><span class="p">,</span>
        <span class="n">IOTest</span><span class="p">,</span>
        <span class="n">ParseErrorTest</span><span class="p">,</span>
        <span class="n">XIncludeTest</span><span class="p">,</span>
        <span class="n">ElementTreeTypeTest</span><span class="p">,</span>
        <span class="n">ElementFindTest</span><span class="p">,</span>
        <span class="n">ElementIterTest</span><span class="p">,</span>
        <span class="n">TreeBuilderTest</span><span class="p">,</span>
        <span class="n">XMLParserTest</span><span class="p">,</span>
        <span class="n">XMLPullParserTest</span><span class="p">,</span>
        <span class="n">BugsTest</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="c"># These tests will only run for the pure-Python version that doesn&#39;t import</span>
    <span class="c"># _elementtree. We can&#39;t use skipUnless here, because pyET is filled in only</span>
    <span class="c"># after the module is loaded.</span>
    <span class="k">if</span> <span class="n">pyET</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ET</span><span class="p">:</span>
        <span class="n">test_classes</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
            <span class="n">NoAcceleratorTest</span><span class="p">,</span>
            <span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c"># XXX the C module should give the same warnings as the Python module</span>
        <span class="k">with</span> <span class="n">CleanContext</span><span class="p">(</span><span class="n">quiet</span><span class="o">=</span><span class="p">(</span><span class="n">pyET</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ET</span><span class="p">)):</span>
            <span class="n">support</span><span class="o">.</span><span class="n">run_unittest</span><span class="p">(</span><span class="o">*</span><span class="n">test_classes</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c"># don&#39;t interfere with subsequent tests</span>
        <span class="n">ET</span> <span class="o">=</span> <span class="n">pyET</span> <span class="o">=</span> <span class="bp">None</span>

</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">test_main</span><span class="p">()</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>