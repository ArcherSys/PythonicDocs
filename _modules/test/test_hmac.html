

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_hmac &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_hmac</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_hmac</h1><div class="highlight"><pre>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">support</span>


<div class="viewcode-block" id="ignore_warning"><a class="viewcode-back" href="../../test.html#test.test_hmac.ignore_warning">[docs]</a><span class="k">def</span> <span class="nf">ignore_warning</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="nd">@functools.wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">&quot;ignore&quot;</span><span class="p">,</span>
                                    <span class="n">category</span><span class="o">=</span><span class="ne">PendingDeprecationWarning</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>

</div>
<div class="viewcode-block" id="TestVectorsTestCase"><a class="viewcode-back" href="../../test.html#test.test_hmac.TestVectorsTestCase">[docs]</a><span class="k">class</span> <span class="nc">TestVectorsTestCase</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="TestVectorsTestCase.test_md5_vectors"><a class="viewcode-back" href="../../test.html#test.test_hmac.TestVectorsTestCase.test_md5_vectors">[docs]</a>    <span class="k">def</span> <span class="nf">test_md5_vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test the HMAC module against test vectors from the RFC.</span>

        <span class="k">def</span> <span class="nf">md5test</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">digest</span><span class="p">):</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">digest</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;hmac-md5&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">digest_size</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">block_size</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>

            <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="s">&#39;md5&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">digest</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;hmac-md5&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">digest_size</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">block_size</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>


        <span class="n">md5test</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;</span><span class="se">\x0b</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span>
                <span class="n">b</span><span class="s">&quot;Hi There&quot;</span><span class="p">,</span>
                <span class="s">&quot;9294727A3638BB1C13F48EF8158BFC9D&quot;</span><span class="p">)</span>

        <span class="n">md5test</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;Jefe&quot;</span><span class="p">,</span>
                <span class="n">b</span><span class="s">&quot;what do ya want for nothing?&quot;</span><span class="p">,</span>
                <span class="s">&quot;750c783e6ab0b503eaa86e310a5db738&quot;</span><span class="p">)</span>

        <span class="n">md5test</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;</span><span class="se">\xaa</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span>
                <span class="n">b</span><span class="s">&quot;</span><span class="se">\xdd</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">,</span>
                <span class="s">&quot;56be34521d144c88dbb8c733f0e8b3f6&quot;</span><span class="p">)</span>

        <span class="n">md5test</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">)),</span>
                <span class="n">b</span><span class="s">&quot;</span><span class="se">\xcd</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">,</span>
                <span class="s">&quot;697eaf0aca3a3aea3a75164746ffaa79&quot;</span><span class="p">)</span>

        <span class="n">md5test</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;</span><span class="se">\x0C</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span>
                <span class="n">b</span><span class="s">&quot;Test With Truncation&quot;</span><span class="p">,</span>
                <span class="s">&quot;56461ef2342edc00f9bab995690efd4c&quot;</span><span class="p">)</span>

        <span class="n">md5test</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;</span><span class="se">\xaa</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">,</span>
                <span class="n">b</span><span class="s">&quot;Test Using Larger Than Block-Size Key - Hash Key First&quot;</span><span class="p">,</span>
                <span class="s">&quot;6b1ab7fe4bd7bf8f0b62e6ce61b9d0cd&quot;</span><span class="p">)</span>

        <span class="n">md5test</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;</span><span class="se">\xaa</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">,</span>
                <span class="p">(</span><span class="n">b</span><span class="s">&quot;Test Using Larger Than Block-Size Key &quot;</span>
                 <span class="n">b</span><span class="s">&quot;and Larger Than One Block-Size Data&quot;</span><span class="p">),</span>
                <span class="s">&quot;6f630fad67cda0ee1fb1f562db3aa53e&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestVectorsTestCase.test_sha_vectors"><a class="viewcode-back" href="../../test.html#test.test_hmac.TestVectorsTestCase.test_sha_vectors">[docs]</a>    <span class="k">def</span> <span class="nf">test_sha_vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">shatest</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">digest</span><span class="p">):</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">digest</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;hmac-sha1&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">digest_size</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">block_size</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>

            <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="s">&#39;sha1&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">digest</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;hmac-sha1&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">digest_size</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">block_size</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>


        <span class="n">shatest</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;</span><span class="se">\x0b</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">,</span>
                <span class="n">b</span><span class="s">&quot;Hi There&quot;</span><span class="p">,</span>
                <span class="s">&quot;b617318655057264e28bc0b6fb378c8ef146be00&quot;</span><span class="p">)</span>

        <span class="n">shatest</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;Jefe&quot;</span><span class="p">,</span>
                <span class="n">b</span><span class="s">&quot;what do ya want for nothing?&quot;</span><span class="p">,</span>
                <span class="s">&quot;effcdf6ae5eb2fa2d27416d5f184df9c259a7c79&quot;</span><span class="p">)</span>

        <span class="n">shatest</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;</span><span class="se">\xAA</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">,</span>
                <span class="n">b</span><span class="s">&quot;</span><span class="se">\xDD</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">,</span>
                <span class="s">&quot;125d7342b9ac11cd91a39af48aa17b4f63f175d3&quot;</span><span class="p">)</span>

        <span class="n">shatest</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">)),</span>
                <span class="n">b</span><span class="s">&quot;</span><span class="se">\xCD</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">,</span>
                <span class="s">&quot;4c9007f4026250c6bc8414f9bf50c86c2d7235da&quot;</span><span class="p">)</span>

        <span class="n">shatest</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;</span><span class="se">\x0C</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">,</span>
                <span class="n">b</span><span class="s">&quot;Test With Truncation&quot;</span><span class="p">,</span>
                <span class="s">&quot;4c1a03424b55e07fe7f27be1d58bb9324a9a5a04&quot;</span><span class="p">)</span>

        <span class="n">shatest</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;</span><span class="se">\xAA</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">,</span>
                <span class="n">b</span><span class="s">&quot;Test Using Larger Than Block-Size Key - Hash Key First&quot;</span><span class="p">,</span>
                <span class="s">&quot;aa4ae5e15272d00e95705637ce8a3b55ed402112&quot;</span><span class="p">)</span>

        <span class="n">shatest</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;</span><span class="se">\xAA</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">,</span>
                <span class="p">(</span><span class="n">b</span><span class="s">&quot;Test Using Larger Than Block-Size Key &quot;</span>
                 <span class="n">b</span><span class="s">&quot;and Larger Than One Block-Size Data&quot;</span><span class="p">),</span>
                <span class="s">&quot;e8e99d0f45237d786d6bbaa7965c7808bbff1a91&quot;</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_rfc4231_test_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hashfunc</span><span class="p">,</span> <span class="n">hash_name</span><span class="p">,</span> <span class="n">digest_size</span><span class="p">,</span> <span class="n">block_size</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">hmactest</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">hexdigests</span><span class="p">):</span>
            <span class="n">hmac_name</span> <span class="o">=</span> <span class="s">&quot;hmac-&quot;</span> <span class="o">+</span> <span class="n">hash_name</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="n">hashfunc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">hexdigests</span><span class="p">[</span><span class="n">hashfunc</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">hmac_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">digest_size</span><span class="p">,</span> <span class="n">digest_size</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">block_size</span><span class="p">,</span> <span class="n">block_size</span><span class="p">)</span>

            <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="n">hash_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">hexdigests</span><span class="p">[</span><span class="n">hashfunc</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">hmac_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">digest_size</span><span class="p">,</span> <span class="n">digest_size</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">block_size</span><span class="p">,</span> <span class="n">block_size</span><span class="p">)</span>


        <span class="c"># 4.2.  Test Case 1</span>
        <span class="n">hmactest</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\x0b</span><span class="s">&#39;</span><span class="o">*</span><span class="mi">20</span><span class="p">,</span>
                 <span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;Hi There&#39;</span><span class="p">,</span>
                 <span class="n">hexdigests</span> <span class="o">=</span> <span class="p">{</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha224</span><span class="p">:</span> <span class="s">&#39;896fb1128abbdf196832107cd49df33f&#39;</span>
                                   <span class="s">&#39;47b4b1169912ba4f53684b22&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">:</span> <span class="s">&#39;b0344c61d8db38535ca8afceaf0bf12b&#39;</span>
                                   <span class="s">&#39;881dc200c9833da726e9376c2e32cff7&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha384</span><span class="p">:</span> <span class="s">&#39;afd03944d84895626b0825f4ab46907f&#39;</span>
                                   <span class="s">&#39;15f9dadbe4101ec682aa034c7cebc59c&#39;</span>
                                   <span class="s">&#39;faea9ea9076ede7f4af152e8b2fa9cb6&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha512</span><span class="p">:</span> <span class="s">&#39;87aa7cdea5ef619d4ff0b4241a1d6cb0&#39;</span>
                                   <span class="s">&#39;2379f4e2ce4ec2787ad0b30545e17cde&#39;</span>
                                   <span class="s">&#39;daa833b7d6b8a702038b274eaea3f4e4&#39;</span>
                                   <span class="s">&#39;be9d914eeb61f1702e696c203a126854&#39;</span><span class="p">,</span>
                 <span class="p">})</span>

        <span class="c"># 4.3.  Test Case 2</span>
        <span class="n">hmactest</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;Jefe&#39;</span><span class="p">,</span>
                 <span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;what do ya want for nothing?&#39;</span><span class="p">,</span>
                 <span class="n">hexdigests</span> <span class="o">=</span> <span class="p">{</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha224</span><span class="p">:</span> <span class="s">&#39;a30e01098bc6dbbf45690f3a7e9e6d0f&#39;</span>
                                   <span class="s">&#39;8bbea2a39e6148008fd05e44&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">:</span> <span class="s">&#39;5bdcc146bf60754e6a042426089575c7&#39;</span>
                                   <span class="s">&#39;5a003f089d2739839dec58b964ec3843&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha384</span><span class="p">:</span> <span class="s">&#39;af45d2e376484031617f78d2b58a6b1b&#39;</span>
                                   <span class="s">&#39;9c7ef464f5a01b47e42ec3736322445e&#39;</span>
                                   <span class="s">&#39;8e2240ca5e69e2c78b3239ecfab21649&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha512</span><span class="p">:</span> <span class="s">&#39;164b7a7bfcf819e2e395fbe73b56e0a3&#39;</span>
                                   <span class="s">&#39;87bd64222e831fd610270cd7ea250554&#39;</span>
                                   <span class="s">&#39;9758bf75c05a994a6d034f65f8f0e6fd&#39;</span>
                                   <span class="s">&#39;caeab1a34d4a6b4b636e070a38bce737&#39;</span><span class="p">,</span>
                 <span class="p">})</span>

        <span class="c"># 4.4.  Test Case 3</span>
        <span class="n">hmactest</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xaa</span><span class="s">&#39;</span><span class="o">*</span><span class="mi">20</span><span class="p">,</span>
                 <span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xdd</span><span class="s">&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">,</span>
                 <span class="n">hexdigests</span> <span class="o">=</span> <span class="p">{</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha224</span><span class="p">:</span> <span class="s">&#39;7fb3cb3588c6c1f6ffa9694d7d6ad264&#39;</span>
                                   <span class="s">&#39;9365b0c1f65d69d1ec8333ea&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">:</span> <span class="s">&#39;773ea91e36800e46854db8ebd09181a7&#39;</span>
                                   <span class="s">&#39;2959098b3ef8c122d9635514ced565fe&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha384</span><span class="p">:</span> <span class="s">&#39;88062608d3e6ad8a0aa2ace014c8a86f&#39;</span>
                                   <span class="s">&#39;0aa635d947ac9febe83ef4e55966144b&#39;</span>
                                   <span class="s">&#39;2a5ab39dc13814b94e3ab6e101a34f27&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha512</span><span class="p">:</span> <span class="s">&#39;fa73b0089d56a284efb0f0756c890be9&#39;</span>
                                   <span class="s">&#39;b1b5dbdd8ee81a3655f83e33b2279d39&#39;</span>
                                   <span class="s">&#39;bf3e848279a722c806b485a47e67c807&#39;</span>
                                   <span class="s">&#39;b946a337bee8942674278859e13292fb&#39;</span><span class="p">,</span>
                 <span class="p">})</span>

        <span class="c"># 4.5.  Test Case 4</span>
        <span class="n">hmactest</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x19</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span>
                 <span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xcd</span><span class="s">&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">,</span>
                 <span class="n">hexdigests</span> <span class="o">=</span> <span class="p">{</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha224</span><span class="p">:</span> <span class="s">&#39;6c11506874013cac6a2abc1bb382627c&#39;</span>
                                   <span class="s">&#39;ec6a90d86efc012de7afec5a&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">:</span> <span class="s">&#39;82558a389a443c0ea4cc819899f2083a&#39;</span>
                                   <span class="s">&#39;85f0faa3e578f8077a2e3ff46729665b&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha384</span><span class="p">:</span> <span class="s">&#39;3e8a69b7783c25851933ab6290af6ca7&#39;</span>
                                   <span class="s">&#39;7a9981480850009cc5577c6e1f573b4e&#39;</span>
                                   <span class="s">&#39;6801dd23c4a7d679ccf8a386c674cffb&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha512</span><span class="p">:</span> <span class="s">&#39;b0ba465637458c6990e5a8c5f61d4af7&#39;</span>
                                   <span class="s">&#39;e576d97ff94b872de76f8050361ee3db&#39;</span>
                                   <span class="s">&#39;a91ca5c11aa25eb4d679275cc5788063&#39;</span>
                                   <span class="s">&#39;a5f19741120c4f2de2adebeb10a298dd&#39;</span><span class="p">,</span>
                 <span class="p">})</span>

        <span class="c"># 4.7.  Test Case 6</span>
        <span class="n">hmactest</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xaa</span><span class="s">&#39;</span><span class="o">*</span><span class="mi">131</span><span class="p">,</span>
                 <span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;Test Using Larger Than Block-Siz&#39;</span>
                        <span class="n">b</span><span class="s">&#39;e Key - Hash Key First&#39;</span><span class="p">,</span>
                 <span class="n">hexdigests</span> <span class="o">=</span> <span class="p">{</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha224</span><span class="p">:</span> <span class="s">&#39;95e9a0db962095adaebe9b2d6f0dbce2&#39;</span>
                                   <span class="s">&#39;d499f112f2d2b7273fa6870e&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">:</span> <span class="s">&#39;60e431591ee0b67f0d8a26aacbf5b77f&#39;</span>
                                   <span class="s">&#39;8e0bc6213728c5140546040f0ee37f54&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha384</span><span class="p">:</span> <span class="s">&#39;4ece084485813e9088d2c63a041bc5b4&#39;</span>
                                   <span class="s">&#39;4f9ef1012a2b588f3cd11f05033ac4c6&#39;</span>
                                   <span class="s">&#39;0c2ef6ab4030fe8296248df163f44952&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha512</span><span class="p">:</span> <span class="s">&#39;80b24263c7c1a3ebb71493c1dd7be8b4&#39;</span>
                                   <span class="s">&#39;9b46d1f41b4aeec1121b013783f8f352&#39;</span>
                                   <span class="s">&#39;6b56d037e05f2598bd0fd2215d6a1e52&#39;</span>
                                   <span class="s">&#39;95e64f73f63f0aec8b915a985d786598&#39;</span><span class="p">,</span>
                 <span class="p">})</span>

        <span class="c"># 4.8.  Test Case 7</span>
        <span class="n">hmactest</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\xaa</span><span class="s">&#39;</span><span class="o">*</span><span class="mi">131</span><span class="p">,</span>
                 <span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;This is a test using a larger th&#39;</span>
                        <span class="n">b</span><span class="s">&#39;an block-size key and a larger t&#39;</span>
                        <span class="n">b</span><span class="s">&#39;han block-size data. The key nee&#39;</span>
                        <span class="n">b</span><span class="s">&#39;ds to be hashed before being use&#39;</span>
                        <span class="n">b</span><span class="s">&#39;d by the HMAC algorithm.&#39;</span><span class="p">,</span>
                 <span class="n">hexdigests</span> <span class="o">=</span> <span class="p">{</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha224</span><span class="p">:</span> <span class="s">&#39;3a854166ac5d9f023f54d517d0b39dbd&#39;</span>
                                   <span class="s">&#39;946770db9c2b95c9f6f565d1&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">:</span> <span class="s">&#39;9b09ffa71b942fcb27635fbcd5b0e944&#39;</span>
                                   <span class="s">&#39;bfdc63644f0713938a7f51535c3a35e2&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha384</span><span class="p">:</span> <span class="s">&#39;6617178e941f020d351e2f254e8fd32c&#39;</span>
                                   <span class="s">&#39;602420feb0b8fb9adccebb82461e99c5&#39;</span>
                                   <span class="s">&#39;a678cc31e799176d3860e6110c46523e&#39;</span><span class="p">,</span>
                   <span class="n">hashlib</span><span class="o">.</span><span class="n">sha512</span><span class="p">:</span> <span class="s">&#39;e37b6a775dc87dbaa4dfa9f96e5e3ffd&#39;</span>
                                   <span class="s">&#39;debd71f8867289865df5a32d20cdc944&#39;</span>
                                   <span class="s">&#39;b6022cac3c4982b10d5eeb55c3e4de15&#39;</span>
                                   <span class="s">&#39;134676fb6de0446065c97440fa8c6a58&#39;</span><span class="p">,</span>
                 <span class="p">})</span>

<div class="viewcode-block" id="TestVectorsTestCase.test_sha224_rfc4231"><a class="viewcode-back" href="../../test.html#test.test_hmac.TestVectorsTestCase.test_sha224_rfc4231">[docs]</a>    <span class="k">def</span> <span class="nf">test_sha224_rfc4231</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rfc4231_test_cases</span><span class="p">(</span><span class="n">hashlib</span><span class="o">.</span><span class="n">sha224</span><span class="p">,</span> <span class="s">&#39;sha224&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestVectorsTestCase.test_sha256_rfc4231"><a class="viewcode-back" href="../../test.html#test.test_hmac.TestVectorsTestCase.test_sha256_rfc4231">[docs]</a>    <span class="k">def</span> <span class="nf">test_sha256_rfc4231</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rfc4231_test_cases</span><span class="p">(</span><span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">,</span> <span class="s">&#39;sha256&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestVectorsTestCase.test_sha384_rfc4231"><a class="viewcode-back" href="../../test.html#test.test_hmac.TestVectorsTestCase.test_sha384_rfc4231">[docs]</a>    <span class="k">def</span> <span class="nf">test_sha384_rfc4231</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rfc4231_test_cases</span><span class="p">(</span><span class="n">hashlib</span><span class="o">.</span><span class="n">sha384</span><span class="p">,</span> <span class="s">&#39;sha384&#39;</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestVectorsTestCase.test_sha512_rfc4231"><a class="viewcode-back" href="../../test.html#test.test_hmac.TestVectorsTestCase.test_sha512_rfc4231">[docs]</a>    <span class="k">def</span> <span class="nf">test_sha512_rfc4231</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rfc4231_test_cases</span><span class="p">(</span><span class="n">hashlib</span><span class="o">.</span><span class="n">sha512</span><span class="p">,</span> <span class="s">&#39;sha512&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestVectorsTestCase.test_legacy_block_size_warnings"><a class="viewcode-back" href="../../test.html#test.test_hmac.TestVectorsTestCase.test_legacy_block_size_warnings">[docs]</a>    <span class="k">def</span> <span class="nf">test_legacy_block_size_warnings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">MockCrazyHash</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Ain&#39;t no block_size attribute here.&quot;&quot;&quot;</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digest_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="o">.</span><span class="n">digest_size</span>
            <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">digest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>

        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s">&#39;error&#39;</span><span class="p">,</span> <span class="ne">RuntimeWarning</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">RuntimeWarning</span><span class="p">):</span>
                <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="n">MockCrazyHash</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&#39;Expected warning about missing block_size&#39;</span><span class="p">)</span>

            <span class="n">MockCrazyHash</span><span class="o">.</span><span class="n">block_size</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">RuntimeWarning</span><span class="p">):</span>
                <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="n">MockCrazyHash</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&#39;Expected warning about small block_size&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TestVectorsTestCase.test_with_digestmod_warning"><a class="viewcode-back" href="../../test.html#test.test_hmac.TestVectorsTestCase.test_with_digestmod_warning">[docs]</a>    <span class="k">def</span> <span class="nf">test_with_digestmod_warning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertWarns</span><span class="p">(</span><span class="ne">PendingDeprecationWarning</span><span class="p">):</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\x0b</span><span class="s">&quot;</span> <span class="o">*</span> <span class="mi">16</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;Hi There&quot;</span>
            <span class="n">digest</span> <span class="o">=</span> <span class="s">&quot;9294727A3638BB1C13F48EF8158BFC9D&quot;</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">digest</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="ConstructorTestCase"><a class="viewcode-back" href="../../test.html#test.test_hmac.ConstructorTestCase">[docs]</a><span class="k">class</span> <span class="nc">ConstructorTestCase</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@ignore_warning</span>
<div class="viewcode-block" id="ConstructorTestCase.test_normal"><a class="viewcode-back" href="../../test.html#test.test_hmac.ConstructorTestCase.test_normal">[docs]</a>    <span class="k">def</span> <span class="nf">test_normal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Standard constructor call.</span>
        <span class="n">failed</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;key&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Standard constructor call raised exception.&quot;</span><span class="p">)</span>
</div>
    <span class="nd">@ignore_warning</span>
<div class="viewcode-block" id="ConstructorTestCase.test_with_str_key"><a class="viewcode-back" href="../../test.html#test.test_hmac.ConstructorTestCase.test_with_str_key">[docs]</a>    <span class="k">def</span> <span class="nf">test_with_str_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Pass a key of type str, which is an error, because it expects a key</span>
        <span class="c"># of type bytes</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">)</span>
</div>
    <span class="nd">@ignore_warning</span>
<div class="viewcode-block" id="ConstructorTestCase.test_dot_new_with_str_key"><a class="viewcode-back" href="../../test.html#test.test_hmac.ConstructorTestCase.test_dot_new_with_str_key">[docs]</a>    <span class="k">def</span> <span class="nf">test_dot_new_with_str_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Pass a key of type str, which is an error, because it expects a key</span>
        <span class="c"># of type bytes</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">)</span>
</div>
    <span class="nd">@ignore_warning</span>
<div class="viewcode-block" id="ConstructorTestCase.test_withtext"><a class="viewcode-back" href="../../test.html#test.test_hmac.ConstructorTestCase.test_withtext">[docs]</a>    <span class="k">def</span> <span class="nf">test_withtext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Constructor call with text.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;key&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;hash this!&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Constructor call with text argument raised exception.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(),</span> <span class="s">&#39;34325b639da4cfd95735b381e28cb864&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ConstructorTestCase.test_with_bytearray"><a class="viewcode-back" href="../../test.html#test.test_hmac.ConstructorTestCase.test_with_bytearray">[docs]</a>    <span class="k">def</span> <span class="nf">test_with_bytearray</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;key&quot;</span><span class="p">),</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;hash this!&quot;</span><span class="p">),</span>
                          <span class="n">digestmod</span><span class="o">=</span><span class="s">&quot;md5&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Constructor call with bytearray arguments raised exception.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(),</span> <span class="s">&#39;34325b639da4cfd95735b381e28cb864&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ConstructorTestCase.test_with_memoryview_msg"><a class="viewcode-back" href="../../test.html#test.test_hmac.ConstructorTestCase.test_with_memoryview_msg">[docs]</a>    <span class="k">def</span> <span class="nf">test_with_memoryview_msg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;key&quot;</span><span class="p">,</span> <span class="n">memoryview</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;hash this!&quot;</span><span class="p">),</span> <span class="n">digestmod</span><span class="o">=</span><span class="s">&quot;md5&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Constructor call with memoryview msg raised exception.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(),</span> <span class="s">&#39;34325b639da4cfd95735b381e28cb864&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ConstructorTestCase.test_withmodule"><a class="viewcode-back" href="../../test.html#test.test_hmac.ConstructorTestCase.test_withmodule">[docs]</a>    <span class="k">def</span> <span class="nf">test_withmodule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Constructor call with text and digest module.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;key&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Constructor call with hashlib.sha1 raised exception.&quot;</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="SanityTestCase"><a class="viewcode-back" href="../../test.html#test.test_hmac.SanityTestCase">[docs]</a><span class="k">class</span> <span class="nc">SanityTestCase</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@ignore_warning</span>
<div class="viewcode-block" id="SanityTestCase.test_default_is_md5"><a class="viewcode-back" href="../../test.html#test.test_hmac.SanityTestCase.test_default_is_md5">[docs]</a>    <span class="k">def</span> <span class="nf">test_default_is_md5</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing if HMAC defaults to MD5 algorithm.</span>
        <span class="c"># NOTE: this whitebox test depends on the hmac class internals</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;key&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">digest_cons</span><span class="p">,</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SanityTestCase.test_exercise_all_methods"><a class="viewcode-back" href="../../test.html#test.test_hmac.SanityTestCase.test_exercise_all_methods">[docs]</a>    <span class="k">def</span> <span class="nf">test_exercise_all_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Exercising all methods once.</span>
        <span class="c"># This must not raise any exceptions</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;my secret key&quot;</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="s">&quot;md5&quot;</span><span class="p">)</span>
            <span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;compute the hash of this text!&quot;</span><span class="p">)</span>
            <span class="n">dig</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
            <span class="n">dig</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
            <span class="n">h2</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Exception raised during normal usage of HMAC class.&quot;</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="CopyTestCase"><a class="viewcode-back" href="../../test.html#test.test_hmac.CopyTestCase">[docs]</a><span class="k">class</span> <span class="nc">CopyTestCase</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="CopyTestCase.test_attributes"><a class="viewcode-back" href="../../test.html#test.test_hmac.CopyTestCase.test_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">test_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing if attributes are of same type.</span>
        <span class="n">h1</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;key&quot;</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="s">&quot;md5&quot;</span><span class="p">)</span>
        <span class="n">h2</span> <span class="o">=</span> <span class="n">h1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">h1</span><span class="o">.</span><span class="n">digest_cons</span> <span class="o">==</span> <span class="n">h2</span><span class="o">.</span><span class="n">digest_cons</span><span class="p">,</span>
            <span class="s">&quot;digest constructors don&#39;t match.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">h1</span><span class="o">.</span><span class="n">inner</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">h2</span><span class="o">.</span><span class="n">inner</span><span class="p">),</span>
            <span class="s">&quot;Types of inner don&#39;t match.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">h1</span><span class="o">.</span><span class="n">outer</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">h2</span><span class="o">.</span><span class="n">outer</span><span class="p">),</span>
            <span class="s">&quot;Types of outer don&#39;t match.&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CopyTestCase.test_realcopy"><a class="viewcode-back" href="../../test.html#test.test_hmac.CopyTestCase.test_realcopy">[docs]</a>    <span class="k">def</span> <span class="nf">test_realcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing if the copy method created a real copy.</span>
        <span class="n">h1</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;key&quot;</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="s">&quot;md5&quot;</span><span class="p">)</span>
        <span class="n">h2</span> <span class="o">=</span> <span class="n">h1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c"># Using id() in case somebody has overridden __eq__/__ne__.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">h1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">id</span><span class="p">(</span><span class="n">h2</span><span class="p">),</span> <span class="s">&quot;No real copy of the HMAC instance.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">h1</span><span class="o">.</span><span class="n">inner</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">id</span><span class="p">(</span><span class="n">h2</span><span class="o">.</span><span class="n">inner</span><span class="p">),</span>
            <span class="s">&quot;No real copy of the attribute &#39;inner&#39;.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">h1</span><span class="o">.</span><span class="n">outer</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">id</span><span class="p">(</span><span class="n">h2</span><span class="o">.</span><span class="n">outer</span><span class="p">),</span>
            <span class="s">&quot;No real copy of the attribute &#39;outer&#39;.&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CopyTestCase.test_equality"><a class="viewcode-back" href="../../test.html#test.test_hmac.CopyTestCase.test_equality">[docs]</a>    <span class="k">def</span> <span class="nf">test_equality</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing if the copy has the same digests.</span>
        <span class="n">h1</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">HMAC</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;key&quot;</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="s">&quot;md5&quot;</span><span class="p">)</span>
        <span class="n">h1</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;some random text&quot;</span><span class="p">)</span>
        <span class="n">h2</span> <span class="o">=</span> <span class="n">h1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h1</span><span class="o">.</span><span class="n">digest</span><span class="p">(),</span> <span class="n">h2</span><span class="o">.</span><span class="n">digest</span><span class="p">(),</span>
            <span class="s">&quot;Digest of copy doesn&#39;t match original digest.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">h1</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(),</span> <span class="n">h2</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(),</span>
            <span class="s">&quot;Hexdigest of copy doesn&#39;t match original hexdigest.&quot;</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="CompareDigestTestCase"><a class="viewcode-back" href="../../test.html#test.test_hmac.CompareDigestTestCase">[docs]</a><span class="k">class</span> <span class="nc">CompareDigestTestCase</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

<div class="viewcode-block" id="CompareDigestTestCase.test_compare_digest"><a class="viewcode-back" href="../../test.html#test.test_hmac.CompareDigestTestCase.test_compare_digest">[docs]</a>    <span class="k">def</span> <span class="nf">test_compare_digest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Testing input type exception handling</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;foobar&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">,</span> <span class="mi">200</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="s">&quot;foobar&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;foobar&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">,</span> <span class="s">&quot;foobar&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

        <span class="c"># Testing bytes of different lengths</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;foo&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\xde\xad\xbe\xef</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\xde\xad</span><span class="s">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

        <span class="c"># Testing bytes of same lengths, different values</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;foobaz&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\xde\xad\xbe\xef</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\xab\xad\x1d\xea</span><span class="s">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

        <span class="c"># Testing bytes of same lengths, same values</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;foobar&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\xde\xad\xbe\xef</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\xde\xad\xbe\xef</span><span class="s">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

        <span class="c"># Testing bytearrays of same lengths, same values</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">),</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

        <span class="c"># Testing bytearrays of diffeent lengths</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">),</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;foo&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

        <span class="c"># Testing bytearrays of same lengths, different values</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">),</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;foobaz&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

        <span class="c"># Testing byte and bytearray of same lengths, same values</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">),</span> <span class="n">b</span><span class="s">&quot;foobar&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>

        <span class="c"># Testing byte bytearray of diffeent lengths</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">),</span> <span class="n">b</span><span class="s">&quot;foo&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>

        <span class="c"># Testing byte and bytearray of same lengths, different values</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">),</span> <span class="n">b</span><span class="s">&quot;foobaz&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>

        <span class="c"># Testing str of same lengths</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="s">&quot;foobar&quot;</span><span class="p">,</span> <span class="s">&quot;foobar&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

        <span class="c"># Testing str of diffeent lengths</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;foobar&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

        <span class="c"># Testing bytes of same lengths, different values</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="s">&quot;foobar&quot;</span><span class="p">,</span> <span class="s">&quot;foobaz&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

        <span class="c"># Testing error cases</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="s">&quot;foobar&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;foobar&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">,</span> <span class="s">&quot;foobar&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">,</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="s">&quot;fooä&quot;</span><span class="p">,</span> <span class="s">&quot;fooä&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

        <span class="c"># subclasses are supported by ignore __eq__</span>
        <span class="k">class</span> <span class="nc">mystr</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>

        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">mystr</span><span class="p">(</span><span class="s">&quot;foobar&quot;</span><span class="p">),</span> <span class="n">mystr</span><span class="p">(</span><span class="s">&quot;foobar&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">mystr</span><span class="p">(</span><span class="s">&quot;foobar&quot;</span><span class="p">),</span> <span class="s">&quot;foobar&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">mystr</span><span class="p">(</span><span class="s">&quot;foobar&quot;</span><span class="p">),</span> <span class="n">mystr</span><span class="p">(</span><span class="s">&quot;foobaz&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

        <span class="k">class</span> <span class="nc">mybytes</span><span class="p">(</span><span class="nb">bytes</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>

        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">mybytes</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">),</span> <span class="n">mybytes</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">mybytes</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">),</span> <span class="n">b</span><span class="s">&quot;foobar&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">mybytes</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;foobar&quot;</span><span class="p">),</span> <span class="n">mybytes</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;foobaz&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

</div></div>
<div class="viewcode-block" id="test_main"><a class="viewcode-back" href="../../test.html#test.test_hmac.test_main">[docs]</a><span class="k">def</span> <span class="nf">test_main</span><span class="p">():</span>
    <span class="n">support</span><span class="o">.</span><span class="n">run_unittest</span><span class="p">(</span>
        <span class="n">TestVectorsTestCase</span><span class="p">,</span>
        <span class="n">ConstructorTestCase</span><span class="p">,</span>
        <span class="n">SanityTestCase</span><span class="p">,</span>
        <span class="n">CopyTestCase</span><span class="p">,</span>
        <span class="n">CompareDigestTestCase</span>
    <span class="p">)</span>
</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">test_main</span><span class="p">()</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>