

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>test.test_strptime &mdash; ArcherBashPYDocs 1.0.0. documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ArcherBashPYDocs 1.0.0. documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> ArcherBashPYDocs</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ArcherBashPYDocs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>test.test_strptime</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for test.test_strptime</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;PyUnit testing against strptime&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">locale</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">support</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span> <span class="k">as</span> <span class="n">datetime_date</span>

<span class="kn">import</span> <span class="nn">_strptime</span>

<div class="viewcode-block" id="getlang_Tests"><a class="viewcode-back" href="../../test.html#test.test_strptime.getlang_Tests">[docs]</a><span class="k">class</span> <span class="nc">getlang_Tests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test _getlang&quot;&quot;&quot;</span>
<div class="viewcode-block" id="getlang_Tests.test_basic"><a class="viewcode-back" href="../../test.html#test.test_strptime.getlang_Tests.test_basic">[docs]</a>    <span class="k">def</span> <span class="nf">test_basic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">_strptime</span><span class="o">.</span><span class="n">_getlang</span><span class="p">(),</span> <span class="n">locale</span><span class="o">.</span><span class="n">getlocale</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">LC_TIME</span><span class="p">))</span>
</div></div>
<div class="viewcode-block" id="LocaleTime_Tests"><a class="viewcode-back" href="../../test.html#test.test_strptime.LocaleTime_Tests">[docs]</a><span class="k">class</span> <span class="nc">LocaleTime_Tests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tests for _strptime.LocaleTime.</span>

<span class="sd">    All values are lower-cased when stored in LocaleTime, so make sure to</span>
<span class="sd">    compare values after running ``lower`` on them.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="LocaleTime_Tests.setUp"><a class="viewcode-back" href="../../test.html#test.test_strptime.LocaleTime_Tests.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create time tuple based on current time.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LT_ins</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">LocaleTime</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="LocaleTime_Tests.compare_against_time"><a class="viewcode-back" href="../../test.html#test.test_strptime.LocaleTime_Tests.compare_against_time">[docs]</a>    <span class="k">def</span> <span class="nf">compare_against_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">testing</span><span class="p">,</span> <span class="n">directive</span><span class="p">,</span> <span class="n">tuple_position</span><span class="p">,</span>
                             <span class="n">error_msg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Helper method that tests testing against directive based on the</span>
<span class="sd">        tuple_position of time_tuple.  Uses error_msg as error message.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strftime_output</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">directive</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">comparison</span> <span class="o">=</span> <span class="n">testing</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">[</span><span class="n">tuple_position</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">strftime_output</span><span class="p">,</span> <span class="n">testing</span><span class="p">,</span>
                      <span class="s">&quot;</span><span class="si">%s</span><span class="s">: not found in tuple&quot;</span> <span class="o">%</span> <span class="n">error_msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">comparison</span><span class="p">,</span> <span class="n">strftime_output</span><span class="p">,</span>
                         <span class="s">&quot;</span><span class="si">%s</span><span class="s">: position within tuple incorrect; </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">error_msg</span><span class="p">,</span> <span class="n">comparison</span><span class="p">,</span> <span class="n">strftime_output</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="LocaleTime_Tests.test_weekday"><a class="viewcode-back" href="../../test.html#test.test_strptime.LocaleTime_Tests.test_weekday">[docs]</a>    <span class="k">def</span> <span class="nf">test_weekday</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure that full and abbreviated weekday names are correct in</span>
        <span class="c"># both string and position with tuple</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compare_against_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LT_ins</span><span class="o">.</span><span class="n">f_weekday</span><span class="p">,</span> <span class="s">&#39;%A&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
                                  <span class="s">&quot;Testing of full weekday name failed&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compare_against_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LT_ins</span><span class="o">.</span><span class="n">a_weekday</span><span class="p">,</span> <span class="s">&#39;%a&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
                                  <span class="s">&quot;Testing of abbreviated weekday name failed&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LocaleTime_Tests.test_month"><a class="viewcode-back" href="../../test.html#test.test_strptime.LocaleTime_Tests.test_month">[docs]</a>    <span class="k">def</span> <span class="nf">test_month</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test full and abbreviated month names; both string and position</span>
        <span class="c"># within the tuple</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compare_against_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LT_ins</span><span class="o">.</span><span class="n">f_month</span><span class="p">,</span> <span class="s">&#39;%B&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                                  <span class="s">&quot;Testing against full month name failed&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compare_against_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LT_ins</span><span class="o">.</span><span class="n">a_month</span><span class="p">,</span> <span class="s">&#39;%b&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                                  <span class="s">&quot;Testing against abbreviated month name failed&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LocaleTime_Tests.test_am_pm"><a class="viewcode-back" href="../../test.html#test.test_strptime.LocaleTime_Tests.test_am_pm">[docs]</a>    <span class="k">def</span> <span class="nf">test_am_pm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure AM/PM representation done properly</span>
        <span class="n">strftime_output</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%p&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">strftime_output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">LT_ins</span><span class="o">.</span><span class="n">am_pm</span><span class="p">,</span>
                      <span class="s">&quot;AM/PM representation not in tuple&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">:</span> <span class="n">position</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">position</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LT_ins</span><span class="o">.</span><span class="n">am_pm</span><span class="p">[</span><span class="n">position</span><span class="p">],</span> <span class="n">strftime_output</span><span class="p">,</span>
                         <span class="s">&quot;AM/PM representation in the wrong position within the tuple&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LocaleTime_Tests.test_timezone"><a class="viewcode-back" href="../../test.html#test.test_strptime.LocaleTime_Tests.test_timezone">[docs]</a>    <span class="k">def</span> <span class="nf">test_timezone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure timezone is correct</span>
        <span class="n">timezone</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%Z&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">timezone</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">timezone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LT_ins</span><span class="o">.</span><span class="n">timezone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span>
                            <span class="n">timezone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LT_ins</span><span class="o">.</span><span class="n">timezone</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                            <span class="s">&quot;timezone </span><span class="si">%s</span><span class="s"> not found in </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                            <span class="p">(</span><span class="n">timezone</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">LT_ins</span><span class="o">.</span><span class="n">timezone</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="LocaleTime_Tests.test_date_time"><a class="viewcode-back" href="../../test.html#test.test_strptime.LocaleTime_Tests.test_date_time">[docs]</a>    <span class="k">def</span> <span class="nf">test_date_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Check that LC_date_time, LC_date, and LC_time are correct</span>
        <span class="c"># the magic date is used so as to not have issues with %c when day of</span>
        <span class="c">#  the month is a single digit and has a leading space.  This is not an</span>
        <span class="c">#  issue since strptime still parses it correctly.  The problem is</span>
        <span class="c">#  testing these directives for correctness by comparing strftime</span>
        <span class="c">#  output.</span>
        <span class="n">magic_date</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1999</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">strftime_output</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%c</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">magic_date</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LT_ins</span><span class="o">.</span><span class="n">LC_date_time</span><span class="p">,</span> <span class="n">magic_date</span><span class="p">),</span>
                         <span class="n">strftime_output</span><span class="p">,</span> <span class="s">&quot;LC_date_time incorrect&quot;</span><span class="p">)</span>
        <span class="n">strftime_output</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%x</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">magic_date</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LT_ins</span><span class="o">.</span><span class="n">LC_date</span><span class="p">,</span> <span class="n">magic_date</span><span class="p">),</span>
                         <span class="n">strftime_output</span><span class="p">,</span> <span class="s">&quot;LC_date incorrect&quot;</span><span class="p">)</span>
        <span class="n">strftime_output</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%X</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">magic_date</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LT_ins</span><span class="o">.</span><span class="n">LC_time</span><span class="p">,</span> <span class="n">magic_date</span><span class="p">),</span>
                         <span class="n">strftime_output</span><span class="p">,</span> <span class="s">&quot;LC_time incorrect&quot;</span><span class="p">)</span>
        <span class="n">LT</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">LocaleTime</span><span class="p">()</span>
        <span class="n">LT</span><span class="o">.</span><span class="n">am_pm</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">LT</span><span class="o">.</span><span class="n">LC_time</span><span class="p">,</span> <span class="s">&quot;LocaleTime&#39;s LC directives cannot handle &quot;</span>
                                    <span class="s">&quot;empty strings&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LocaleTime_Tests.test_lang"><a class="viewcode-back" href="../../test.html#test.test_strptime.LocaleTime_Tests.test_lang">[docs]</a>    <span class="k">def</span> <span class="nf">test_lang</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure lang is set to what _getlang() returns</span>
        <span class="c"># Assuming locale has not changed between now and when self.LT_ins was created</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LT_ins</span><span class="o">.</span><span class="n">lang</span><span class="p">,</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_getlang</span><span class="p">())</span>

</div></div>
<div class="viewcode-block" id="TimeRETests"><a class="viewcode-back" href="../../test.html#test.test_strptime.TimeRETests">[docs]</a><span class="k">class</span> <span class="nc">TimeRETests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tests for TimeRE.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="TimeRETests.setUp"><a class="viewcode-back" href="../../test.html#test.test_strptime.TimeRETests.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct generic TimeRE object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_re</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">TimeRE</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locale_time</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">LocaleTime</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TimeRETests.test_pattern"><a class="viewcode-back" href="../../test.html#test.test_strptime.TimeRETests.test_pattern">[docs]</a>    <span class="k">def</span> <span class="nf">test_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test TimeRE.pattern</span>
        <span class="n">pattern_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_re</span><span class="o">.</span><span class="n">pattern</span><span class="p">(</span><span class="s">r&quot;%a %A </span><span class="si">%d</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">pattern_string</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locale_time</span><span class="o">.</span><span class="n">a_weekday</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                        <span class="s">&quot;did not find abbreviated weekday in pattern string &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span>
                         <span class="n">pattern_string</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">pattern_string</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locale_time</span><span class="o">.</span><span class="n">f_weekday</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                        <span class="s">&quot;did not find full weekday in pattern string &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span>
                         <span class="n">pattern_string</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">pattern_string</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_re</span><span class="p">[</span><span class="s">&#39;d&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                        <span class="s">&quot;did not find &#39;d&#39; directive pattern string &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span>
                         <span class="n">pattern_string</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TimeRETests.test_pattern_escaping"><a class="viewcode-back" href="../../test.html#test.test_strptime.TimeRETests.test_pattern_escaping">[docs]</a>    <span class="k">def</span> <span class="nf">test_pattern_escaping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure any characters in the format string that might be taken as</span>
        <span class="c"># regex syntax is escaped.</span>
        <span class="n">pattern_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_re</span><span class="o">.</span><span class="n">pattern</span><span class="p">(</span><span class="s">&quot;\d+&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">r&quot;</span><span class="se">\\</span><span class="s">d\+&quot;</span><span class="p">,</span> <span class="n">pattern_string</span><span class="p">,</span>
                      <span class="s">&quot;</span><span class="si">%s</span><span class="s"> does not have re characters escaped properly&quot;</span> <span class="o">%</span>
                      <span class="n">pattern_string</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TimeRETests.test_compile"><a class="viewcode-back" href="../../test.html#test.test_strptime.TimeRETests.test_compile">[docs]</a>    <span class="k">def</span> <span class="nf">test_compile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Check that compiled regex is correct</span>
        <span class="n">found</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;%A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locale_time</span><span class="o">.</span><span class="n">f_weekday</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">found</span> <span class="ow">and</span> <span class="n">found</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">locale_time</span><span class="o">.</span><span class="n">f_weekday</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span>
                        <span class="s">&quot;re object for &#39;%A&#39; failed&quot;</span><span class="p">)</span>
        <span class="n">compiled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;%a %b&quot;</span><span class="p">)</span>
        <span class="n">found</span> <span class="o">=</span> <span class="n">compiled</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locale_time</span><span class="o">.</span><span class="n">a_weekday</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">locale_time</span><span class="o">.</span><span class="n">a_month</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">found</span><span class="p">,</span>
            <span class="s">&quot;Match failed with &#39;</span><span class="si">%s</span><span class="s">&#39; regex and &#39;</span><span class="si">%s</span><span class="s">&#39; string&quot;</span> <span class="o">%</span>
             <span class="p">(</span><span class="n">compiled</span><span class="o">.</span><span class="n">pattern</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locale_time</span><span class="o">.</span><span class="n">a_weekday</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">locale_time</span><span class="o">.</span><span class="n">a_month</span><span class="p">[</span><span class="mi">4</span><span class="p">])))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">found</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">locale_time</span><span class="o">.</span><span class="n">a_weekday</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">and</span>
                         <span class="n">found</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">locale_time</span><span class="o">.</span><span class="n">a_month</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                        <span class="s">&quot;re object couldn&#39;t find the abbreviated weekday month in &quot;</span>
                         <span class="s">&quot;&#39;</span><span class="si">%s</span><span class="s">&#39; using &#39;</span><span class="si">%s</span><span class="s">&#39;; group &#39;a&#39; = &#39;</span><span class="si">%s</span><span class="s">&#39;, group &#39;b&#39; = </span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">found</span><span class="o">.</span><span class="n">string</span><span class="p">,</span> <span class="n">found</span><span class="o">.</span><span class="n">re</span><span class="o">.</span><span class="n">pattern</span><span class="p">,</span> <span class="n">found</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">),</span>
                          <span class="n">found</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">directive</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;B&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="s">&#39;H&#39;</span><span class="p">,</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="s">&#39;j&#39;</span><span class="p">,</span><span class="s">&#39;m&#39;</span><span class="p">,</span><span class="s">&#39;M&#39;</span><span class="p">,</span><span class="s">&#39;p&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span>
                          <span class="s">&#39;U&#39;</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">,</span><span class="s">&#39;W&#39;</span><span class="p">,</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="s">&#39;X&#39;</span><span class="p">,</span><span class="s">&#39;y&#39;</span><span class="p">,</span><span class="s">&#39;Y&#39;</span><span class="p">,</span><span class="s">&#39;Z&#39;</span><span class="p">,</span><span class="s">&#39;%&#39;</span><span class="p">):</span>
            <span class="n">compiled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;%&quot;</span> <span class="o">+</span> <span class="n">directive</span><span class="p">)</span>
            <span class="n">found</span> <span class="o">=</span> <span class="n">compiled</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%&quot;</span> <span class="o">+</span> <span class="n">directive</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">found</span><span class="p">,</span> <span class="s">&quot;Matching failed on &#39;</span><span class="si">%s</span><span class="s">&#39; using &#39;</span><span class="si">%s</span><span class="s">&#39; regex&quot;</span> <span class="o">%</span>
                                    <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%&quot;</span> <span class="o">+</span> <span class="n">directive</span><span class="p">),</span>
                                     <span class="n">compiled</span><span class="o">.</span><span class="n">pattern</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="TimeRETests.test_blankpattern"><a class="viewcode-back" href="../../test.html#test.test_strptime.TimeRETests.test_blankpattern">[docs]</a>    <span class="k">def</span> <span class="nf">test_blankpattern</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure when tuple or something has no values no regex is generated.</span>
        <span class="c"># Fixes bug #661354</span>
        <span class="n">test_locale</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">LocaleTime</span><span class="p">()</span>
        <span class="n">test_locale</span><span class="o">.</span><span class="n">timezone</span> <span class="o">=</span> <span class="p">(</span><span class="nb">frozenset</span><span class="p">(),</span> <span class="nb">frozenset</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">_strptime</span><span class="o">.</span><span class="n">TimeRE</span><span class="p">(</span><span class="n">test_locale</span><span class="p">)</span><span class="o">.</span><span class="n">pattern</span><span class="p">(</span><span class="s">&quot;%Z&quot;</span><span class="p">),</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
                         <span class="s">&quot;with timezone == (&#39;&#39;,&#39;&#39;), TimeRE().pattern(&#39;%Z&#39;) != &#39;&#39;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TimeRETests.test_matching_with_escapes"><a class="viewcode-back" href="../../test.html#test.test_strptime.TimeRETests.test_matching_with_escapes">[docs]</a>    <span class="k">def</span> <span class="nf">test_matching_with_escapes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure a format that requires escaping of characters works</span>
        <span class="n">compiled_re</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;\w+ %m&quot;</span><span class="p">)</span>
        <span class="n">found</span> <span class="o">=</span> <span class="n">compiled_re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">&quot;\w+ 10&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">found</span><span class="p">,</span> <span class="s">&quot;Escaping failed of format &#39;\w+ 10&#39;&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TimeRETests.test_locale_data_w_regex_metacharacters"><a class="viewcode-back" href="../../test.html#test.test_strptime.TimeRETests.test_locale_data_w_regex_metacharacters">[docs]</a>    <span class="k">def</span> <span class="nf">test_locale_data_w_regex_metacharacters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Check that if locale data contains regex metacharacters they are</span>
        <span class="c"># escaped properly.</span>
        <span class="c"># Discovered by bug #1039270 .</span>
        <span class="n">locale_time</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">LocaleTime</span><span class="p">()</span>
        <span class="n">locale_time</span><span class="o">.</span><span class="n">timezone</span> <span class="o">=</span> <span class="p">(</span><span class="nb">frozenset</span><span class="p">((</span><span class="s">&quot;utc&quot;</span><span class="p">,</span> <span class="s">&quot;gmt&quot;</span><span class="p">,</span>
                                            <span class="s">&quot;Tokyo (standard time)&quot;</span><span class="p">)),</span>
                                <span class="nb">frozenset</span><span class="p">(</span><span class="s">&quot;Tokyo (daylight time)&quot;</span><span class="p">))</span>
        <span class="n">time_re</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">TimeRE</span><span class="p">(</span><span class="n">locale_time</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">time_re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;%Z&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">&quot;Tokyo (standard time)&quot;</span><span class="p">),</span>
                        <span class="s">&quot;locale data that contains regex metacharacters is not&quot;</span>
                        <span class="s">&quot; properly escaped&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TimeRETests.test_whitespace_substitution"><a class="viewcode-back" href="../../test.html#test.test_strptime.TimeRETests.test_whitespace_substitution">[docs]</a>    <span class="k">def</span> <span class="nf">test_whitespace_substitution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># When pattern contains whitespace, make sure it is taken into account</span>
        <span class="c"># so as to not allow to subpatterns to end up next to each other and</span>
        <span class="c"># &quot;steal&quot; characters from each other.</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_re</span><span class="o">.</span><span class="n">pattern</span><span class="p">(</span><span class="s">&#39;%j %H&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="s">&quot;180&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="s">&quot;18 0&quot;</span><span class="p">))</span>

</div></div>
<div class="viewcode-block" id="StrptimeTests"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests">[docs]</a><span class="k">class</span> <span class="nc">StrptimeTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tests for _strptime.strptime.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="StrptimeTests.setUp"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create testing time tuple.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">gmtime</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_ValueError"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_ValueError">[docs]</a>    <span class="k">def</span> <span class="nf">test_ValueError</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure ValueError is raised when match fails or format is bad</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">,</span> <span class="n">data_string</span><span class="o">=</span><span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span><span class="p">,</span>
                          <span class="n">format</span><span class="o">=</span><span class="s">&quot;%A&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">bad_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;%&quot;</span><span class="p">,</span> <span class="s">&quot;% &quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">%e</span><span class="s">&quot;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&quot;2005&quot;</span><span class="p">,</span> <span class="n">bad_format</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;&#39;</span><span class="si">%s</span><span class="s">&#39; raised </span><span class="si">%s</span><span class="s">, not ValueError&quot;</span> <span class="o">%</span>
                            <span class="p">(</span><span class="n">bad_format</span><span class="p">,</span> <span class="n">err</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;&#39;</span><span class="si">%s</span><span class="s">&#39; did not raise ValueError&quot;</span> <span class="o">%</span> <span class="n">bad_format</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_strptime_exception_context"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_strptime_exception_context">[docs]</a>    <span class="k">def</span> <span class="nf">test_strptime_exception_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># check that this doesn&#39;t chain exceptions needlessly (see #17572)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;%D&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">exception</span><span class="o">.</span><span class="n">__suppress_context__</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="c"># additional check for IndexError branch (issue #19545)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&#39;19&#39;</span><span class="p">,</span> <span class="s">&#39;%Y %&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">exception</span><span class="o">.</span><span class="n">__suppress_context__</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_unconverteddata"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_unconverteddata">[docs]</a>    <span class="k">def</span> <span class="nf">test_unconverteddata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Check ValueError is raised when there is unconverted data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">,</span> <span class="s">&quot;10 12&quot;</span><span class="p">,</span> <span class="s">&quot;%m&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.helper"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.helper">[docs]</a>    <span class="k">def</span> <span class="nf">helper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directive</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Helper fxn in testing.&quot;&quot;&quot;</span>
        <span class="n">strf_output</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%&quot;</span> <span class="o">+</span> <span class="n">directive</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">)</span>
        <span class="n">strp_output</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="n">strf_output</span><span class="p">,</span> <span class="s">&quot;%&quot;</span> <span class="o">+</span> <span class="n">directive</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">strp_output</span><span class="p">[</span><span class="n">position</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">[</span><span class="n">position</span><span class="p">],</span>
                        <span class="s">&quot;testing of &#39;</span><span class="si">%s</span><span class="s">&#39; directive failed; &#39;</span><span class="si">%s</span><span class="s">&#39; -&gt; </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">directive</span><span class="p">,</span> <span class="n">strf_output</span><span class="p">,</span> <span class="n">strp_output</span><span class="p">[</span><span class="n">position</span><span class="p">],</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">[</span><span class="n">position</span><span class="p">]))</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_year"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_year">[docs]</a>    <span class="k">def</span> <span class="nf">test_year</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test that the year is handled properly</span>
        <span class="k">for</span> <span class="n">directive</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="p">(</span><span class="n">directive</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c"># Must also make sure %y values are correct for bounds set by Open Group</span>
        <span class="k">for</span> <span class="n">century</span><span class="p">,</span> <span class="n">bounds</span> <span class="ow">in</span> <span class="p">((</span><span class="mi">1900</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;69&#39;</span><span class="p">,</span> <span class="s">&#39;99&#39;</span><span class="p">)),</span> <span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;00&#39;</span><span class="p">,</span> <span class="s">&#39;68&#39;</span><span class="p">))):</span>
            <span class="k">for</span> <span class="n">bound</span> <span class="ow">in</span> <span class="n">bounds</span><span class="p">:</span>
                <span class="n">strp_output</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="n">bound</span><span class="p">,</span> <span class="s">&#39;%y&#39;</span><span class="p">)</span>
                <span class="n">expected_result</span> <span class="o">=</span> <span class="n">century</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">strp_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">expected_result</span><span class="p">,</span>
                                <span class="s">&quot;&#39;y&#39; test failed; passed in &#39;</span><span class="si">%s</span><span class="s">&#39; &quot;</span>
                                <span class="s">&quot;and returned &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bound</span><span class="p">,</span> <span class="n">strp_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_month"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_month">[docs]</a>    <span class="k">def</span> <span class="nf">test_month</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test for month directives</span>
        <span class="k">for</span> <span class="n">directive</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;m&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="p">(</span><span class="n">directive</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_day"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_day">[docs]</a>    <span class="k">def</span> <span class="nf">test_day</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test for day directives</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_hour"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_hour">[docs]</a>    <span class="k">def</span> <span class="nf">test_hour</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test hour directives</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="p">(</span><span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">strf_output</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%I %p&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">)</span>
        <span class="n">strp_output</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="n">strf_output</span><span class="p">,</span> <span class="s">&quot;%I %p&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">strp_output</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                        <span class="s">&quot;testing of &#39;</span><span class="si">%%</span><span class="s">I </span><span class="si">%%</span><span class="s">p&#39; directive failed; &#39;</span><span class="si">%s</span><span class="s">&#39; -&gt; </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">strf_output</span><span class="p">,</span> <span class="n">strp_output</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_minute"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_minute">[docs]</a>    <span class="k">def</span> <span class="nf">test_minute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test minute directives</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="p">(</span><span class="s">&#39;M&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_second"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_second">[docs]</a>    <span class="k">def</span> <span class="nf">test_second</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test second directives</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="p">(</span><span class="s">&#39;S&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_fraction"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_fraction">[docs]</a>    <span class="k">def</span> <span class="nf">test_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test microseconds</span>
        <span class="kn">import</span> <span class="nn">datetime</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">78987</span><span class="p">)</span>
        <span class="n">tup</span><span class="p">,</span> <span class="n">frac</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">format</span><span class="o">=</span><span class="s">&quot;%Y-%m-</span><span class="si">%d</span><span class="s"> %H:%M:%S.</span><span class="si">%f</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">frac</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">microsecond</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_weekday"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_weekday">[docs]</a>    <span class="k">def</span> <span class="nf">test_weekday</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test weekday directives</span>
        <span class="k">for</span> <span class="n">directive</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="p">(</span><span class="n">directive</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_julian"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_julian">[docs]</a>    <span class="k">def</span> <span class="nf">test_julian</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test julian directives</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="p">(</span><span class="s">&#39;j&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_timezone"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_timezone">[docs]</a>    <span class="k">def</span> <span class="nf">test_timezone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test timezone directives.</span>
        <span class="c"># When gmtime() is used with %Z, entire result of strftime() is empty.</span>
        <span class="c"># Check for equal timezone names deals with bad locale info when this</span>
        <span class="c"># occurs; first found in FreeBSD 4.4.</span>
        <span class="n">strp_output</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&quot;UTC&quot;</span><span class="p">,</span> <span class="s">&quot;%Z&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">strp_output</span><span class="o">.</span><span class="n">tm_isdst</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">strp_output</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&quot;GMT&quot;</span><span class="p">,</span> <span class="s">&quot;%Z&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">strp_output</span><span class="o">.</span><span class="n">tm_isdst</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">time_tuple</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">()</span>
        <span class="n">strf_output</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%Z&quot;</span><span class="p">)</span>  <span class="c">#UTC does not have a timezone</span>
        <span class="n">strp_output</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="n">strf_output</span><span class="p">,</span> <span class="s">&quot;%Z&quot;</span><span class="p">)</span>
        <span class="n">locale_time</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">LocaleTime</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">tzname</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">time</span><span class="o">.</span><span class="n">tzname</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">time</span><span class="o">.</span><span class="n">daylight</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">strp_output</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">==</span> <span class="n">time_tuple</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span>
                            <span class="s">&quot;timezone check failed; &#39;</span><span class="si">%s</span><span class="s">&#39; -&gt; </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                             <span class="p">(</span><span class="n">strf_output</span><span class="p">,</span> <span class="n">strp_output</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">time_tuple</span><span class="p">[</span><span class="mi">8</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">strp_output</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                            <span class="s">&quot;LocaleTime().timezone has duplicate values and &quot;</span>
                             <span class="s">&quot;time.daylight but timezone value not set to -1&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_bad_timezone"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_bad_timezone">[docs]</a>    <span class="k">def</span> <span class="nf">test_bad_timezone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Explicitly test possibility of bad timezone;</span>
        <span class="c"># when time.tzname[0] == time.tzname[1] and time.daylight</span>
        <span class="n">tz_name</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">tzname</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">tz_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;UTC&quot;</span><span class="p">,</span> <span class="s">&quot;GMT&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipTest</span><span class="p">(</span><span class="s">&#39;need non-UTC/GMT timezone&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">original_tzname</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">tzname</span>
            <span class="n">original_daylight</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">daylight</span>
            <span class="n">time</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="p">(</span><span class="n">tz_name</span><span class="p">,</span> <span class="n">tz_name</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">daylight</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">tz_value</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="n">tz_name</span><span class="p">,</span> <span class="s">&quot;%Z&quot;</span><span class="p">)[</span><span class="mi">8</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tz_value</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                    <span class="s">&quot;</span><span class="si">%s</span><span class="s"> lead to a timezone value of </span><span class="si">%s</span><span class="s"> instead of -1 when &quot;</span>
                    <span class="s">&quot;time.daylight set to </span><span class="si">%s</span><span class="s"> and passing in </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                    <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">tz_value</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">daylight</span><span class="p">,</span> <span class="n">tz_name</span><span class="p">))</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">original_tzname</span>
            <span class="n">time</span><span class="o">.</span><span class="n">daylight</span> <span class="o">=</span> <span class="n">original_daylight</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_date_time"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_date_time">[docs]</a>    <span class="k">def</span> <span class="nf">test_date_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test %c directive</span>
        <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="n">position</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_date"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_date">[docs]</a>    <span class="k">def</span> <span class="nf">test_date</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test %x directive</span>
        <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">position</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_time"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_time">[docs]</a>    <span class="k">def</span> <span class="nf">test_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test %X directive</span>
        <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="p">(</span><span class="s">&#39;X&#39;</span><span class="p">,</span> <span class="n">position</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_percent"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_percent">[docs]</a>    <span class="k">def</span> <span class="nf">test_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure % signs are handled properly</span>
        <span class="n">strf_output</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%m </span><span class="si">%%</span><span class="s"> %Y&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">)</span>
        <span class="n">strp_output</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="n">strf_output</span><span class="p">,</span> <span class="s">&quot;%m </span><span class="si">%%</span><span class="s"> %Y&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">strp_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span>
                         <span class="n">strp_output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="s">&quot;handling of percent sign failed&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_caseinsensitive"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_caseinsensitive">[docs]</a>    <span class="k">def</span> <span class="nf">test_caseinsensitive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Should handle names case-insensitively.</span>
        <span class="n">strf_output</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%B&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="n">strf_output</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="s">&quot;%B&quot;</span><span class="p">),</span>
                        <span class="s">&quot;strptime does not handle ALL-CAPS names properly&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="n">strf_output</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="s">&quot;%B&quot;</span><span class="p">),</span>
                        <span class="s">&quot;strptime does not handle lowercase names properly&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="n">strf_output</span><span class="o">.</span><span class="n">capitalize</span><span class="p">(),</span> <span class="s">&quot;%B&quot;</span><span class="p">),</span>
                        <span class="s">&quot;strptime does not handle capword names properly&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_defaults"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_defaults">[docs]</a>    <span class="k">def</span> <span class="nf">test_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Default return value should be (1900, 1, 1, 0, 0, 0, 0, 1, 0)</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1900</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">strp_output</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;%m&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">strp_output</span> <span class="o">==</span> <span class="n">defaults</span><span class="p">,</span>
                        <span class="s">&quot;Default values for strptime() are incorrect;&quot;</span>
                        <span class="s">&quot; </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">strp_output</span><span class="p">,</span> <span class="n">defaults</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_escaping"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_escaping">[docs]</a>    <span class="k">def</span> <span class="nf">test_escaping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure all characters that have regex significance are escaped.</span>
        <span class="c"># Parentheses are in a purposeful order; will cause an error of</span>
        <span class="c"># unbalanced parentheses when the regex is compiled if they are not</span>
        <span class="c"># escaped.</span>
        <span class="c"># Test instigated by bug #796149 .</span>
        <span class="n">need_escaping</span> <span class="o">=</span> <span class="s">&quot;.^$*+?{}\[]|)(&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="n">need_escaping</span><span class="p">,</span> <span class="n">need_escaping</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_feb29_on_leap_year_without_year"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_feb29_on_leap_year_without_year">[docs]</a>    <span class="k">def</span> <span class="nf">test_feb29_on_leap_year_without_year</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s">&quot;Feb 29&quot;</span><span class="p">,</span> <span class="s">&quot;%b </span><span class="si">%d</span><span class="s">&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="StrptimeTests.test_mar1_comes_after_feb29_even_when_omitting_the_year"><a class="viewcode-back" href="../../test.html#test.test_strptime.StrptimeTests.test_mar1_comes_after_feb29_even_when_omitting_the_year">[docs]</a>    <span class="k">def</span> <span class="nf">test_mar1_comes_after_feb29_even_when_omitting_the_year</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span>
                <span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s">&quot;Feb 29&quot;</span><span class="p">,</span> <span class="s">&quot;%b </span><span class="si">%d</span><span class="s">&quot;</span><span class="p">),</span>
                <span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s">&quot;Mar 1&quot;</span><span class="p">,</span> <span class="s">&quot;%b </span><span class="si">%d</span><span class="s">&quot;</span><span class="p">))</span>
</div></div>
<div class="viewcode-block" id="Strptime12AMPMTests"><a class="viewcode-back" href="../../test.html#test.test_strptime.Strptime12AMPMTests">[docs]</a><span class="k">class</span> <span class="nc">Strptime12AMPMTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test a _strptime regression in &#39;%I %p&#39; at 12 noon (12 PM)&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Strptime12AMPMTests.test_twelve_noon_midnight"><a class="viewcode-back" href="../../test.html#test.test_strptime.Strptime12AMPMTests.test_twelve_noon_midnight">[docs]</a>    <span class="k">def</span> <span class="nf">test_twelve_noon_midnight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">eq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span>
        <span class="n">eq</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s">&#39;12 PM&#39;</span><span class="p">,</span> <span class="s">&#39;%I %p&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">12</span><span class="p">)</span>
        <span class="n">eq</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s">&#39;12 AM&#39;</span><span class="p">,</span> <span class="s">&#39;%I %p&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">eq</span><span class="p">(</span><span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&#39;12 PM&#39;</span><span class="p">,</span> <span class="s">&#39;%I %p&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">12</span><span class="p">)</span>
        <span class="n">eq</span><span class="p">(</span><span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&#39;12 AM&#39;</span><span class="p">,</span> <span class="s">&#39;%I %p&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="JulianTests"><a class="viewcode-back" href="../../test.html#test.test_strptime.JulianTests">[docs]</a><span class="k">class</span> <span class="nc">JulianTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test a _strptime regression that all julian (1-366) are accepted&quot;&quot;&quot;</span>

<div class="viewcode-block" id="JulianTests.test_all_julian_days"><a class="viewcode-back" href="../../test.html#test.test_strptime.JulianTests.test_all_julian_days">[docs]</a>    <span class="k">def</span> <span class="nf">test_all_julian_days</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">eq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">367</span><span class="p">):</span>
            <span class="c"># use 2004, since it is a leap year, we have 366 days</span>
            <span class="n">eq</span><span class="p">(</span><span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%d</span><span class="s"> 2004&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s">&#39;%j %Y&#39;</span><span class="p">)[</span><span class="mi">7</span><span class="p">],</span> <span class="n">i</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="CalculationTests"><a class="viewcode-back" href="../../test.html#test.test_strptime.CalculationTests">[docs]</a><span class="k">class</span> <span class="nc">CalculationTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test that strptime() fills in missing info correctly&quot;&quot;&quot;</span>

<div class="viewcode-block" id="CalculationTests.setUp"><a class="viewcode-back" href="../../test.html#test.test_strptime.CalculationTests.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">gmtime</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="CalculationTests.test_julian_calculation"><a class="viewcode-back" href="../../test.html#test.test_strptime.CalculationTests.test_julian_calculation">[docs]</a>    <span class="k">def</span> <span class="nf">test_julian_calculation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure that when Julian is missing that it is calculated</span>
        <span class="n">format_string</span> <span class="o">=</span> <span class="s">&quot;%Y %m </span><span class="si">%d</span><span class="s"> %H %M %S %w %Z&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">format_string</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">),</span>
                                    <span class="n">format_string</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">tm_yday</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="o">.</span><span class="n">tm_yday</span><span class="p">,</span>
                        <span class="s">&quot;Calculation of tm_yday failed; </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">tm_yday</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="o">.</span><span class="n">tm_yday</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="CalculationTests.test_gregorian_calculation"><a class="viewcode-back" href="../../test.html#test.test_strptime.CalculationTests.test_gregorian_calculation">[docs]</a>    <span class="k">def</span> <span class="nf">test_gregorian_calculation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test that Gregorian date can be calculated from Julian day</span>
        <span class="n">format_string</span> <span class="o">=</span> <span class="s">&quot;%Y %H %M %S %w %j %Z&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">format_string</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">),</span>
                                    <span class="n">format_string</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">tm_year</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="o">.</span><span class="n">tm_year</span> <span class="ow">and</span>
                         <span class="n">result</span><span class="o">.</span><span class="n">tm_mon</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="o">.</span><span class="n">tm_mon</span> <span class="ow">and</span>
                         <span class="n">result</span><span class="o">.</span><span class="n">tm_mday</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="o">.</span><span class="n">tm_mday</span><span class="p">,</span>
                        <span class="s">&quot;Calculation of Gregorian date failed;&quot;</span>
                         <span class="s">&quot;</span><span class="si">%s</span><span class="s">-</span><span class="si">%s</span><span class="s">-</span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">-</span><span class="si">%s</span><span class="s">-</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">tm_year</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">tm_mon</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">tm_mday</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="o">.</span><span class="n">tm_year</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="o">.</span><span class="n">tm_mon</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="o">.</span><span class="n">tm_mday</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="CalculationTests.test_day_of_week_calculation"><a class="viewcode-back" href="../../test.html#test.test_strptime.CalculationTests.test_day_of_week_calculation">[docs]</a>    <span class="k">def</span> <span class="nf">test_day_of_week_calculation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test that the day of the week is calculated as needed</span>
        <span class="n">format_string</span> <span class="o">=</span> <span class="s">&quot;%Y %m </span><span class="si">%d</span><span class="s"> %H %S %j %Z&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">format_string</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="p">),</span>
                                    <span class="n">format_string</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">tm_wday</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="o">.</span><span class="n">tm_wday</span><span class="p">,</span>
                        <span class="s">&quot;Calculation of day of the week failed;&quot;</span>
                         <span class="s">&quot;</span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">tm_wday</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tuple</span><span class="o">.</span><span class="n">tm_wday</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="CalculationTests.test_week_of_year_and_day_of_week_calculation"><a class="viewcode-back" href="../../test.html#test.test_strptime.CalculationTests.test_week_of_year_and_day_of_week_calculation">[docs]</a>    <span class="k">def</span> <span class="nf">test_week_of_year_and_day_of_week_calculation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Should be able to infer date if given year, week of year (%U or %W)</span>
        <span class="c"># and day of the week</span>
        <span class="k">def</span> <span class="nf">test_helper</span><span class="p">(</span><span class="n">ymd_tuple</span><span class="p">,</span> <span class="n">test_reason</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">directive</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;W&#39;</span><span class="p">,</span> <span class="s">&#39;U&#39;</span><span class="p">):</span>
                <span class="n">format_string</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%%</span><span class="s">Y </span><span class="si">%%%s</span><span class="s"> </span><span class="si">%%</span><span class="s">w&quot;</span> <span class="o">%</span> <span class="n">directive</span>
                <span class="n">dt_date</span> <span class="o">=</span> <span class="n">datetime_date</span><span class="p">(</span><span class="o">*</span><span class="n">ymd_tuple</span><span class="p">)</span>
                <span class="n">strp_input</span> <span class="o">=</span> <span class="n">dt_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">format_string</span><span class="p">)</span>
                <span class="n">strp_output</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="n">strp_input</span><span class="p">,</span> <span class="n">format_string</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">strp_output</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">ymd_tuple</span><span class="p">,</span>
                        <span class="s">&quot;</span><span class="si">%s</span><span class="s">(</span><span class="si">%s</span><span class="s">) test failed w/ &#39;</span><span class="si">%s</span><span class="s">&#39;: </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s"> (</span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span>
                            <span class="p">(</span><span class="n">test_reason</span><span class="p">,</span> <span class="n">directive</span><span class="p">,</span> <span class="n">strp_input</span><span class="p">,</span>
                                <span class="n">strp_output</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">ymd_tuple</span><span class="p">,</span>
                                <span class="n">strp_output</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">dt_date</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()[</span><span class="mi">7</span><span class="p">]))</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">1901</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s">&quot;week 0&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">1901</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="s">&quot;common case&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">1901</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="s">&quot;day on Sunday&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">1901</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="s">&quot;day on Monday&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">1905</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s">&quot;Jan 1 on Sunday&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">1906</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s">&quot;Jan 1 on Monday&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">1906</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="s">&quot;first Sunday in a year starting on Monday&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">1905</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span> <span class="s">&quot;Dec 31 on Sunday&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">1906</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span> <span class="s">&quot;Dec 31 on Monday&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">2008</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span> <span class="s">&quot;Monday in the last week of the year&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">2008</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="s">&quot;Monday in the second-to-last week of the &quot;</span>
                                    <span class="s">&quot;year&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">1978</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="s">&quot;randomly chosen date&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">2004</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="s">&quot;randomly chosen date&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">1978</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="s">&quot;year starting and ending on Monday while &quot;</span>
                                        <span class="s">&quot;date not on Sunday or Monday&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">1917</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="s">&quot;year starting and ending on Monday with &quot;</span>
                                        <span class="s">&quot;a Monday not at the beginning or end &quot;</span>
                                        <span class="s">&quot;of the year&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">1917</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span> <span class="s">&quot;Dec 31 on Monday with year starting and &quot;</span>
                                        <span class="s">&quot;ending on Monday&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">2007</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="s">&quot;First Sunday of 2007&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">2007</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="s">&quot;Second Sunday of 2007&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">2006</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span> <span class="s">&quot;Last Sunday of 2006&quot;</span><span class="p">)</span>
        <span class="n">test_helper</span><span class="p">((</span><span class="mi">2006</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="s">&quot;Second to last Sunday of 2006&quot;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="CacheTests"><a class="viewcode-back" href="../../test.html#test.test_strptime.CacheTests">[docs]</a><span class="k">class</span> <span class="nc">CacheTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test that caching works properly.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="CacheTests.test_time_re_recreation"><a class="viewcode-back" href="../../test.html#test.test_strptime.CacheTests.test_time_re_recreation">[docs]</a>    <span class="k">def</span> <span class="nf">test_time_re_recreation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure cache is recreated when current locale does not match what</span>
        <span class="c"># cached object was created with.</span>
        <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&quot;2005&quot;</span><span class="p">,</span> <span class="s">&quot;%Y&quot;</span><span class="p">)</span>
        <span class="n">_strptime</span><span class="o">.</span><span class="n">_TimeRE_cache</span><span class="o">.</span><span class="n">locale_time</span><span class="o">.</span><span class="n">lang</span> <span class="o">=</span> <span class="s">&quot;Ni&quot;</span>
        <span class="n">original_time_re</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_TimeRE_cache</span>
        <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">original_time_re</span><span class="p">,</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_TimeRE_cache</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_strptime</span><span class="o">.</span><span class="n">_regex_cache</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CacheTests.test_regex_cleanup"><a class="viewcode-back" href="../../test.html#test.test_strptime.CacheTests.test_regex_cleanup">[docs]</a>    <span class="k">def</span> <span class="nf">test_regex_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Make sure cached regexes are discarded when cache becomes &quot;full&quot;.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_regex_cache</span><span class="p">[</span><span class="s">&#39;</span><span class="si">%d</span><span class="s">&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">bogus_key</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">_strptime</span><span class="o">.</span><span class="n">_regex_cache</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_CACHE_MAX_SIZE</span><span class="p">:</span>
            <span class="n">_strptime</span><span class="o">.</span><span class="n">_regex_cache</span><span class="p">[</span><span class="n">bogus_key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">bogus_key</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_strptime</span><span class="o">.</span><span class="n">_regex_cache</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CacheTests.test_new_localetime"><a class="viewcode-back" href="../../test.html#test.test_strptime.CacheTests.test_new_localetime">[docs]</a>    <span class="k">def</span> <span class="nf">test_new_localetime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># A new LocaleTime instance should be created when a new TimeRE object</span>
        <span class="c"># is created.</span>
        <span class="n">locale_time_id</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_TimeRE_cache</span><span class="o">.</span><span class="n">locale_time</span>
        <span class="n">_strptime</span><span class="o">.</span><span class="n">_TimeRE_cache</span><span class="o">.</span><span class="n">locale_time</span><span class="o">.</span><span class="n">lang</span> <span class="o">=</span> <span class="s">&quot;Ni&quot;</span>
        <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">locale_time_id</span><span class="p">,</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_TimeRE_cache</span><span class="o">.</span><span class="n">locale_time</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CacheTests.test_TimeRE_recreation"><a class="viewcode-back" href="../../test.html#test.test_strptime.CacheTests.test_TimeRE_recreation">[docs]</a>    <span class="k">def</span> <span class="nf">test_TimeRE_recreation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># The TimeRE instance should be recreated upon changing the locale.</span>
        <span class="n">locale_info</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">getlocale</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">LC_TIME</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">locale</span><span class="o">.</span><span class="n">setlocale</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">LC_TIME</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;en_US&#39;</span><span class="p">,</span> <span class="s">&#39;UTF8&#39;</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">locale</span><span class="o">.</span><span class="n">Error</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skipTest</span><span class="p">(</span><span class="s">&#39;test needs en_US.UTF8 locale&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&#39;10&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="si">%d</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="c"># Get id of current cache object.</span>
            <span class="n">first_time_re</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_TimeRE_cache</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c"># Change the locale and force a recreation of the cache.</span>
                <span class="n">locale</span><span class="o">.</span><span class="n">setlocale</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">LC_TIME</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;de_DE&#39;</span><span class="p">,</span> <span class="s">&#39;UTF8&#39;</span><span class="p">))</span>
                <span class="n">_strptime</span><span class="o">.</span><span class="n">_strptime_time</span><span class="p">(</span><span class="s">&#39;10&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="si">%d</span><span class="s">&#39;</span><span class="p">)</span>
                <span class="c"># Get the new cache object&#39;s id.</span>
                <span class="n">second_time_re</span> <span class="o">=</span> <span class="n">_strptime</span><span class="o">.</span><span class="n">_TimeRE_cache</span>
                <span class="c"># They should not be equal.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNot</span><span class="p">(</span><span class="n">first_time_re</span><span class="p">,</span> <span class="n">second_time_re</span><span class="p">)</span>
            <span class="c"># Possible test locale is not supported while initial locale is.</span>
            <span class="c"># If this is the case just suppress the exception and fall-through</span>
            <span class="c"># to the resetting to the original locale.</span>
            <span class="k">except</span> <span class="n">locale</span><span class="o">.</span><span class="n">Error</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">skipTest</span><span class="p">(</span><span class="s">&#39;test needs de_DE.UTF8 locale&#39;</span><span class="p">)</span>
        <span class="c"># Make sure we don&#39;t trample on the locale setting once we leave the</span>
        <span class="c"># test.</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">locale</span><span class="o">.</span><span class="n">setlocale</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">LC_TIME</span><span class="p">,</span> <span class="n">locale_info</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="test_main"><a class="viewcode-back" href="../../test.html#test.test_strptime.test_main">[docs]</a><span class="k">def</span> <span class="nf">test_main</span><span class="p">():</span>
    <span class="n">support</span><span class="o">.</span><span class="n">run_unittest</span><span class="p">(</span>
        <span class="n">getlang_Tests</span><span class="p">,</span>
        <span class="n">LocaleTime_Tests</span><span class="p">,</span>
        <span class="n">TimeRETests</span><span class="p">,</span>
        <span class="n">StrptimeTests</span><span class="p">,</span>
        <span class="n">Strptime12AMPMTests</span><span class="p">,</span>
        <span class="n">JulianTests</span><span class="p">,</span>
        <span class="n">CalculationTests</span><span class="p">,</span>
        <span class="n">CacheTests</span>
    <span class="p">)</span>

</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">test_main</span><span class="p">()</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Weldon Henson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>